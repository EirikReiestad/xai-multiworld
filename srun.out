Cleaning up
Running from this directory: /cluster/work/eirre/xai-multiworld
Name of job: multi-agent-rl
ID of job: 22842627
The jo was run on these nodes: idun-04-11

Currently Loaded Modules:
  1) GCCcore/13.2.0                       7) Tcl/8.6.13-GCCcore-13.2.0    (H)
  2) zlib/1.2.13-GCCcore-13.2.0     (H)   8) SQLite/3.43.1-GCCcore-13.2.0 (H)
  3) binutils/2.40-GCCcore-13.2.0   (H)   9) XZ/5.4.4-GCCcore-13.2.0      (H)
  4) bzip2/1.0.8-GCCcore-13.2.0     (H)  10) libffi/3.4.4-GCCcore-13.2.0  (H)
  5) ncurses/6.4-GCCcore-13.2.0     (H)  11) OpenSSL/1.1                  (H)
  6) libreadline/8.2-GCCcore-13.2.0 (H)  12) Python/3.11.5-GCCcore-13.2.0

  Where:
   H:  Hidden Module

 

Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: pip in /cluster/home/eirre/.local/lib/python3.11/site-packages (25.1.1)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: poetry in /cluster/home/eirre/.local/lib/python3.11/site-packages (1.8.3)
Requirement already satisfied: build<2.0.0,>=1.0.3 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (1.2.2)
Requirement already satisfied: cachecontrol<0.15.0,>=0.14.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from cachecontrol[filecache]<0.15.0,>=0.14.0->poetry) (0.14.0)
Requirement already satisfied: cleo<3.0.0,>=2.1.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (2.1.0)
Requirement already satisfied: crashtest<0.5.0,>=0.4.1 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (0.4.1)
Requirement already satisfied: dulwich<0.22.0,>=0.21.2 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (0.21.7)
Requirement already satisfied: fastjsonschema<3.0.0,>=2.18.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (2.20.0)
Requirement already satisfied: installer<0.8.0,>=0.7.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (0.7.0)
Requirement already satisfied: keyring<25.0.0,>=24.0.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (24.3.1)
Requirement already satisfied: packaging>=23.1 in /cluster/apps/eb/software/Python/3.11.5-GCCcore-13.2.0/lib/python3.11/site-packages (from poetry) (23.2)
Requirement already satisfied: pexpect<5.0.0,>=4.7.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (4.9.0)
Requirement already satisfied: pkginfo<2.0,>=1.10 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (1.11.1)
Requirement already satisfied: platformdirs<5,>=3.0.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (4.3.6)
Requirement already satisfied: poetry-core==1.9.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (1.9.0)
Requirement already satisfied: poetry-plugin-export<2.0.0,>=1.6.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (1.8.0)
Requirement already satisfied: pyproject-hooks<2.0.0,>=1.0.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (1.1.0)
Requirement already satisfied: requests<3.0,>=2.26 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (2.32.3)
Requirement already satisfied: requests-toolbelt<2.0.0,>=1.0.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (1.0.0)
Requirement already satisfied: shellingham<2.0,>=1.5 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (1.5.4)
Requirement already satisfied: tomlkit<1.0.0,>=0.11.4 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (0.13.2)
Requirement already satisfied: trove-classifiers>=2022.5.19 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (2024.9.12)
Requirement already satisfied: virtualenv<21.0.0,>=20.23.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (20.26.5)
Requirement already satisfied: msgpack<2.0.0,>=0.5.2 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from cachecontrol<0.15.0,>=0.14.0->cachecontrol[filecache]<0.15.0,>=0.14.0->poetry) (1.1.0)
Requirement already satisfied: filelock>=3.8.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from cachecontrol[filecache]<0.15.0,>=0.14.0->poetry) (3.16.1)
Requirement already satisfied: rapidfuzz<4.0.0,>=3.0.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from cleo<3.0.0,>=2.1.0->poetry) (3.9.7)
Requirement already satisfied: urllib3>=1.25 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from dulwich<0.22.0,>=0.21.2->poetry) (2.2.3)
Requirement already satisfied: jaraco.classes in /cluster/home/eirre/.local/lib/python3.11/site-packages (from keyring<25.0.0,>=24.0.0->poetry) (3.4.0)
Requirement already satisfied: importlib-metadata>=4.11.4 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from keyring<25.0.0,>=24.0.0->poetry) (8.5.0)
Requirement already satisfied: SecretStorage>=3.2 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from keyring<25.0.0,>=24.0.0->poetry) (3.3.3)
Requirement already satisfied: jeepney>=0.4.2 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from keyring<25.0.0,>=24.0.0->poetry) (0.8.0)
Requirement already satisfied: ptyprocess>=0.5 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from pexpect<5.0.0,>=4.7.0->poetry) (0.7.0)
Requirement already satisfied: charset-normalizer<4,>=2 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from requests<3.0,>=2.26->poetry) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from requests<3.0,>=2.26->poetry) (3.10)
Requirement already satisfied: certifi>=2017.4.17 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from requests<3.0,>=2.26->poetry) (2024.8.30)
Requirement already satisfied: distlib<1,>=0.3.7 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from virtualenv<21.0.0,>=20.23.0->poetry) (0.3.8)
Requirement already satisfied: zipp>=3.20 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from importlib-metadata>=4.11.4->keyring<25.0.0,>=24.0.0->poetry) (3.20.2)
Requirement already satisfied: cryptography>=2.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from SecretStorage>=3.2->keyring<25.0.0,>=24.0.0->poetry) (43.0.1)
Requirement already satisfied: cffi>=1.12 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from cryptography>=2.0->SecretStorage>=3.2->keyring<25.0.0,>=24.0.0->poetry) (1.17.1)
Requirement already satisfied: pycparser in /cluster/home/eirre/.local/lib/python3.11/site-packages (from cffi>=1.12->cryptography>=2.0->SecretStorage>=3.2->keyring<25.0.0,>=24.0.0->poetry) (2.22)
Requirement already satisfied: more-itertools in /cluster/home/eirre/.local/lib/python3.11/site-packages (from jaraco.classes->keyring<25.0.0,>=24.0.0->poetry) (10.5.0)
Installing dependencies from lock file

No dependencies to install or update

Installing the current project: xai-multiworld (0.1.0)

Test set: Average loss: 0.0364, Accuracy: 9874/10000 (99%)


Testing with M=15
Step 0000 | Epoch 01 | Objective: -3.2349 | Coherence: 16.8397 | Separation: 56.8556 | Information gain: 7.6667 | Grad Norm: 4.3572 | Time: 0.4s
Step 0010 | Epoch 01 | Objective: -2.9697 | Coherence: 17.8470 | Separation: 55.2108 | Information gain: 7.6667 | Grad Norm: 4.2500 | Time: 0.6s
Step 0020 | Epoch 01 | Objective: -2.7039 | Coherence: 18.8564 | Separation: 53.5622 | Information gain: 7.6667 | Grad Norm: 4.2116 | Time: 0.8s
Step 0030 | Epoch 01 | Objective: -2.4397 | Coherence: 19.8720 | Separation: 51.9353 | Information gain: 7.6667 | Grad Norm: 4.0964 | Time: 1.0s
Step 0040 | Epoch 01 | Objective: -2.1914 | Coherence: 20.8634 | Separation: 50.4443 | Information gain: 7.6667 | Grad Norm: 3.8701 | Time: 1.3s
Step 0050 | Epoch 01 | Objective: -1.9435 | Coherence: 21.8252 | Separation: 48.9264 | Information gain: 7.6667 | Grad Norm: 3.8715 | Time: 1.5s
Step 0060 | Epoch 01 | Objective: -1.7020 | Coherence: 22.8296 | Separation: 47.5159 | Information gain: 7.6667 | Grad Norm: 3.6559 | Time: 1.7s
Step 0070 | Epoch 01 | Objective: -1.4849 | Coherence: 23.8681 | Separation: 46.2166 | Information gain: 7.5000 | Grad Norm: 3.6346 | Time: 1.9s
Step 0080 | Epoch 01 | Objective: -1.2688 | Coherence: 24.8636 | Separation: 45.0511 | Information gain: 7.5000 | Grad Norm: 3.4616 | Time: 2.2s
Step 0090 | Epoch 01 | Objective: -1.0599 | Coherence: 25.7968 | Separation: 43.8961 | Information gain: 7.5000 | Grad Norm: 3.4606 | Time: 2.4s
Step 0100 | Epoch 01 | Objective: -0.8745 | Coherence: 26.6669 | Separation: 42.7455 | Information gain: 7.3333 | Grad Norm: 3.3316 | Time: 2.6s
Step 0110 | Epoch 01 | Objective: -0.6746 | Coherence: 27.5155 | Separation: 41.5950 | Information gain: 7.3333 | Grad Norm: 3.2723 | Time: 2.8s
Step 0120 | Epoch 01 | Objective: -0.4769 | Coherence: 28.2952 | Separation: 40.3972 | Information gain: 7.3333 | Grad Norm: 3.2583 | Time: 3.1s
Step 0130 | Epoch 01 | Objective: -0.2795 | Coherence: 29.0805 | Separation: 39.2089 | Information gain: 7.3333 | Grad Norm: 3.2179 | Time: 3.3s
Step 0140 | Epoch 01 | Objective: -0.0905 | Coherence: 29.8190 | Separation: 38.0573 | Information gain: 7.3333 | Grad Norm: 3.1765 | Time: 3.5s
Step 0150 | Epoch 01 | Objective: 0.0938 | Coherence: 30.5955 | Separation: 36.9906 | Information gain: 7.3333 | Grad Norm: 3.0025 | Time: 3.8s
Step 0160 | Epoch 01 | Objective: 0.2555 | Coherence: 31.3930 | Separation: 36.0042 | Information gain: 7.1667 | Grad Norm: 2.9138 | Time: 4.0s
Step 0170 | Epoch 01 | Objective: 0.4334 | Coherence: 32.2658 | Separation: 35.0984 | Information gain: 7.1667 | Grad Norm: 2.9927 | Time: 4.2s
Step 0180 | Epoch 01 | Objective: 0.5841 | Coherence: 33.1137 | Separation: 34.2732 | Information gain: 7.0000 | Grad Norm: 3.0323 | Time: 4.4s
Step 0190 | Epoch 01 | Objective: 0.7260 | Coherence: 33.9304 | Separation: 33.5041 | Information gain: 6.8333 | Grad Norm: 3.1780 | Time: 4.7s
Step 0200 | Epoch 01 | Objective: 0.8932 | Coherence: 34.6670 | Separation: 32.7348 | Information gain: 7.0000 | Grad Norm: 2.8412 | Time: 4.9s
Step 0201 | Epoch 01 | Objective: 0.9086 | Coherence: 34.7403 | Separation: 32.6547 | Information gain: 7.0000 | Grad Norm: 2.8159 | Time: 4.9s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.640571  0.517020  0.625197  ...  0.299442  0.470064  0.422283
1  0.535189  0.609415  0.546344  ...  0.410953  0.415965  0.399935
2  0.588157  0.495752  0.601048  ...  0.311358  0.438870  0.427675
3  0.463249  0.555807  0.470515  ...  0.486602  0.513965  0.472109
4  0.411860  0.385645  0.407961  ...  0.425042  0.555124  0.513310

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7829
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8900
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8740
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.1554, accuracy=0.0883
Testing SVM
  SVM Test Accuracy: 0.8536
Testing SVM
  SVM Test Accuracy: 0.8536
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8283
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000


===== Computing accuracy for [0, 1, 6, 7, 8, 10, 12, 14] (0/3) =====
Linux idun-04-11 5.14.0-427.13.1.el9_4.x86_64 #1 SMP PREEMPT_DYNAMIC Wed May 1 19:11:28 UTC 2024 x86_64 x86_64 x86_64 GNU/Linux
