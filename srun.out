Cleaning up
Running from this directory: /cluster/work/eirre/xai-multiworld
Name of job: multi-agent-rl
ID of job: 22832302
The jo was run on these nodes: idun-03-15

Currently Loaded Modules:
  1) GCCcore/13.2.0                       7) Tcl/8.6.13-GCCcore-13.2.0    (H)
  2) zlib/1.2.13-GCCcore-13.2.0     (H)   8) SQLite/3.43.1-GCCcore-13.2.0 (H)
  3) binutils/2.40-GCCcore-13.2.0   (H)   9) XZ/5.4.4-GCCcore-13.2.0      (H)
  4) bzip2/1.0.8-GCCcore-13.2.0     (H)  10) libffi/3.4.4-GCCcore-13.2.0  (H)
  5) ncurses/6.4-GCCcore-13.2.0     (H)  11) OpenSSL/1.1                  (H)
  6) libreadline/8.2-GCCcore-13.2.0 (H)  12) Python/3.11.5-GCCcore-13.2.0

  Where:
   H:  Hidden Module

 

Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: pip in /cluster/home/eirre/.local/lib/python3.11/site-packages (25.1.1)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: poetry in /cluster/home/eirre/.local/lib/python3.11/site-packages (1.8.3)
Requirement already satisfied: build<2.0.0,>=1.0.3 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (1.2.2)
Requirement already satisfied: cachecontrol<0.15.0,>=0.14.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from cachecontrol[filecache]<0.15.0,>=0.14.0->poetry) (0.14.0)
Requirement already satisfied: cleo<3.0.0,>=2.1.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (2.1.0)
Requirement already satisfied: crashtest<0.5.0,>=0.4.1 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (0.4.1)
Requirement already satisfied: dulwich<0.22.0,>=0.21.2 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (0.21.7)
Requirement already satisfied: fastjsonschema<3.0.0,>=2.18.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (2.20.0)
Requirement already satisfied: installer<0.8.0,>=0.7.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (0.7.0)
Requirement already satisfied: keyring<25.0.0,>=24.0.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (24.3.1)
Requirement already satisfied: packaging>=23.1 in /cluster/apps/eb/software/Python/3.11.5-GCCcore-13.2.0/lib/python3.11/site-packages (from poetry) (23.2)
Requirement already satisfied: pexpect<5.0.0,>=4.7.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (4.9.0)
Requirement already satisfied: pkginfo<2.0,>=1.10 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (1.11.1)
Requirement already satisfied: platformdirs<5,>=3.0.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (4.3.6)
Requirement already satisfied: poetry-core==1.9.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (1.9.0)
Requirement already satisfied: poetry-plugin-export<2.0.0,>=1.6.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (1.8.0)
Requirement already satisfied: pyproject-hooks<2.0.0,>=1.0.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (1.1.0)
Requirement already satisfied: requests<3.0,>=2.26 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (2.32.3)
Requirement already satisfied: requests-toolbelt<2.0.0,>=1.0.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (1.0.0)
Requirement already satisfied: shellingham<2.0,>=1.5 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (1.5.4)
Requirement already satisfied: tomlkit<1.0.0,>=0.11.4 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (0.13.2)
Requirement already satisfied: trove-classifiers>=2022.5.19 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (2024.9.12)
Requirement already satisfied: virtualenv<21.0.0,>=20.23.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from poetry) (20.26.5)
Requirement already satisfied: msgpack<2.0.0,>=0.5.2 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from cachecontrol<0.15.0,>=0.14.0->cachecontrol[filecache]<0.15.0,>=0.14.0->poetry) (1.1.0)
Requirement already satisfied: filelock>=3.8.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from cachecontrol[filecache]<0.15.0,>=0.14.0->poetry) (3.16.1)
Requirement already satisfied: rapidfuzz<4.0.0,>=3.0.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from cleo<3.0.0,>=2.1.0->poetry) (3.9.7)
Requirement already satisfied: urllib3>=1.25 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from dulwich<0.22.0,>=0.21.2->poetry) (2.2.3)
Requirement already satisfied: jaraco.classes in /cluster/home/eirre/.local/lib/python3.11/site-packages (from keyring<25.0.0,>=24.0.0->poetry) (3.4.0)
Requirement already satisfied: importlib-metadata>=4.11.4 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from keyring<25.0.0,>=24.0.0->poetry) (8.5.0)
Requirement already satisfied: SecretStorage>=3.2 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from keyring<25.0.0,>=24.0.0->poetry) (3.3.3)
Requirement already satisfied: jeepney>=0.4.2 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from keyring<25.0.0,>=24.0.0->poetry) (0.8.0)
Requirement already satisfied: ptyprocess>=0.5 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from pexpect<5.0.0,>=4.7.0->poetry) (0.7.0)
Requirement already satisfied: charset-normalizer<4,>=2 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from requests<3.0,>=2.26->poetry) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from requests<3.0,>=2.26->poetry) (3.10)
Requirement already satisfied: certifi>=2017.4.17 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from requests<3.0,>=2.26->poetry) (2024.8.30)
Requirement already satisfied: distlib<1,>=0.3.7 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from virtualenv<21.0.0,>=20.23.0->poetry) (0.3.8)
Requirement already satisfied: zipp>=3.20 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from importlib-metadata>=4.11.4->keyring<25.0.0,>=24.0.0->poetry) (3.20.2)
Requirement already satisfied: cryptography>=2.0 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from SecretStorage>=3.2->keyring<25.0.0,>=24.0.0->poetry) (43.0.1)
Requirement already satisfied: cffi>=1.12 in /cluster/home/eirre/.local/lib/python3.11/site-packages (from cryptography>=2.0->SecretStorage>=3.2->keyring<25.0.0,>=24.0.0->poetry) (1.17.1)
Requirement already satisfied: pycparser in /cluster/home/eirre/.local/lib/python3.11/site-packages (from cffi>=1.12->cryptography>=2.0->SecretStorage>=3.2->keyring<25.0.0,>=24.0.0->poetry) (2.22)
Requirement already satisfied: more-itertools in /cluster/home/eirre/.local/lib/python3.11/site-packages (from jaraco.classes->keyring<25.0.0,>=24.0.0->poetry) (10.5.0)
Installing dependencies from lock file

No dependencies to install or update

Installing the current project: xai-multiworld (0.1.0)

Virtualenv
Python:         3.11.5
Implementation: CPython
Path:           /cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11
Executable:     /cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/bin/python
Valid:          True

Base
Platform:   linux
OS:         posix
Python:     3.11.5
Path:       /cluster/apps/eb/software/Python/3.11.3-GCCcore-12.3.0
Executable: /cluster/apps/eb/software/Python/3.11.3-GCCcore-12.3.0/bin/python3.11
absl-py                  2.1.0         Abseil Python Common Libraries, see ...
aenum                    3.1.15        Advanced Enumerations (compatible wi...
annotated-types          0.7.0         Reusable constraint types to use wit...
asttokens                3.0.0         Annotate AST trees with source code ...
attrs                    25.1.0        Classes Without Boilerplate
certifi                  2025.1.31     Python package for providing Mozilla...
cffi                     1.17.1        Foreign Function Interface for Pytho...
charset-normalizer       3.4.1         The Real First Universal Charset Det...
click                    8.1.8         Composable command line interface to...
cloudpickle              3.1.1         Pickler class to extend the standard...
contourpy                1.3.1         Python library for calculating conto...
coverage                 7.7.0         Code coverage measurement for Python
coveralls                1.8.0         Show coverage stats online via cover...
cycler                   0.12.1        Composable style cycles
decorator                5.2.1         Decorators for Humans
dm-tree                  0.1.9         Tree is a library for working with n...
docker-pycreds           0.4.0         Python bindings for the docker crede...
docopt                   0.6.2         Pythonic argument parser, that will ...
einops                   0.8.1         A new flavour of deep learning opera...
evdev                    1.8.0         Bindings to the Linux input handling...
executing                2.2.0         Get the currently executing AST node...
farama-notifications     0.0.4         Notifications for all Farama Foundat...
filelock                 3.17.0        A platform independent file lock.
fonttools                4.55.8        Tools to manipulate font files
fsspec                   2025.2.0      File-system specification
future                   1.0.0         Clean single-source support for Pyth...
gitdb                    4.0.12        Git Object Database
gitpython                3.1.44        GitPython is a Python library used t...
grpcio                   1.70.0        HTTP/2-based RPC framework
gymnasium                1.0.0         A standard API for reinforcement lea...
idna                     3.10          Internationalized Domain Names in Ap...
imageio                  2.37.0        Library for reading and writing a wi...
imageio-ffmpeg           0.6.0         FFMPEG wrapper for Python
iniconfig                2.0.0         brain-dead simple config-ini parsing
ipython                  9.0.2         IPython: Productive Interactive Comp...
ipython-pygments-lexers  1.1.1         Defines a variety of Pygments lexers...
isort                    5.13.2        A Python utility / library to sort P...
jedi                     0.19.2        An autocompletion tool for Python th...
jinja2                   3.1.5         A very fast and expressive template ...
joblib                   1.4.2         Lightweight pipelining with Python f...
kiwisolver               1.4.8         A fast implementation of the Cassowa...
kornia                   0.4.1         Open Source Differentiable Computer ...
lazy-loader              0.4           Makes it easy to load subpackages an...
llvmlite                 0.44.0        lightweight wrapper around basic LLV...
markdown                 3.7           Python implementation of John Gruber...
markupsafe               3.0.2         Safely add untrusted strings to HTML...
matplotlib               3.10.0        Python plotting package
matplotlib-inline        0.1.7         Inline Matplotlib backend for Jupyter
moviepy                  2.1.2         Video editing with Python
mpmath                   1.3.0         Python library for arbitrary-precisi...
networkx                 3.4.2         Python package for creating and mani...
numba                    0.61.0        compiling Python code using LLVM
numpy                    2.1.3         Fundamental package for array comput...
nvidia-cublas-cu12       12.4.5.8      CUBLAS native runtime libraries
nvidia-cuda-cupti-cu12   12.4.127      CUDA profiling tools runtime libs.
nvidia-cuda-nvrtc-cu12   12.4.127      NVRTC native runtime libraries
nvidia-cuda-runtime-cu12 12.4.127      CUDA Runtime native Libraries
nvidia-cudnn-cu12        9.1.0.70      cuDNN runtime libraries
nvidia-cufft-cu12        11.2.1.3      CUFFT native runtime libraries
nvidia-curand-cu12       10.3.5.147    CURAND native runtime libraries
nvidia-cusolver-cu12     11.6.1.9      CUDA solver native runtime libraries
nvidia-cusparse-cu12     12.3.1.170    CUSPARSE native runtime libraries
nvidia-cusparselt-cu12   0.6.2         NVIDIA cuSPARSELt
nvidia-nccl-cu12         2.21.5        NVIDIA Collective Communication Libr...
nvidia-nvjitlink-cu12    12.4.127      Nvidia JIT LTO Library
nvidia-nvtx-cu12         12.4.127      NVIDIA Tools Extension
opencv-python            4.11.0.86     Wrapper package for OpenCV python bi...
packaging                24.2          Core utilities for Python packages
pandas                   2.2.3         Powerful data structures for data an...
parso                    0.8.4         A Python Parser
pettingzoo               1.24.3        Gymnasium for multi-agent reinforcem...
pexpect                  4.9.0         Pexpect allows easy control of inter...
pillow                   10.4.0        Python Imaging Library (Fork)
platformdirs             4.3.6         A small Python package for determini...
pluggy                   1.5.0         plugin and hook calling mechanisms f...
proglog                  0.1.10        Log and progress bar manager for con...
prompt-toolkit           3.0.50        Library for building powerful intera...
protobuf                 5.29.3        
psutil                   6.1.1         Cross-platform lib for process and s...
ptyprocess               0.7.0         Run a subprocess in a pseudo terminal
pure-eval                0.2.3         Safely evaluate AST nodes without si...
pycparser                2.22          C parser in Python
pydantic                 2.10.6        Data validation using Python type hints
pydantic-core            2.27.2        Core functionality for Pydantic vali...
pygame                   2.6.1         Python Game Development
pygments                 2.19.1        Pygments is a syntax highlighting pa...
pymunk                   6.11.1        Pymunk is a easy-to-use pythonic 2D ...
pynput                   1.7.7         Monitor and control user input devices
pyparsing                3.2.1         pyparsing module - Classes and metho...
pytest                   8.3.5         pytest: simple powerful testing with...
python-dateutil          2.9.0.post0   Extensions to the standard Python da...
python-dotenv            1.0.1         Read key-value pairs from a .env fil...
python-xlib              0.33          Python X Library
pytz                     2025.1        World timezone definitions, modern a...
pyyaml                   6.0.2         YAML parser and emitter for Python
requests                 2.32.3        Python HTTP for Humans.
scikit-image             0.25.2        Image processing in Python
scikit-learn             1.6.1         A set of python modules for machine ...
scipy                    1.15.1        Fundamental algorithms for scientifi...
seaborn                  0.13.2        Statistical data visualization
sentry-sdk               2.20.0        Python client for Sentry (https://se...
setproctitle             1.3.4         A Python module to customize the pro...
setuptools               75.8.0        Easily download, build, install, upg...
shap                     0.46.0        A unified approach to explain the ou...
six                      1.17.0        Python 2 and 3 compatibility utilities
slicer                   0.0.8         A small package for big slicing.
smmap                    5.0.2         A pure Python implementation of a sl...
stable-baselines3        2.5.0         Pytorch version of Stable Baselines,...
stack-data               0.6.3         Extract data from python stack frame...
supersuit                3.9.3         Wrappers for Gymnasium and PettingZoo
sympy                    1.13.1        Computer algebra system (CAS) in Python
tabulate                 0.9.0         Pretty-print tabular data
tensorboard              2.19.0        TensorBoard lets you watch Tensors Flow
tensorboard-data-server  0.7.2         Fast data loading for TensorBoard
threadpoolctl            3.5.0         threadpoolctl
tifffile                 2025.5.10     Read and write TIFF files
tinyscaler               1.2.8         A tiny, simple image scaler.
tomli                    1.2.3         A lil' TOML parser
torch                    2.6.0         Tensors and Dynamic neural networks ...
torch-lucent             0.1.8 d6d5636 Lucid for PyTorch. Collection of inf...
torchvision              0.21.0        image and video datasets and models ...
tqdm                     4.67.1        Fast, Extensible Progress Meter
traitlets                5.14.3        Traitlets Python configuration system
triton                   3.2.0         A language and compiler for custom D...
typing-extensions        4.12.2        Backported and Experimental Type Hin...
tzdata                   2025.1        Provider of IANA time zone data
urllib3                  2.3.0         HTTP library with thread-safe connec...
wandb                    0.19.6        A CLI and library for interacting wi...
wcwidth                  0.2.13        Measures the displayed width of unic...
werkzeug                 3.1.3         The comprehensive WSGI web applicati...
wrapt                    1.17.2        Module for decorators, wrappers and ...
xgboost                  3.0.1         XGBoost Python Package
Step 0000 | Epoch 01 | Objective: -6.2037 | Coherence: 13.6548 | Separation: 54.0874 | Information gain: 8.1667 | Grad Norm: 18.6704 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -4.5617 | Coherence: 15.8221 | Separation: 53.4960 | Information gain: 8.1667 | Grad Norm: 18.3639 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -2.9401 | Coherence: 17.9843 | Separation: 52.9555 | Information gain: 8.1667 | Grad Norm: 17.7656 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -1.3793 | Coherence: 20.0987 | Separation: 52.5021 | Information gain: 8.1667 | Grad Norm: 17.6465 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: 0.1807 | Coherence: 22.1710 | Separation: 51.9666 | Information gain: 8.1667 | Grad Norm: 17.4981 | Time: 1.0s
Step 0045 | Epoch 01 | Objective: 0.9022 | Coherence: 23.2041 | Separation: 51.7015 | Information gain: 8.0000 | Grad Norm: 17.4171 | Time: 1.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.568333  0.495642  0.313718  ...  0.481267  0.536845  0.467762
1  0.477940  0.583125  0.526404  ...  0.423473  0.486202  0.441978
2  0.392877  0.564953  0.613179  ...  0.395148  0.395356  0.430139
3  0.368112  0.534716  0.600527  ...  0.407577  0.364738  0.435787
4  0.527352  0.498397  0.348184  ...  0.452208  0.537953  0.488555

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8037
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8993
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8843
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0763, accuracy=0.1051
Testing SVM
  SVM Test Accuracy: 0.8598
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8246

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7008, Accuracy: 9510/12000 (79%)

Epoch 1 | Train Acc: 0.6717083333333334 | Test Acc: 0.7925 | Time: 1.1674950122833252 sec

Test set: Average loss: 0.4885, Accuracy: 10189/12000 (85%)

Epoch 2 | Train Acc: 0.8305208333333334 | Test Acc: 0.8490833333333333 | Time: 1.023996114730835 sec

Test set: Average loss: 0.4196, Accuracy: 10438/12000 (87%)

Epoch 3 | Train Acc: 0.8609583333333334 | Test Acc: 0.8698333333333333 | Time: 1.0182995796203613 sec

Test set: Average loss: 0.3861, Accuracy: 10536/12000 (88%)

Epoch 4 | Train Acc: 0.877625 | Test Acc: 0.878 | Time: 1.0231175422668457 sec

Test set: Average loss: 0.3622, Accuracy: 10627/12000 (89%)

Epoch 5 | Train Acc: 0.885875 | Test Acc: 0.8855833333333333 | Time: 1.0181300640106201 sec

Test set: Average loss: 0.3475, Accuracy: 10684/12000 (89%)

Epoch 6 | Train Acc: 0.8919166666666667 | Test Acc: 0.8903333333333333 | Time: 1.0313916206359863 sec

Test set: Average loss: 0.3375, Accuracy: 10745/12000 (90%)

Epoch 7 | Train Acc: 0.8958333333333334 | Test Acc: 0.8954166666666666 | Time: 1.022916555404663 sec

Test set: Average loss: 0.3309, Accuracy: 10770/12000 (90%)

Epoch 8 | Train Acc: 0.8985 | Test Acc: 0.8975 | Time: 1.2171025276184082 sec

Test set: Average loss: 0.3265, Accuracy: 10781/12000 (90%)

Epoch 9 | Train Acc: 0.9003958333333333 | Test Acc: 0.8984166666666666 | Time: 1.2830314636230469 sec

Test set: Average loss: 0.3235, Accuracy: 10792/12000 (90%)

Epoch 10 | Train Acc: 0.9018541666666666 | Test Acc: 0.8993333333333333 | Time: 1.195620059967041 sec

Test set: Average loss: 0.3213, Accuracy: 10801/12000 (90%)

Epoch 11 | Train Acc: 0.9027291666666667 | Test Acc: 0.9000833333333333 | Time: 1.0354502201080322 sec

Test set: Average loss: 0.3199, Accuracy: 10805/12000 (90%)

Epoch 12 | Train Acc: 0.9036041666666667 | Test Acc: 0.9004166666666666 | Time: 1.0293383598327637 sec

Test set: Average loss: 0.3189, Accuracy: 10808/12000 (90%)

Epoch 13 | Train Acc: 0.9037916666666667 | Test Acc: 0.9006666666666666 | Time: 1.0293424129486084 sec

Test set: Average loss: 0.3182, Accuracy: 10811/12000 (90%)

Epoch 14 | Train Acc: 0.9038125 | Test Acc: 0.9009166666666667 | Time: 1.0322680473327637 sec

Test set: Average loss: 0.3178, Accuracy: 10813/12000 (90%)

Epoch 15 | Train Acc: 0.9039375 | Test Acc: 0.9010833333333333 | Time: 1.036057949066162 sec

Test set: Average loss: 0.3175, Accuracy: 10814/12000 (90%)

Epoch 16 | Train Acc: 0.9040625 | Test Acc: 0.9011666666666667 | Time: 1.0445582866668701 sec

Test set: Average loss: 0.3174, Accuracy: 10814/12000 (90%)

Epoch 17 | Train Acc: 0.9041458333333333 | Test Acc: 0.9011666666666667 | Time: 1.0286712646484375 sec

Test set: Average loss: 0.3173, Accuracy: 10813/12000 (90%)

Epoch 18 | Train Acc: 0.9042916666666667 | Test Acc: 0.9010833333333333 | Time: 1.0253796577453613 sec

Test set: Average loss: 0.3172, Accuracy: 10814/12000 (90%)

Epoch 19 | Train Acc: 0.904375 | Test Acc: 0.9011666666666667 | Time: 1.1246814727783203 sec

Test set: Average loss: 0.3172, Accuracy: 10813/12000 (90%)

Epoch 20 | Train Acc: 0.9044166666666666 | Test Acc: 0.9010833333333333 | Time: 1.1209547519683838 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -5.2785 | Coherence: 10.0229 | Separation: 51.8812 | Information gain: 8.0000 | Grad Norm: 18.2215 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: -3.6651 | Coherence: 12.0099 | Separation: 51.0153 | Information gain: 8.0000 | Grad Norm: 18.1237 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -2.0417 | Coherence: 14.0924 | Separation: 50.3098 | Information gain: 8.0000 | Grad Norm: 17.9154 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: -0.3783 | Coherence: 16.2497 | Separation: 49.6342 | Information gain: 8.0000 | Grad Norm: 18.2548 | Time: 0.8s
Step 0038 | Epoch 01 | Objective: 0.9648 | Coherence: 17.9579 | Separation: 49.0215 | Information gain: 8.0000 | Grad Norm: 17.9184 | Time: 1.0s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.563161  0.392758  0.348026  ...  0.421732  0.473816  0.377940
1  0.428722  0.621021  0.461440  ...  0.492039  0.438656  0.561061
2  0.445210  0.482725  0.616080  ...  0.443857  0.580109  0.550616
3  0.456780  0.628705  0.476772  ...  0.488985  0.458809  0.547890
4  0.515569  0.457391  0.391255  ...  0.428356  0.440867  0.407400

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7858
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8901
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8683
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0988, accuracy=0.0990
Testing SVM
  SVM Test Accuracy: 0.8594
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8341

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6374, Accuracy: 9553/12000 (80%)

Epoch 1 | Train Acc: 0.6809583333333333 | Test Acc: 0.7960833333333334 | Time: 1.0314276218414307 sec

Test set: Average loss: 0.5124, Accuracy: 9930/12000 (83%)

Epoch 2 | Train Acc: 0.81875 | Test Acc: 0.8275 | Time: 1.2756757736206055 sec

Test set: Average loss: 0.4688, Accuracy: 10094/12000 (84%)

Epoch 3 | Train Acc: 0.8432708333333333 | Test Acc: 0.8411666666666666 | Time: 1.3277242183685303 sec

Test set: Average loss: 0.4265, Accuracy: 10270/12000 (86%)

Epoch 4 | Train Acc: 0.8592291666666667 | Test Acc: 0.8558333333333333 | Time: 1.0520122051239014 sec

Test set: Average loss: 0.3999, Accuracy: 10402/12000 (87%)

Epoch 5 | Train Acc: 0.8692291666666667 | Test Acc: 0.8668333333333333 | Time: 1.0429201126098633 sec

Test set: Average loss: 0.3825, Accuracy: 10474/12000 (87%)

Epoch 6 | Train Acc: 0.8770833333333333 | Test Acc: 0.8728333333333333 | Time: 1.1839067935943604 sec

Test set: Average loss: 0.3704, Accuracy: 10539/12000 (88%)

Epoch 7 | Train Acc: 0.8816666666666667 | Test Acc: 0.87825 | Time: 1.420201301574707 sec

Test set: Average loss: 0.3624, Accuracy: 10571/12000 (88%)

Epoch 8 | Train Acc: 0.8850208333333334 | Test Acc: 0.8809166666666667 | Time: 1.3685104846954346 sec

Test set: Average loss: 0.3560, Accuracy: 10612/12000 (88%)

Epoch 9 | Train Acc: 0.8876666666666667 | Test Acc: 0.8843333333333333 | Time: 1.0817577838897705 sec

Test set: Average loss: 0.3513, Accuracy: 10643/12000 (89%)

Epoch 10 | Train Acc: 0.889375 | Test Acc: 0.8869166666666667 | Time: 1.0252344608306885 sec

Test set: Average loss: 0.3479, Accuracy: 10665/12000 (89%)

Epoch 11 | Train Acc: 0.8902708333333333 | Test Acc: 0.88875 | Time: 1.162916660308838 sec

Test set: Average loss: 0.3455, Accuracy: 10669/12000 (89%)

Epoch 12 | Train Acc: 0.8910416666666666 | Test Acc: 0.8890833333333333 | Time: 1.3977305889129639 sec

Test set: Average loss: 0.3438, Accuracy: 10684/12000 (89%)

Epoch 13 | Train Acc: 0.8915 | Test Acc: 0.8903333333333333 | Time: 1.2333228588104248 sec

Test set: Average loss: 0.3427, Accuracy: 10689/12000 (89%)

Epoch 14 | Train Acc: 0.8918958333333333 | Test Acc: 0.89075 | Time: 1.2824571132659912 sec

Test set: Average loss: 0.3419, Accuracy: 10693/12000 (89%)

Epoch 15 | Train Acc: 0.8923333333333333 | Test Acc: 0.8910833333333333 | Time: 1.0274066925048828 sec

Test set: Average loss: 0.3415, Accuracy: 10699/12000 (89%)

Epoch 16 | Train Acc: 0.8925416666666667 | Test Acc: 0.8915833333333333 | Time: 1.1155726909637451 sec

Test set: Average loss: 0.3412, Accuracy: 10699/12000 (89%)

Epoch 17 | Train Acc: 0.8927916666666667 | Test Acc: 0.8915833333333333 | Time: 1.3527510166168213 sec

Test set: Average loss: 0.3410, Accuracy: 10698/12000 (89%)

Epoch 18 | Train Acc: 0.8931041666666667 | Test Acc: 0.8915 | Time: 1.4342646598815918 sec

Test set: Average loss: 0.3408, Accuracy: 10697/12000 (89%)

Epoch 19 | Train Acc: 0.893375 | Test Acc: 0.8914166666666666 | Time: 1.2215569019317627 sec

Test set: Average loss: 0.3407, Accuracy: 10699/12000 (89%)

Epoch 20 | Train Acc: 0.8933958333333333 | Test Acc: 0.8915833333333333 | Time: 1.0206983089447021 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -0.8648 | Coherence: 12.3078 | Separation: 50.7100 | Information gain: 7.8333 | Grad Norm: 18.4535 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: 0.6673 | Coherence: 14.1762 | Separation: 49.8505 | Information gain: 7.8333 | Grad Norm: 18.3568 | Time: 0.3s
Step 0012 | Epoch 01 | Objective: 0.9768 | Coherence: 14.5482 | Separation: 49.6660 | Information gain: 7.8333 | Grad Norm: 18.4291 | Time: 0.3s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.543008  0.501173 -0.472646  ... -0.399266 -0.386623  0.456523
1  0.533930  0.579684 -0.468602  ... -0.386955 -0.375110  0.529005
2  0.502729  0.470024 -0.591495  ... -0.541053 -0.500329  0.483601
3  0.497276  0.547634 -0.523387  ... -0.481259 -0.485238  0.590880
4  0.494703  0.536210 -0.528821  ... -0.501656 -0.492527  0.579128

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7960
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9010
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8824
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.8583, accuracy=0.0969
Testing SVM
  SVM Test Accuracy: 0.8620
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8334

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6685, Accuracy: 9587/12000 (80%)

Epoch 1 | Train Acc: 0.6678958333333334 | Test Acc: 0.7989166666666667 | Time: 1.3009746074676514 sec

Test set: Average loss: 0.5031, Accuracy: 10078/12000 (84%)

Epoch 2 | Train Acc: 0.837625 | Test Acc: 0.8398333333333333 | Time: 1.023831844329834 sec

Test set: Average loss: 0.4363, Accuracy: 10348/12000 (86%)

Epoch 3 | Train Acc: 0.8618333333333333 | Test Acc: 0.8623333333333333 | Time: 1.1394178867340088 sec

Test set: Average loss: 0.4009, Accuracy: 10460/12000 (87%)

Epoch 4 | Train Acc: 0.8755416666666667 | Test Acc: 0.8716666666666667 | Time: 1.4207375049591064 sec

Test set: Average loss: 0.3706, Accuracy: 10583/12000 (88%)

Epoch 5 | Train Acc: 0.8842708333333333 | Test Acc: 0.8819166666666667 | Time: 1.2222380638122559 sec

Test set: Average loss: 0.3522, Accuracy: 10671/12000 (89%)

Epoch 6 | Train Acc: 0.8905833333333333 | Test Acc: 0.88925 | Time: 1.0227365493774414 sec

Test set: Average loss: 0.3398, Accuracy: 10727/12000 (89%)

Epoch 7 | Train Acc: 0.8945416666666667 | Test Acc: 0.8939166666666667 | Time: 1.0247454643249512 sec

Test set: Average loss: 0.3323, Accuracy: 10755/12000 (90%)

Epoch 8 | Train Acc: 0.8967083333333333 | Test Acc: 0.89625 | Time: 1.3308331966400146 sec

Test set: Average loss: 0.3276, Accuracy: 10770/12000 (90%)

Epoch 9 | Train Acc: 0.8993333333333333 | Test Acc: 0.8975 | Time: 1.4324491024017334 sec

Test set: Average loss: 0.3244, Accuracy: 10798/12000 (90%)

Epoch 10 | Train Acc: 0.9006666666666666 | Test Acc: 0.8998333333333334 | Time: 1.1787340641021729 sec

Test set: Average loss: 0.3221, Accuracy: 10818/12000 (90%)

Epoch 11 | Train Acc: 0.9018333333333334 | Test Acc: 0.9015 | Time: 1.024876594543457 sec

Test set: Average loss: 0.3204, Accuracy: 10812/12000 (90%)

Epoch 12 | Train Acc: 0.9024375 | Test Acc: 0.901 | Time: 1.0517165660858154 sec

Test set: Average loss: 0.3193, Accuracy: 10814/12000 (90%)

Epoch 13 | Train Acc: 0.9028333333333334 | Test Acc: 0.9011666666666667 | Time: 1.1617534160614014 sec

Test set: Average loss: 0.3186, Accuracy: 10820/12000 (90%)

Epoch 14 | Train Acc: 0.9032916666666667 | Test Acc: 0.9016666666666666 | Time: 1.2872016429901123 sec

Test set: Average loss: 0.3181, Accuracy: 10825/12000 (90%)

Epoch 15 | Train Acc: 0.9034791666666667 | Test Acc: 0.9020833333333333 | Time: 1.3585929870605469 sec

Test set: Average loss: 0.3178, Accuracy: 10829/12000 (90%)

Epoch 16 | Train Acc: 0.9037083333333333 | Test Acc: 0.9024166666666666 | Time: 1.163374423980713 sec

Test set: Average loss: 0.3175, Accuracy: 10829/12000 (90%)

Epoch 17 | Train Acc: 0.90375 | Test Acc: 0.9024166666666666 | Time: 1.024388313293457 sec

Test set: Average loss: 0.3174, Accuracy: 10826/12000 (90%)

Epoch 18 | Train Acc: 0.9037708333333333 | Test Acc: 0.9021666666666667 | Time: 1.0294420719146729 sec

Test set: Average loss: 0.3173, Accuracy: 10827/12000 (90%)

Epoch 19 | Train Acc: 0.9037083333333333 | Test Acc: 0.90225 | Time: 1.1328983306884766 sec

Test set: Average loss: 0.3172, Accuracy: 10826/12000 (90%)

Epoch 20 | Train Acc: 0.9038541666666666 | Test Acc: 0.9021666666666667 | Time: 1.0998082160949707 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -25.5906 | Coherence: 18.2873 | Separation: 56.6732 | Information gain: 7.8333 | Grad Norm: 28.5523 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: -23.7707 | Coherence: 19.5465 | Separation: 55.2026 | Information gain: 7.8333 | Grad Norm: 28.0873 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -22.0085 | Coherence: 20.7454 | Separation: 53.7582 | Information gain: 7.8333 | Grad Norm: 26.8361 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: -20.2684 | Coherence: 21.8685 | Separation: 52.2712 | Information gain: 7.8333 | Grad Norm: 26.4247 | Time: 0.9s
Step 0040 | Epoch 01 | Objective: -18.5030 | Coherence: 22.9443 | Separation: 50.6988 | Information gain: 7.8333 | Grad Norm: 25.2009 | Time: 1.2s
Step 0050 | Epoch 01 | Objective: -16.8170 | Coherence: 24.0683 | Separation: 49.2938 | Information gain: 7.8333 | Grad Norm: 24.6142 | Time: 1.5s
Step 0060 | Epoch 01 | Objective: -15.1171 | Coherence: 25.2322 | Separation: 47.9079 | Information gain: 7.8333 | Grad Norm: 24.4413 | Time: 1.7s
Step 0070 | Epoch 01 | Objective: -13.4890 | Coherence: 26.4044 | Separation: 46.6379 | Information gain: 7.6667 | Grad Norm: 23.7324 | Time: 2.0s
Step 0080 | Epoch 01 | Objective: -11.8414 | Coherence: 27.5385 | Separation: 45.3005 | Information gain: 7.6667 | Grad Norm: 23.1526 | Time: 2.3s
Step 0090 | Epoch 01 | Objective: -10.2765 | Coherence: 28.6706 | Separation: 44.0854 | Information gain: 7.6667 | Grad Norm: 22.2638 | Time: 2.5s
Step 0100 | Epoch 01 | Objective: -8.7955 | Coherence: 29.8336 | Separation: 43.0268 | Information gain: 7.5000 | Grad Norm: 21.8920 | Time: 2.7s
Step 0110 | Epoch 01 | Objective: -7.3666 | Coherence: 30.8828 | Separation: 41.9327 | Information gain: 7.5000 | Grad Norm: 21.5312 | Time: 3.0s
Step 0120 | Epoch 01 | Objective: -6.0606 | Coherence: 31.8652 | Separation: 40.9561 | Information gain: 7.5000 | Grad Norm: 19.7822 | Time: 3.2s
Step 0130 | Epoch 01 | Objective: -4.8638 | Coherence: 32.7766 | Separation: 40.0724 | Information gain: 7.5000 | Grad Norm: 20.1851 | Time: 3.4s
Step 0140 | Epoch 01 | Objective: -3.7933 | Coherence: 33.6558 | Separation: 39.3457 | Information gain: 7.5000 | Grad Norm: 18.6101 | Time: 3.7s
Step 0150 | Epoch 01 | Objective: -2.8234 | Coherence: 34.3799 | Separation: 38.6151 | Information gain: 7.5000 | Grad Norm: 18.2405 | Time: 3.9s
Step 0160 | Epoch 01 | Objective: -1.8781 | Coherence: 35.0691 | Separation: 37.8863 | Information gain: 7.5000 | Grad Norm: 18.6476 | Time: 4.1s
Step 0170 | Epoch 01 | Objective: -0.9513 | Coherence: 35.7867 | Separation: 37.2136 | Information gain: 7.3333 | Grad Norm: 18.4476 | Time: 4.3s
Step 0180 | Epoch 01 | Objective: -0.0301 | Coherence: 36.4768 | Separation: 36.5219 | Information gain: 7.3333 | Grad Norm: 18.6119 | Time: 4.6s
Step 0190 | Epoch 01 | Objective: 0.9156 | Coherence: 37.1506 | Separation: 35.7772 | Information gain: 7.3333 | Grad Norm: 17.9533 | Time: 4.8s
Step 0190 | Epoch 01 | Objective: 0.9156 | Coherence: 37.1506 | Separation: 35.7772 | Information gain: 7.3333 | Grad Norm: 17.9533 | Time: 4.8s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.665442  0.484791  0.428316  ...  0.561615  0.491414  0.336246
1  0.436144  0.576815  0.473458  ...  0.490235  0.565794  0.388315
2  0.420689  0.487121  0.581617  ...  0.555452  0.451203  0.374716
3  0.439577  0.437631  0.437195  ...  0.460718  0.462065  0.491649
4  0.428176  0.538675  0.525447  ...  0.537802  0.518911  0.389912

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7964
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8873
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8676
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0255, accuracy=0.0956
Testing SVM
  SVM Test Accuracy: 0.8533
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8262

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7245, Accuracy: 9327/12000 (78%)

Epoch 1 | Train Acc: 0.6365416666666667 | Test Acc: 0.77725 | Time: 1.033294439315796 sec

Test set: Average loss: 0.5462, Accuracy: 9866/12000 (82%)

Epoch 2 | Train Acc: 0.8070625 | Test Acc: 0.8221666666666667 | Time: 1.1983051300048828 sec

Test set: Average loss: 0.4694, Accuracy: 10133/12000 (84%)

Epoch 3 | Train Acc: 0.8442708333333333 | Test Acc: 0.8444166666666667 | Time: 1.1250674724578857 sec

Test set: Average loss: 0.4212, Accuracy: 10345/12000 (86%)

Epoch 4 | Train Acc: 0.8612708333333333 | Test Acc: 0.8620833333333333 | Time: 1.132964849472046 sec

Test set: Average loss: 0.3924, Accuracy: 10457/12000 (87%)

Epoch 5 | Train Acc: 0.871625 | Test Acc: 0.8714166666666666 | Time: 1.2567272186279297 sec

Test set: Average loss: 0.3782, Accuracy: 10528/12000 (88%)

Epoch 6 | Train Acc: 0.878625 | Test Acc: 0.8773333333333333 | Time: 1.022984266281128 sec

Test set: Average loss: 0.3675, Accuracy: 10572/12000 (88%)

Epoch 7 | Train Acc: 0.8835208333333333 | Test Acc: 0.881 | Time: 1.1695129871368408 sec

Test set: Average loss: 0.3604, Accuracy: 10594/12000 (88%)

Epoch 8 | Train Acc: 0.88675 | Test Acc: 0.8828333333333334 | Time: 1.0252835750579834 sec

Test set: Average loss: 0.3559, Accuracy: 10611/12000 (88%)

Epoch 9 | Train Acc: 0.8886666666666667 | Test Acc: 0.88425 | Time: 1.3622214794158936 sec

Test set: Average loss: 0.3527, Accuracy: 10630/12000 (89%)

Epoch 10 | Train Acc: 0.89 | Test Acc: 0.8858333333333334 | Time: 1.1426615715026855 sec

Test set: Average loss: 0.3503, Accuracy: 10634/12000 (89%)

Epoch 11 | Train Acc: 0.8912083333333334 | Test Acc: 0.8861666666666667 | Time: 1.0341687202453613 sec

Test set: Average loss: 0.3486, Accuracy: 10637/12000 (89%)

Epoch 12 | Train Acc: 0.8917708333333333 | Test Acc: 0.8864166666666666 | Time: 1.10123610496521 sec

Test set: Average loss: 0.3474, Accuracy: 10645/12000 (89%)

Epoch 13 | Train Acc: 0.8918541666666666 | Test Acc: 0.8870833333333333 | Time: 1.2226476669311523 sec

Test set: Average loss: 0.3465, Accuracy: 10652/12000 (89%)

Epoch 14 | Train Acc: 0.8922708333333333 | Test Acc: 0.8876666666666667 | Time: 1.0256385803222656 sec

Test set: Average loss: 0.3459, Accuracy: 10653/12000 (89%)

Epoch 15 | Train Acc: 0.89275 | Test Acc: 0.88775 | Time: 1.035306453704834 sec

Test set: Average loss: 0.3455, Accuracy: 10653/12000 (89%)

Epoch 16 | Train Acc: 0.8928958333333333 | Test Acc: 0.88775 | Time: 1.324587106704712 sec

Test set: Average loss: 0.3452, Accuracy: 10657/12000 (89%)

Epoch 17 | Train Acc: 0.8930208333333334 | Test Acc: 0.8880833333333333 | Time: 1.035456895828247 sec

Test set: Average loss: 0.3451, Accuracy: 10658/12000 (89%)

Epoch 18 | Train Acc: 0.8931041666666667 | Test Acc: 0.8881666666666667 | Time: 1.0219764709472656 sec

Test set: Average loss: 0.3450, Accuracy: 10659/12000 (89%)

Epoch 19 | Train Acc: 0.8932291666666666 | Test Acc: 0.88825 | Time: 1.032837152481079 sec

Test set: Average loss: 0.3449, Accuracy: 10661/12000 (89%)

Epoch 20 | Train Acc: 0.893375 | Test Acc: 0.8884166666666666 | Time: 1.083482027053833 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -22.2640 | Coherence: 15.0439 | Separation: 51.8566 | Information gain: 6.8333 | Grad Norm: 27.5420 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: -20.6548 | Coherence: 16.1231 | Separation: 50.4386 | Information gain: 6.6667 | Grad Norm: 25.7922 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -19.1036 | Coherence: 17.2258 | Separation: 49.2145 | Information gain: 6.6667 | Grad Norm: 24.9103 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -17.6283 | Coherence: 18.3505 | Separation: 48.1262 | Information gain: 6.6667 | Grad Norm: 24.9839 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -16.1642 | Coherence: 19.5282 | Separation: 47.1079 | Information gain: 6.6667 | Grad Norm: 24.4962 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -14.7748 | Coherence: 20.7042 | Separation: 46.1997 | Information gain: 6.6667 | Grad Norm: 24.8455 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -13.3354 | Coherence: 21.7939 | Separation: 45.2970 | Information gain: 7.0000 | Grad Norm: 23.3093 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -12.2073 | Coherence: 22.7583 | Separation: 44.4026 | Information gain: 6.6667 | Grad Norm: 22.9472 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -10.9570 | Coherence: 23.6577 | Separation: 43.4266 | Information gain: 6.6667 | Grad Norm: 23.1074 | Time: 1.8s
Step 0090 | Epoch 01 | Objective: -9.6990 | Coherence: 24.5633 | Separation: 42.4451 | Information gain: 6.6667 | Grad Norm: 22.7630 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -8.4262 | Coherence: 25.4692 | Separation: 41.4418 | Information gain: 6.6667 | Grad Norm: 21.4153 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -7.1588 | Coherence: 26.4065 | Separation: 40.4780 | Information gain: 6.6667 | Grad Norm: 21.6408 | Time: 2.5s
Step 0120 | Epoch 01 | Objective: -5.8931 | Coherence: 27.2740 | Separation: 39.5303 | Information gain: 6.8333 | Grad Norm: 21.2442 | Time: 2.7s
Step 0130 | Epoch 01 | Objective: -4.7423 | Coherence: 28.0818 | Separation: 38.6119 | Information gain: 6.8333 | Grad Norm: 20.5442 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -3.6855 | Coherence: 28.8359 | Separation: 37.7808 | Information gain: 6.8333 | Grad Norm: 20.0289 | Time: 3.2s
Step 0150 | Epoch 01 | Objective: -2.5784 | Coherence: 29.6019 | Separation: 36.8861 | Information gain: 6.8333 | Grad Norm: 20.1436 | Time: 3.4s
Step 0160 | Epoch 01 | Objective: -1.5300 | Coherence: 30.3387 | Separation: 36.0504 | Information gain: 6.8333 | Grad Norm: 20.4008 | Time: 3.6s
Step 0170 | Epoch 01 | Objective: -0.5355 | Coherence: 31.0575 | Separation: 35.2774 | Information gain: 6.8333 | Grad Norm: 20.6119 | Time: 3.9s
Step 0180 | Epoch 01 | Objective: 0.4275 | Coherence: 31.6934 | Separation: 34.4689 | Information gain: 6.8333 | Grad Norm: 18.8047 | Time: 4.1s
Step 0185 | Epoch 01 | Objective: 0.9309 | Coherence: 31.9957 | Separation: 34.0160 | Information gain: 6.8333 | Grad Norm: 18.8456 | Time: 4.2s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.569881  0.545008  0.455383  ...  0.535133  0.401073  0.530809
1  0.554760  0.582365  0.451785  ...  0.496610  0.462911  0.509606
2  0.468204  0.458118  0.602078  ...  0.423941  0.432629  0.416640
3  0.544762  0.560646  0.508149  ...  0.486111  0.494061  0.504071
4  0.319937  0.327803  0.460163  ...  0.305657  0.490147  0.292815

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7998
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8912
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8768
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.1357, accuracy=0.0940
Testing SVM
  SVM Test Accuracy: 0.8520
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8264

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6568, Accuracy: 9510/12000 (79%)

Epoch 1 | Train Acc: 0.6721458333333333 | Test Acc: 0.7925 | Time: 1.0283629894256592 sec

Test set: Average loss: 0.5222, Accuracy: 9944/12000 (83%)

Epoch 2 | Train Acc: 0.82025 | Test Acc: 0.8286666666666667 | Time: 1.0295965671539307 sec

Test set: Average loss: 0.4492, Accuracy: 10224/12000 (85%)

Epoch 3 | Train Acc: 0.8474166666666667 | Test Acc: 0.852 | Time: 1.1385772228240967 sec

Test set: Average loss: 0.4095, Accuracy: 10402/12000 (87%)

Epoch 4 | Train Acc: 0.8620833333333333 | Test Acc: 0.8668333333333333 | Time: 1.0308711528778076 sec

Test set: Average loss: 0.3836, Accuracy: 10529/12000 (88%)

Epoch 5 | Train Acc: 0.8706041666666666 | Test Acc: 0.8774166666666666 | Time: 1.0261707305908203 sec

Test set: Average loss: 0.3702, Accuracy: 10590/12000 (88%)

Epoch 6 | Train Acc: 0.8777083333333333 | Test Acc: 0.8825 | Time: 1.0198349952697754 sec

Test set: Average loss: 0.3616, Accuracy: 10614/12000 (88%)

Epoch 7 | Train Acc: 0.8824375 | Test Acc: 0.8845 | Time: 1.0271329879760742 sec

Test set: Average loss: 0.3561, Accuracy: 10632/12000 (89%)

Epoch 8 | Train Acc: 0.8853333333333333 | Test Acc: 0.886 | Time: 1.0197181701660156 sec

Test set: Average loss: 0.3520, Accuracy: 10646/12000 (89%)

Epoch 9 | Train Acc: 0.8871875 | Test Acc: 0.8871666666666667 | Time: 1.0249056816101074 sec

Test set: Average loss: 0.3492, Accuracy: 10649/12000 (89%)

Epoch 10 | Train Acc: 0.8882083333333334 | Test Acc: 0.8874166666666666 | Time: 1.019873857498169 sec

Test set: Average loss: 0.3472, Accuracy: 10656/12000 (89%)

Epoch 11 | Train Acc: 0.8890625 | Test Acc: 0.888 | Time: 1.0263848304748535 sec

Test set: Average loss: 0.3456, Accuracy: 10665/12000 (89%)

Epoch 12 | Train Acc: 0.8894583333333334 | Test Acc: 0.88875 | Time: 1.1375675201416016 sec

Test set: Average loss: 0.3443, Accuracy: 10678/12000 (89%)

Epoch 13 | Train Acc: 0.8897708333333333 | Test Acc: 0.8898333333333334 | Time: 1.0288991928100586 sec

Test set: Average loss: 0.3433, Accuracy: 10686/12000 (89%)

Epoch 14 | Train Acc: 0.8897916666666666 | Test Acc: 0.8905 | Time: 1.0315501689910889 sec

Test set: Average loss: 0.3426, Accuracy: 10680/12000 (89%)

Epoch 15 | Train Acc: 0.8900625 | Test Acc: 0.89 | Time: 1.0264084339141846 sec

Test set: Average loss: 0.3422, Accuracy: 10686/12000 (89%)

Epoch 16 | Train Acc: 0.8904375 | Test Acc: 0.8905 | Time: 1.164686918258667 sec

Test set: Average loss: 0.3420, Accuracy: 10684/12000 (89%)

Epoch 17 | Train Acc: 0.8905416666666667 | Test Acc: 0.8903333333333333 | Time: 1.1519672870635986 sec

Test set: Average loss: 0.3419, Accuracy: 10682/12000 (89%)

Epoch 18 | Train Acc: 0.8905416666666667 | Test Acc: 0.8901666666666667 | Time: 1.054779052734375 sec

Test set: Average loss: 0.3418, Accuracy: 10678/12000 (89%)

Epoch 19 | Train Acc: 0.8906666666666667 | Test Acc: 0.8898333333333334 | Time: 1.028571605682373 sec
Early stopping at epoch 19

Testing with M=15
Step 0000 | Epoch 01 | Objective: -21.9911 | Coherence: 14.2006 | Separation: 55.1872 | Information gain: 8.0000 | Grad Norm: 31.6729 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -19.8996 | Coherence: 15.4103 | Separation: 53.2597 | Information gain: 8.0000 | Grad Norm: 30.6125 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -17.8501 | Coherence: 16.6290 | Separation: 51.4041 | Information gain: 8.0000 | Grad Norm: 29.5431 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -16.0260 | Coherence: 17.8349 | Separation: 49.7072 | Information gain: 7.8333 | Grad Norm: 27.3178 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -14.3759 | Coherence: 18.8555 | Separation: 48.2526 | Information gain: 7.8333 | Grad Norm: 26.2154 | Time: 0.9s
Step 0050 | Epoch 01 | Objective: -12.7634 | Coherence: 19.6889 | Separation: 46.8339 | Information gain: 8.0000 | Grad Norm: 25.8787 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -11.3644 | Coherence: 20.4869 | Separation: 45.3668 | Information gain: 7.8333 | Grad Norm: 24.8029 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -9.9571 | Coherence: 21.2388 | Separation: 44.0078 | Information gain: 7.8333 | Grad Norm: 24.6015 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -8.6450 | Coherence: 21.9628 | Separation: 42.7636 | Information gain: 7.8333 | Grad Norm: 23.5075 | Time: 1.8s
Step 0090 | Epoch 01 | Objective: -7.4138 | Coherence: 22.7222 | Separation: 41.6763 | Information gain: 7.8333 | Grad Norm: 23.0349 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -6.4104 | Coherence: 23.4794 | Separation: 40.5951 | Information gain: 7.5000 | Grad Norm: 22.9905 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -5.1887 | Coherence: 24.1691 | Separation: 39.4521 | Information gain: 7.5000 | Grad Norm: 21.9756 | Time: 2.5s
Step 0120 | Epoch 01 | Objective: -3.9459 | Coherence: 24.8613 | Separation: 38.2801 | Information gain: 7.5000 | Grad Norm: 22.5862 | Time: 2.7s
Step 0130 | Epoch 01 | Objective: -2.5288 | Coherence: 25.5570 | Separation: 37.1835 | Information gain: 7.8333 | Grad Norm: 21.5674 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -1.6186 | Coherence: 26.2109 | Separation: 36.3055 | Information gain: 7.6667 | Grad Norm: 20.9289 | Time: 3.2s
Step 0150 | Epoch 01 | Objective: -0.7022 | Coherence: 26.7989 | Separation: 35.5189 | Information gain: 7.6667 | Grad Norm: 20.3569 | Time: 3.4s
Step 0160 | Epoch 01 | Objective: 0.1101 | Coherence: 27.3468 | Separation: 34.8484 | Information gain: 7.6667 | Grad Norm: 18.6122 | Time: 3.6s
Step 0170 | Epoch 01 | Objective: 0.8103 | Coherence: 27.8306 | Separation: 34.2818 | Information gain: 7.6667 | Grad Norm: 18.7269 | Time: 3.9s
Step 0172 | Epoch 01 | Objective: 0.9474 | Coherence: 27.9237 | Separation: 34.1693 | Information gain: 7.6667 | Grad Norm: 17.9391 | Time: 3.9s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.618534  0.544213  0.477140  ...  0.577389  0.496863 -0.573024
1  0.533277  0.609266  0.494773  ...  0.547291  0.506839 -0.539565
2  0.479973  0.498792  0.633109  ...  0.414057  0.440851 -0.484528
3  0.566746  0.562796  0.476459  ...  0.549336  0.538662 -0.591742
4  0.544918  0.588076  0.385249  ...  0.569103  0.563805 -0.562966

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7895
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8956
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8843
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.8107, accuracy=0.1079
Testing SVM
  SVM Test Accuracy: 0.8609
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8301

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7816, Accuracy: 9034/12000 (75%)

Epoch 1 | Train Acc: 0.6317083333333333 | Test Acc: 0.7528333333333334 | Time: 1.0347352027893066 sec

Test set: Average loss: 0.5598, Accuracy: 9934/12000 (83%)

Epoch 2 | Train Acc: 0.8149166666666666 | Test Acc: 0.8278333333333333 | Time: 1.0256202220916748 sec

Test set: Average loss: 0.4745, Accuracy: 10229/12000 (85%)

Epoch 3 | Train Acc: 0.8455 | Test Acc: 0.8524166666666667 | Time: 1.028876543045044 sec

Test set: Average loss: 0.4254, Accuracy: 10409/12000 (87%)

Epoch 4 | Train Acc: 0.8620833333333333 | Test Acc: 0.8674166666666666 | Time: 1.027428150177002 sec

Test set: Average loss: 0.3973, Accuracy: 10495/12000 (87%)

Epoch 5 | Train Acc: 0.87275 | Test Acc: 0.8745833333333334 | Time: 1.0220277309417725 sec

Test set: Average loss: 0.3791, Accuracy: 10551/12000 (88%)

Epoch 6 | Train Acc: 0.8795208333333333 | Test Acc: 0.87925 | Time: 1.0283689498901367 sec

Test set: Average loss: 0.3679, Accuracy: 10591/12000 (88%)

Epoch 7 | Train Acc: 0.8840416666666666 | Test Acc: 0.8825833333333334 | Time: 1.0209195613861084 sec

Test set: Average loss: 0.3605, Accuracy: 10602/12000 (88%)

Epoch 8 | Train Acc: 0.8872083333333334 | Test Acc: 0.8835 | Time: 1.0255448818206787 sec

Test set: Average loss: 0.3549, Accuracy: 10619/12000 (88%)

Epoch 9 | Train Acc: 0.8894375 | Test Acc: 0.8849166666666667 | Time: 1.0224413871765137 sec

Test set: Average loss: 0.3509, Accuracy: 10648/12000 (89%)

Epoch 10 | Train Acc: 0.890875 | Test Acc: 0.8873333333333333 | Time: 1.2074000835418701 sec

Test set: Average loss: 0.3482, Accuracy: 10661/12000 (89%)

Epoch 11 | Train Acc: 0.8918125 | Test Acc: 0.8884166666666666 | Time: 1.0223491191864014 sec

Test set: Average loss: 0.3463, Accuracy: 10667/12000 (89%)

Epoch 12 | Train Acc: 0.8923333333333333 | Test Acc: 0.8889166666666667 | Time: 1.0240743160247803 sec

Test set: Average loss: 0.3451, Accuracy: 10671/12000 (89%)

Epoch 13 | Train Acc: 0.8928333333333334 | Test Acc: 0.88925 | Time: 1.0325474739074707 sec

Test set: Average loss: 0.3443, Accuracy: 10677/12000 (89%)

Epoch 14 | Train Acc: 0.8932291666666666 | Test Acc: 0.88975 | Time: 1.0228571891784668 sec

Test set: Average loss: 0.3437, Accuracy: 10681/12000 (89%)

Epoch 15 | Train Acc: 0.8935833333333333 | Test Acc: 0.8900833333333333 | Time: 1.0259838104248047 sec

Test set: Average loss: 0.3434, Accuracy: 10679/12000 (89%)

Epoch 16 | Train Acc: 0.8937083333333333 | Test Acc: 0.8899166666666667 | Time: 1.0243504047393799 sec

Test set: Average loss: 0.3431, Accuracy: 10677/12000 (89%)

Epoch 17 | Train Acc: 0.8937708333333333 | Test Acc: 0.88975 | Time: 1.0236916542053223 sec

Test set: Average loss: 0.3429, Accuracy: 10678/12000 (89%)

Epoch 18 | Train Acc: 0.8938333333333334 | Test Acc: 0.8898333333333334 | Time: 1.0296854972839355 sec

Test set: Average loss: 0.3428, Accuracy: 10681/12000 (89%)

Epoch 19 | Train Acc: 0.893875 | Test Acc: 0.8900833333333333 | Time: 1.116842269897461 sec

Test set: Average loss: 0.3427, Accuracy: 10682/12000 (89%)

Epoch 20 | Train Acc: 0.8940416666666666 | Test Acc: 0.8901666666666667 | Time: 1.031123399734497 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -22.9399 | Coherence: 9.5537 | Separation: 54.4635 | Information gain: 7.0000 | Grad Norm: 28.2897 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -21.3747 | Coherence: 10.5651 | Separation: 53.1271 | Information gain: 7.0000 | Grad Norm: 27.6823 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -19.8514 | Coherence: 11.6301 | Separation: 51.9072 | Information gain: 7.0000 | Grad Norm: 26.5216 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -18.4746 | Coherence: 12.7043 | Separation: 50.9162 | Information gain: 7.0000 | Grad Norm: 25.8468 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -17.0566 | Coherence: 13.7118 | Separation: 49.7966 | Information gain: 7.0000 | Grad Norm: 26.3556 | Time: 0.9s
Step 0050 | Epoch 01 | Objective: -15.7619 | Coherence: 14.7406 | Separation: 48.6334 | Information gain: 6.8333 | Grad Norm: 25.4946 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -14.2976 | Coherence: 15.7640 | Separation: 47.4603 | Information gain: 6.8333 | Grad Norm: 25.5007 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -12.9062 | Coherence: 16.8366 | Separation: 46.4459 | Information gain: 6.8333 | Grad Norm: 24.6778 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -11.5471 | Coherence: 17.9125 | Separation: 45.4832 | Information gain: 6.8333 | Grad Norm: 24.1588 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -10.2891 | Coherence: 18.9373 | Separation: 44.6210 | Information gain: 6.8333 | Grad Norm: 23.4261 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -9.0653 | Coherence: 19.9594 | Separation: 43.8073 | Information gain: 6.8333 | Grad Norm: 22.6722 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -7.8311 | Coherence: 20.9811 | Separation: 42.9776 | Information gain: 6.8333 | Grad Norm: 22.8329 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -6.5668 | Coherence: 21.9942 | Separation: 42.0944 | Information gain: 6.8333 | Grad Norm: 22.7666 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -5.2740 | Coherence: 23.0030 | Separation: 41.1641 | Information gain: 6.8333 | Grad Norm: 23.2837 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -4.1360 | Coherence: 24.0054 | Separation: 40.2094 | Information gain: 6.6667 | Grad Norm: 22.5092 | Time: 3.3s
Step 0150 | Epoch 01 | Objective: -2.8148 | Coherence: 24.9934 | Separation: 39.2156 | Information gain: 6.6667 | Grad Norm: 21.9735 | Time: 3.5s
Step 0160 | Epoch 01 | Objective: -1.5524 | Coherence: 25.9661 | Separation: 38.2946 | Information gain: 6.6667 | Grad Norm: 20.6062 | Time: 3.7s
Step 0170 | Epoch 01 | Objective: -0.3043 | Coherence: 26.9443 | Separation: 37.4007 | Information gain: 6.6667 | Grad Norm: 20.5157 | Time: 4.0s
Step 0180 | Epoch 01 | Objective: 0.9490 | Coherence: 27.9448 | Separation: 36.5212 | Information gain: 6.6667 | Grad Norm: 21.0933 | Time: 4.2s
Step 0180 | Epoch 01 | Objective: 0.9490 | Coherence: 27.9448 | Separation: 36.5212 | Information gain: 6.6667 | Grad Norm: 21.0933 | Time: 4.2s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.617921  0.564218  0.571735  ...  0.600679  0.542700  0.502790
1  0.554308  0.604043  0.554763  ...  0.520991  0.450623  0.394230
2  0.538663  0.523859  0.575160  ...  0.510958  0.467325  0.427707
3  0.606292  0.613826  0.631222  ...  0.584198  0.498410  0.427262
4  0.425290  0.405756  0.406975  ...  0.424204  0.488706  0.486028

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7844
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8963
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8745
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.2613, accuracy=0.0829
Testing SVM
  SVM Test Accuracy: 0.8571
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8265

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7612, Accuracy: 9329/12000 (78%)

Epoch 1 | Train Acc: 0.61025 | Test Acc: 0.7774166666666666 | Time: 1.0268068313598633 sec

Test set: Average loss: 0.5376, Accuracy: 9980/12000 (83%)

Epoch 2 | Train Acc: 0.8029166666666666 | Test Acc: 0.8316666666666667 | Time: 1.0272901058197021 sec

Test set: Average loss: 0.4634, Accuracy: 10230/12000 (85%)

Epoch 3 | Train Acc: 0.8394166666666667 | Test Acc: 0.8525 | Time: 1.019644021987915 sec

Test set: Average loss: 0.4228, Accuracy: 10383/12000 (87%)

Epoch 4 | Train Acc: 0.8582083333333334 | Test Acc: 0.86525 | Time: 1.028191089630127 sec

Test set: Average loss: 0.3991, Accuracy: 10464/12000 (87%)

Epoch 5 | Train Acc: 0.8716875 | Test Acc: 0.872 | Time: 1.034273386001587 sec

Test set: Average loss: 0.3804, Accuracy: 10545/12000 (88%)

Epoch 6 | Train Acc: 0.8797916666666666 | Test Acc: 0.87875 | Time: 1.1321132183074951 sec

Test set: Average loss: 0.3688, Accuracy: 10597/12000 (88%)

Epoch 7 | Train Acc: 0.8852916666666667 | Test Acc: 0.8830833333333333 | Time: 1.0251941680908203 sec

Test set: Average loss: 0.3590, Accuracy: 10635/12000 (89%)

Epoch 8 | Train Acc: 0.8886666666666667 | Test Acc: 0.88625 | Time: 1.0211107730865479 sec

Test set: Average loss: 0.3524, Accuracy: 10679/12000 (89%)

Epoch 9 | Train Acc: 0.8918333333333334 | Test Acc: 0.8899166666666667 | Time: 1.0217182636260986 sec

Test set: Average loss: 0.3472, Accuracy: 10706/12000 (89%)

Epoch 10 | Train Acc: 0.8935833333333333 | Test Acc: 0.8921666666666667 | Time: 1.0303714275360107 sec

Test set: Average loss: 0.3432, Accuracy: 10719/12000 (89%)

Epoch 11 | Train Acc: 0.8946041666666666 | Test Acc: 0.89325 | Time: 1.022104024887085 sec

Test set: Average loss: 0.3410, Accuracy: 10723/12000 (89%)

Epoch 12 | Train Acc: 0.895375 | Test Acc: 0.8935833333333333 | Time: 1.03950834274292 sec

Test set: Average loss: 0.3395, Accuracy: 10730/12000 (89%)

Epoch 13 | Train Acc: 0.8959166666666667 | Test Acc: 0.8941666666666667 | Time: 1.0382411479949951 sec

Test set: Average loss: 0.3384, Accuracy: 10736/12000 (89%)

Epoch 14 | Train Acc: 0.8963958333333333 | Test Acc: 0.8946666666666667 | Time: 1.0323450565338135 sec

Test set: Average loss: 0.3377, Accuracy: 10734/12000 (89%)

Epoch 15 | Train Acc: 0.8967291666666667 | Test Acc: 0.8945 | Time: 1.1407146453857422 sec

Test set: Average loss: 0.3371, Accuracy: 10735/12000 (89%)

Epoch 16 | Train Acc: 0.8970208333333334 | Test Acc: 0.8945833333333333 | Time: 1.0409536361694336 sec

Test set: Average loss: 0.3367, Accuracy: 10736/12000 (89%)

Epoch 17 | Train Acc: 0.8972916666666667 | Test Acc: 0.8946666666666667 | Time: 1.0330002307891846 sec

Test set: Average loss: 0.3364, Accuracy: 10740/12000 (90%)

Epoch 18 | Train Acc: 0.8972708333333334 | Test Acc: 0.895 | Time: 1.0405468940734863 sec

Test set: Average loss: 0.3363, Accuracy: 10746/12000 (90%)

Epoch 19 | Train Acc: 0.8974583333333334 | Test Acc: 0.8955 | Time: 1.0384342670440674 sec

Test set: Average loss: 0.3362, Accuracy: 10752/12000 (90%)

Epoch 20 | Train Acc: 0.8975833333333333 | Test Acc: 0.896 | Time: 1.0325140953063965 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -42.1514 | Coherence: 12.5185 | Separation: 50.4970 | Information gain: 7.8333 | Grad Norm: 40.3733 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -40.0269 | Coherence: 13.1774 | Separation: 48.8118 | Information gain: 7.8333 | Grad Norm: 38.7218 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -38.0185 | Coherence: 13.8148 | Separation: 47.2283 | Information gain: 7.8333 | Grad Norm: 38.8061 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -35.9888 | Coherence: 14.4658 | Separation: 45.6326 | Information gain: 7.8333 | Grad Norm: 38.3890 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -34.0226 | Coherence: 15.1573 | Separation: 44.1274 | Information gain: 8.0000 | Grad Norm: 35.8425 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -32.0585 | Coherence: 15.8777 | Separation: 42.6436 | Information gain: 8.0000 | Grad Norm: 35.5789 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -29.9817 | Coherence: 16.6367 | Separation: 41.0728 | Information gain: 8.0000 | Grad Norm: 35.3507 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -27.9070 | Coherence: 17.4196 | Separation: 39.5201 | Information gain: 8.0000 | Grad Norm: 34.3621 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -25.9502 | Coherence: 18.2493 | Separation: 38.1164 | Information gain: 8.0000 | Grad Norm: 33.2935 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -24.2496 | Coherence: 19.1293 | Separation: 37.0024 | Information gain: 8.1667 | Grad Norm: 32.4011 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -22.6706 | Coherence: 20.0115 | Separation: 36.0116 | Information gain: 8.0000 | Grad Norm: 30.4672 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -21.1657 | Coherence: 20.9689 | Separation: 35.1450 | Information gain: 8.0000 | Grad Norm: 30.3849 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -19.7421 | Coherence: 21.9262 | Separation: 34.3596 | Information gain: 8.1667 | Grad Norm: 30.4992 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -18.2926 | Coherence: 22.8288 | Separation: 33.5118 | Information gain: 8.3333 | Grad Norm: 29.4088 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -16.9005 | Coherence: 23.7079 | Separation: 32.7058 | Information gain: 8.3333 | Grad Norm: 29.8194 | Time: 3.3s
Step 0150 | Epoch 01 | Objective: -15.4735 | Coherence: 24.5574 | Separation: 31.8451 | Information gain: 8.3333 | Grad Norm: 29.0983 | Time: 3.5s
Step 0160 | Epoch 01 | Objective: -14.0412 | Coherence: 25.3909 | Separation: 30.9685 | Information gain: 8.8333 | Grad Norm: 29.2604 | Time: 3.7s
Step 0170 | Epoch 01 | Objective: -12.8234 | Coherence: 26.2071 | Separation: 30.2948 | Information gain: 8.8333 | Grad Norm: 26.5345 | Time: 3.9s
Step 0180 | Epoch 01 | Objective: -11.7855 | Coherence: 26.9654 | Separation: 29.7625 | Information gain: 8.8333 | Grad Norm: 26.8550 | Time: 4.2s
Step 0190 | Epoch 01 | Objective: -10.7526 | Coherence: 27.7106 | Separation: 29.2264 | Information gain: 8.8333 | Grad Norm: 27.2876 | Time: 4.4s
Step 0200 | Epoch 01 | Objective: -9.7491 | Coherence: 28.5049 | Separation: 28.7523 | Information gain: 8.6667 | Grad Norm: 26.2428 | Time: 4.6s
Step 0210 | Epoch 01 | Objective: -8.7290 | Coherence: 29.2692 | Separation: 28.2418 | Information gain: 8.6667 | Grad Norm: 27.8555 | Time: 4.8s
Step 0220 | Epoch 01 | Objective: -7.6924 | Coherence: 30.0216 | Separation: 27.7069 | Information gain: 8.5000 | Grad Norm: 27.1561 | Time: 5.1s
Step 0230 | Epoch 01 | Objective: -6.6836 | Coherence: 30.7836 | Separation: 27.2060 | Information gain: 8.3333 | Grad Norm: 26.6768 | Time: 5.3s
Step 0240 | Epoch 01 | Objective: -5.6370 | Coherence: 31.5266 | Separation: 26.6548 | Information gain: 8.3333 | Grad Norm: 27.9393 | Time: 5.5s
Step 0250 | Epoch 01 | Objective: -4.6358 | Coherence: 32.2509 | Separation: 26.1364 | Information gain: 8.3333 | Grad Norm: 26.0987 | Time: 5.8s
Step 0260 | Epoch 01 | Objective: -3.6300 | Coherence: 32.9438 | Separation: 25.5926 | Information gain: 8.3333 | Grad Norm: 26.4895 | Time: 6.0s
Step 0270 | Epoch 01 | Objective: -2.6082 | Coherence: 33.6123 | Separation: 25.0164 | Information gain: 8.3333 | Grad Norm: 26.6414 | Time: 6.2s
Step 0280 | Epoch 01 | Objective: -1.6140 | Coherence: 34.2614 | Separation: 24.4550 | Information gain: 8.3333 | Grad Norm: 26.4599 | Time: 6.4s
Step 0290 | Epoch 01 | Objective: -0.6229 | Coherence: 34.9115 | Separation: 23.8972 | Information gain: 8.3333 | Grad Norm: 26.7506 | Time: 6.7s
Step 0300 | Epoch 01 | Objective: 0.2877 | Coherence: 35.4875 | Separation: 23.3707 | Information gain: 8.3333 | Grad Norm: 25.3066 | Time: 6.9s
Step 0308 | Epoch 01 | Objective: 0.9325 | Coherence: 35.9052 | Separation: 23.0043 | Information gain: 8.3333 | Grad Norm: 24.2949 | Time: 7.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.616741  0.517589  0.431389  ...  0.433024  0.444340  0.441752
1  0.485840  0.569137  0.400125  ...  0.385544  0.465086  0.448533
2  0.427577  0.424590  0.574808  ...  0.532048  0.496331  0.479284
3  0.447181  0.454106  0.509793  ...  0.468469  0.480373  0.458705
4  0.390319  0.423209  0.595067  ...  0.518607  0.525981  0.501499

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7900
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8817
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8665
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.5231, accuracy=0.0725
Testing SVM
  SVM Test Accuracy: 0.8498
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8231

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6737, Accuracy: 9577/12000 (80%)

Epoch 1 | Train Acc: 0.6584791666666666 | Test Acc: 0.7980833333333334 | Time: 1.139960765838623 sec

Test set: Average loss: 0.5418, Accuracy: 9915/12000 (83%)

Epoch 2 | Train Acc: 0.8147916666666667 | Test Acc: 0.82625 | Time: 1.0255141258239746 sec

Test set: Average loss: 0.4864, Accuracy: 10079/12000 (84%)

Epoch 3 | Train Acc: 0.841125 | Test Acc: 0.8399166666666666 | Time: 1.0270042419433594 sec

Test set: Average loss: 0.4489, Accuracy: 10217/12000 (85%)

Epoch 4 | Train Acc: 0.8540416666666667 | Test Acc: 0.8514166666666667 | Time: 1.0276634693145752 sec

Test set: Average loss: 0.4188, Accuracy: 10345/12000 (86%)

Epoch 5 | Train Acc: 0.8624166666666667 | Test Acc: 0.8620833333333333 | Time: 1.0207126140594482 sec

Test set: Average loss: 0.4002, Accuracy: 10435/12000 (87%)

Epoch 6 | Train Acc: 0.8694375 | Test Acc: 0.8695833333333334 | Time: 1.0243465900421143 sec

Test set: Average loss: 0.3886, Accuracy: 10469/12000 (87%)

Epoch 7 | Train Acc: 0.8739166666666667 | Test Acc: 0.8724166666666666 | Time: 1.0218784809112549 sec

Test set: Average loss: 0.3811, Accuracy: 10511/12000 (88%)

Epoch 8 | Train Acc: 0.876625 | Test Acc: 0.8759166666666667 | Time: 1.01832914352417 sec

Test set: Average loss: 0.3759, Accuracy: 10525/12000 (88%)

Epoch 9 | Train Acc: 0.8785 | Test Acc: 0.8770833333333333 | Time: 1.023026943206787 sec

Test set: Average loss: 0.3720, Accuracy: 10545/12000 (88%)

Epoch 10 | Train Acc: 0.8802708333333333 | Test Acc: 0.87875 | Time: 1.1338226795196533 sec

Test set: Average loss: 0.3693, Accuracy: 10559/12000 (88%)

Epoch 11 | Train Acc: 0.8808958333333333 | Test Acc: 0.8799166666666667 | Time: 1.0332012176513672 sec

Test set: Average loss: 0.3676, Accuracy: 10560/12000 (88%)

Epoch 12 | Train Acc: 0.8817083333333333 | Test Acc: 0.88 | Time: 1.0250065326690674 sec

Test set: Average loss: 0.3663, Accuracy: 10569/12000 (88%)

Epoch 13 | Train Acc: 0.8819791666666666 | Test Acc: 0.88075 | Time: 1.027221918106079 sec

Test set: Average loss: 0.3655, Accuracy: 10574/12000 (88%)

Epoch 14 | Train Acc: 0.8822916666666667 | Test Acc: 0.8811666666666667 | Time: 1.0246059894561768 sec

Test set: Average loss: 0.3649, Accuracy: 10568/12000 (88%)

Epoch 15 | Train Acc: 0.8826666666666667 | Test Acc: 0.8806666666666667 | Time: 1.0284514427185059 sec

Test set: Average loss: 0.3646, Accuracy: 10570/12000 (88%)

Epoch 16 | Train Acc: 0.8829791666666666 | Test Acc: 0.8808333333333334 | Time: 1.0310094356536865 sec

Test set: Average loss: 0.3644, Accuracy: 10574/12000 (88%)

Epoch 17 | Train Acc: 0.883125 | Test Acc: 0.8811666666666667 | Time: 1.0269684791564941 sec

Test set: Average loss: 0.3643, Accuracy: 10575/12000 (88%)

Epoch 18 | Train Acc: 0.8831041666666667 | Test Acc: 0.88125 | Time: 1.0195796489715576 sec

Test set: Average loss: 0.3642, Accuracy: 10577/12000 (88%)

Epoch 19 | Train Acc: 0.8831458333333333 | Test Acc: 0.8814166666666666 | Time: 1.1282575130462646 sec

Test set: Average loss: 0.3641, Accuracy: 10575/12000 (88%)

Epoch 20 | Train Acc: 0.8831875 | Test Acc: 0.88125 | Time: 1.0277297496795654 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -49.4988 | Coherence: 19.3832 | Separation: 64.7542 | Information gain: 7.0000 | Grad Norm: 44.5706 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -47.4409 | Coherence: 19.7596 | Separation: 62.9474 | Information gain: 7.0000 | Grad Norm: 42.7776 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -45.5027 | Coherence: 20.1652 | Separation: 61.2795 | Information gain: 7.0000 | Grad Norm: 41.7060 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -43.5515 | Coherence: 20.5973 | Separation: 59.6164 | Information gain: 7.0000 | Grad Norm: 41.1172 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: -41.6136 | Coherence: 21.0615 | Separation: 57.9879 | Information gain: 7.0000 | Grad Norm: 40.3943 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -39.7004 | Coherence: 21.6519 | Separation: 56.4683 | Information gain: 7.0000 | Grad Norm: 39.3910 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -37.7793 | Coherence: 22.2179 | Separation: 54.9246 | Information gain: 7.0000 | Grad Norm: 38.9773 | Time: 1.5s
Step 0070 | Epoch 01 | Objective: -35.8186 | Coherence: 22.7663 | Separation: 53.3294 | Information gain: 7.0000 | Grad Norm: 37.2524 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -34.0590 | Coherence: 23.3086 | Separation: 51.9314 | Information gain: 7.0000 | Grad Norm: 35.3179 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -32.3334 | Coherence: 23.9255 | Separation: 50.6726 | Information gain: 7.1667 | Grad Norm: 34.9414 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -30.6444 | Coherence: 24.5290 | Separation: 49.4415 | Information gain: 7.3333 | Grad Norm: 34.8610 | Time: 2.4s
Step 0110 | Epoch 01 | Objective: -29.0249 | Coherence: 25.0854 | Separation: 48.2485 | Information gain: 7.5000 | Grad Norm: 33.3254 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -27.5156 | Coherence: 25.6637 | Separation: 47.1247 | Information gain: 7.5000 | Grad Norm: 32.5301 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -26.2251 | Coherence: 26.1912 | Separation: 46.0748 | Information gain: 7.1667 | Grad Norm: 32.1101 | Time: 3.1s
Step 0140 | Epoch 01 | Objective: -24.9306 | Coherence: 26.7061 | Separation: 45.0680 | Information gain: 7.0000 | Grad Norm: 31.8384 | Time: 3.3s
Step 0150 | Epoch 01 | Objective: -23.5450 | Coherence: 27.1855 | Separation: 44.0020 | Information gain: 7.0000 | Grad Norm: 30.4841 | Time: 3.5s
Step 0160 | Epoch 01 | Objective: -22.1455 | Coherence: 27.6064 | Separation: 42.8831 | Information gain: 7.0000 | Grad Norm: 30.2703 | Time: 3.8s
Step 0170 | Epoch 01 | Objective: -20.5961 | Coherence: 27.9972 | Separation: 41.6498 | Information gain: 7.1667 | Grad Norm: 31.3953 | Time: 4.0s
Step 0180 | Epoch 01 | Objective: -19.1506 | Coherence: 28.3885 | Separation: 40.4652 | Information gain: 7.1667 | Grad Norm: 30.1352 | Time: 4.2s
Step 0190 | Epoch 01 | Objective: -17.7192 | Coherence: 28.7817 | Separation: 39.2959 | Information gain: 7.1667 | Grad Norm: 31.6061 | Time: 4.5s
Step 0200 | Epoch 01 | Objective: -16.3396 | Coherence: 29.2637 | Separation: 38.2377 | Information gain: 7.1667 | Grad Norm: 30.3903 | Time: 4.7s
Step 0210 | Epoch 01 | Objective: -14.9118 | Coherence: 29.7574 | Separation: 37.1945 | Information gain: 7.3333 | Grad Norm: 29.6178 | Time: 4.9s
Step 0220 | Epoch 01 | Objective: -13.4396 | Coherence: 30.1952 | Separation: 36.0697 | Information gain: 7.5000 | Grad Norm: 29.2094 | Time: 5.2s
Step 0230 | Epoch 01 | Objective: -11.9562 | Coherence: 30.6208 | Separation: 34.9256 | Information gain: 7.6667 | Grad Norm: 30.4077 | Time: 5.4s
Step 0240 | Epoch 01 | Objective: -10.5190 | Coherence: 31.0370 | Separation: 33.7659 | Information gain: 7.6667 | Grad Norm: 29.7151 | Time: 5.6s
Step 0250 | Epoch 01 | Objective: -9.0662 | Coherence: 31.4562 | Separation: 32.5925 | Information gain: 7.6667 | Grad Norm: 29.9007 | Time: 5.9s
Step 0260 | Epoch 01 | Objective: -7.6886 | Coherence: 31.8967 | Separation: 31.5085 | Information gain: 7.6667 | Grad Norm: 29.1447 | Time: 6.1s
Step 0270 | Epoch 01 | Objective: -6.3253 | Coherence: 32.3601 | Separation: 30.5098 | Information gain: 7.8333 | Grad Norm: 27.1647 | Time: 6.3s
Step 0280 | Epoch 01 | Objective: -5.1919 | Coherence: 32.7916 | Separation: 29.6641 | Information gain: 7.8333 | Grad Norm: 26.7556 | Time: 6.5s
Step 0290 | Epoch 01 | Objective: -4.1969 | Coherence: 33.1895 | Separation: 28.9343 | Information gain: 7.8333 | Grad Norm: 26.4254 | Time: 6.8s
Step 0300 | Epoch 01 | Objective: -3.1361 | Coherence: 33.6418 | Separation: 28.2862 | Information gain: 8.1667 | Grad Norm: 25.5972 | Time: 7.0s
Step 0310 | Epoch 01 | Objective: -2.2579 | Coherence: 34.1240 | Separation: 27.7295 | Information gain: 8.1667 | Grad Norm: 26.4549 | Time: 7.2s
Step 0320 | Epoch 01 | Objective: -1.5019 | Coherence: 34.5234 | Separation: 27.2397 | Information gain: 8.1667 | Grad Norm: 24.8369 | Time: 7.5s
Step 0330 | Epoch 01 | Objective: -0.7598 | Coherence: 34.8418 | Separation: 26.7099 | Information gain: 8.1667 | Grad Norm: 25.8023 | Time: 7.7s
Step 0340 | Epoch 01 | Objective: 0.0135 | Coherence: 35.1765 | Separation: 26.2153 | Information gain: 8.3333 | Grad Norm: 25.2804 | Time: 7.9s
Step 0350 | Epoch 01 | Objective: 0.6748 | Coherence: 35.5306 | Separation: 25.7345 | Information gain: 8.1667 | Grad Norm: 23.9113 | Time: 8.1s
Step 0354 | Epoch 01 | Objective: 0.9531 | Coherence: 35.6675 | Separation: 25.5474 | Information gain: 8.1667 | Grad Norm: 25.3757 | Time: 8.2s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.556690  0.411971  0.451039  ...  0.316545  0.351180  0.512541
1  0.448173  0.604133  0.573220  ...  0.345561  0.462141  0.460970
2  0.523340  0.608858  0.646659  ...  0.399609  0.501481  0.560760
3  0.471054  0.480021  0.482976  ...  0.409609  0.457783  0.495297
4  0.538216  0.598077  0.625429  ...  0.414529  0.496856  0.561841

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7949
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8892
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8681
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0279, accuracy=0.1084
Testing SVM
  SVM Test Accuracy: 0.8530
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8259

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7122, Accuracy: 9324/12000 (78%)

Epoch 1 | Train Acc: 0.6387291666666667 | Test Acc: 0.777 | Time: 1.0240554809570312 sec

Test set: Average loss: 0.5374, Accuracy: 9946/12000 (83%)

Epoch 2 | Train Acc: 0.8082916666666666 | Test Acc: 0.8288333333333333 | Time: 1.0267529487609863 sec

Test set: Average loss: 0.4683, Accuracy: 10192/12000 (85%)

Epoch 3 | Train Acc: 0.8425416666666666 | Test Acc: 0.8493333333333334 | Time: 1.0223541259765625 sec

Test set: Average loss: 0.4252, Accuracy: 10375/12000 (86%)

Epoch 4 | Train Acc: 0.8594166666666667 | Test Acc: 0.8645833333333334 | Time: 1.0291690826416016 sec

Test set: Average loss: 0.4007, Accuracy: 10451/12000 (87%)

Epoch 5 | Train Acc: 0.8706875 | Test Acc: 0.8709166666666667 | Time: 1.0305120944976807 sec

Test set: Average loss: 0.3843, Accuracy: 10513/12000 (88%)

Epoch 6 | Train Acc: 0.8775 | Test Acc: 0.8760833333333333 | Time: 1.0249302387237549 sec

Test set: Average loss: 0.3731, Accuracy: 10552/12000 (88%)

Epoch 7 | Train Acc: 0.8814166666666666 | Test Acc: 0.8793333333333333 | Time: 1.1372883319854736 sec

Test set: Average loss: 0.3642, Accuracy: 10577/12000 (88%)

Epoch 8 | Train Acc: 0.884625 | Test Acc: 0.8814166666666666 | Time: 1.0315661430358887 sec

Test set: Average loss: 0.3587, Accuracy: 10604/12000 (88%)

Epoch 9 | Train Acc: 0.8867083333333333 | Test Acc: 0.8836666666666667 | Time: 1.0244009494781494 sec

Test set: Average loss: 0.3552, Accuracy: 10624/12000 (89%)

Epoch 10 | Train Acc: 0.8876041666666666 | Test Acc: 0.8853333333333333 | Time: 1.0307939052581787 sec

Test set: Average loss: 0.3528, Accuracy: 10639/12000 (89%)

Epoch 11 | Train Acc: 0.8886875 | Test Acc: 0.8865833333333333 | Time: 1.0290277004241943 sec

Test set: Average loss: 0.3511, Accuracy: 10656/12000 (89%)

Epoch 12 | Train Acc: 0.8894791666666667 | Test Acc: 0.888 | Time: 1.021855354309082 sec

Test set: Average loss: 0.3498, Accuracy: 10665/12000 (89%)

Epoch 13 | Train Acc: 0.89 | Test Acc: 0.88875 | Time: 1.0298192501068115 sec

Test set: Average loss: 0.3491, Accuracy: 10658/12000 (89%)

Epoch 14 | Train Acc: 0.8904583333333334 | Test Acc: 0.8881666666666667 | Time: 1.0245251655578613 sec

Test set: Average loss: 0.3485, Accuracy: 10666/12000 (89%)

Epoch 15 | Train Acc: 0.8908125 | Test Acc: 0.8888333333333334 | Time: 1.0285816192626953 sec

Test set: Average loss: 0.3481, Accuracy: 10665/12000 (89%)

Epoch 16 | Train Acc: 0.8911458333333333 | Test Acc: 0.88875 | Time: 1.1164476871490479 sec

Test set: Average loss: 0.3478, Accuracy: 10661/12000 (89%)

Epoch 17 | Train Acc: 0.891125 | Test Acc: 0.8884166666666666 | Time: 1.0342164039611816 sec

Test set: Average loss: 0.3476, Accuracy: 10660/12000 (89%)

Epoch 18 | Train Acc: 0.8912083333333334 | Test Acc: 0.8883333333333333 | Time: 1.0288560390472412 sec

Test set: Average loss: 0.3475, Accuracy: 10659/12000 (89%)

Epoch 19 | Train Acc: 0.8913541666666667 | Test Acc: 0.88825 | Time: 1.028648853302002 sec

Test set: Average loss: 0.3474, Accuracy: 10657/12000 (89%)

Epoch 20 | Train Acc: 0.8912916666666667 | Test Acc: 0.8880833333333333 | Time: 1.0209314823150635 sec
Early stopping at epoch 20

Testing with M=15
Step 0000 | Epoch 01 | Objective: -40.8220 | Coherence: 16.9954 | Separation: 56.7079 | Information gain: 6.8333 | Grad Norm: 41.2616 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -38.6617 | Coherence: 17.5621 | Separation: 54.9253 | Information gain: 6.8333 | Grad Norm: 37.2841 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -37.0487 | Coherence: 18.1265 | Separation: 53.6886 | Information gain: 6.8333 | Grad Norm: 34.5280 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -35.5578 | Coherence: 18.6998 | Separation: 52.5799 | Information gain: 6.8333 | Grad Norm: 34.5002 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -33.9626 | Coherence: 19.2812 | Separation: 51.3722 | Information gain: 6.8333 | Grad Norm: 34.2998 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -32.2687 | Coherence: 19.8773 | Separation: 50.0758 | Information gain: 6.8333 | Grad Norm: 34.2611 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -30.4898 | Coherence: 20.5052 | Separation: 48.7155 | Information gain: 6.8333 | Grad Norm: 34.3970 | Time: 1.5s
Step 0070 | Epoch 01 | Objective: -28.7264 | Coherence: 21.1009 | Separation: 47.3492 | Information gain: 6.8333 | Grad Norm: 33.0864 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -26.9514 | Coherence: 21.6476 | Separation: 45.9387 | Information gain: 6.8333 | Grad Norm: 32.2482 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -25.2433 | Coherence: 22.1934 | Separation: 44.5945 | Information gain: 6.8333 | Grad Norm: 31.1100 | Time: 2.2s
Step 0100 | Epoch 01 | Objective: -23.5538 | Coherence: 22.7707 | Separation: 43.2898 | Information gain: 6.8333 | Grad Norm: 31.0801 | Time: 2.4s
Step 0110 | Epoch 01 | Objective: -21.7054 | Coherence: 23.3923 | Separation: 41.9669 | Information gain: 7.0000 | Grad Norm: 29.7706 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -20.0031 | Coherence: 24.0878 | Separation: 40.7284 | Information gain: 7.0000 | Grad Norm: 29.6584 | Time: 2.9s
Step 0130 | Epoch 01 | Objective: -18.2627 | Coherence: 24.7769 | Separation: 39.5584 | Information gain: 7.1667 | Grad Norm: 31.7441 | Time: 3.1s
Step 0140 | Epoch 01 | Objective: -16.5631 | Coherence: 25.4833 | Separation: 38.4409 | Information gain: 7.3333 | Grad Norm: 29.1429 | Time: 3.3s
Step 0150 | Epoch 01 | Objective: -15.2070 | Coherence: 26.1791 | Separation: 37.5486 | Information gain: 7.3333 | Grad Norm: 27.0685 | Time: 3.6s
Step 0160 | Epoch 01 | Objective: -13.9054 | Coherence: 26.8756 | Separation: 36.8224 | Information gain: 7.5000 | Grad Norm: 28.1662 | Time: 3.8s
Step 0170 | Epoch 01 | Objective: -12.8100 | Coherence: 27.4787 | Separation: 36.1292 | Information gain: 7.5000 | Grad Norm: 26.0757 | Time: 4.0s
Step 0180 | Epoch 01 | Objective: -11.8058 | Coherence: 28.0174 | Separation: 35.4841 | Information gain: 7.5000 | Grad Norm: 25.6623 | Time: 4.2s
Step 0190 | Epoch 01 | Objective: -10.7142 | Coherence: 28.5413 | Separation: 34.8529 | Information gain: 7.6667 | Grad Norm: 26.7648 | Time: 4.5s
Step 0200 | Epoch 01 | Objective: -9.9898 | Coherence: 29.0318 | Separation: 34.2333 | Information gain: 7.3333 | Grad Norm: 26.5959 | Time: 4.7s
Step 0210 | Epoch 01 | Objective: -8.8540 | Coherence: 29.5417 | Separation: 33.7706 | Information gain: 7.8333 | Grad Norm: 24.9945 | Time: 4.9s
Step 0220 | Epoch 01 | Objective: -8.0440 | Coherence: 30.0917 | Separation: 33.3274 | Information gain: 7.8333 | Grad Norm: 26.1381 | Time: 5.1s
Step 0230 | Epoch 01 | Objective: -7.2006 | Coherence: 30.5891 | Separation: 32.8156 | Information gain: 7.8333 | Grad Norm: 26.6399 | Time: 5.4s
Step 0240 | Epoch 01 | Objective: -6.3308 | Coherence: 31.0925 | Separation: 32.2813 | Information gain: 7.8333 | Grad Norm: 26.0480 | Time: 5.6s
Step 0250 | Epoch 01 | Objective: -5.5925 | Coherence: 31.5912 | Separation: 31.7643 | Information gain: 7.6667 | Grad Norm: 26.5289 | Time: 5.8s
Step 0260 | Epoch 01 | Objective: -4.7515 | Coherence: 32.0457 | Separation: 31.2264 | Information gain: 7.6667 | Grad Norm: 25.8759 | Time: 6.0s
Step 0270 | Epoch 01 | Objective: -3.8893 | Coherence: 32.5041 | Separation: 30.6698 | Information gain: 7.6667 | Grad Norm: 24.5915 | Time: 6.3s
Step 0280 | Epoch 01 | Objective: -2.9993 | Coherence: 32.9852 | Separation: 30.1005 | Information gain: 7.6667 | Grad Norm: 27.0758 | Time: 6.5s
Step 0290 | Epoch 01 | Objective: -2.1252 | Coherence: 33.4377 | Separation: 29.5281 | Information gain: 7.6667 | Grad Norm: 26.6771 | Time: 6.7s
Step 0300 | Epoch 01 | Objective: -1.3823 | Coherence: 33.8730 | Separation: 29.0754 | Information gain: 7.6667 | Grad Norm: 24.1728 | Time: 6.9s
Step 0310 | Epoch 01 | Objective: -0.5519 | Coherence: 34.2770 | Separation: 28.6255 | Information gain: 7.8333 | Grad Norm: 26.7820 | Time: 7.2s
Step 0320 | Epoch 01 | Objective: 0.0731 | Coherence: 34.6543 | Separation: 28.1408 | Information gain: 7.6667 | Grad Norm: 25.0156 | Time: 7.4s
Step 0330 | Epoch 01 | Objective: 0.7970 | Coherence: 35.0480 | Separation: 27.6794 | Information gain: 7.6667 | Grad Norm: 24.5493 | Time: 7.6s
Step 0332 | Epoch 01 | Objective: 0.9397 | Coherence: 35.1230 | Separation: 27.5867 | Information gain: 7.6667 | Grad Norm: 26.9375 | Time: 7.7s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.605215  0.554128  0.374015  ...  0.466419  0.507879  0.572421
1  0.547283  0.599749  0.440847  ...  0.481804  0.501248  0.583343
2  0.370203  0.438682  0.595998  ...  0.440366  0.411850  0.446086
3  0.411966  0.468697  0.402043  ...  0.312911  0.466890  0.466361
4  0.520258  0.537548  0.509782  ...  0.459032  0.570668  0.543302

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8089
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8983
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8805
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0090, accuracy=0.1135
Testing SVM
  SVM Test Accuracy: 0.8584
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8389

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6636, Accuracy: 9606/12000 (80%)

Epoch 1 | Train Acc: 0.6682291666666667 | Test Acc: 0.8005 | Time: 1.025219440460205 sec

Test set: Average loss: 0.5089, Accuracy: 10030/12000 (84%)

Epoch 2 | Train Acc: 0.8295 | Test Acc: 0.8358333333333333 | Time: 1.0220720767974854 sec

Test set: Average loss: 0.4364, Accuracy: 10335/12000 (86%)

Epoch 3 | Train Acc: 0.8567708333333334 | Test Acc: 0.86125 | Time: 1.1301896572113037 sec

Test set: Average loss: 0.3986, Accuracy: 10482/12000 (87%)

Epoch 4 | Train Acc: 0.8715416666666667 | Test Acc: 0.8735 | Time: 1.0232293605804443 sec

Test set: Average loss: 0.3787, Accuracy: 10540/12000 (88%)

Epoch 5 | Train Acc: 0.8807083333333333 | Test Acc: 0.8783333333333333 | Time: 1.02858304977417 sec

Test set: Average loss: 0.3670, Accuracy: 10593/12000 (88%)

Epoch 6 | Train Acc: 0.8875625 | Test Acc: 0.88275 | Time: 1.0228750705718994 sec

Test set: Average loss: 0.3580, Accuracy: 10628/12000 (89%)

Epoch 7 | Train Acc: 0.8910208333333334 | Test Acc: 0.8856666666666667 | Time: 1.0222792625427246 sec

Test set: Average loss: 0.3520, Accuracy: 10656/12000 (89%)

Epoch 8 | Train Acc: 0.894125 | Test Acc: 0.888 | Time: 1.021860122680664 sec

Test set: Average loss: 0.3479, Accuracy: 10676/12000 (89%)

Epoch 9 | Train Acc: 0.8965208333333333 | Test Acc: 0.8896666666666667 | Time: 1.050318956375122 sec

Test set: Average loss: 0.3450, Accuracy: 10695/12000 (89%)

Epoch 10 | Train Acc: 0.8975625 | Test Acc: 0.89125 | Time: 1.030402421951294 sec

Test set: Average loss: 0.3428, Accuracy: 10703/12000 (89%)

Epoch 11 | Train Acc: 0.8986041666666666 | Test Acc: 0.8919166666666667 | Time: 1.0318198204040527 sec

Test set: Average loss: 0.3412, Accuracy: 10712/12000 (89%)

Epoch 12 | Train Acc: 0.8991666666666667 | Test Acc: 0.8926666666666667 | Time: 1.2054071426391602 sec

Test set: Average loss: 0.3400, Accuracy: 10716/12000 (89%)

Epoch 13 | Train Acc: 0.8994791666666667 | Test Acc: 0.893 | Time: 1.0403904914855957 sec

Test set: Average loss: 0.3391, Accuracy: 10724/12000 (89%)

Epoch 14 | Train Acc: 0.8998541666666666 | Test Acc: 0.8936666666666667 | Time: 1.0451698303222656 sec

Test set: Average loss: 0.3385, Accuracy: 10724/12000 (89%)

Epoch 15 | Train Acc: 0.9000208333333334 | Test Acc: 0.8936666666666667 | Time: 1.032841682434082 sec

Test set: Average loss: 0.3381, Accuracy: 10730/12000 (89%)

Epoch 16 | Train Acc: 0.9002083333333334 | Test Acc: 0.8941666666666667 | Time: 1.028383493423462 sec

Test set: Average loss: 0.3379, Accuracy: 10731/12000 (89%)

Epoch 17 | Train Acc: 0.9004375 | Test Acc: 0.89425 | Time: 1.0288059711456299 sec

Test set: Average loss: 0.3377, Accuracy: 10730/12000 (89%)

Epoch 18 | Train Acc: 0.9005625 | Test Acc: 0.8941666666666667 | Time: 1.033918857574463 sec

Test set: Average loss: 0.3376, Accuracy: 10731/12000 (89%)

Epoch 19 | Train Acc: 0.9007291666666667 | Test Acc: 0.89425 | Time: 1.036496639251709 sec

Test set: Average loss: 0.3375, Accuracy: 10731/12000 (89%)

Epoch 20 | Train Acc: 0.9008333333333334 | Test Acc: 0.89425 | Time: 1.0287270545959473 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -41.6804 | Coherence: 11.5930 | Separation: 57.0758 | Information gain: 7.6667 | Grad Norm: 43.1251 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -39.0942 | Coherence: 12.1362 | Separation: 54.8517 | Information gain: 7.6667 | Grad Norm: 41.6645 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -36.4222 | Coherence: 12.7153 | Separation: 52.7324 | Information gain: 7.8333 | Grad Norm: 39.9500 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -33.8035 | Coherence: 13.2710 | Separation: 50.6508 | Information gain: 8.0000 | Grad Norm: 38.3132 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -31.9156 | Coherence: 13.8415 | Separation: 48.9766 | Information gain: 7.8333 | Grad Norm: 36.3765 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -30.0078 | Coherence: 14.4187 | Separation: 47.4536 | Information gain: 7.8333 | Grad Norm: 35.2006 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -28.2132 | Coherence: 15.0651 | Separation: 46.0899 | Information gain: 7.8333 | Grad Norm: 34.5516 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -26.4169 | Coherence: 15.7619 | Separation: 44.7582 | Information gain: 7.8333 | Grad Norm: 33.7741 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -24.6047 | Coherence: 16.4768 | Separation: 43.4226 | Information gain: 7.8333 | Grad Norm: 33.1602 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -23.1002 | Coherence: 17.2080 | Separation: 42.0722 | Information gain: 7.5000 | Grad Norm: 32.5575 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -21.1816 | Coherence: 17.9369 | Separation: 40.8063 | Information gain: 7.6667 | Grad Norm: 32.7633 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -19.5491 | Coherence: 18.6591 | Separation: 39.6551 | Information gain: 7.6667 | Grad Norm: 30.4438 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -18.0242 | Coherence: 19.3643 | Separation: 38.6004 | Information gain: 7.6667 | Grad Norm: 31.6355 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -16.5139 | Coherence: 20.0536 | Separation: 37.5496 | Information gain: 7.6667 | Grad Norm: 30.1817 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -15.0343 | Coherence: 20.7765 | Separation: 36.5519 | Information gain: 7.6667 | Grad Norm: 29.0627 | Time: 3.2s
Step 0150 | Epoch 01 | Objective: -13.5600 | Coherence: 21.4812 | Separation: 35.5475 | Information gain: 7.6667 | Grad Norm: 29.4234 | Time: 3.5s
Step 0160 | Epoch 01 | Objective: -12.7210 | Coherence: 22.1924 | Separation: 34.8492 | Information gain: 7.3333 | Grad Norm: 27.2225 | Time: 3.7s
Step 0170 | Epoch 01 | Objective: -11.6520 | Coherence: 22.9069 | Separation: 34.2566 | Information gain: 7.3333 | Grad Norm: 27.2211 | Time: 3.9s
Step 0180 | Epoch 01 | Objective: -10.4232 | Coherence: 23.5957 | Separation: 33.6536 | Information gain: 7.5000 | Grad Norm: 26.3761 | Time: 4.2s
Step 0190 | Epoch 01 | Objective: -9.3673 | Coherence: 24.2704 | Separation: 33.0476 | Information gain: 7.5000 | Grad Norm: 27.3106 | Time: 4.4s
Step 0200 | Epoch 01 | Objective: -8.4052 | Coherence: 24.8963 | Separation: 32.5027 | Information gain: 7.5000 | Grad Norm: 27.1768 | Time: 4.6s
Step 0210 | Epoch 01 | Objective: -7.4988 | Coherence: 25.5276 | Separation: 32.0172 | Information gain: 7.5000 | Grad Norm: 24.9672 | Time: 4.9s
Step 0220 | Epoch 01 | Objective: -6.7325 | Coherence: 26.1652 | Separation: 31.6760 | Information gain: 7.5000 | Grad Norm: 24.9093 | Time: 5.1s
Step 0230 | Epoch 01 | Objective: -5.9304 | Coherence: 26.7578 | Separation: 31.2690 | Information gain: 7.5000 | Grad Norm: 24.1874 | Time: 5.3s
Step 0240 | Epoch 01 | Objective: -5.0004 | Coherence: 27.3475 | Separation: 30.8987 | Information gain: 7.6667 | Grad Norm: 22.2824 | Time: 5.6s
Step 0250 | Epoch 01 | Objective: -4.1002 | Coherence: 27.8938 | Separation: 30.5294 | Information gain: 7.8333 | Grad Norm: 23.6362 | Time: 5.8s
Step 0260 | Epoch 01 | Objective: -3.3702 | Coherence: 28.4529 | Separation: 30.1721 | Information gain: 7.8333 | Grad Norm: 26.8762 | Time: 6.0s
Step 0270 | Epoch 01 | Objective: -2.6584 | Coherence: 29.0153 | Separation: 29.8353 | Information gain: 7.8333 | Grad Norm: 27.5099 | Time: 6.3s
Step 0280 | Epoch 01 | Objective: -2.0525 | Coherence: 29.5730 | Separation: 29.6011 | Information gain: 7.8333 | Grad Norm: 25.5772 | Time: 6.5s
Step 0290 | Epoch 01 | Objective: -1.4754 | Coherence: 30.1110 | Separation: 29.3828 | Information gain: 7.8333 | Grad Norm: 21.9332 | Time: 6.7s
Step 0300 | Epoch 01 | Objective: -0.9065 | Coherence: 30.6056 | Separation: 29.1436 | Information gain: 7.8333 | Grad Norm: 23.6713 | Time: 6.9s
Step 0310 | Epoch 01 | Objective: -0.3539 | Coherence: 31.0880 | Separation: 28.9126 | Information gain: 7.8333 | Grad Norm: 27.4560 | Time: 7.2s
Step 0320 | Epoch 01 | Objective: 0.1995 | Coherence: 31.5874 | Separation: 28.6922 | Information gain: 7.8333 | Grad Norm: 24.1817 | Time: 7.4s
Step 0330 | Epoch 01 | Objective: 0.7195 | Coherence: 32.0607 | Separation: 28.4876 | Information gain: 7.8333 | Grad Norm: 22.1802 | Time: 7.6s
Step 0334 | Epoch 01 | Objective: 0.9231 | Coherence: 32.2337 | Separation: 28.3994 | Information gain: 7.8333 | Grad Norm: 24.9001 | Time: 7.7s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.564696  0.418787  0.444067  ...  0.447378  0.532671  0.447534
1  0.470802  0.642336  0.493380  ...  0.455494  0.493070  0.443916
2  0.439588  0.422019  0.555504  ...  0.498914  0.457604  0.497789
3  0.483632  0.497385  0.518489  ...  0.502397  0.491433  0.491153
4  0.488626  0.409804  0.551120  ...  0.544893  0.492251  0.521481

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8052
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9020
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8829
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0614, accuracy=0.0986
Testing SVM
  SVM Test Accuracy: 0.8628
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8398

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6619, Accuracy: 9600/12000 (80%)

Epoch 1 | Train Acc: 0.6698125 | Test Acc: 0.8 | Time: 1.3941504955291748 sec

Test set: Average loss: 0.5048, Accuracy: 10121/12000 (84%)

Epoch 2 | Train Acc: 0.835 | Test Acc: 0.8434166666666667 | Time: 1.1124958992004395 sec

Test set: Average loss: 0.4388, Accuracy: 10343/12000 (86%)

Epoch 3 | Train Acc: 0.8615416666666667 | Test Acc: 0.8619166666666667 | Time: 1.1164488792419434 sec

Test set: Average loss: 0.3928, Accuracy: 10507/12000 (88%)

Epoch 4 | Train Acc: 0.8757083333333333 | Test Acc: 0.8755833333333334 | Time: 1.2983224391937256 sec

Test set: Average loss: 0.3684, Accuracy: 10593/12000 (88%)

Epoch 5 | Train Acc: 0.8837708333333333 | Test Acc: 0.88275 | Time: 1.4196603298187256 sec

Test set: Average loss: 0.3502, Accuracy: 10670/12000 (89%)

Epoch 6 | Train Acc: 0.8902291666666666 | Test Acc: 0.8891666666666667 | Time: 1.4046025276184082 sec

Test set: Average loss: 0.3391, Accuracy: 10716/12000 (89%)

Epoch 7 | Train Acc: 0.8943333333333333 | Test Acc: 0.893 | Time: 1.024451732635498 sec

Test set: Average loss: 0.3322, Accuracy: 10740/12000 (90%)

Epoch 8 | Train Acc: 0.8974583333333334 | Test Acc: 0.895 | Time: 1.0229730606079102 sec

Test set: Average loss: 0.3281, Accuracy: 10757/12000 (90%)

Epoch 9 | Train Acc: 0.8993541666666667 | Test Acc: 0.8964166666666666 | Time: 1.0196151733398438 sec

Test set: Average loss: 0.3252, Accuracy: 10764/12000 (90%)

Epoch 10 | Train Acc: 0.9005833333333333 | Test Acc: 0.897 | Time: 1.1392066478729248 sec

Test set: Average loss: 0.3233, Accuracy: 10783/12000 (90%)

Epoch 11 | Train Acc: 0.9012916666666667 | Test Acc: 0.8985833333333333 | Time: 1.2510838508605957 sec

Test set: Average loss: 0.3220, Accuracy: 10785/12000 (90%)

Epoch 12 | Train Acc: 0.902125 | Test Acc: 0.89875 | Time: 1.2677547931671143 sec

Test set: Average loss: 0.3210, Accuracy: 10795/12000 (90%)

Epoch 13 | Train Acc: 0.9025833333333333 | Test Acc: 0.8995833333333333 | Time: 1.0648937225341797 sec

Test set: Average loss: 0.3204, Accuracy: 10795/12000 (90%)

Epoch 14 | Train Acc: 0.9029583333333333 | Test Acc: 0.8995833333333333 | Time: 1.373866319656372 sec

Test set: Average loss: 0.3200, Accuracy: 10799/12000 (90%)

Epoch 15 | Train Acc: 0.9032083333333333 | Test Acc: 0.8999166666666667 | Time: 1.206479549407959 sec

Test set: Average loss: 0.3197, Accuracy: 10803/12000 (90%)

Epoch 16 | Train Acc: 0.9035833333333333 | Test Acc: 0.90025 | Time: 1.0312621593475342 sec

Test set: Average loss: 0.3195, Accuracy: 10802/12000 (90%)

Epoch 17 | Train Acc: 0.9036875 | Test Acc: 0.9001666666666667 | Time: 1.2019667625427246 sec

Test set: Average loss: 0.3194, Accuracy: 10804/12000 (90%)

Epoch 18 | Train Acc: 0.9037291666666667 | Test Acc: 0.9003333333333333 | Time: 1.3092246055603027 sec

Test set: Average loss: 0.3193, Accuracy: 10804/12000 (90%)

Epoch 19 | Train Acc: 0.9037083333333333 | Test Acc: 0.9003333333333333 | Time: 1.6881380081176758 sec

Test set: Average loss: 0.3192, Accuracy: 10801/12000 (90%)

Epoch 20 | Train Acc: 0.9037708333333333 | Test Acc: 0.9000833333333333 | Time: 1.1208539009094238 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: 18.8112 | Coherence: 18.8112 | Separation: 53.5008 | Information gain: 7.1667 | Grad Norm: 22.2024 | Time: 0.0s
Step 0001 | Epoch 01 | Objective: 19.0392 | Coherence: 19.0392 | Separation: 53.5162 | Information gain: 7.1667 | Grad Norm: 22.2024 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.572183  0.507439  0.524336  ...  0.554771 -0.472864  0.480538
1 -0.527537  0.587039  0.522010  ...  0.521226 -0.508788  0.555381
2 -0.489739  0.499308  0.563822  ...  0.498466 -0.482698  0.501638
3 -0.541030  0.504592  0.550654  ...  0.525222 -0.495697  0.520157
4 -0.348530  0.446246  0.486401  ...  0.353721 -0.476180  0.464122

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7858
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8997
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8774
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.2417, accuracy=0.0845
Testing SVM
  SVM Test Accuracy: 0.8582
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8264

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7346, Accuracy: 9193/12000 (77%)

Epoch 1 | Train Acc: 0.634125 | Test Acc: 0.7660833333333333 | Time: 1.0409421920776367 sec

Test set: Average loss: 0.5186, Accuracy: 10040/12000 (84%)

Epoch 2 | Train Acc: 0.8182291666666667 | Test Acc: 0.8366666666666667 | Time: 1.2240357398986816 sec

Test set: Average loss: 0.4355, Accuracy: 10366/12000 (86%)

Epoch 3 | Train Acc: 0.8546041666666667 | Test Acc: 0.8638333333333333 | Time: 1.21370530128479 sec

Test set: Average loss: 0.3865, Accuracy: 10546/12000 (88%)

Epoch 4 | Train Acc: 0.872375 | Test Acc: 0.8788333333333334 | Time: 1.3337349891662598 sec

Test set: Average loss: 0.3619, Accuracy: 10647/12000 (89%)

Epoch 5 | Train Acc: 0.8838125 | Test Acc: 0.88725 | Time: 1.0248377323150635 sec

Test set: Average loss: 0.3476, Accuracy: 10712/12000 (89%)

Epoch 6 | Train Acc: 0.89125 | Test Acc: 0.8926666666666667 | Time: 1.0185291767120361 sec

Test set: Average loss: 0.3379, Accuracy: 10764/12000 (90%)

Epoch 7 | Train Acc: 0.8962708333333333 | Test Acc: 0.897 | Time: 1.1839165687561035 sec

Test set: Average loss: 0.3318, Accuracy: 10769/12000 (90%)

Epoch 8 | Train Acc: 0.8992291666666666 | Test Acc: 0.8974166666666666 | Time: 1.103590726852417 sec

Test set: Average loss: 0.3278, Accuracy: 10766/12000 (90%)

Epoch 9 | Train Acc: 0.9008333333333334 | Test Acc: 0.8971666666666667 | Time: 1.2879858016967773 sec

Test set: Average loss: 0.3250, Accuracy: 10766/12000 (90%)

Epoch 10 | Train Acc: 0.9022708333333334 | Test Acc: 0.8971666666666667 | Time: 1.1591346263885498 sec

Test set: Average loss: 0.3230, Accuracy: 10771/12000 (90%)

Epoch 11 | Train Acc: 0.9031041666666667 | Test Acc: 0.8975833333333333 | Time: 1.2431230545043945 sec

Test set: Average loss: 0.3216, Accuracy: 10775/12000 (90%)

Epoch 12 | Train Acc: 0.9035833333333333 | Test Acc: 0.8979166666666667 | Time: 1.115879774093628 sec

Test set: Average loss: 0.3206, Accuracy: 10778/12000 (90%)

Epoch 13 | Train Acc: 0.9042291666666666 | Test Acc: 0.8981666666666667 | Time: 1.021996021270752 sec

Test set: Average loss: 0.3198, Accuracy: 10788/12000 (90%)

Epoch 14 | Train Acc: 0.9047083333333333 | Test Acc: 0.899 | Time: 1.2205979824066162 sec

Test set: Average loss: 0.3192, Accuracy: 10786/12000 (90%)

Epoch 15 | Train Acc: 0.9049583333333333 | Test Acc: 0.8988333333333334 | Time: 1.270641565322876 sec

Test set: Average loss: 0.3189, Accuracy: 10786/12000 (90%)

Epoch 16 | Train Acc: 0.90525 | Test Acc: 0.8988333333333334 | Time: 1.4626696109771729 sec

Test set: Average loss: 0.3186, Accuracy: 10786/12000 (90%)

Epoch 17 | Train Acc: 0.9052708333333334 | Test Acc: 0.8988333333333334 | Time: 1.0304210186004639 sec

Test set: Average loss: 0.3185, Accuracy: 10784/12000 (90%)

Epoch 18 | Train Acc: 0.9054583333333334 | Test Acc: 0.8986666666666666 | Time: 1.0168519020080566 sec

Test set: Average loss: 0.3183, Accuracy: 10783/12000 (90%)

Epoch 19 | Train Acc: 0.9056041666666667 | Test Acc: 0.8985833333333333 | Time: 1.0210423469543457 sec
Early stopping at epoch 19

Testing with M=15
Step 0000 | Epoch 01 | Objective: 16.5804 | Coherence: 13.9693 | Separation: 51.6960 | Information gain: 7.8333 | Grad Norm: 22.3254 | Time: 0.1s
Step 0001 | Epoch 01 | Objective: 16.8124 | Coherence: 14.2013 | Separation: 51.6681 | Information gain: 7.8333 | Grad Norm: 22.3254 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.630733  0.597480  0.602939  ...  0.565875  0.582326  0.408582
1  0.583380  0.608470  0.548973  ...  0.592534  0.535804  0.487238
2  0.589527  0.547635  0.610419  ...  0.551010  0.500846  0.396757
3  0.529238  0.526145  0.555759  ...  0.554252  0.445059  0.454917
4  0.454481  0.484241  0.463650  ...  0.509929  0.394373  0.498684

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8011
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8943
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8746
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.2076, accuracy=0.1026
Testing SVM
  SVM Test Accuracy: 0.8512
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8228

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7341, Accuracy: 9402/12000 (78%)

Epoch 1 | Train Acc: 0.645875 | Test Acc: 0.7835 | Time: 1.0295233726501465 sec

Test set: Average loss: 0.5338, Accuracy: 9923/12000 (83%)

Epoch 2 | Train Acc: 0.8168125 | Test Acc: 0.8269166666666666 | Time: 1.0229823589324951 sec

Test set: Average loss: 0.4650, Accuracy: 10190/12000 (85%)

Epoch 3 | Train Acc: 0.8470416666666667 | Test Acc: 0.8491666666666666 | Time: 1.0290532112121582 sec

Test set: Average loss: 0.4238, Accuracy: 10340/12000 (86%)

Epoch 4 | Train Acc: 0.8613541666666666 | Test Acc: 0.8616666666666667 | Time: 1.1385071277618408 sec

Test set: Average loss: 0.3986, Accuracy: 10446/12000 (87%)

Epoch 5 | Train Acc: 0.870625 | Test Acc: 0.8705 | Time: 1.0273408889770508 sec

Test set: Average loss: 0.3841, Accuracy: 10513/12000 (88%)

Epoch 6 | Train Acc: 0.8774583333333333 | Test Acc: 0.8760833333333333 | Time: 1.023421287536621 sec

Test set: Average loss: 0.3745, Accuracy: 10559/12000 (88%)

Epoch 7 | Train Acc: 0.881375 | Test Acc: 0.8799166666666667 | Time: 1.0272424221038818 sec

Test set: Average loss: 0.3678, Accuracy: 10580/12000 (88%)

Epoch 8 | Train Acc: 0.8842708333333333 | Test Acc: 0.8816666666666667 | Time: 1.0254466533660889 sec

Test set: Average loss: 0.3629, Accuracy: 10600/12000 (88%)

Epoch 9 | Train Acc: 0.8860416666666666 | Test Acc: 0.8833333333333333 | Time: 1.0992960929870605 sec

Test set: Average loss: 0.3592, Accuracy: 10623/12000 (89%)

Epoch 10 | Train Acc: 0.88725 | Test Acc: 0.88525 | Time: 1.025434970855713 sec

Test set: Average loss: 0.3565, Accuracy: 10642/12000 (89%)

Epoch 11 | Train Acc: 0.8879375 | Test Acc: 0.8868333333333334 | Time: 1.0238311290740967 sec

Test set: Average loss: 0.3547, Accuracy: 10649/12000 (89%)

Epoch 12 | Train Acc: 0.8888541666666666 | Test Acc: 0.8874166666666666 | Time: 1.0264015197753906 sec

Test set: Average loss: 0.3534, Accuracy: 10660/12000 (89%)

Epoch 13 | Train Acc: 0.8892083333333334 | Test Acc: 0.8883333333333333 | Time: 1.1287884712219238 sec

Test set: Average loss: 0.3524, Accuracy: 10671/12000 (89%)

Epoch 14 | Train Acc: 0.8897708333333333 | Test Acc: 0.88925 | Time: 1.0293474197387695 sec

Test set: Average loss: 0.3517, Accuracy: 10669/12000 (89%)

Epoch 15 | Train Acc: 0.8899583333333333 | Test Acc: 0.8890833333333333 | Time: 1.1213123798370361 sec

Test set: Average loss: 0.3512, Accuracy: 10675/12000 (89%)

Epoch 16 | Train Acc: 0.8902708333333333 | Test Acc: 0.8895833333333333 | Time: 1.037210464477539 sec

Test set: Average loss: 0.3509, Accuracy: 10680/12000 (89%)

Epoch 17 | Train Acc: 0.89025 | Test Acc: 0.89 | Time: 1.0254435539245605 sec

Test set: Average loss: 0.3506, Accuracy: 10679/12000 (89%)

Epoch 18 | Train Acc: 0.8902708333333333 | Test Acc: 0.8899166666666667 | Time: 1.0241506099700928 sec

Test set: Average loss: 0.3505, Accuracy: 10679/12000 (89%)

Epoch 19 | Train Acc: 0.8902916666666667 | Test Acc: 0.8899166666666667 | Time: 1.024967908859253 sec

Test set: Average loss: 0.3504, Accuracy: 10677/12000 (89%)

Epoch 20 | Train Acc: 0.8903333333333333 | Test Acc: 0.88975 | Time: 1.0292482376098633 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: 26.4880 | Coherence: 21.1546 | Separation: 49.0918 | Information gain: 8.0000 | Grad Norm: 22.2252 | Time: 0.0s
Step 0001 | Epoch 01 | Objective: 26.7327 | Coherence: 21.3993 | Separation: 49.0755 | Information gain: 8.0000 | Grad Norm: 22.2252 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.639729  0.515438  0.525155  ...  0.480043  0.474154  0.561753
1  0.483443  0.599584  0.557213  ...  0.494917  0.520564  0.507633
2  0.480700  0.542192  0.576657  ...  0.479467  0.495856  0.516254
3  0.607539  0.546964  0.532894  ...  0.464566  0.473214  0.542020
4  0.395831  0.523178  0.532009  ...  0.460290  0.496078  0.424080

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7850
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8967
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8723
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.9806, accuracy=0.0993
Testing SVM
  SVM Test Accuracy: 0.8550
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8298

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.8205, Accuracy: 8893/12000 (74%)

Epoch 1 | Train Acc: 0.6516875 | Test Acc: 0.7410833333333333 | Time: 1.0538170337677002 sec

Test set: Average loss: 0.5534, Accuracy: 9889/12000 (82%)

Epoch 2 | Train Acc: 0.8104791666666666 | Test Acc: 0.8240833333333333 | Time: 1.0418190956115723 sec

Test set: Average loss: 0.4607, Accuracy: 10257/12000 (85%)

Epoch 3 | Train Acc: 0.848 | Test Acc: 0.85475 | Time: 1.0272269248962402 sec

Test set: Average loss: 0.4162, Accuracy: 10421/12000 (87%)

Epoch 4 | Train Acc: 0.8680833333333333 | Test Acc: 0.8684166666666666 | Time: 1.0270464420318604 sec

Test set: Average loss: 0.3911, Accuracy: 10526/12000 (88%)

Epoch 5 | Train Acc: 0.8797083333333333 | Test Acc: 0.8771666666666667 | Time: 1.0216929912567139 sec

Test set: Average loss: 0.3754, Accuracy: 10582/12000 (88%)

Epoch 6 | Train Acc: 0.88725 | Test Acc: 0.8818333333333334 | Time: 1.0233001708984375 sec

Test set: Average loss: 0.3652, Accuracy: 10605/12000 (88%)

Epoch 7 | Train Acc: 0.8918958333333333 | Test Acc: 0.88375 | Time: 1.0259594917297363 sec

Test set: Average loss: 0.3586, Accuracy: 10624/12000 (89%)

Epoch 8 | Train Acc: 0.8944583333333334 | Test Acc: 0.8853333333333333 | Time: 1.0326588153839111 sec

Test set: Average loss: 0.3543, Accuracy: 10640/12000 (89%)

Epoch 9 | Train Acc: 0.8967083333333333 | Test Acc: 0.8866666666666667 | Time: 1.0405848026275635 sec

Test set: Average loss: 0.3514, Accuracy: 10659/12000 (89%)

Epoch 10 | Train Acc: 0.8979375 | Test Acc: 0.88825 | Time: 1.041511058807373 sec

Test set: Average loss: 0.3495, Accuracy: 10675/12000 (89%)

Epoch 11 | Train Acc: 0.8987708333333333 | Test Acc: 0.8895833333333333 | Time: 1.1434431076049805 sec

Test set: Average loss: 0.3481, Accuracy: 10677/12000 (89%)

Epoch 12 | Train Acc: 0.8996666666666666 | Test Acc: 0.88975 | Time: 1.0443768501281738 sec

Test set: Average loss: 0.3470, Accuracy: 10673/12000 (89%)

Epoch 13 | Train Acc: 0.9005 | Test Acc: 0.8894166666666666 | Time: 1.0355198383331299 sec

Test set: Average loss: 0.3461, Accuracy: 10674/12000 (89%)

Epoch 14 | Train Acc: 0.9009375 | Test Acc: 0.8895 | Time: 1.0363593101501465 sec

Test set: Average loss: 0.3455, Accuracy: 10675/12000 (89%)

Epoch 15 | Train Acc: 0.9008958333333333 | Test Acc: 0.8895833333333333 | Time: 1.1346750259399414 sec

Test set: Average loss: 0.3451, Accuracy: 10673/12000 (89%)

Epoch 16 | Train Acc: 0.9010833333333333 | Test Acc: 0.8894166666666666 | Time: 1.2163913249969482 sec

Test set: Average loss: 0.3448, Accuracy: 10674/12000 (89%)

Epoch 17 | Train Acc: 0.9011458333333333 | Test Acc: 0.8895 | Time: 1.1066489219665527 sec
Early stopping at epoch 17

Testing with M=15
Step 0000 | Epoch 01 | Objective: 39.6001 | Coherence: 31.2668 | Separation: 54.0768 | Information gain: 8.3333 | Grad Norm: 22.3115 | Time: 0.0s
Step 0001 | Epoch 01 | Objective: 39.8171 | Coherence: 31.4838 | Separation: 54.0786 | Information gain: 8.3333 | Grad Norm: 22.3115 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.606473  0.448308  0.471197  ...  0.521881  0.566440  0.523190
1  0.461077  0.640204  0.349435  ...  0.513590  0.405376  0.376549
2  0.463308  0.339368  0.590992  ...  0.457535  0.395984  0.550718
3  0.489602  0.493519  0.428543  ...  0.569352  0.448748  0.440129
4  0.471404  0.347563  0.594109  ...  0.458069  0.409917  0.565033

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7961
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8978
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8776
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.1687, accuracy=0.0922
Testing SVM
  SVM Test Accuracy: 0.8581
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8261

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7274, Accuracy: 9281/12000 (77%)

Epoch 1 | Train Acc: 0.6504791666666667 | Test Acc: 0.7734166666666666 | Time: 1.1075952053070068 sec

Test set: Average loss: 0.5525, Accuracy: 9891/12000 (82%)

Epoch 2 | Train Acc: 0.8195833333333333 | Test Acc: 0.82425 | Time: 1.3118977546691895 sec

Test set: Average loss: 0.4601, Accuracy: 10233/12000 (85%)

Epoch 3 | Train Acc: 0.85 | Test Acc: 0.85275 | Time: 1.1185855865478516 sec

Test set: Average loss: 0.4116, Accuracy: 10411/12000 (87%)

Epoch 4 | Train Acc: 0.8659791666666666 | Test Acc: 0.8675833333333334 | Time: 1.0260367393493652 sec

Test set: Average loss: 0.3825, Accuracy: 10524/12000 (88%)

Epoch 5 | Train Acc: 0.8764791666666667 | Test Acc: 0.877 | Time: 1.0266730785369873 sec

Test set: Average loss: 0.3639, Accuracy: 10598/12000 (88%)

Epoch 6 | Train Acc: 0.8830833333333333 | Test Acc: 0.8831666666666667 | Time: 1.024620532989502 sec

Test set: Average loss: 0.3516, Accuracy: 10647/12000 (89%)

Epoch 7 | Train Acc: 0.8876041666666666 | Test Acc: 0.88725 | Time: 1.0272836685180664 sec

Test set: Average loss: 0.3436, Accuracy: 10691/12000 (89%)

Epoch 8 | Train Acc: 0.8910625 | Test Acc: 0.8909166666666667 | Time: 1.039355993270874 sec

Test set: Average loss: 0.3385, Accuracy: 10709/12000 (89%)

Epoch 9 | Train Acc: 0.8927291666666667 | Test Acc: 0.8924166666666666 | Time: 1.0243685245513916 sec

Test set: Average loss: 0.3353, Accuracy: 10722/12000 (89%)

Epoch 10 | Train Acc: 0.8939375 | Test Acc: 0.8935 | Time: 1.1672401428222656 sec

Test set: Average loss: 0.3330, Accuracy: 10726/12000 (89%)

Epoch 11 | Train Acc: 0.8953125 | Test Acc: 0.8938333333333334 | Time: 1.0463106632232666 sec

Test set: Average loss: 0.3315, Accuracy: 10730/12000 (89%)

Epoch 12 | Train Acc: 0.8962083333333334 | Test Acc: 0.8941666666666667 | Time: 1.0169501304626465 sec

Test set: Average loss: 0.3305, Accuracy: 10732/12000 (89%)

Epoch 13 | Train Acc: 0.8964791666666667 | Test Acc: 0.8943333333333333 | Time: 1.0247650146484375 sec

Test set: Average loss: 0.3298, Accuracy: 10736/12000 (89%)

Epoch 14 | Train Acc: 0.89675 | Test Acc: 0.8946666666666667 | Time: 1.0208213329315186 sec

Test set: Average loss: 0.3292, Accuracy: 10745/12000 (90%)

Epoch 15 | Train Acc: 0.897125 | Test Acc: 0.8954166666666666 | Time: 1.028212070465088 sec

Test set: Average loss: 0.3288, Accuracy: 10744/12000 (90%)

Epoch 16 | Train Acc: 0.897125 | Test Acc: 0.8953333333333333 | Time: 1.0262410640716553 sec

Test set: Average loss: 0.3286, Accuracy: 10749/12000 (90%)

Epoch 17 | Train Acc: 0.8973541666666667 | Test Acc: 0.89575 | Time: 1.2513518333435059 sec

Test set: Average loss: 0.3284, Accuracy: 10753/12000 (90%)

Epoch 18 | Train Acc: 0.8976458333333334 | Test Acc: 0.8960833333333333 | Time: 1.2608466148376465 sec

Test set: Average loss: 0.3282, Accuracy: 10755/12000 (90%)

Epoch 19 | Train Acc: 0.8977708333333333 | Test Acc: 0.89625 | Time: 1.1965270042419434 sec

Test set: Average loss: 0.3281, Accuracy: 10756/12000 (90%)

Epoch 20 | Train Acc: 0.8977291666666667 | Test Acc: 0.8963333333333333 | Time: 1.0254216194152832 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -9.0907 | Coherence: 9.2393 | Separation: 54.9900 | Information gain: 6.6667 | Grad Norm: 26.3244 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -6.5837 | Coherence: 11.3994 | Separation: 53.9491 | Information gain: 6.8333 | Grad Norm: 25.8246 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -4.1400 | Coherence: 13.5585 | Separation: 53.0957 | Information gain: 6.8333 | Grad Norm: 24.7310 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -1.8150 | Coherence: 15.6846 | Separation: 52.4987 | Information gain: 7.0000 | Grad Norm: 23.8513 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: 0.4467 | Coherence: 17.7905 | Separation: 52.0317 | Information gain: 7.0000 | Grad Norm: 23.3673 | Time: 1.0s
Step 0043 | Epoch 01 | Objective: 1.1112 | Coherence: 18.4148 | Separation: 51.9107 | Information gain: 7.0000 | Grad Norm: 23.3673 | Time: 1.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.573716  0.534417  0.476806  ...  0.515870  0.546338  0.468641
1  0.544262  0.588431  0.555504  ...  0.542021  0.543906  0.443116
2  0.491946  0.565086  0.605561  ...  0.545753  0.472399  0.443316
3  0.489062  0.449489  0.438651  ...  0.461963  0.400774  0.552067
4  0.575540  0.577330  0.539094  ...  0.546191  0.566021  0.474736

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7874
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8802
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8635
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.2300, accuracy=0.0851
Testing SVM
  SVM Test Accuracy: 0.8459
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8238

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7522, Accuracy: 9030/12000 (75%)

Epoch 1 | Train Acc: 0.6368125 | Test Acc: 0.7525 | Time: 1.070112705230713 sec

Test set: Average loss: 0.6494, Accuracy: 9296/12000 (77%)

Epoch 2 | Train Acc: 0.7820833333333334 | Test Acc: 0.7746666666666666 | Time: 1.0259184837341309 sec

Test set: Average loss: 0.5353, Accuracy: 9868/12000 (82%)

Epoch 3 | Train Acc: 0.8214375 | Test Acc: 0.8223333333333334 | Time: 1.0312485694885254 sec

Test set: Average loss: 0.4646, Accuracy: 10187/12000 (85%)

Epoch 4 | Train Acc: 0.8446458333333333 | Test Acc: 0.8489166666666667 | Time: 1.0386114120483398 sec

Test set: Average loss: 0.4284, Accuracy: 10359/12000 (86%)

Epoch 5 | Train Acc: 0.8571041666666667 | Test Acc: 0.86325 | Time: 1.0335328578948975 sec

Test set: Average loss: 0.4062, Accuracy: 10442/12000 (87%)

Epoch 6 | Train Acc: 0.8654375 | Test Acc: 0.8701666666666666 | Time: 1.3018231391906738 sec

Test set: Average loss: 0.3943, Accuracy: 10491/12000 (87%)

Epoch 7 | Train Acc: 0.8700625 | Test Acc: 0.87425 | Time: 1.1099181175231934 sec

Test set: Average loss: 0.3856, Accuracy: 10516/12000 (88%)

Epoch 8 | Train Acc: 0.8731666666666666 | Test Acc: 0.8763333333333333 | Time: 1.0310325622558594 sec

Test set: Average loss: 0.3800, Accuracy: 10537/12000 (88%)

Epoch 9 | Train Acc: 0.8754583333333333 | Test Acc: 0.8780833333333333 | Time: 1.0323050022125244 sec

Test set: Average loss: 0.3765, Accuracy: 10553/12000 (88%)

Epoch 10 | Train Acc: 0.8769583333333333 | Test Acc: 0.8794166666666666 | Time: 1.0262629985809326 sec

Test set: Average loss: 0.3739, Accuracy: 10565/12000 (88%)

Epoch 11 | Train Acc: 0.8783958333333334 | Test Acc: 0.8804166666666666 | Time: 1.021883249282837 sec

Test set: Average loss: 0.3723, Accuracy: 10573/12000 (88%)

Epoch 12 | Train Acc: 0.8794166666666666 | Test Acc: 0.8810833333333333 | Time: 1.034947156906128 sec

Test set: Average loss: 0.3712, Accuracy: 10576/12000 (88%)

Epoch 13 | Train Acc: 0.8801666666666667 | Test Acc: 0.8813333333333333 | Time: 1.0478034019470215 sec

Test set: Average loss: 0.3704, Accuracy: 10585/12000 (88%)

Epoch 14 | Train Acc: 0.8807083333333333 | Test Acc: 0.8820833333333333 | Time: 1.0304675102233887 sec

Test set: Average loss: 0.3698, Accuracy: 10582/12000 (88%)

Epoch 15 | Train Acc: 0.8811458333333333 | Test Acc: 0.8818333333333334 | Time: 1.308154582977295 sec

Test set: Average loss: 0.3694, Accuracy: 10582/12000 (88%)

Epoch 16 | Train Acc: 0.8815625 | Test Acc: 0.8818333333333334 | Time: 1.186554193496704 sec

Test set: Average loss: 0.3691, Accuracy: 10582/12000 (88%)

Epoch 17 | Train Acc: 0.8815208333333333 | Test Acc: 0.8818333333333334 | Time: 1.0557727813720703 sec

Test set: Average loss: 0.3689, Accuracy: 10583/12000 (88%)

Epoch 18 | Train Acc: 0.8818541666666667 | Test Acc: 0.8819166666666667 | Time: 1.0298519134521484 sec

Test set: Average loss: 0.3688, Accuracy: 10582/12000 (88%)

Epoch 19 | Train Acc: 0.8820625 | Test Acc: 0.8818333333333334 | Time: 1.0285556316375732 sec
Early stopping at epoch 19

Testing with M=15
Step 0000 | Epoch 01 | Objective: -13.3449 | Coherence: 3.5054 | Separation: 58.5509 | Information gain: 8.0000 | Grad Norm: 24.0259 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: -11.1501 | Coherence: 5.7480 | Separation: 58.6941 | Information gain: 8.0000 | Grad Norm: 24.1888 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -8.9026 | Coherence: 8.0009 | Separation: 58.7107 | Information gain: 8.0000 | Grad Norm: 24.3158 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: -6.6425 | Coherence: 10.2575 | Separation: 58.7001 | Information gain: 8.0000 | Grad Norm: 24.1732 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: -4.3387 | Coherence: 12.5194 | Separation: 58.5742 | Information gain: 8.0000 | Grad Norm: 24.3248 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -2.0027 | Coherence: 14.7896 | Separation: 58.3771 | Information gain: 8.0000 | Grad Norm: 24.1628 | Time: 1.3s
Step 0060 | Epoch 01 | Objective: 0.3422 | Coherence: 17.0362 | Separation: 58.0821 | Information gain: 8.0000 | Grad Norm: 24.1707 | Time: 1.5s
Step 0063 | Epoch 01 | Objective: 1.0452 | Coherence: 17.7044 | Separation: 57.9777 | Information gain: 8.0000 | Grad Norm: 24.2187 | Time: 1.6s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.584753  0.461697  0.480016  ... -0.399239  0.528005  0.571961
1  0.442210  0.584361  0.441102  ... -0.349535  0.471998  0.464164
2  0.486682  0.457327  0.610764  ... -0.539110  0.544110  0.484516
3  0.519237  0.386219  0.437921  ... -0.410661  0.480545  0.508893
4  0.523642  0.460731  0.475164  ... -0.423585  0.553912  0.485452

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7890
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8962
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8773
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.8953, accuracy=0.1111
Testing SVM
  SVM Test Accuracy: 0.8597
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8350

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6628, Accuracy: 9517/12000 (79%)

Epoch 1 | Train Acc: 0.6748958333333334 | Test Acc: 0.7930833333333334 | Time: 1.2876644134521484 sec

Test set: Average loss: 0.5108, Accuracy: 10035/12000 (84%)

Epoch 2 | Train Acc: 0.8219375 | Test Acc: 0.83625 | Time: 1.2364916801452637 sec

Test set: Average loss: 0.4484, Accuracy: 10259/12000 (85%)

Epoch 3 | Train Acc: 0.8489583333333334 | Test Acc: 0.8549166666666667 | Time: 1.144479751586914 sec

Test set: Average loss: 0.4124, Accuracy: 10385/12000 (87%)

Epoch 4 | Train Acc: 0.8646875 | Test Acc: 0.8654166666666666 | Time: 1.0231404304504395 sec

Test set: Average loss: 0.3895, Accuracy: 10459/12000 (87%)

Epoch 5 | Train Acc: 0.873875 | Test Acc: 0.8715833333333334 | Time: 1.0167388916015625 sec

Test set: Average loss: 0.3738, Accuracy: 10526/12000 (88%)

Epoch 6 | Train Acc: 0.8803958333333334 | Test Acc: 0.8771666666666667 | Time: 1.023625373840332 sec

Test set: Average loss: 0.3643, Accuracy: 10573/12000 (88%)

Epoch 7 | Train Acc: 0.8841041666666667 | Test Acc: 0.8810833333333333 | Time: 1.0262770652770996 sec

Test set: Average loss: 0.3575, Accuracy: 10597/12000 (88%)

Epoch 8 | Train Acc: 0.887125 | Test Acc: 0.8830833333333333 | Time: 1.025059700012207 sec

Test set: Average loss: 0.3527, Accuracy: 10619/12000 (88%)

Epoch 9 | Train Acc: 0.8894375 | Test Acc: 0.8849166666666667 | Time: 1.0176796913146973 sec

Test set: Average loss: 0.3494, Accuracy: 10628/12000 (89%)

Epoch 10 | Train Acc: 0.8911041666666667 | Test Acc: 0.8856666666666667 | Time: 1.0204651355743408 sec

Test set: Average loss: 0.3470, Accuracy: 10637/12000 (89%)

Epoch 11 | Train Acc: 0.8921666666666667 | Test Acc: 0.8864166666666666 | Time: 1.041839599609375 sec

Test set: Average loss: 0.3454, Accuracy: 10649/12000 (89%)

Epoch 12 | Train Acc: 0.8925416666666667 | Test Acc: 0.8874166666666666 | Time: 1.1469318866729736 sec

Test set: Average loss: 0.3445, Accuracy: 10662/12000 (89%)

Epoch 13 | Train Acc: 0.8928125 | Test Acc: 0.8885 | Time: 1.0226433277130127 sec

Test set: Average loss: 0.3438, Accuracy: 10665/12000 (89%)

Epoch 14 | Train Acc: 0.8930625 | Test Acc: 0.88875 | Time: 1.0180976390838623 sec

Test set: Average loss: 0.3433, Accuracy: 10668/12000 (89%)

Epoch 15 | Train Acc: 0.8931875 | Test Acc: 0.889 | Time: 1.0268361568450928 sec

Test set: Average loss: 0.3430, Accuracy: 10670/12000 (89%)

Epoch 16 | Train Acc: 0.8933541666666667 | Test Acc: 0.8891666666666667 | Time: 1.0258209705352783 sec

Test set: Average loss: 0.3427, Accuracy: 10676/12000 (89%)

Epoch 17 | Train Acc: 0.893375 | Test Acc: 0.8896666666666667 | Time: 1.0287878513336182 sec

Test set: Average loss: 0.3426, Accuracy: 10677/12000 (89%)

Epoch 18 | Train Acc: 0.8934583333333334 | Test Acc: 0.88975 | Time: 1.0302324295043945 sec

Test set: Average loss: 0.3425, Accuracy: 10678/12000 (89%)

Epoch 19 | Train Acc: 0.8936875 | Test Acc: 0.8898333333333334 | Time: 1.0272493362426758 sec

Test set: Average loss: 0.3424, Accuracy: 10678/12000 (89%)

Epoch 20 | Train Acc: 0.8937916666666667 | Test Acc: 0.8898333333333334 | Time: 1.0257129669189453 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -8.5084 | Coherence: 4.8328 | Separation: 55.0235 | Information gain: 7.5000 | Grad Norm: 26.0042 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -6.0309 | Coherence: 7.2100 | Separation: 54.7229 | Information gain: 7.5000 | Grad Norm: 25.5047 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -3.5889 | Coherence: 9.5519 | Separation: 54.4222 | Information gain: 7.5000 | Grad Norm: 25.4373 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -1.1292 | Coherence: 11.8805 | Separation: 54.0293 | Information gain: 7.5000 | Grad Norm: 25.3689 | Time: 0.8s
Step 0039 | Epoch 01 | Objective: 1.0990 | Coherence: 13.9684 | Separation: 53.6083 | Information gain: 7.5000 | Grad Norm: 25.3079 | Time: 1.0s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.632522  0.504815 -0.396165  ...  0.507849 -0.576209  0.452024
1  0.500056  0.595297 -0.409537  ...  0.526891 -0.442966  0.476526
2  0.436833  0.447173 -0.579931  ...  0.480072 -0.461860  0.568937
3  0.404278  0.543476 -0.456050  ...  0.480698 -0.392678  0.468281
4  0.338141  0.363393 -0.555664  ...  0.393129 -0.426130  0.483963

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7947
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8990
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8849
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.7570, accuracy=0.1185
Testing SVM
  SVM Test Accuracy: 0.8561
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8335

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6324, Accuracy: 9683/12000 (81%)

Epoch 1 | Train Acc: 0.6808958333333334 | Test Acc: 0.8069166666666666 | Time: 1.1846494674682617 sec

Test set: Average loss: 0.4841, Accuracy: 10177/12000 (85%)

Epoch 2 | Train Acc: 0.8314583333333333 | Test Acc: 0.8480833333333333 | Time: 1.261448621749878 sec

Test set: Average loss: 0.4272, Accuracy: 10380/12000 (86%)

Epoch 3 | Train Acc: 0.8608333333333333 | Test Acc: 0.865 | Time: 1.0998554229736328 sec

Test set: Average loss: 0.3865, Accuracy: 10537/12000 (88%)

Epoch 4 | Train Acc: 0.8741041666666667 | Test Acc: 0.8780833333333333 | Time: 1.0194792747497559 sec

Test set: Average loss: 0.3614, Accuracy: 10651/12000 (89%)

Epoch 5 | Train Acc: 0.8827916666666666 | Test Acc: 0.8875833333333333 | Time: 1.0243313312530518 sec

Test set: Average loss: 0.3478, Accuracy: 10700/12000 (89%)

Epoch 6 | Train Acc: 0.888625 | Test Acc: 0.8916666666666667 | Time: 1.0260450839996338 sec

Test set: Average loss: 0.3394, Accuracy: 10723/12000 (89%)

Epoch 7 | Train Acc: 0.8923333333333333 | Test Acc: 0.8935833333333333 | Time: 1.3594374656677246 sec

Test set: Average loss: 0.3334, Accuracy: 10749/12000 (90%)

Epoch 8 | Train Acc: 0.8946041666666666 | Test Acc: 0.89575 | Time: 1.3614015579223633 sec

Test set: Average loss: 0.3291, Accuracy: 10756/12000 (90%)

Epoch 9 | Train Acc: 0.8963958333333333 | Test Acc: 0.8963333333333333 | Time: 1.0620663166046143 sec

Test set: Average loss: 0.3258, Accuracy: 10766/12000 (90%)

Epoch 10 | Train Acc: 0.8973958333333333 | Test Acc: 0.8971666666666667 | Time: 1.1945672035217285 sec

Test set: Average loss: 0.3235, Accuracy: 10781/12000 (90%)

Epoch 11 | Train Acc: 0.8979166666666667 | Test Acc: 0.8984166666666666 | Time: 1.0284459590911865 sec

Test set: Average loss: 0.3221, Accuracy: 10786/12000 (90%)

Epoch 12 | Train Acc: 0.8985833333333333 | Test Acc: 0.8988333333333334 | Time: 1.3471980094909668 sec

Test set: Average loss: 0.3210, Accuracy: 10796/12000 (90%)

Epoch 13 | Train Acc: 0.8990625 | Test Acc: 0.8996666666666666 | Time: 1.032860517501831 sec

Test set: Average loss: 0.3203, Accuracy: 10797/12000 (90%)

Epoch 14 | Train Acc: 0.89925 | Test Acc: 0.89975 | Time: 1.0498073101043701 sec

Test set: Average loss: 0.3198, Accuracy: 10790/12000 (90%)

Epoch 15 | Train Acc: 0.8995625 | Test Acc: 0.8991666666666667 | Time: 1.2283966541290283 sec

Test set: Average loss: 0.3194, Accuracy: 10798/12000 (90%)

Epoch 16 | Train Acc: 0.89975 | Test Acc: 0.8998333333333334 | Time: 1.3231267929077148 sec

Test set: Average loss: 0.3192, Accuracy: 10799/12000 (90%)

Epoch 17 | Train Acc: 0.8998541666666666 | Test Acc: 0.8999166666666667 | Time: 1.4205458164215088 sec

Test set: Average loss: 0.3191, Accuracy: 10797/12000 (90%)

Epoch 18 | Train Acc: 0.9000208333333334 | Test Acc: 0.89975 | Time: 1.029663324356079 sec

Test set: Average loss: 0.3190, Accuracy: 10795/12000 (90%)

Epoch 19 | Train Acc: 0.9 | Test Acc: 0.8995833333333333 | Time: 1.1156537532806396 sec

Test set: Average loss: 0.3190, Accuracy: 10794/12000 (90%)

Epoch 20 | Train Acc: 0.9000833333333333 | Test Acc: 0.8995 | Time: 1.0229971408843994 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -0.3248 | Coherence: 10.9100 | Separation: 55.2042 | Information gain: 7.1667 | Grad Norm: 23.6261 | Time: 0.1s
Step 0006 | Epoch 01 | Objective: 0.9879 | Coherence: 12.2192 | Separation: 55.1939 | Information gain: 7.1667 | Grad Norm: 23.6714 | Time: 0.2s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.640758  0.441487 -0.416762  ...  0.375003  0.309951 -0.550005
1 -0.512186  0.584038 -0.546748  ...  0.483927  0.426282 -0.512523
2 -0.394461  0.498431 -0.590284  ...  0.520197  0.502539 -0.421312
3 -0.500334  0.574722 -0.600441  ...  0.504619  0.457986 -0.492535
4 -0.426808  0.470618 -0.544338  ...  0.571829  0.499628 -0.460073

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8142
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9054
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8870
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.2627, accuracy=0.0790
Testing SVM
  SVM Test Accuracy: 0.8645
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8363

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7490, Accuracy: 9206/12000 (77%)

Epoch 1 | Train Acc: 0.6430416666666666 | Test Acc: 0.7671666666666667 | Time: 1.2240066528320312 sec

Test set: Average loss: 0.5522, Accuracy: 9808/12000 (82%)

Epoch 2 | Train Acc: 0.8263125 | Test Acc: 0.8173333333333334 | Time: 1.023726224899292 sec

Test set: Average loss: 0.4557, Accuracy: 10220/12000 (85%)

Epoch 3 | Train Acc: 0.8542083333333333 | Test Acc: 0.8516666666666667 | Time: 1.0186131000518799 sec

Test set: Average loss: 0.4020, Accuracy: 10431/12000 (87%)

Epoch 4 | Train Acc: 0.8702083333333334 | Test Acc: 0.86925 | Time: 1.027914047241211 sec

Test set: Average loss: 0.3742, Accuracy: 10540/12000 (88%)

Epoch 5 | Train Acc: 0.881375 | Test Acc: 0.8783333333333333 | Time: 1.124222993850708 sec

Test set: Average loss: 0.3530, Accuracy: 10628/12000 (89%)

Epoch 6 | Train Acc: 0.8880208333333334 | Test Acc: 0.8856666666666667 | Time: 1.6054139137268066 sec

Test set: Average loss: 0.3402, Accuracy: 10679/12000 (89%)

Epoch 7 | Train Acc: 0.892625 | Test Acc: 0.8899166666666667 | Time: 1.289137601852417 sec

Test set: Average loss: 0.3325, Accuracy: 10699/12000 (89%)

Epoch 8 | Train Acc: 0.8956666666666667 | Test Acc: 0.8915833333333333 | Time: 1.4084322452545166 sec

Test set: Average loss: 0.3272, Accuracy: 10730/12000 (89%)

Epoch 9 | Train Acc: 0.8975625 | Test Acc: 0.8941666666666667 | Time: 1.0566723346710205 sec

Test set: Average loss: 0.3239, Accuracy: 10747/12000 (90%)

Epoch 10 | Train Acc: 0.8989166666666667 | Test Acc: 0.8955833333333333 | Time: 1.025094747543335 sec

Test set: Average loss: 0.3217, Accuracy: 10756/12000 (90%)

Epoch 11 | Train Acc: 0.8996875 | Test Acc: 0.8963333333333333 | Time: 1.2926735877990723 sec

Test set: Average loss: 0.3203, Accuracy: 10771/12000 (90%)

Epoch 12 | Train Acc: 0.9001458333333333 | Test Acc: 0.8975833333333333 | Time: 1.2809550762176514 sec

Test set: Average loss: 0.3192, Accuracy: 10781/12000 (90%)

Epoch 13 | Train Acc: 0.9008541666666666 | Test Acc: 0.8984166666666666 | Time: 1.0294413566589355 sec

Test set: Average loss: 0.3184, Accuracy: 10781/12000 (90%)

Epoch 14 | Train Acc: 0.9014166666666666 | Test Acc: 0.8984166666666666 | Time: 1.5300252437591553 sec

Test set: Average loss: 0.3179, Accuracy: 10782/12000 (90%)

Epoch 15 | Train Acc: 0.9017083333333333 | Test Acc: 0.8985 | Time: 1.1580181121826172 sec

Test set: Average loss: 0.3176, Accuracy: 10780/12000 (90%)

Epoch 16 | Train Acc: 0.9017708333333333 | Test Acc: 0.8983333333333333 | Time: 1.3599798679351807 sec

Test set: Average loss: 0.3174, Accuracy: 10787/12000 (90%)

Epoch 17 | Train Acc: 0.9019583333333333 | Test Acc: 0.8989166666666667 | Time: 1.4316213130950928 sec

Test set: Average loss: 0.3173, Accuracy: 10788/12000 (90%)

Epoch 18 | Train Acc: 0.9020625 | Test Acc: 0.899 | Time: 1.0691869258880615 sec

Test set: Average loss: 0.3173, Accuracy: 10787/12000 (90%)

Epoch 19 | Train Acc: 0.9022291666666666 | Test Acc: 0.8989166666666667 | Time: 1.0204997062683105 sec

Test set: Average loss: 0.3172, Accuracy: 10784/12000 (90%)

Epoch 20 | Train Acc: 0.9022916666666667 | Test Acc: 0.8986666666666666 | Time: 1.0220458507537842 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -16.5594 | Coherence: 18.9580 | Separation: 53.2761 | Information gain: 7.1667 | Grad Norm: 33.6296 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -13.7984 | Coherence: 20.5962 | Separation: 51.5918 | Information gain: 7.1667 | Grad Norm: 31.9404 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -11.2337 | Coherence: 22.2320 | Separation: 50.1986 | Information gain: 7.1667 | Grad Norm: 30.9575 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -8.7183 | Coherence: 23.8894 | Separation: 48.9116 | Information gain: 7.1667 | Grad Norm: 29.8595 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -6.3059 | Coherence: 25.4870 | Separation: 47.6895 | Information gain: 7.3333 | Grad Norm: 28.9647 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -4.0118 | Coherence: 27.0637 | Separation: 46.6132 | Information gain: 7.3333 | Grad Norm: 27.8767 | Time: 1.3s
Step 0060 | Epoch 01 | Objective: -1.8760 | Coherence: 28.5674 | Separation: 45.6650 | Information gain: 7.3333 | Grad Norm: 27.8644 | Time: 1.6s
Step 0070 | Epoch 01 | Objective: 0.1008 | Coherence: 30.0142 | Separation: 44.8701 | Information gain: 7.3333 | Grad Norm: 26.0595 | Time: 1.8s
Step 0075 | Epoch 01 | Objective: 1.0761 | Coherence: 30.7032 | Separation: 44.4406 | Information gain: 7.3333 | Grad Norm: 27.0887 | Time: 2.0s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.590574  0.473323  0.563333  ... -0.479353 -0.437895  0.509882
1  0.459240  0.585146  0.495957  ... -0.507887 -0.401001  0.504937
2  0.605607  0.546533  0.638830  ... -0.490033 -0.379255  0.538607
3  0.583942  0.489110  0.570682  ... -0.496866 -0.419785  0.498904
4  0.455877  0.499426  0.455392  ... -0.423544 -0.492046  0.551464

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7787
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8884
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8681
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.9499, accuracy=0.1098
Testing SVM
  SVM Test Accuracy: 0.8408
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8108

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7419, Accuracy: 9352/12000 (78%)

Epoch 1 | Train Acc: 0.6236458333333333 | Test Acc: 0.7793333333333333 | Time: 1.1344268321990967 sec

Test set: Average loss: 0.5717, Accuracy: 9806/12000 (82%)

Epoch 2 | Train Acc: 0.8001458333333333 | Test Acc: 0.8171666666666667 | Time: 1.0329217910766602 sec

Test set: Average loss: 0.4879, Accuracy: 10094/12000 (84%)

Epoch 3 | Train Acc: 0.8320625 | Test Acc: 0.8411666666666666 | Time: 1.0233800411224365 sec

Test set: Average loss: 0.4407, Accuracy: 10264/12000 (86%)

Epoch 4 | Train Acc: 0.849125 | Test Acc: 0.8553333333333333 | Time: 1.0385360717773438 sec

Test set: Average loss: 0.4078, Accuracy: 10388/12000 (87%)

Epoch 5 | Train Acc: 0.8614375 | Test Acc: 0.8656666666666667 | Time: 1.0253446102142334 sec

Test set: Average loss: 0.3882, Accuracy: 10464/12000 (87%)

Epoch 6 | Train Acc: 0.8696666666666667 | Test Acc: 0.872 | Time: 1.0383951663970947 sec

Test set: Average loss: 0.3750, Accuracy: 10528/12000 (88%)

Epoch 7 | Train Acc: 0.8753958333333334 | Test Acc: 0.8773333333333333 | Time: 1.025132417678833 sec

Test set: Average loss: 0.3657, Accuracy: 10568/12000 (88%)

Epoch 8 | Train Acc: 0.879 | Test Acc: 0.8806666666666667 | Time: 1.0269198417663574 sec

Test set: Average loss: 0.3600, Accuracy: 10594/12000 (88%)

Epoch 9 | Train Acc: 0.8818125 | Test Acc: 0.8828333333333334 | Time: 1.0306339263916016 sec

Test set: Average loss: 0.3561, Accuracy: 10610/12000 (88%)

Epoch 10 | Train Acc: 0.8840416666666666 | Test Acc: 0.8841666666666667 | Time: 1.1380467414855957 sec

Test set: Average loss: 0.3534, Accuracy: 10615/12000 (88%)

Epoch 11 | Train Acc: 0.8852708333333333 | Test Acc: 0.8845833333333334 | Time: 1.035515308380127 sec

Test set: Average loss: 0.3515, Accuracy: 10627/12000 (89%)

Epoch 12 | Train Acc: 0.8863125 | Test Acc: 0.8855833333333333 | Time: 1.0287449359893799 sec

Test set: Average loss: 0.3503, Accuracy: 10632/12000 (89%)

Epoch 13 | Train Acc: 0.8870625 | Test Acc: 0.886 | Time: 1.0386836528778076 sec

Test set: Average loss: 0.3495, Accuracy: 10638/12000 (89%)

Epoch 14 | Train Acc: 0.8876041666666666 | Test Acc: 0.8865 | Time: 1.0360453128814697 sec

Test set: Average loss: 0.3489, Accuracy: 10641/12000 (89%)

Epoch 15 | Train Acc: 0.8881666666666667 | Test Acc: 0.88675 | Time: 1.0419883728027344 sec

Test set: Average loss: 0.3486, Accuracy: 10643/12000 (89%)

Epoch 16 | Train Acc: 0.888125 | Test Acc: 0.8869166666666667 | Time: 1.040724754333496 sec

Test set: Average loss: 0.3483, Accuracy: 10643/12000 (89%)

Epoch 17 | Train Acc: 0.888375 | Test Acc: 0.8869166666666667 | Time: 1.0395526885986328 sec

Test set: Average loss: 0.3482, Accuracy: 10643/12000 (89%)

Epoch 18 | Train Acc: 0.8885833333333333 | Test Acc: 0.8869166666666667 | Time: 1.0529041290283203 sec

Test set: Average loss: 0.3480, Accuracy: 10643/12000 (89%)

Epoch 19 | Train Acc: 0.88875 | Test Acc: 0.8869166666666667 | Time: 1.2947735786437988 sec

Test set: Average loss: 0.3479, Accuracy: 10645/12000 (89%)

Epoch 20 | Train Acc: 0.8888333333333334 | Test Acc: 0.8870833333333333 | Time: 1.0531203746795654 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -20.4621 | Coherence: 9.8665 | Separation: 49.6596 | Information gain: 8.3333 | Grad Norm: 32.2413 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -17.8892 | Coherence: 11.4720 | Separation: 48.2084 | Information gain: 8.3333 | Grad Norm: 31.7680 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -15.2344 | Coherence: 13.1240 | Separation: 46.7042 | Information gain: 8.3333 | Grad Norm: 31.9192 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -12.7212 | Coherence: 14.8061 | Separation: 45.4576 | Information gain: 8.3333 | Grad Norm: 30.1432 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: -10.2694 | Coherence: 16.4794 | Separation: 44.2899 | Information gain: 8.3333 | Grad Norm: 29.4200 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -7.7809 | Coherence: 18.1616 | Separation: 43.0805 | Information gain: 8.3333 | Grad Norm: 29.5384 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -5.3506 | Coherence: 19.8319 | Separation: 41.9404 | Information gain: 8.3333 | Grad Norm: 28.2733 | Time: 1.5s
Step 0070 | Epoch 01 | Objective: -2.9605 | Coherence: 21.4680 | Separation: 40.8093 | Information gain: 8.3333 | Grad Norm: 27.3454 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -0.6265 | Coherence: 23.0857 | Separation: 39.8183 | Information gain: 8.5000 | Grad Norm: 27.6909 | Time: 1.9s
Step 0088 | Epoch 01 | Objective: 1.0943 | Coherence: 24.4002 | Separation: 39.2088 | Information gain: 8.5000 | Grad Norm: 25.4997 | Time: 2.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.573310  0.410310  0.456638  ...  0.424099  0.456758  0.479927
1  0.401259  0.602338  0.464014  ...  0.581255  0.463692  0.493992
2  0.479692  0.481725  0.605337  ...  0.448310  0.580182  0.582308
3  0.464117  0.385501  0.466711  ...  0.333376  0.487049  0.448866
4  0.496672  0.405064  0.492975  ...  0.408672  0.534210  0.512253

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7877
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8935
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8733
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.1608, accuracy=0.0801
Testing SVM
  SVM Test Accuracy: 0.8571
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8277

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7668, Accuracy: 9106/12000 (76%)

Epoch 1 | Train Acc: 0.6325416666666667 | Test Acc: 0.7588333333333334 | Time: 1.0230262279510498 sec

Test set: Average loss: 0.5491, Accuracy: 9904/12000 (83%)

Epoch 2 | Train Acc: 0.8162916666666666 | Test Acc: 0.8253333333333334 | Time: 1.0405499935150146 sec

Test set: Average loss: 0.4407, Accuracy: 10394/12000 (87%)

Epoch 3 | Train Acc: 0.8533333333333334 | Test Acc: 0.8661666666666666 | Time: 1.0213849544525146 sec

Test set: Average loss: 0.3950, Accuracy: 10541/12000 (88%)

Epoch 4 | Train Acc: 0.8718125 | Test Acc: 0.8784166666666666 | Time: 1.023979663848877 sec

Test set: Average loss: 0.3714, Accuracy: 10607/12000 (88%)

Epoch 5 | Train Acc: 0.8833958333333334 | Test Acc: 0.8839166666666667 | Time: 1.0236296653747559 sec

Test set: Average loss: 0.3554, Accuracy: 10673/12000 (89%)

Epoch 6 | Train Acc: 0.8903541666666667 | Test Acc: 0.8894166666666666 | Time: 1.14644193649292 sec

Test set: Average loss: 0.3449, Accuracy: 10714/12000 (89%)

Epoch 7 | Train Acc: 0.8944791666666667 | Test Acc: 0.8928333333333334 | Time: 1.0837268829345703 sec

Test set: Average loss: 0.3380, Accuracy: 10737/12000 (89%)

Epoch 8 | Train Acc: 0.8972708333333334 | Test Acc: 0.89475 | Time: 1.141679048538208 sec

Test set: Average loss: 0.3331, Accuracy: 10742/12000 (90%)

Epoch 9 | Train Acc: 0.8990416666666666 | Test Acc: 0.8951666666666667 | Time: 1.0597622394561768 sec

Test set: Average loss: 0.3302, Accuracy: 10747/12000 (90%)

Epoch 10 | Train Acc: 0.9005 | Test Acc: 0.8955833333333333 | Time: 1.034029483795166 sec

Test set: Average loss: 0.3281, Accuracy: 10758/12000 (90%)

Epoch 11 | Train Acc: 0.9013333333333333 | Test Acc: 0.8965 | Time: 1.039367914199829 sec

Test set: Average loss: 0.3267, Accuracy: 10763/12000 (90%)

Epoch 12 | Train Acc: 0.9019583333333333 | Test Acc: 0.8969166666666667 | Time: 1.0300929546356201 sec

Test set: Average loss: 0.3258, Accuracy: 10765/12000 (90%)

Epoch 13 | Train Acc: 0.9020833333333333 | Test Acc: 0.8970833333333333 | Time: 1.0334773063659668 sec

Test set: Average loss: 0.3252, Accuracy: 10773/12000 (90%)

Epoch 14 | Train Acc: 0.90275 | Test Acc: 0.89775 | Time: 1.125412940979004 sec

Test set: Average loss: 0.3247, Accuracy: 10776/12000 (90%)

Epoch 15 | Train Acc: 0.9030833333333333 | Test Acc: 0.898 | Time: 1.034696102142334 sec

Test set: Average loss: 0.3245, Accuracy: 10774/12000 (90%)

Epoch 16 | Train Acc: 0.9033125 | Test Acc: 0.8978333333333334 | Time: 1.0336358547210693 sec

Test set: Average loss: 0.3243, Accuracy: 10773/12000 (90%)

Epoch 17 | Train Acc: 0.9034166666666666 | Test Acc: 0.89775 | Time: 1.031890630722046 sec

Test set: Average loss: 0.3242, Accuracy: 10771/12000 (90%)

Epoch 18 | Train Acc: 0.9035208333333333 | Test Acc: 0.8975833333333333 | Time: 1.0323748588562012 sec

Test set: Average loss: 0.3241, Accuracy: 10774/12000 (90%)

Epoch 19 | Train Acc: 0.9036041666666667 | Test Acc: 0.8978333333333334 | Time: 1.0268256664276123 sec

Test set: Average loss: 0.3241, Accuracy: 10774/12000 (90%)

Epoch 20 | Train Acc: 0.9035625 | Test Acc: 0.8978333333333334 | Time: 1.0343420505523682 sec
Early stopping at epoch 20

Testing with M=15
Step 0000 | Epoch 01 | Objective: -14.4392 | Coherence: 19.8338 | Separation: 58.9094 | Information gain: 7.5000 | Grad Norm: 36.7377 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -11.7728 | Coherence: 21.3237 | Separation: 57.1448 | Information gain: 7.5000 | Grad Norm: 35.6213 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -9.1332 | Coherence: 22.7909 | Separation: 55.3861 | Information gain: 7.5000 | Grad Norm: 35.1369 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -6.5785 | Coherence: 24.2180 | Separation: 53.6947 | Information gain: 7.5000 | Grad Norm: 33.7012 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -4.2121 | Coherence: 25.4919 | Separation: 52.0560 | Information gain: 7.5000 | Grad Norm: 32.7350 | Time: 0.9s
Step 0050 | Epoch 01 | Objective: -1.7597 | Coherence: 26.6875 | Separation: 50.3374 | Information gain: 7.6667 | Grad Norm: 32.0327 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: 0.3892 | Coherence: 27.8581 | Separation: 48.8700 | Information gain: 7.6667 | Grad Norm: 30.0620 | Time: 1.4s
Step 0063 | Epoch 01 | Objective: 1.0028 | Coherence: 28.1966 | Separation: 48.4575 | Information gain: 7.6667 | Grad Norm: 29.6645 | Time: 1.5s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.585933  0.427797  0.540238  ...  0.484624  0.553497 -0.476989
1  0.431962  0.612535  0.478922  ...  0.542657  0.474132 -0.503401
2  0.507650  0.445668  0.561681  ...  0.449164  0.477485 -0.458228
3  0.403581  0.572753  0.452683  ...  0.534501  0.441551 -0.513578
4  0.435328  0.523800  0.506040  ...  0.518831  0.507417 -0.579593

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8165
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9024
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8895
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.8356, accuracy=0.1298
Testing SVM
  SVM Test Accuracy: 0.8592
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8298

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6146, Accuracy: 9807/12000 (82%)

Epoch 1 | Train Acc: 0.6823541666666667 | Test Acc: 0.81725 | Time: 1.1337604522705078 sec

Test set: Average loss: 0.4930, Accuracy: 10146/12000 (85%)

Epoch 2 | Train Acc: 0.8349791666666667 | Test Acc: 0.8455 | Time: 1.0234713554382324 sec

Test set: Average loss: 0.4334, Accuracy: 10354/12000 (86%)

Epoch 3 | Train Acc: 0.8607291666666667 | Test Acc: 0.8628333333333333 | Time: 1.0277528762817383 sec

Test set: Average loss: 0.3974, Accuracy: 10467/12000 (87%)

Epoch 4 | Train Acc: 0.8746875 | Test Acc: 0.87225 | Time: 1.0293004512786865 sec

Test set: Average loss: 0.3746, Accuracy: 10573/12000 (88%)

Epoch 5 | Train Acc: 0.8842291666666666 | Test Acc: 0.8810833333333333 | Time: 1.0285449028015137 sec

Test set: Average loss: 0.3543, Accuracy: 10661/12000 (89%)

Epoch 6 | Train Acc: 0.8909583333333333 | Test Acc: 0.8884166666666666 | Time: 1.0179307460784912 sec

Test set: Average loss: 0.3411, Accuracy: 10705/12000 (89%)

Epoch 7 | Train Acc: 0.89575 | Test Acc: 0.8920833333333333 | Time: 1.0262277126312256 sec

Test set: Average loss: 0.3320, Accuracy: 10732/12000 (89%)

Epoch 8 | Train Acc: 0.8981041666666667 | Test Acc: 0.8943333333333333 | Time: 1.0353379249572754 sec

Test set: Average loss: 0.3263, Accuracy: 10745/12000 (90%)

Epoch 9 | Train Acc: 0.8999375 | Test Acc: 0.8954166666666666 | Time: 1.0298008918762207 sec

Test set: Average loss: 0.3227, Accuracy: 10757/12000 (90%)

Epoch 10 | Train Acc: 0.9010208333333334 | Test Acc: 0.8964166666666666 | Time: 1.1098852157592773 sec

Test set: Average loss: 0.3204, Accuracy: 10768/12000 (90%)

Epoch 11 | Train Acc: 0.9019791666666667 | Test Acc: 0.8973333333333333 | Time: 1.0245084762573242 sec

Test set: Average loss: 0.3188, Accuracy: 10771/12000 (90%)

Epoch 12 | Train Acc: 0.9030625 | Test Acc: 0.8975833333333333 | Time: 1.0223407745361328 sec

Test set: Average loss: 0.3177, Accuracy: 10779/12000 (90%)

Epoch 13 | Train Acc: 0.9035625 | Test Acc: 0.89825 | Time: 1.020054578781128 sec

Test set: Average loss: 0.3169, Accuracy: 10782/12000 (90%)

Epoch 14 | Train Acc: 0.9039583333333333 | Test Acc: 0.8985 | Time: 1.024744987487793 sec

Test set: Average loss: 0.3163, Accuracy: 10788/12000 (90%)

Epoch 15 | Train Acc: 0.9042291666666666 | Test Acc: 0.899 | Time: 1.0216445922851562 sec

Test set: Average loss: 0.3159, Accuracy: 10787/12000 (90%)

Epoch 16 | Train Acc: 0.9042708333333334 | Test Acc: 0.8989166666666667 | Time: 1.0253512859344482 sec

Test set: Average loss: 0.3156, Accuracy: 10786/12000 (90%)

Epoch 17 | Train Acc: 0.9042916666666667 | Test Acc: 0.8988333333333334 | Time: 1.0315606594085693 sec

Test set: Average loss: 0.3154, Accuracy: 10785/12000 (90%)

Epoch 18 | Train Acc: 0.9042916666666667 | Test Acc: 0.89875 | Time: 1.030433177947998 sec

Test set: Average loss: 0.3152, Accuracy: 10784/12000 (90%)

Epoch 19 | Train Acc: 0.9043541666666667 | Test Acc: 0.8986666666666666 | Time: 1.1143648624420166 sec

Test set: Average loss: 0.3151, Accuracy: 10782/12000 (90%)

Epoch 20 | Train Acc: 0.9042708333333334 | Test Acc: 0.8985 | Time: 1.021989345550537 sec
Early stopping at epoch 20

Testing with M=15
Step 0000 | Epoch 01 | Objective: -10.1836 | Coherence: 24.7573 | Separation: 64.1614 | Information gain: 7.8333 | Grad Norm: 36.3906 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -7.1933 | Coherence: 26.4544 | Separation: 62.2217 | Information gain: 7.8333 | Grad Norm: 35.7442 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -4.3038 | Coherence: 28.1152 | Separation: 60.3785 | Information gain: 7.8333 | Grad Norm: 34.2425 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -1.2703 | Coherence: 29.7378 | Separation: 58.5120 | Information gain: 8.0000 | Grad Norm: 33.9616 | Time: 0.7s
Step 0038 | Epoch 01 | Objective: 1.0576 | Coherence: 31.0199 | Separation: 56.9434 | Information gain: 8.0000 | Grad Norm: 33.6818 | Time: 0.9s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.621120  0.429623  0.490381  ...  0.448232  0.484092  0.362561
1  0.419064  0.600374  0.410887  ...  0.484643  0.393885  0.520584
2  0.492666  0.402263  0.561126  ...  0.498200  0.509217  0.373879
3  0.473381  0.528099  0.407528  ...  0.449191  0.350650  0.464534
4  0.340966  0.461552  0.417876  ...  0.526351  0.396859  0.524888

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7976
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8992
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8811
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.1014, accuracy=0.1096
Testing SVM
  SVM Test Accuracy: 0.8619
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8329

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6678, Accuracy: 9666/12000 (81%)

Epoch 1 | Train Acc: 0.65 | Test Acc: 0.8055 | Time: 1.0223462581634521 sec

Test set: Average loss: 0.5054, Accuracy: 10106/12000 (84%)

Epoch 2 | Train Acc: 0.8261458333333334 | Test Acc: 0.8421666666666666 | Time: 1.0239479541778564 sec

Test set: Average loss: 0.4354, Accuracy: 10365/12000 (86%)

Epoch 3 | Train Acc: 0.8571666666666666 | Test Acc: 0.86375 | Time: 1.0212111473083496 sec

Test set: Average loss: 0.4026, Accuracy: 10486/12000 (87%)

Epoch 4 | Train Acc: 0.8727916666666666 | Test Acc: 0.8738333333333334 | Time: 1.0223760604858398 sec

Test set: Average loss: 0.3778, Accuracy: 10585/12000 (88%)

Epoch 5 | Train Acc: 0.8823333333333333 | Test Acc: 0.8820833333333333 | Time: 1.0262119770050049 sec

Test set: Average loss: 0.3629, Accuracy: 10646/12000 (89%)

Epoch 6 | Train Acc: 0.8883333333333333 | Test Acc: 0.8871666666666667 | Time: 1.02836012840271 sec

Test set: Average loss: 0.3527, Accuracy: 10670/12000 (89%)

Epoch 7 | Train Acc: 0.8927083333333333 | Test Acc: 0.8891666666666667 | Time: 1.143347978591919 sec

Test set: Average loss: 0.3456, Accuracy: 10703/12000 (89%)

Epoch 8 | Train Acc: 0.8960833333333333 | Test Acc: 0.8919166666666667 | Time: 1.1717710494995117 sec

Test set: Average loss: 0.3402, Accuracy: 10724/12000 (89%)

Epoch 9 | Train Acc: 0.898 | Test Acc: 0.8936666666666667 | Time: 1.0828111171722412 sec

Test set: Average loss: 0.3363, Accuracy: 10742/12000 (90%)

Epoch 10 | Train Acc: 0.8993541666666667 | Test Acc: 0.8951666666666667 | Time: 1.0297293663024902 sec

Test set: Average loss: 0.3339, Accuracy: 10750/12000 (90%)

Epoch 11 | Train Acc: 0.9002083333333334 | Test Acc: 0.8958333333333334 | Time: 1.0352513790130615 sec

Test set: Average loss: 0.3320, Accuracy: 10760/12000 (90%)

Epoch 12 | Train Acc: 0.901125 | Test Acc: 0.8966666666666666 | Time: 1.0324578285217285 sec

Test set: Average loss: 0.3307, Accuracy: 10766/12000 (90%)

Epoch 13 | Train Acc: 0.9016875 | Test Acc: 0.8971666666666667 | Time: 1.0374271869659424 sec

Test set: Average loss: 0.3296, Accuracy: 10768/12000 (90%)

Epoch 14 | Train Acc: 0.9023125 | Test Acc: 0.8973333333333333 | Time: 1.033402681350708 sec

Test set: Average loss: 0.3289, Accuracy: 10773/12000 (90%)

Epoch 15 | Train Acc: 0.902375 | Test Acc: 0.89775 | Time: 1.0328972339630127 sec

Test set: Average loss: 0.3283, Accuracy: 10772/12000 (90%)

Epoch 16 | Train Acc: 0.9025208333333333 | Test Acc: 0.8976666666666666 | Time: 1.128175973892212 sec

Test set: Average loss: 0.3279, Accuracy: 10773/12000 (90%)

Epoch 17 | Train Acc: 0.9026458333333334 | Test Acc: 0.89775 | Time: 1.0390374660491943 sec

Test set: Average loss: 0.3277, Accuracy: 10771/12000 (90%)

Epoch 18 | Train Acc: 0.9024791666666667 | Test Acc: 0.8975833333333333 | Time: 1.0446293354034424 sec

Test set: Average loss: 0.3275, Accuracy: 10771/12000 (90%)

Epoch 19 | Train Acc: 0.9024791666666667 | Test Acc: 0.8975833333333333 | Time: 1.0403339862823486 sec

Test set: Average loss: 0.3274, Accuracy: 10772/12000 (90%)

Epoch 20 | Train Acc: 0.9026458333333334 | Test Acc: 0.8976666666666666 | Time: 1.0441348552703857 sec
Early stopping at epoch 20

Testing with M=15
Step 0000 | Epoch 01 | Objective: -51.5747 | Coherence: 3.5150 | Separation: 55.0896 | Information gain: 7.8333 | Grad Norm: 45.8433 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -48.8241 | Coherence: 4.7282 | Separation: 53.5523 | Information gain: 7.8333 | Grad Norm: 44.4550 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -46.1288 | Coherence: 5.9310 | Separation: 52.0598 | Information gain: 7.8333 | Grad Norm: 42.7808 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -43.6105 | Coherence: 7.1500 | Separation: 50.7605 | Information gain: 7.8333 | Grad Norm: 41.4149 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -41.2467 | Coherence: 8.3388 | Separation: 49.5855 | Information gain: 7.8333 | Grad Norm: 40.9946 | Time: 0.9s
Step 0050 | Epoch 01 | Objective: -38.8820 | Coherence: 9.5829 | Separation: 48.4649 | Information gain: 7.8333 | Grad Norm: 39.9408 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -36.6165 | Coherence: 10.7865 | Separation: 47.4029 | Information gain: 7.6667 | Grad Norm: 39.6827 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -34.4365 | Coherence: 11.9396 | Separation: 46.3760 | Information gain: 7.6667 | Grad Norm: 39.5861 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -32.2836 | Coherence: 13.0642 | Separation: 45.3479 | Information gain: 7.6667 | Grad Norm: 38.5325 | Time: 1.8s
Step 0090 | Epoch 01 | Objective: -30.2199 | Coherence: 14.1606 | Separation: 44.3805 | Information gain: 8.0000 | Grad Norm: 38.0522 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -28.1998 | Coherence: 15.2014 | Separation: 43.4012 | Information gain: 8.0000 | Grad Norm: 37.3174 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -26.3259 | Coherence: 16.2448 | Separation: 42.5707 | Information gain: 8.0000 | Grad Norm: 35.6556 | Time: 2.5s
Step 0120 | Epoch 01 | Objective: -24.5210 | Coherence: 17.2269 | Separation: 41.7479 | Information gain: 8.3333 | Grad Norm: 34.2105 | Time: 2.7s
Step 0130 | Epoch 01 | Objective: -22.8712 | Coherence: 18.1928 | Separation: 41.0640 | Information gain: 8.1667 | Grad Norm: 33.5322 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -21.3260 | Coherence: 19.1111 | Separation: 40.4372 | Information gain: 8.1667 | Grad Norm: 31.9477 | Time: 3.2s
Step 0150 | Epoch 01 | Objective: -19.8720 | Coherence: 20.0237 | Separation: 39.8957 | Information gain: 8.3333 | Grad Norm: 31.8970 | Time: 3.4s
Step 0160 | Epoch 01 | Objective: -18.4580 | Coherence: 20.9180 | Separation: 39.3760 | Information gain: 8.3333 | Grad Norm: 31.7123 | Time: 3.6s
Step 0170 | Epoch 01 | Objective: -17.1073 | Coherence: 21.8358 | Separation: 38.9431 | Information gain: 8.1667 | Grad Norm: 30.7434 | Time: 3.9s
Step 0180 | Epoch 01 | Objective: -15.7932 | Coherence: 22.6760 | Separation: 38.4692 | Information gain: 8.1667 | Grad Norm: 31.6489 | Time: 4.1s
Step 0190 | Epoch 01 | Objective: -14.4760 | Coherence: 23.4921 | Separation: 37.9681 | Information gain: 8.1667 | Grad Norm: 31.0446 | Time: 4.3s
Step 0200 | Epoch 01 | Objective: -13.1429 | Coherence: 24.2911 | Separation: 37.4339 | Information gain: 8.1667 | Grad Norm: 29.6968 | Time: 4.6s
Step 0210 | Epoch 01 | Objective: -11.9257 | Coherence: 25.0327 | Separation: 36.9584 | Information gain: 8.1667 | Grad Norm: 28.7032 | Time: 4.8s
Step 0220 | Epoch 01 | Objective: -10.7103 | Coherence: 25.7260 | Separation: 36.4363 | Information gain: 8.1667 | Grad Norm: 29.5460 | Time: 5.0s
Step 0230 | Epoch 01 | Objective: -9.5378 | Coherence: 26.4160 | Separation: 35.9537 | Information gain: 8.1667 | Grad Norm: 28.3640 | Time: 5.3s
Step 0240 | Epoch 01 | Objective: -8.3943 | Coherence: 27.0738 | Separation: 35.4681 | Information gain: 8.1667 | Grad Norm: 27.6049 | Time: 5.5s
Step 0250 | Epoch 01 | Objective: -7.2772 | Coherence: 27.7675 | Separation: 35.0447 | Information gain: 7.8333 | Grad Norm: 28.2723 | Time: 5.7s
Step 0260 | Epoch 01 | Objective: -6.1463 | Coherence: 28.4768 | Separation: 34.6231 | Information gain: 7.8333 | Grad Norm: 29.7865 | Time: 6.0s
Step 0270 | Epoch 01 | Objective: -5.0368 | Coherence: 29.1600 | Separation: 34.1968 | Information gain: 7.8333 | Grad Norm: 26.8594 | Time: 6.2s
Step 0280 | Epoch 01 | Objective: -4.0515 | Coherence: 29.8008 | Separation: 33.8523 | Information gain: 8.0000 | Grad Norm: 27.3431 | Time: 6.4s
Step 0290 | Epoch 01 | Objective: -3.0593 | Coherence: 30.4233 | Separation: 33.4826 | Information gain: 8.0000 | Grad Norm: 26.2792 | Time: 6.7s
Step 0300 | Epoch 01 | Objective: -2.0037 | Coherence: 31.0432 | Separation: 33.0469 | Information gain: 7.6667 | Grad Norm: 27.5137 | Time: 6.9s
Step 0310 | Epoch 01 | Objective: -0.9837 | Coherence: 31.6506 | Separation: 32.6343 | Information gain: 7.6667 | Grad Norm: 26.6741 | Time: 7.1s
Step 0320 | Epoch 01 | Objective: 0.0583 | Coherence: 32.2726 | Separation: 32.2143 | Information gain: 7.6667 | Grad Norm: 27.5395 | Time: 7.4s
Step 0329 | Epoch 01 | Objective: 0.9696 | Coherence: 32.8274 | Separation: 31.8579 | Information gain: 7.3333 | Grad Norm: 25.9731 | Time: 7.6s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.562697  0.435450  0.447980  ...  0.477858 -0.487399  0.446468
1  0.451989  0.666632  0.453053  ...  0.571305 -0.435482  0.467062
2  0.470371  0.429033  0.594584  ...  0.416580 -0.540458  0.476356
3  0.498467  0.439338  0.531751  ...  0.496399 -0.539295  0.537279
4  0.496712  0.306983  0.504612  ...  0.320786 -0.542049  0.378955

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8054
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8989
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8763
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.9213, accuracy=0.1047
Testing SVM
  SVM Test Accuracy: 0.8572
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8318

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6568, Accuracy: 9494/12000 (79%)

Epoch 1 | Train Acc: 0.6793125 | Test Acc: 0.7911666666666667 | Time: 1.0565118789672852 sec

Test set: Average loss: 0.4935, Accuracy: 10167/12000 (85%)

Epoch 2 | Train Acc: 0.8281875 | Test Acc: 0.84725 | Time: 1.0260262489318848 sec

Test set: Average loss: 0.4431, Accuracy: 10313/12000 (86%)

Epoch 3 | Train Acc: 0.8521458333333334 | Test Acc: 0.8594166666666667 | Time: 1.1346240043640137 sec

Test set: Average loss: 0.4116, Accuracy: 10423/12000 (87%)

Epoch 4 | Train Acc: 0.8666666666666667 | Test Acc: 0.8685833333333334 | Time: 1.0228209495544434 sec

Test set: Average loss: 0.3882, Accuracy: 10517/12000 (88%)

Epoch 5 | Train Acc: 0.8755625 | Test Acc: 0.8764166666666666 | Time: 1.0271544456481934 sec

Test set: Average loss: 0.3742, Accuracy: 10569/12000 (88%)

Epoch 6 | Train Acc: 0.8825208333333333 | Test Acc: 0.88075 | Time: 1.0206973552703857 sec

Test set: Average loss: 0.3649, Accuracy: 10617/12000 (88%)

Epoch 7 | Train Acc: 0.8870416666666666 | Test Acc: 0.88475 | Time: 1.030531644821167 sec

Test set: Average loss: 0.3585, Accuracy: 10645/12000 (89%)

Epoch 8 | Train Acc: 0.8904375 | Test Acc: 0.8870833333333333 | Time: 1.0306754112243652 sec

Test set: Average loss: 0.3541, Accuracy: 10652/12000 (89%)

Epoch 9 | Train Acc: 0.8927708333333333 | Test Acc: 0.8876666666666667 | Time: 1.0340640544891357 sec

Test set: Average loss: 0.3510, Accuracy: 10674/12000 (89%)

Epoch 10 | Train Acc: 0.8940416666666666 | Test Acc: 0.8895 | Time: 1.0234429836273193 sec

Test set: Average loss: 0.3487, Accuracy: 10685/12000 (89%)

Epoch 11 | Train Acc: 0.895125 | Test Acc: 0.8904166666666666 | Time: 1.0224575996398926 sec

Test set: Average loss: 0.3470, Accuracy: 10695/12000 (89%)

Epoch 12 | Train Acc: 0.895875 | Test Acc: 0.89125 | Time: 1.1439034938812256 sec

Test set: Average loss: 0.3458, Accuracy: 10707/12000 (89%)

Epoch 13 | Train Acc: 0.8962291666666666 | Test Acc: 0.89225 | Time: 1.036001205444336 sec

Test set: Average loss: 0.3450, Accuracy: 10709/12000 (89%)

Epoch 14 | Train Acc: 0.8965833333333333 | Test Acc: 0.8924166666666666 | Time: 1.026322603225708 sec

Test set: Average loss: 0.3444, Accuracy: 10707/12000 (89%)

Epoch 15 | Train Acc: 0.8966875 | Test Acc: 0.89225 | Time: 1.0256998538970947 sec

Test set: Average loss: 0.3439, Accuracy: 10706/12000 (89%)

Epoch 16 | Train Acc: 0.8969166666666667 | Test Acc: 0.8921666666666667 | Time: 1.1413021087646484 sec

Test set: Average loss: 0.3437, Accuracy: 10710/12000 (89%)

Epoch 17 | Train Acc: 0.8970625 | Test Acc: 0.8925 | Time: 1.0526490211486816 sec

Test set: Average loss: 0.3435, Accuracy: 10710/12000 (89%)

Epoch 18 | Train Acc: 0.897125 | Test Acc: 0.8925 | Time: 1.028883457183838 sec

Test set: Average loss: 0.3433, Accuracy: 10710/12000 (89%)

Epoch 19 | Train Acc: 0.8971458333333333 | Test Acc: 0.8925 | Time: 1.0245001316070557 sec

Test set: Average loss: 0.3433, Accuracy: 10710/12000 (89%)

Epoch 20 | Train Acc: 0.8971875 | Test Acc: 0.8925 | Time: 1.0200612545013428 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -44.2174 | Coherence: 12.4446 | Separation: 58.9953 | Information gain: 7.0000 | Grad Norm: 43.2548 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -41.6592 | Coherence: 13.2993 | Separation: 57.2918 | Information gain: 7.0000 | Grad Norm: 42.9720 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -39.0507 | Coherence: 14.1710 | Separation: 55.6106 | Information gain: 7.1667 | Grad Norm: 42.2214 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -36.4970 | Coherence: 15.1197 | Separation: 54.0056 | Information gain: 7.1667 | Grad Norm: 42.0097 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -33.9799 | Coherence: 16.1468 | Separation: 52.4601 | Information gain: 7.0000 | Grad Norm: 40.8894 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -31.3572 | Coherence: 17.2366 | Separation: 50.9827 | Information gain: 7.1667 | Grad Norm: 39.4233 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -29.0621 | Coherence: 18.3459 | Separation: 49.7969 | Information gain: 7.1667 | Grad Norm: 37.8090 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -26.8209 | Coherence: 19.4387 | Separation: 48.5929 | Information gain: 7.0000 | Grad Norm: 37.5296 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -24.6536 | Coherence: 20.5305 | Separation: 47.5175 | Information gain: 7.0000 | Grad Norm: 36.2285 | Time: 1.8s
Step 0090 | Epoch 01 | Objective: -22.5919 | Coherence: 21.6151 | Separation: 46.5403 | Information gain: 7.0000 | Grad Norm: 34.9173 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -20.6390 | Coherence: 22.6515 | Separation: 45.6239 | Information gain: 7.0000 | Grad Norm: 35.4350 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -18.7509 | Coherence: 23.6753 | Separation: 44.7039 | Information gain: 6.8333 | Grad Norm: 34.3446 | Time: 2.5s
Step 0120 | Epoch 01 | Objective: -16.9035 | Coherence: 24.6375 | Separation: 43.8187 | Information gain: 6.8333 | Grad Norm: 33.0584 | Time: 2.7s
Step 0130 | Epoch 01 | Objective: -15.2165 | Coherence: 25.5644 | Separation: 43.0587 | Information gain: 6.8333 | Grad Norm: 31.5574 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -13.6119 | Coherence: 26.4295 | Separation: 42.3191 | Information gain: 6.8333 | Grad Norm: 31.1062 | Time: 3.2s
Step 0150 | Epoch 01 | Objective: -12.0230 | Coherence: 27.2663 | Separation: 41.5670 | Information gain: 6.8333 | Grad Norm: 31.1922 | Time: 3.4s
Step 0160 | Epoch 01 | Objective: -10.4436 | Coherence: 28.0993 | Separation: 40.8206 | Information gain: 6.8333 | Grad Norm: 30.4584 | Time: 3.7s
Step 0170 | Epoch 01 | Objective: -8.8110 | Coherence: 28.9278 | Separation: 40.0166 | Information gain: 6.8333 | Grad Norm: 31.8364 | Time: 3.9s
Step 0180 | Epoch 01 | Objective: -7.1079 | Coherence: 29.7638 | Separation: 39.1495 | Information gain: 6.8333 | Grad Norm: 30.9476 | Time: 4.1s
Step 0190 | Epoch 01 | Objective: -5.5019 | Coherence: 30.5787 | Separation: 38.3584 | Information gain: 6.8333 | Grad Norm: 30.3277 | Time: 4.3s
Step 0200 | Epoch 01 | Objective: -3.9354 | Coherence: 31.3795 | Separation: 37.6483 | Information gain: 7.0000 | Grad Norm: 28.7195 | Time: 4.5s
Step 0210 | Epoch 01 | Objective: -2.3157 | Coherence: 32.1564 | Separation: 36.9166 | Information gain: 7.3333 | Grad Norm: 30.0875 | Time: 4.8s
Step 0220 | Epoch 01 | Objective: -0.9329 | Coherence: 32.8961 | Separation: 36.2180 | Information gain: 7.1667 | Grad Norm: 30.3449 | Time: 5.0s
Step 0230 | Epoch 01 | Objective: 0.5221 | Coherence: 33.6006 | Separation: 35.4674 | Information gain: 7.1667 | Grad Norm: 28.6021 | Time: 5.2s
Step 0233 | Epoch 01 | Objective: 0.9666 | Coherence: 33.8058 | Separation: 35.2281 | Information gain: 7.1667 | Grad Norm: 29.5500 | Time: 5.3s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.613364  0.504296  0.450285  ...  0.510202  0.447602  0.453808
1  0.504209  0.621700  0.541964  ...  0.465104  0.531596  0.593034
2  0.419708  0.499271  0.567298  ...  0.490486  0.424108  0.528739
3  0.438197  0.417626  0.452533  ...  0.528363  0.353002  0.382635
4  0.457780  0.591952  0.577870  ...  0.446933  0.492770  0.605395

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7883
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9040
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8787
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.1369, accuracy=0.0882
Testing SVM
  SVM Test Accuracy: 0.8623
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8379

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7986, Accuracy: 8855/12000 (74%)

Epoch 1 | Train Acc: 0.6162291666666667 | Test Acc: 0.7379166666666667 | Time: 1.0228216648101807 sec

Test set: Average loss: 0.5548, Accuracy: 9800/12000 (82%)

Epoch 2 | Train Acc: 0.8105208333333334 | Test Acc: 0.8166666666666667 | Time: 1.0184736251831055 sec

Test set: Average loss: 0.4598, Accuracy: 10202/12000 (85%)

Epoch 3 | Train Acc: 0.8488125 | Test Acc: 0.8501666666666666 | Time: 1.0318772792816162 sec

Test set: Average loss: 0.4074, Accuracy: 10421/12000 (87%)

Epoch 4 | Train Acc: 0.868125 | Test Acc: 0.8684166666666666 | Time: 1.0212738513946533 sec

Test set: Average loss: 0.3758, Accuracy: 10567/12000 (88%)

Epoch 5 | Train Acc: 0.8807708333333333 | Test Acc: 0.8805833333333334 | Time: 1.0222110748291016 sec

Test set: Average loss: 0.3514, Accuracy: 10669/12000 (89%)

Epoch 6 | Train Acc: 0.8886041666666666 | Test Acc: 0.8890833333333333 | Time: 1.026984453201294 sec

Test set: Average loss: 0.3362, Accuracy: 10749/12000 (90%)

Epoch 7 | Train Acc: 0.8938125 | Test Acc: 0.89575 | Time: 1.0228307247161865 sec

Test set: Average loss: 0.3267, Accuracy: 10792/12000 (90%)

Epoch 8 | Train Acc: 0.8976041666666666 | Test Acc: 0.8993333333333333 | Time: 1.0224409103393555 sec

Test set: Average loss: 0.3205, Accuracy: 10814/12000 (90%)

Epoch 9 | Train Acc: 0.8997083333333333 | Test Acc: 0.9011666666666667 | Time: 1.159266710281372 sec

Test set: Average loss: 0.3164, Accuracy: 10829/12000 (90%)

Epoch 10 | Train Acc: 0.9014791666666667 | Test Acc: 0.9024166666666666 | Time: 1.0219857692718506 sec

Test set: Average loss: 0.3136, Accuracy: 10840/12000 (90%)

Epoch 11 | Train Acc: 0.9026458333333334 | Test Acc: 0.9033333333333333 | Time: 1.024230718612671 sec

Test set: Average loss: 0.3117, Accuracy: 10851/12000 (90%)

Epoch 12 | Train Acc: 0.9036041666666667 | Test Acc: 0.90425 | Time: 1.024390697479248 sec

Test set: Average loss: 0.3104, Accuracy: 10855/12000 (90%)

Epoch 13 | Train Acc: 0.9041666666666667 | Test Acc: 0.9045833333333333 | Time: 1.0220649242401123 sec

Test set: Average loss: 0.3094, Accuracy: 10866/12000 (91%)

Epoch 14 | Train Acc: 0.9043541666666667 | Test Acc: 0.9055 | Time: 1.0322279930114746 sec

Test set: Average loss: 0.3088, Accuracy: 10866/12000 (91%)

Epoch 15 | Train Acc: 0.9045416666666667 | Test Acc: 0.9055 | Time: 1.0220460891723633 sec

Test set: Average loss: 0.3083, Accuracy: 10867/12000 (91%)

Epoch 16 | Train Acc: 0.904625 | Test Acc: 0.9055833333333333 | Time: 1.0222513675689697 sec

Test set: Average loss: 0.3081, Accuracy: 10869/12000 (91%)

Epoch 17 | Train Acc: 0.9046041666666667 | Test Acc: 0.90575 | Time: 1.033834457397461 sec

Test set: Average loss: 0.3079, Accuracy: 10873/12000 (91%)

Epoch 18 | Train Acc: 0.9048541666666666 | Test Acc: 0.9060833333333334 | Time: 1.1182119846343994 sec

Test set: Average loss: 0.3078, Accuracy: 10875/12000 (91%)

Epoch 19 | Train Acc: 0.905 | Test Acc: 0.90625 | Time: 1.0226433277130127 sec

Test set: Average loss: 0.3077, Accuracy: 10873/12000 (91%)

Epoch 20 | Train Acc: 0.905125 | Test Acc: 0.9060833333333334 | Time: 1.0293362140655518 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -43.6496 | Coherence: 8.1933 | Separation: 57.9540 | Information gain: 9.1667 | Grad Norm: 48.1117 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -40.8830 | Coherence: 9.1770 | Separation: 56.0600 | Information gain: 9.0000 | Grad Norm: 46.4250 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -38.0228 | Coherence: 10.1722 | Separation: 54.1949 | Information gain: 9.0000 | Grad Norm: 45.8891 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -35.4696 | Coherence: 11.1705 | Separation: 52.6402 | Information gain: 9.0000 | Grad Norm: 42.4517 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -33.1309 | Coherence: 12.2366 | Separation: 51.3675 | Information gain: 9.0000 | Grad Norm: 40.6207 | Time: 0.9s
Step 0050 | Epoch 01 | Objective: -30.9179 | Coherence: 13.2825 | Separation: 50.2004 | Information gain: 9.0000 | Grad Norm: 39.3796 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -28.7339 | Coherence: 14.3502 | Separation: 49.0841 | Information gain: 9.0000 | Grad Norm: 40.0551 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -26.6396 | Coherence: 15.4230 | Separation: 48.0626 | Information gain: 9.0000 | Grad Norm: 38.6939 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -24.5612 | Coherence: 16.4949 | Separation: 47.0560 | Information gain: 9.0000 | Grad Norm: 37.4994 | Time: 1.8s
Step 0090 | Epoch 01 | Objective: -22.4388 | Coherence: 17.5748 | Separation: 46.1247 | Information gain: 9.1667 | Grad Norm: 37.8688 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -20.5935 | Coherence: 18.6661 | Separation: 45.2596 | Information gain: 9.0000 | Grad Norm: 35.1807 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -18.7160 | Coherence: 19.7416 | Separation: 44.4576 | Information gain: 9.0000 | Grad Norm: 37.6362 | Time: 2.5s
Step 0120 | Epoch 01 | Objective: -16.8534 | Coherence: 20.8117 | Separation: 43.6651 | Information gain: 9.0000 | Grad Norm: 34.3794 | Time: 2.7s
Step 0130 | Epoch 01 | Objective: -15.0293 | Coherence: 21.8026 | Separation: 42.9430 | Information gain: 9.1667 | Grad Norm: 33.5230 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -13.3061 | Coherence: 22.7527 | Separation: 42.1699 | Information gain: 9.1667 | Grad Norm: 33.2279 | Time: 3.2s
Step 0150 | Epoch 01 | Objective: -11.5489 | Coherence: 23.7288 | Separation: 41.3888 | Information gain: 9.1667 | Grad Norm: 34.6224 | Time: 3.4s
Step 0160 | Epoch 01 | Objective: -9.7181 | Coherence: 24.7450 | Separation: 40.6852 | Information gain: 9.3333 | Grad Norm: 32.3295 | Time: 3.6s
Step 0170 | Epoch 01 | Objective: -8.0101 | Coherence: 25.8190 | Separation: 40.0514 | Information gain: 9.3333 | Grad Norm: 33.3250 | Time: 3.9s
Step 0180 | Epoch 01 | Objective: -6.5421 | Coherence: 26.8318 | Separation: 39.4851 | Information gain: 9.1667 | Grad Norm: 30.5996 | Time: 4.1s
Step 0190 | Epoch 01 | Objective: -4.9217 | Coherence: 27.7708 | Separation: 38.8036 | Information gain: 9.1667 | Grad Norm: 31.6607 | Time: 4.3s
Step 0200 | Epoch 01 | Objective: -3.4071 | Coherence: 28.7106 | Separation: 38.2288 | Information gain: 9.1667 | Grad Norm: 30.5799 | Time: 4.5s
Step 0210 | Epoch 01 | Objective: -1.8882 | Coherence: 29.6459 | Separation: 37.6451 | Information gain: 9.1667 | Grad Norm: 29.6517 | Time: 4.7s
Step 0220 | Epoch 01 | Objective: -0.3291 | Coherence: 30.5662 | Separation: 37.0064 | Information gain: 9.1667 | Grad Norm: 29.6390 | Time: 5.0s
Step 0229 | Epoch 01 | Objective: 1.0291 | Coherence: 31.3827 | Separation: 36.4647 | Information gain: 9.1667 | Grad Norm: 30.6548 | Time: 5.2s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.521855  0.401886  0.452312  ...  0.439623  0.417069  0.450672
1  0.434168  0.639198  0.493408  ...  0.525484  0.622244  0.491872
2  0.459483  0.448548  0.582387  ...  0.518828  0.425227  0.495089
3  0.448818  0.513249  0.497530  ...  0.476883  0.535714  0.437191
4  0.479548  0.437263  0.479317  ...  0.513966  0.453851  0.412882

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7979
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9098
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8903
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0691, accuracy=0.0921
Testing SVM
  SVM Test Accuracy: 0.8687
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8413

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6163, Accuracy: 9866/12000 (82%)

Epoch 1 | Train Acc: 0.6820625 | Test Acc: 0.8221666666666667 | Time: 1.028641939163208 sec

Test set: Average loss: 0.4492, Accuracy: 10308/12000 (86%)

Epoch 2 | Train Acc: 0.8446041666666667 | Test Acc: 0.859 | Time: 1.1125411987304688 sec

Test set: Average loss: 0.3923, Accuracy: 10520/12000 (88%)

Epoch 3 | Train Acc: 0.8710625 | Test Acc: 0.8766666666666667 | Time: 1.027355670928955 sec

Test set: Average loss: 0.3551, Accuracy: 10642/12000 (89%)

Epoch 4 | Train Acc: 0.884125 | Test Acc: 0.8868333333333334 | Time: 1.1365950107574463 sec

Test set: Average loss: 0.3361, Accuracy: 10727/12000 (89%)

Epoch 5 | Train Acc: 0.8936458333333334 | Test Acc: 0.8939166666666667 | Time: 1.5614354610443115 sec

Test set: Average loss: 0.3235, Accuracy: 10765/12000 (90%)

Epoch 6 | Train Acc: 0.899625 | Test Acc: 0.8970833333333333 | Time: 1.2978391647338867 sec

Test set: Average loss: 0.3161, Accuracy: 10788/12000 (90%)

Epoch 7 | Train Acc: 0.9035833333333333 | Test Acc: 0.899 | Time: 1.0728082656860352 sec

Test set: Average loss: 0.3113, Accuracy: 10804/12000 (90%)

Epoch 8 | Train Acc: 0.9065833333333333 | Test Acc: 0.9003333333333333 | Time: 1.0189015865325928 sec

Test set: Average loss: 0.3075, Accuracy: 10826/12000 (90%)

Epoch 9 | Train Acc: 0.9084583333333334 | Test Acc: 0.9021666666666667 | Time: 1.015657663345337 sec

Test set: Average loss: 0.3046, Accuracy: 10835/12000 (90%)

Epoch 10 | Train Acc: 0.9095416666666667 | Test Acc: 0.9029166666666667 | Time: 1.0259795188903809 sec

Test set: Average loss: 0.3024, Accuracy: 10848/12000 (90%)

Epoch 11 | Train Acc: 0.910625 | Test Acc: 0.904 | Time: 1.3514809608459473 sec

Test set: Average loss: 0.3009, Accuracy: 10843/12000 (90%)

Epoch 12 | Train Acc: 0.9112291666666666 | Test Acc: 0.9035833333333333 | Time: 1.2471141815185547 sec

Test set: Average loss: 0.3000, Accuracy: 10848/12000 (90%)

Epoch 13 | Train Acc: 0.9115208333333333 | Test Acc: 0.904 | Time: 1.157691240310669 sec

Test set: Average loss: 0.2994, Accuracy: 10852/12000 (90%)

Epoch 14 | Train Acc: 0.912 | Test Acc: 0.9043333333333333 | Time: 1.176332712173462 sec

Test set: Average loss: 0.2991, Accuracy: 10849/12000 (90%)

Epoch 15 | Train Acc: 0.9123125 | Test Acc: 0.9040833333333333 | Time: 1.2590439319610596 sec

Test set: Average loss: 0.2989, Accuracy: 10851/12000 (90%)

Epoch 16 | Train Acc: 0.9123541666666667 | Test Acc: 0.90425 | Time: 1.3765103816986084 sec

Test set: Average loss: 0.2988, Accuracy: 10847/12000 (90%)

Epoch 17 | Train Acc: 0.9125416666666667 | Test Acc: 0.9039166666666667 | Time: 1.3511936664581299 sec

Test set: Average loss: 0.2987, Accuracy: 10847/12000 (90%)

Epoch 18 | Train Acc: 0.9125 | Test Acc: 0.9039166666666667 | Time: 1.0263478755950928 sec

Test set: Average loss: 0.2986, Accuracy: 10849/12000 (90%)

Epoch 19 | Train Acc: 0.9124583333333334 | Test Acc: 0.9040833333333333 | Time: 1.0172159671783447 sec
Early stopping at epoch 19

Testing with M=15
Step 0000 | Epoch 01 | Objective: -35.0768 | Coherence: 19.2153 | Separation: 61.9587 | Information gain: 7.6667 | Grad Norm: 43.2704 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -32.5186 | Coherence: 20.0983 | Separation: 60.2836 | Information gain: 7.6667 | Grad Norm: 42.9262 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -29.9649 | Coherence: 21.0154 | Separation: 58.6471 | Information gain: 7.6667 | Grad Norm: 41.2332 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -27.2625 | Coherence: 21.9955 | Separation: 57.0913 | Information gain: 7.8333 | Grad Norm: 40.9662 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: -24.6121 | Coherence: 23.0146 | Separation: 55.4600 | Information gain: 7.8333 | Grad Norm: 41.2542 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -21.9047 | Coherence: 24.0434 | Separation: 53.7815 | Information gain: 7.8333 | Grad Norm: 40.0562 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -19.1879 | Coherence: 25.0792 | Separation: 52.1004 | Information gain: 7.8333 | Grad Norm: 39.5364 | Time: 1.5s
Step 0070 | Epoch 01 | Objective: -16.5320 | Coherence: 26.1431 | Separation: 50.5084 | Information gain: 7.8333 | Grad Norm: 38.0096 | Time: 1.8s
Step 0080 | Epoch 01 | Objective: -14.2531 | Coherence: 27.1915 | Separation: 49.2779 | Information gain: 7.8333 | Grad Norm: 35.6813 | Time: 2.0s
Step 0090 | Epoch 01 | Objective: -12.0550 | Coherence: 28.2226 | Separation: 48.1109 | Information gain: 7.8333 | Grad Norm: 36.5703 | Time: 2.3s
Step 0100 | Epoch 01 | Objective: -9.6922 | Coherence: 29.1909 | Separation: 46.8831 | Information gain: 8.0000 | Grad Norm: 36.0597 | Time: 2.6s
Step 0110 | Epoch 01 | Objective: -7.4581 | Coherence: 30.1974 | Separation: 45.6555 | Information gain: 8.0000 | Grad Norm: 36.2163 | Time: 2.9s
Step 0120 | Epoch 01 | Objective: -5.2682 | Coherence: 31.1640 | Separation: 44.4321 | Information gain: 8.0000 | Grad Norm: 35.0647 | Time: 3.1s
Step 0130 | Epoch 01 | Objective: -3.2144 | Coherence: 32.1677 | Separation: 43.3821 | Information gain: 8.0000 | Grad Norm: 33.8042 | Time: 3.4s
Step 0140 | Epoch 01 | Objective: -1.1937 | Coherence: 33.1267 | Separation: 42.3204 | Information gain: 8.0000 | Grad Norm: 33.2580 | Time: 3.7s
Step 0150 | Epoch 01 | Objective: 0.8697 | Coherence: 34.0699 | Separation: 41.2002 | Information gain: 8.0000 | Grad Norm: 33.8901 | Time: 3.9s
Step 0151 | Epoch 01 | Objective: 1.0756 | Coherence: 34.1650 | Separation: 41.0894 | Information gain: 8.0000 | Grad Norm: 32.7287 | Time: 3.9s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.632111  0.447217  0.484026  ...  0.488345 -0.522741  0.435269
1  0.423141  0.594134  0.501393  ...  0.474137 -0.528707  0.540169
2  0.456338  0.491684  0.587120  ...  0.507611 -0.547759  0.560403
3  0.405597  0.525713  0.551999  ...  0.499792 -0.494450  0.542764
4  0.401369  0.455061  0.450317  ...  0.565918 -0.437359  0.430112

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8019
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8991
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8781
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0011, accuracy=0.1146
Testing SVM
  SVM Test Accuracy: 0.8581
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8313

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7331, Accuracy: 9403/12000 (78%)

Epoch 1 | Train Acc: 0.6585416666666667 | Test Acc: 0.7835833333333333 | Time: 1.3083348274230957 sec

Test set: Average loss: 0.5217, Accuracy: 10026/12000 (84%)

Epoch 2 | Train Acc: 0.8261875 | Test Acc: 0.8355 | Time: 1.1586041450500488 sec

Test set: Average loss: 0.4538, Accuracy: 10249/12000 (85%)

Epoch 3 | Train Acc: 0.8538541666666667 | Test Acc: 0.8540833333333333 | Time: 1.0274498462677002 sec

Test set: Average loss: 0.4106, Accuracy: 10432/12000 (87%)

Epoch 4 | Train Acc: 0.8708125 | Test Acc: 0.8693333333333333 | Time: 1.3687620162963867 sec

Test set: Average loss: 0.3804, Accuracy: 10565/12000 (88%)

Epoch 5 | Train Acc: 0.8818333333333334 | Test Acc: 0.8804166666666666 | Time: 1.2788572311401367 sec

Test set: Average loss: 0.3593, Accuracy: 10623/12000 (89%)

Epoch 6 | Train Acc: 0.889 | Test Acc: 0.88525 | Time: 1.024310827255249 sec

Test set: Average loss: 0.3454, Accuracy: 10664/12000 (89%)

Epoch 7 | Train Acc: 0.8939166666666667 | Test Acc: 0.8886666666666667 | Time: 1.0237689018249512 sec

Test set: Average loss: 0.3365, Accuracy: 10692/12000 (89%)

Epoch 8 | Train Acc: 0.8976041666666666 | Test Acc: 0.891 | Time: 1.0221736431121826 sec

Test set: Average loss: 0.3306, Accuracy: 10730/12000 (89%)

Epoch 9 | Train Acc: 0.8998541666666666 | Test Acc: 0.8941666666666667 | Time: 1.028151273727417 sec

Test set: Average loss: 0.3267, Accuracy: 10753/12000 (90%)

Epoch 10 | Train Acc: 0.9009375 | Test Acc: 0.8960833333333333 | Time: 1.2658345699310303 sec

Test set: Average loss: 0.3241, Accuracy: 10765/12000 (90%)

Epoch 11 | Train Acc: 0.9019375 | Test Acc: 0.8970833333333333 | Time: 1.0826501846313477 sec

Test set: Average loss: 0.3225, Accuracy: 10775/12000 (90%)

Epoch 12 | Train Acc: 0.9025208333333333 | Test Acc: 0.8979166666666667 | Time: 1.1578898429870605 sec

Test set: Average loss: 0.3214, Accuracy: 10773/12000 (90%)

Epoch 13 | Train Acc: 0.9031458333333333 | Test Acc: 0.89775 | Time: 1.2313106060028076 sec

Test set: Average loss: 0.3206, Accuracy: 10781/12000 (90%)

Epoch 14 | Train Acc: 0.9035625 | Test Acc: 0.8984166666666666 | Time: 1.435945987701416 sec

Test set: Average loss: 0.3200, Accuracy: 10789/12000 (90%)

Epoch 15 | Train Acc: 0.9038125 | Test Acc: 0.8990833333333333 | Time: 1.0772216320037842 sec

Test set: Average loss: 0.3195, Accuracy: 10793/12000 (90%)

Epoch 16 | Train Acc: 0.9040208333333334 | Test Acc: 0.8994166666666666 | Time: 1.023606538772583 sec

Test set: Average loss: 0.3192, Accuracy: 10795/12000 (90%)

Epoch 17 | Train Acc: 0.9041875 | Test Acc: 0.8995833333333333 | Time: 1.0284509658813477 sec

Test set: Average loss: 0.3190, Accuracy: 10792/12000 (90%)

Epoch 18 | Train Acc: 0.9042708333333334 | Test Acc: 0.8993333333333333 | Time: 1.0265402793884277 sec

Test set: Average loss: 0.3189, Accuracy: 10794/12000 (90%)

Epoch 19 | Train Acc: 0.9043333333333333 | Test Acc: 0.8995 | Time: 1.5652339458465576 sec

Test set: Average loss: 0.3188, Accuracy: 10792/12000 (90%)

Epoch 20 | Train Acc: 0.9045208333333333 | Test Acc: 0.8993333333333333 | Time: 1.153148889541626 sec

Baseline test with max_depth=15
Perfect info MNIST DecisionTree Test accuracy (max_depth=15): 0.8812

Results have been saved to json_results/cav_experiment_results.json

Testing with M=15
Step 0000 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 0.9s
Step 0040 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 1.2s
Step 0050 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 1.4s
Step 0060 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 1.7s
Step 0070 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 2.0s
Step 0080 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 2.2s
Step 0090 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 2.4s
Step 0100 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 2.7s
Step 0110 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 2.9s
Step 0120 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 3.2s
Step 0130 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 3.5s
Step 0140 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 3.7s
Step 0150 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 3.9s
Step 0160 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 4.2s
Step 0170 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 4.4s
Step 0180 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 4.6s
Step 0190 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 4.8s
Step 0200 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 5.1s
Step 0210 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 5.4s
Step 0220 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 5.6s
Step 0230 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 5.9s
Step 0240 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 6.2s
Step 0250 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 6.5s
Step 0260 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 6.7s
Step 0270 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 7.0s
Step 0280 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 7.3s
Step 0290 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 7.6s
Step 0300 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 7.9s
Step 0310 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 8.1s
Step 0320 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 8.4s
Step 0330 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 8.6s
Step 0340 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 8.8s
Step 0350 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 9.1s
Step 0360 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 9.3s
Step 0370 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 9.5s
Step 0380 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 9.8s
Step 0390 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 10.0s
Step 0400 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 10.2s
Step 0410 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 10.5s
Step 0420 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 10.7s
Step 0430 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 10.9s
Step 0440 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 11.1s
Step 0450 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 11.4s
Step 0460 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 11.6s
Step 0470 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 11.8s
Step 0480 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 12.1s
Step 0490 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 12.3s
Step 0500 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 12.5s
Step 0510 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 12.8s
Step 0520 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 13.1s
Step 0530 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 13.3s
Step 0540 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 13.6s
Step 0550 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 13.9s
Step 0560 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 14.1s
Step 0570 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 14.4s
Step 0580 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 14.7s
Step 0590 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 15.0s
Step 0600 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 15.2s
Step 0610 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 15.4s
Step 0620 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 15.7s
Step 0630 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 15.9s
Step 0640 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 16.1s
Step 0650 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 16.4s
Step 0660 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 16.7s
Step 0670 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 16.9s
Step 0680 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 17.1s
Step 0690 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 17.4s
Step 0700 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 17.6s
Step 0710 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 17.8s
Step 0720 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 18.0s
Step 0730 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 18.3s
Step 0740 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 18.5s
Step 0750 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 18.7s
Step 0760 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 19.0s
Step 0770 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 19.3s
Step 0780 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 19.5s
Step 0790 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 19.7s
Step 0800 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 20.0s
Step 0810 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 20.2s
Step 0820 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 20.4s
Step 0830 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 20.7s
Step 0840 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 20.9s
Step 0850 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 21.1s
Step 0860 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 21.3s
Step 0870 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 21.6s
Step 0880 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 21.8s
Step 0890 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 22.0s
Step 0900 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 22.3s
Step 0910 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 22.5s
Step 0920 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 22.7s
Step 0930 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 22.9s
Step 0940 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 23.2s
Step 0950 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 23.5s
Step 0960 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 23.8s
Step 0970 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 24.0s
Step 0980 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 24.3s
Step 0990 | Epoch 01 | Objective: 0.0000 | Coherence: 34.7355 | Separation: 57.4352 | Information gain: 6.6667 | Grad Norm: 0.0000 | Time: 24.5s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.564168  0.462660  0.460263  ...  0.539198  0.494941  0.526213
1  0.472504  0.583871  0.460428  ...  0.504816  0.501050  0.531763
2  0.475619  0.479909  0.626887  ...  0.535033  0.409911  0.544723
3  0.518089  0.397557  0.310249  ...  0.438774  0.440733  0.432042
4  0.515774  0.555969  0.479313  ...  0.527029  0.511434  0.574115

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7645
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8798
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8580
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.1825, accuracy=0.0866
Testing SVM
  SVM Test Accuracy: 0.8452
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8174

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7970, Accuracy: 8944/12000 (75%)

Epoch 1 | Train Acc: 0.584375 | Test Acc: 0.7453333333333333 | Time: 1.0231518745422363 sec

Test set: Average loss: 0.5645, Accuracy: 9888/12000 (82%)

Epoch 2 | Train Acc: 0.7788333333333334 | Test Acc: 0.824 | Time: 1.018336296081543 sec

Test set: Average loss: 0.4793, Accuracy: 10177/12000 (85%)

Epoch 3 | Train Acc: 0.82475 | Test Acc: 0.8480833333333333 | Time: 1.0258309841156006 sec

Test set: Average loss: 0.4346, Accuracy: 10335/12000 (86%)

Epoch 4 | Train Acc: 0.8459583333333334 | Test Acc: 0.86125 | Time: 1.0991184711456299 sec

Test set: Average loss: 0.4091, Accuracy: 10423/12000 (87%)

Epoch 5 | Train Acc: 0.8593125 | Test Acc: 0.8685833333333334 | Time: 1.1421396732330322 sec

Test set: Average loss: 0.3935, Accuracy: 10475/12000 (87%)

Epoch 6 | Train Acc: 0.8675208333333333 | Test Acc: 0.8729166666666667 | Time: 1.1097803115844727 sec

Test set: Average loss: 0.3842, Accuracy: 10507/12000 (88%)

Epoch 7 | Train Acc: 0.8725625 | Test Acc: 0.8755833333333334 | Time: 1.157609224319458 sec

Test set: Average loss: 0.3777, Accuracy: 10538/12000 (88%)

Epoch 8 | Train Acc: 0.8759791666666666 | Test Acc: 0.8781666666666667 | Time: 1.3941066265106201 sec

Test set: Average loss: 0.3735, Accuracy: 10555/12000 (88%)

Epoch 9 | Train Acc: 0.8785416666666667 | Test Acc: 0.8795833333333334 | Time: 1.1129090785980225 sec

Test set: Average loss: 0.3700, Accuracy: 10583/12000 (88%)

Epoch 10 | Train Acc: 0.8799583333333333 | Test Acc: 0.8819166666666667 | Time: 1.3133039474487305 sec

Test set: Average loss: 0.3674, Accuracy: 10593/12000 (88%)

Epoch 11 | Train Acc: 0.8812708333333333 | Test Acc: 0.88275 | Time: 1.0630195140838623 sec

Test set: Average loss: 0.3654, Accuracy: 10604/12000 (88%)

Epoch 12 | Train Acc: 0.8819375 | Test Acc: 0.8836666666666667 | Time: 1.0216455459594727 sec

Test set: Average loss: 0.3642, Accuracy: 10608/12000 (88%)

Epoch 13 | Train Acc: 0.8827083333333333 | Test Acc: 0.884 | Time: 1.0263681411743164 sec

Test set: Average loss: 0.3633, Accuracy: 10610/12000 (88%)

Epoch 14 | Train Acc: 0.8833958333333334 | Test Acc: 0.8841666666666667 | Time: 1.13515305519104 sec

Test set: Average loss: 0.3627, Accuracy: 10607/12000 (88%)

Epoch 15 | Train Acc: 0.8836666666666667 | Test Acc: 0.8839166666666667 | Time: 1.3186938762664795 sec

Test set: Average loss: 0.3624, Accuracy: 10606/12000 (88%)

Epoch 16 | Train Acc: 0.8841458333333333 | Test Acc: 0.8838333333333334 | Time: 1.1221871376037598 sec

Test set: Average loss: 0.3621, Accuracy: 10604/12000 (88%)

Epoch 17 | Train Acc: 0.884375 | Test Acc: 0.8836666666666667 | Time: 1.0344133377075195 sec

Test set: Average loss: 0.3620, Accuracy: 10606/12000 (88%)

Epoch 18 | Train Acc: 0.8843333333333333 | Test Acc: 0.8838333333333334 | Time: 1.3131344318389893 sec

Test set: Average loss: 0.3619, Accuracy: 10609/12000 (88%)

Epoch 19 | Train Acc: 0.8842708333333333 | Test Acc: 0.8840833333333333 | Time: 1.1421878337860107 sec
Early stopping at epoch 19

Testing with M=15
Step 0000 | Epoch 01 | Objective: 2.5556 | Coherence: 12.5301 | Separation: 59.7177 | Information gain: 7.6667 | Grad Norm: 0.0000 | Time: 0.0s
Step 0001 | Epoch 01 | Objective: 2.5556 | Coherence: 12.5301 | Separation: 59.7177 | Information gain: 7.6667 | Grad Norm: 0.0000 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.569621  0.526301  0.373661  ...  0.506762  0.464689 -0.421923
1 -0.537714  0.611160  0.500283  ...  0.474309  0.508421 -0.504296
2 -0.399277  0.526186  0.641045  ...  0.420178  0.544827 -0.549121
3 -0.555464  0.611556  0.500861  ...  0.520705  0.539943 -0.548102
4 -0.455482  0.445206  0.330673  ...  0.539259  0.443882 -0.509666

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7794
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8881
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8713
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0923, accuracy=0.0996
Testing SVM
  SVM Test Accuracy: 0.8501
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8192

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7233, Accuracy: 9502/12000 (79%)

Epoch 1 | Train Acc: 0.6387916666666666 | Test Acc: 0.7918333333333333 | Time: 1.0284221172332764 sec

Test set: Average loss: 0.5256, Accuracy: 10036/12000 (84%)

Epoch 2 | Train Acc: 0.8100208333333333 | Test Acc: 0.8363333333333334 | Time: 1.0259912014007568 sec

Test set: Average loss: 0.4585, Accuracy: 10265/12000 (86%)

Epoch 3 | Train Acc: 0.8419166666666666 | Test Acc: 0.8554166666666667 | Time: 1.0219099521636963 sec

Test set: Average loss: 0.4261, Accuracy: 10362/12000 (86%)

Epoch 4 | Train Acc: 0.8592083333333334 | Test Acc: 0.8635 | Time: 1.1535615921020508 sec

Test set: Average loss: 0.4029, Accuracy: 10449/12000 (87%)

Epoch 5 | Train Acc: 0.8695625 | Test Acc: 0.87075 | Time: 1.0202383995056152 sec

Test set: Average loss: 0.3883, Accuracy: 10497/12000 (87%)

Epoch 6 | Train Acc: 0.8770833333333333 | Test Acc: 0.87475 | Time: 1.0217640399932861 sec

Test set: Average loss: 0.3780, Accuracy: 10546/12000 (88%)

Epoch 7 | Train Acc: 0.8811875 | Test Acc: 0.8788333333333334 | Time: 1.025559425354004 sec

Test set: Average loss: 0.3706, Accuracy: 10570/12000 (88%)

Epoch 8 | Train Acc: 0.884625 | Test Acc: 0.8808333333333334 | Time: 1.147674322128296 sec

Test set: Average loss: 0.3654, Accuracy: 10587/12000 (88%)

Epoch 9 | Train Acc: 0.88725 | Test Acc: 0.88225 | Time: 1.1815412044525146 sec

Test set: Average loss: 0.3616, Accuracy: 10607/12000 (88%)

Epoch 10 | Train Acc: 0.8887083333333333 | Test Acc: 0.8839166666666667 | Time: 1.0466525554656982 sec

Test set: Average loss: 0.3588, Accuracy: 10627/12000 (89%)

Epoch 11 | Train Acc: 0.8900833333333333 | Test Acc: 0.8855833333333333 | Time: 1.0275044441223145 sec

Test set: Average loss: 0.3569, Accuracy: 10634/12000 (89%)

Epoch 12 | Train Acc: 0.8909166666666667 | Test Acc: 0.8861666666666667 | Time: 1.020986795425415 sec

Test set: Average loss: 0.3556, Accuracy: 10638/12000 (89%)

Epoch 13 | Train Acc: 0.8914375 | Test Acc: 0.8865 | Time: 1.1157443523406982 sec

Test set: Average loss: 0.3547, Accuracy: 10634/12000 (89%)

Epoch 14 | Train Acc: 0.891875 | Test Acc: 0.8861666666666667 | Time: 1.0214078426361084 sec

Test set: Average loss: 0.3542, Accuracy: 10644/12000 (89%)

Epoch 15 | Train Acc: 0.89225 | Test Acc: 0.887 | Time: 1.0276131629943848 sec

Test set: Average loss: 0.3539, Accuracy: 10648/12000 (89%)

Epoch 16 | Train Acc: 0.8926041666666666 | Test Acc: 0.8873333333333333 | Time: 1.0314831733703613 sec

Test set: Average loss: 0.3537, Accuracy: 10652/12000 (89%)

Epoch 17 | Train Acc: 0.892875 | Test Acc: 0.8876666666666667 | Time: 1.104142427444458 sec

Test set: Average loss: 0.3535, Accuracy: 10652/12000 (89%)

Epoch 18 | Train Acc: 0.8928958333333333 | Test Acc: 0.8876666666666667 | Time: 1.0663797855377197 sec

Test set: Average loss: 0.3534, Accuracy: 10652/12000 (89%)

Epoch 19 | Train Acc: 0.8928541666666666 | Test Acc: 0.8876666666666667 | Time: 1.039292335510254 sec

Test set: Average loss: 0.3534, Accuracy: 10652/12000 (89%)

Epoch 20 | Train Acc: 0.8928541666666666 | Test Acc: 0.8876666666666667 | Time: 1.0283846855163574 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: 4.5556 | Coherence: 2.3258 | Separation: 49.7056 | Information gain: 6.8333 | Grad Norm: 0.0000 | Time: 0.0s
Step 0001 | Epoch 01 | Objective: 4.5556 | Coherence: 2.3258 | Separation: 49.7056 | Information gain: 6.8333 | Grad Norm: 0.0000 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.567682 -0.328962 -0.514372  ... -0.407289  0.512123 -0.499918
1 -0.335865 -0.624524 -0.430188  ... -0.545148  0.350208 -0.418592
2 -0.522307 -0.422106 -0.593910  ... -0.514678  0.536464 -0.471864
3 -0.379226 -0.538004 -0.383054  ... -0.451949  0.351385 -0.421666
4 -0.465441 -0.456641 -0.552618  ... -0.512281  0.494220 -0.428213

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7964
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9026
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8811
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.1433, accuracy=0.0858
Testing SVM
  SVM Test Accuracy: 0.8591
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8288

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7186, Accuracy: 9204/12000 (77%)

Epoch 1 | Train Acc: 0.6669166666666667 | Test Acc: 0.767 | Time: 1.0594818592071533 sec

Test set: Average loss: 0.5369, Accuracy: 9886/12000 (82%)

Epoch 2 | Train Acc: 0.8183541666666667 | Test Acc: 0.8238333333333333 | Time: 1.0247294902801514 sec

Test set: Average loss: 0.4522, Accuracy: 10257/12000 (85%)

Epoch 3 | Train Acc: 0.852125 | Test Acc: 0.85475 | Time: 1.1669127941131592 sec

Test set: Average loss: 0.4034, Accuracy: 10470/12000 (87%)

Epoch 4 | Train Acc: 0.8713333333333333 | Test Acc: 0.8725 | Time: 1.241828441619873 sec

Test set: Average loss: 0.3739, Accuracy: 10601/12000 (88%)

Epoch 5 | Train Acc: 0.8822083333333334 | Test Acc: 0.8834166666666666 | Time: 1.0255239009857178 sec

Test set: Average loss: 0.3525, Accuracy: 10697/12000 (89%)

Epoch 6 | Train Acc: 0.8900416666666666 | Test Acc: 0.8914166666666666 | Time: 1.0251476764678955 sec

Test set: Average loss: 0.3386, Accuracy: 10764/12000 (90%)

Epoch 7 | Train Acc: 0.8954791666666667 | Test Acc: 0.897 | Time: 1.0218169689178467 sec

Test set: Average loss: 0.3292, Accuracy: 10791/12000 (90%)

Epoch 8 | Train Acc: 0.8997708333333333 | Test Acc: 0.89925 | Time: 1.0225598812103271 sec

Test set: Average loss: 0.3226, Accuracy: 10820/12000 (90%)

Epoch 9 | Train Acc: 0.9021041666666667 | Test Acc: 0.9016666666666666 | Time: 1.0234019756317139 sec

Test set: Average loss: 0.3190, Accuracy: 10836/12000 (90%)

Epoch 10 | Train Acc: 0.9037083333333333 | Test Acc: 0.903 | Time: 1.1390399932861328 sec

Test set: Average loss: 0.3165, Accuracy: 10843/12000 (90%)

Epoch 11 | Train Acc: 0.9047916666666667 | Test Acc: 0.9035833333333333 | Time: 1.0229742527008057 sec

Test set: Average loss: 0.3149, Accuracy: 10842/12000 (90%)

Epoch 12 | Train Acc: 0.9054583333333334 | Test Acc: 0.9035 | Time: 1.027653455734253 sec

Test set: Average loss: 0.3138, Accuracy: 10844/12000 (90%)

Epoch 13 | Train Acc: 0.9060208333333334 | Test Acc: 0.9036666666666666 | Time: 1.059896469116211 sec

Test set: Average loss: 0.3130, Accuracy: 10844/12000 (90%)

Epoch 14 | Train Acc: 0.9063958333333333 | Test Acc: 0.9036666666666666 | Time: 1.026947259902954 sec

Test set: Average loss: 0.3125, Accuracy: 10854/12000 (90%)

Epoch 15 | Train Acc: 0.9069375 | Test Acc: 0.9045 | Time: 1.0243103504180908 sec

Test set: Average loss: 0.3121, Accuracy: 10853/12000 (90%)

Epoch 16 | Train Acc: 0.9071458333333333 | Test Acc: 0.9044166666666666 | Time: 1.024646520614624 sec

Test set: Average loss: 0.3118, Accuracy: 10854/12000 (90%)

Epoch 17 | Train Acc: 0.9072083333333333 | Test Acc: 0.9045 | Time: 1.0291721820831299 sec

Test set: Average loss: 0.3116, Accuracy: 10852/12000 (90%)

Epoch 18 | Train Acc: 0.9073333333333333 | Test Acc: 0.9043333333333333 | Time: 1.022566795349121 sec

Test set: Average loss: 0.3115, Accuracy: 10854/12000 (90%)

Epoch 19 | Train Acc: 0.9075 | Test Acc: 0.9045 | Time: 1.14656662940979 sec

Test set: Average loss: 0.3115, Accuracy: 10855/12000 (90%)

Epoch 20 | Train Acc: 0.907375 | Test Acc: 0.9045833333333333 | Time: 1.1360738277435303 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: 8.0000 | Coherence: 22.9868 | Separation: 54.5862 | Information gain: 8.0000 | Grad Norm: 0.0000 | Time: 0.1s
Step 0001 | Epoch 01 | Objective: 8.0000 | Coherence: 22.9868 | Separation: 54.5862 | Information gain: 8.0000 | Grad Norm: 0.0000 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.598919  0.521405  0.486658  ...  0.491199  0.575703  0.491937
1 -0.554744  0.615395  0.513072  ...  0.450823  0.552078  0.504375
2 -0.487661  0.488026  0.590316  ...  0.487846  0.484504  0.585883
3 -0.485265  0.441583  0.472235  ...  0.473240  0.499433  0.479057
4 -0.441899  0.415476  0.471848  ...  0.472218  0.464090  0.477153

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8068
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8962
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8820
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.9681, accuracy=0.1032
Testing SVM
  SVM Test Accuracy: 0.8565
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8262

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6549, Accuracy: 9575/12000 (80%)

Epoch 1 | Train Acc: 0.6781875 | Test Acc: 0.7979166666666667 | Time: 1.0281908512115479 sec

Test set: Average loss: 0.4874, Accuracy: 10145/12000 (85%)

Epoch 2 | Train Acc: 0.8266875 | Test Acc: 0.8454166666666667 | Time: 1.0247218608856201 sec

Test set: Average loss: 0.4324, Accuracy: 10320/12000 (86%)

Epoch 3 | Train Acc: 0.8514583333333333 | Test Acc: 0.86 | Time: 1.0288493633270264 sec

Test set: Average loss: 0.4029, Accuracy: 10428/12000 (87%)

Epoch 4 | Train Acc: 0.8655833333333334 | Test Acc: 0.869 | Time: 1.0258817672729492 sec

Test set: Average loss: 0.3831, Accuracy: 10488/12000 (87%)

Epoch 5 | Train Acc: 0.87375 | Test Acc: 0.874 | Time: 1.0440514087677002 sec

Test set: Average loss: 0.3704, Accuracy: 10558/12000 (88%)

Epoch 6 | Train Acc: 0.8791458333333333 | Test Acc: 0.8798333333333334 | Time: 1.2739439010620117 sec

Test set: Average loss: 0.3632, Accuracy: 10598/12000 (88%)

Epoch 7 | Train Acc: 0.8837708333333333 | Test Acc: 0.8831666666666667 | Time: 1.2466516494750977 sec

Test set: Average loss: 0.3573, Accuracy: 10616/12000 (88%)

Epoch 8 | Train Acc: 0.8871458333333333 | Test Acc: 0.8846666666666667 | Time: 1.0243635177612305 sec

Test set: Average loss: 0.3529, Accuracy: 10647/12000 (89%)

Epoch 9 | Train Acc: 0.8890833333333333 | Test Acc: 0.88725 | Time: 1.0242576599121094 sec

Test set: Average loss: 0.3494, Accuracy: 10655/12000 (89%)

Epoch 10 | Train Acc: 0.8901666666666667 | Test Acc: 0.8879166666666667 | Time: 1.0175693035125732 sec

Test set: Average loss: 0.3470, Accuracy: 10665/12000 (89%)

Epoch 11 | Train Acc: 0.8914166666666666 | Test Acc: 0.88875 | Time: 1.0180432796478271 sec

Test set: Average loss: 0.3455, Accuracy: 10671/12000 (89%)

Epoch 12 | Train Acc: 0.8917083333333333 | Test Acc: 0.88925 | Time: 1.0234622955322266 sec

Test set: Average loss: 0.3446, Accuracy: 10678/12000 (89%)

Epoch 13 | Train Acc: 0.8926875 | Test Acc: 0.8898333333333334 | Time: 1.0219087600708008 sec

Test set: Average loss: 0.3439, Accuracy: 10687/12000 (89%)

Epoch 14 | Train Acc: 0.8929166666666667 | Test Acc: 0.8905833333333333 | Time: 1.0234670639038086 sec

Test set: Average loss: 0.3434, Accuracy: 10701/12000 (89%)

Epoch 15 | Train Acc: 0.8932291666666666 | Test Acc: 0.89175 | Time: 1.0248024463653564 sec

Test set: Average loss: 0.3430, Accuracy: 10709/12000 (89%)

Epoch 16 | Train Acc: 0.8932916666666667 | Test Acc: 0.8924166666666666 | Time: 1.1209676265716553 sec

Test set: Average loss: 0.3427, Accuracy: 10711/12000 (89%)

Epoch 17 | Train Acc: 0.8936458333333334 | Test Acc: 0.8925833333333333 | Time: 1.0232460498809814 sec

Test set: Average loss: 0.3425, Accuracy: 10714/12000 (89%)

Epoch 18 | Train Acc: 0.8937083333333333 | Test Acc: 0.8928333333333334 | Time: 1.0368828773498535 sec

Test set: Average loss: 0.3424, Accuracy: 10715/12000 (89%)

Epoch 19 | Train Acc: 0.8936875 | Test Acc: 0.8929166666666667 | Time: 1.2723989486694336 sec

Test set: Average loss: 0.3423, Accuracy: 10716/12000 (89%)

Epoch 20 | Train Acc: 0.89375 | Test Acc: 0.893 | Time: 1.1888220310211182 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -17.8711 | Coherence: 24.9427 | Separation: 53.6132 | Information gain: 6.3333 | Grad Norm: 12.6453 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -17.3917 | Coherence: 24.7959 | Separation: 52.1751 | Information gain: 6.3333 | Grad Norm: 11.8351 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -16.9853 | Coherence: 24.5585 | Separation: 50.9560 | Information gain: 6.3333 | Grad Norm: 11.5381 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -16.6035 | Coherence: 24.3131 | Separation: 49.8104 | Information gain: 6.3333 | Grad Norm: 11.5935 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: -16.1979 | Coherence: 24.0665 | Separation: 48.5936 | Information gain: 6.3333 | Grad Norm: 11.4300 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -15.7876 | Coherence: 23.8377 | Separation: 47.3629 | Information gain: 6.3333 | Grad Norm: 11.2171 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -15.3440 | Coherence: 23.6208 | Separation: 46.0319 | Information gain: 6.3333 | Grad Norm: 11.0048 | Time: 1.5s
Step 0070 | Epoch 01 | Objective: -14.9069 | Coherence: 23.4181 | Separation: 44.7206 | Information gain: 6.3333 | Grad Norm: 10.9094 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -14.4898 | Coherence: 23.2662 | Separation: 43.4695 | Information gain: 6.3333 | Grad Norm: 10.4835 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -14.1058 | Coherence: 23.1058 | Separation: 42.3175 | Information gain: 6.3333 | Grad Norm: 10.6365 | Time: 2.2s
Step 0100 | Epoch 01 | Objective: -13.7252 | Coherence: 22.9527 | Separation: 41.1756 | Information gain: 6.1667 | Grad Norm: 10.5568 | Time: 2.4s
Step 0110 | Epoch 01 | Objective: -13.3501 | Coherence: 22.8175 | Separation: 40.0503 | Information gain: 6.3333 | Grad Norm: 10.2791 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -12.9727 | Coherence: 22.6882 | Separation: 38.9181 | Information gain: 6.3333 | Grad Norm: 10.3931 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -12.5960 | Coherence: 22.5653 | Separation: 37.7880 | Information gain: 6.3333 | Grad Norm: 10.3330 | Time: 3.1s
Step 0140 | Epoch 01 | Objective: -12.1961 | Coherence: 22.4093 | Separation: 36.5883 | Information gain: 6.3333 | Grad Norm: 9.8491 | Time: 3.3s
Step 0150 | Epoch 01 | Objective: -11.7841 | Coherence: 22.2560 | Separation: 35.3522 | Information gain: 6.3333 | Grad Norm: 9.7827 | Time: 3.5s
Step 0160 | Epoch 01 | Objective: -11.4416 | Coherence: 22.1194 | Separation: 34.3249 | Information gain: 6.3333 | Grad Norm: 9.5418 | Time: 3.7s
Step 0170 | Epoch 01 | Objective: -11.1442 | Coherence: 21.9971 | Separation: 33.4327 | Information gain: 6.3333 | Grad Norm: 9.1301 | Time: 4.0s
Step 0180 | Epoch 01 | Objective: -10.9373 | Coherence: 21.8876 | Separation: 32.8119 | Information gain: 6.3333 | Grad Norm: 8.7642 | Time: 4.2s
Step 0190 | Epoch 01 | Objective: -10.7404 | Coherence: 21.8264 | Separation: 32.2211 | Information gain: 6.3333 | Grad Norm: 9.1947 | Time: 4.4s
Step 0200 | Epoch 01 | Objective: -10.5461 | Coherence: 21.7579 | Separation: 31.6383 | Information gain: 6.1667 | Grad Norm: 9.4150 | Time: 4.6s
Step 0210 | Epoch 01 | Objective: -10.3425 | Coherence: 21.6741 | Separation: 31.0274 | Information gain: 6.1667 | Grad Norm: 9.1983 | Time: 4.9s
Step 0220 | Epoch 01 | Objective: -10.1401 | Coherence: 21.5995 | Separation: 30.4202 | Information gain: 6.1667 | Grad Norm: 9.0904 | Time: 5.1s
Step 0230 | Epoch 01 | Objective: -9.9533 | Coherence: 21.5505 | Separation: 29.8600 | Information gain: 6.1667 | Grad Norm: 8.9830 | Time: 5.3s
Step 0240 | Epoch 01 | Objective: -9.7658 | Coherence: 21.5138 | Separation: 29.2974 | Information gain: 6.1667 | Grad Norm: 8.8423 | Time: 5.6s
Step 0250 | Epoch 01 | Objective: -9.5800 | Coherence: 21.4635 | Separation: 28.7401 | Information gain: 6.1667 | Grad Norm: 9.4105 | Time: 5.8s
Step 0260 | Epoch 01 | Objective: -9.4053 | Coherence: 21.3890 | Separation: 28.2160 | Information gain: 6.1667 | Grad Norm: 9.0752 | Time: 6.0s
Step 0270 | Epoch 01 | Objective: -9.2435 | Coherence: 21.2953 | Separation: 27.7305 | Information gain: 6.1667 | Grad Norm: 8.9102 | Time: 6.3s
Step 0280 | Epoch 01 | Objective: -9.0959 | Coherence: 21.2280 | Separation: 27.2878 | Information gain: 6.1667 | Grad Norm: 8.5032 | Time: 6.5s
Step 0290 | Epoch 01 | Objective: -8.9408 | Coherence: 21.1633 | Separation: 26.8224 | Information gain: 6.3333 | Grad Norm: 9.1012 | Time: 6.7s
Step 0300 | Epoch 01 | Objective: -8.7934 | Coherence: 21.0993 | Separation: 26.3801 | Information gain: 6.3333 | Grad Norm: 8.6786 | Time: 6.9s
Step 0310 | Epoch 01 | Objective: -8.6647 | Coherence: 21.0446 | Separation: 25.9940 | Information gain: 6.3333 | Grad Norm: 9.0691 | Time: 7.2s
Step 0320 | Epoch 01 | Objective: -8.5375 | Coherence: 21.0274 | Separation: 25.6126 | Information gain: 6.3333 | Grad Norm: 9.1705 | Time: 7.4s
Step 0330 | Epoch 01 | Objective: -8.4394 | Coherence: 21.0095 | Separation: 25.3182 | Information gain: 6.3333 | Grad Norm: 8.2443 | Time: 7.6s
Step 0340 | Epoch 01 | Objective: -8.3365 | Coherence: 21.0122 | Separation: 25.0095 | Information gain: 6.3333 | Grad Norm: 8.6574 | Time: 7.8s
Step 0350 | Epoch 01 | Objective: -8.2307 | Coherence: 21.0013 | Separation: 24.6922 | Information gain: 6.3333 | Grad Norm: 8.6575 | Time: 8.0s
Step 0360 | Epoch 01 | Objective: -8.1165 | Coherence: 21.0108 | Separation: 24.3494 | Information gain: 6.3333 | Grad Norm: 8.7179 | Time: 8.3s
Step 0370 | Epoch 01 | Objective: -8.0273 | Coherence: 21.0402 | Separation: 24.0819 | Information gain: 6.3333 | Grad Norm: 8.6931 | Time: 8.5s
Step 0380 | Epoch 01 | Objective: -7.9357 | Coherence: 21.1339 | Separation: 23.8070 | Information gain: 6.3333 | Grad Norm: 8.6295 | Time: 8.7s
Step 0390 | Epoch 01 | Objective: -7.8468 | Coherence: 21.2159 | Separation: 23.5403 | Information gain: 6.5000 | Grad Norm: 9.2876 | Time: 8.9s
Step 0400 | Epoch 01 | Objective: -7.7910 | Coherence: 21.3034 | Separation: 23.3731 | Information gain: 6.5000 | Grad Norm: 8.5961 | Time: 9.2s
Step 0410 | Epoch 01 | Objective: -7.7371 | Coherence: 21.3702 | Separation: 23.2114 | Information gain: 6.5000 | Grad Norm: 8.8695 | Time: 9.4s
Step 0420 | Epoch 01 | Objective: -7.6846 | Coherence: 21.4532 | Separation: 23.0538 | Information gain: 6.5000 | Grad Norm: 9.3158 | Time: 9.6s
Step 0430 | Epoch 01 | Objective: -7.6300 | Coherence: 21.5557 | Separation: 22.8900 | Information gain: 6.5000 | Grad Norm: 8.7974 | Time: 9.9s
Step 0440 | Epoch 01 | Objective: -7.5786 | Coherence: 21.6726 | Separation: 22.7357 | Information gain: 6.5000 | Grad Norm: 9.1331 | Time: 10.1s
Step 0450 | Epoch 01 | Objective: -7.5325 | Coherence: 21.8097 | Separation: 22.5975 | Information gain: 6.5000 | Grad Norm: 8.9112 | Time: 10.3s
Step 0460 | Epoch 01 | Objective: -7.4877 | Coherence: 21.9638 | Separation: 22.4632 | Information gain: 6.5000 | Grad Norm: 8.4679 | Time: 10.5s
Step 0470 | Epoch 01 | Objective: -7.4438 | Coherence: 22.0836 | Separation: 22.3313 | Information gain: 6.5000 | Grad Norm: 9.9214 | Time: 10.8s
Step 0480 | Epoch 01 | Objective: -7.3978 | Coherence: 22.2219 | Separation: 22.1933 | Information gain: 6.5000 | Grad Norm: 9.0806 | Time: 11.1s
Step 0490 | Epoch 01 | Objective: -7.3456 | Coherence: 22.3605 | Separation: 22.0367 | Information gain: 6.5000 | Grad Norm: 9.0013 | Time: 11.3s
Step 0500 | Epoch 01 | Objective: -7.2986 | Coherence: 22.5034 | Separation: 21.8957 | Information gain: 6.5000 | Grad Norm: 8.6380 | Time: 11.6s
Step 0510 | Epoch 01 | Objective: -7.2511 | Coherence: 22.6422 | Separation: 21.7533 | Information gain: 6.5000 | Grad Norm: 9.4172 | Time: 11.8s
Step 0520 | Epoch 01 | Objective: -7.1991 | Coherence: 22.7952 | Separation: 21.5972 | Information gain: 6.5000 | Grad Norm: 9.6062 | Time: 12.1s
Step 0530 | Epoch 01 | Objective: -7.1436 | Coherence: 22.9334 | Separation: 21.4307 | Information gain: 6.5000 | Grad Norm: 9.4063 | Time: 12.4s
Step 0540 | Epoch 01 | Objective: -7.0848 | Coherence: 23.0671 | Separation: 21.2543 | Information gain: 6.5000 | Grad Norm: 8.9300 | Time: 12.6s
Step 0550 | Epoch 01 | Objective: -7.0223 | Coherence: 23.2137 | Separation: 21.0669 | Information gain: 6.6667 | Grad Norm: 9.4057 | Time: 12.8s
Step 0560 | Epoch 01 | Objective: -6.9538 | Coherence: 23.3715 | Separation: 20.8614 | Information gain: 6.5000 | Grad Norm: 8.8616 | Time: 13.1s
Step 0570 | Epoch 01 | Objective: -6.8793 | Coherence: 23.5305 | Separation: 20.6379 | Information gain: 6.5000 | Grad Norm: 9.0164 | Time: 13.3s
Step 0580 | Epoch 01 | Objective: -6.8005 | Coherence: 23.7010 | Separation: 20.4016 | Information gain: 6.5000 | Grad Norm: 9.0117 | Time: 13.6s
Step 0590 | Epoch 01 | Objective: -6.7219 | Coherence: 23.8562 | Separation: 20.1656 | Information gain: 6.5000 | Grad Norm: 9.4391 | Time: 13.8s
Step 0600 | Epoch 01 | Objective: -6.6336 | Coherence: 24.0358 | Separation: 19.9009 | Information gain: 6.5000 | Grad Norm: 8.4695 | Time: 14.0s
Step 0610 | Epoch 01 | Objective: -6.5429 | Coherence: 24.1974 | Separation: 19.6286 | Information gain: 6.5000 | Grad Norm: 8.6962 | Time: 14.2s
Step 0620 | Epoch 01 | Objective: -6.4488 | Coherence: 24.3756 | Separation: 19.3463 | Information gain: 6.5000 | Grad Norm: 9.7726 | Time: 14.5s
Step 0630 | Epoch 01 | Objective: -6.3455 | Coherence: 24.5503 | Separation: 19.0365 | Information gain: 6.5000 | Grad Norm: 9.3676 | Time: 14.7s
Step 0640 | Epoch 01 | Objective: -6.2400 | Coherence: 24.7276 | Separation: 18.7200 | Information gain: 6.6667 | Grad Norm: 8.9409 | Time: 14.9s
Step 0650 | Epoch 01 | Objective: -6.1335 | Coherence: 24.8822 | Separation: 18.4005 | Information gain: 6.8333 | Grad Norm: 9.1712 | Time: 15.2s
Step 0660 | Epoch 01 | Objective: -6.0451 | Coherence: 25.0349 | Separation: 18.1354 | Information gain: 6.8333 | Grad Norm: 9.2986 | Time: 15.4s
Step 0670 | Epoch 01 | Objective: -5.9534 | Coherence: 25.1840 | Separation: 17.8601 | Information gain: 6.8333 | Grad Norm: 9.2187 | Time: 15.6s
Step 0680 | Epoch 01 | Objective: -5.8633 | Coherence: 25.3077 | Separation: 17.5900 | Information gain: 6.6667 | Grad Norm: 9.3476 | Time: 15.9s
Step 0690 | Epoch 01 | Objective: -5.7695 | Coherence: 25.4391 | Separation: 17.3084 | Information gain: 6.6667 | Grad Norm: 9.1202 | Time: 16.1s
Step 0700 | Epoch 01 | Objective: -5.6711 | Coherence: 25.5772 | Separation: 17.0134 | Information gain: 6.5000 | Grad Norm: 9.0724 | Time: 16.3s
Step 0710 | Epoch 01 | Objective: -5.5845 | Coherence: 25.7149 | Separation: 16.7534 | Information gain: 6.3333 | Grad Norm: 9.3541 | Time: 16.5s
Step 0720 | Epoch 01 | Objective: -5.5072 | Coherence: 25.7742 | Separation: 16.5215 | Information gain: 6.3333 | Grad Norm: 9.6367 | Time: 16.8s
Step 0730 | Epoch 01 | Objective: -5.4407 | Coherence: 25.8372 | Separation: 16.3220 | Information gain: 6.5000 | Grad Norm: 9.3861 | Time: 17.0s
Step 0740 | Epoch 01 | Objective: -5.3763 | Coherence: 25.9034 | Separation: 16.1290 | Information gain: 6.5000 | Grad Norm: 9.1757 | Time: 17.2s
Step 0750 | Epoch 01 | Objective: -5.3142 | Coherence: 25.9567 | Separation: 15.9427 | Information gain: 6.5000 | Grad Norm: 9.9260 | Time: 17.4s
Step 0760 | Epoch 01 | Objective: -5.2505 | Coherence: 26.0223 | Separation: 15.7515 | Information gain: 6.5000 | Grad Norm: 10.3976 | Time: 17.7s
Step 0770 | Epoch 01 | Objective: -5.1907 | Coherence: 26.0830 | Separation: 15.5722 | Information gain: 6.5000 | Grad Norm: 10.5453 | Time: 17.9s
Step 0780 | Epoch 01 | Objective: -5.1244 | Coherence: 26.1316 | Separation: 15.3732 | Information gain: 6.5000 | Grad Norm: 9.9911 | Time: 18.1s
Step 0790 | Epoch 01 | Objective: -5.0617 | Coherence: 26.1808 | Separation: 15.1852 | Information gain: 6.3333 | Grad Norm: 10.0126 | Time: 18.3s
Step 0800 | Epoch 01 | Objective: -5.0071 | Coherence: 26.2300 | Separation: 15.0214 | Information gain: 6.3333 | Grad Norm: 9.9398 | Time: 18.6s
Step 0810 | Epoch 01 | Objective: -4.9552 | Coherence: 26.2298 | Separation: 14.8655 | Information gain: 6.3333 | Grad Norm: 10.0057 | Time: 18.8s
Step 0820 | Epoch 01 | Objective: -4.9052 | Coherence: 26.2516 | Separation: 14.7157 | Information gain: 6.1667 | Grad Norm: 10.0089 | Time: 19.0s
Step 0830 | Epoch 01 | Objective: -4.8578 | Coherence: 26.2779 | Separation: 14.5735 | Information gain: 6.1667 | Grad Norm: 9.6691 | Time: 19.3s
Step 0840 | Epoch 01 | Objective: -4.8075 | Coherence: 26.2913 | Separation: 14.4225 | Information gain: 6.1667 | Grad Norm: 10.3032 | Time: 19.5s
Step 0850 | Epoch 01 | Objective: -4.7578 | Coherence: 26.3156 | Separation: 14.2733 | Information gain: 6.1667 | Grad Norm: 10.8065 | Time: 19.7s
Step 0860 | Epoch 01 | Objective: -4.7050 | Coherence: 26.3291 | Separation: 14.1151 | Information gain: 6.1667 | Grad Norm: 10.0130 | Time: 19.9s
Step 0870 | Epoch 01 | Objective: -4.6769 | Coherence: 26.3159 | Separation: 14.0308 | Information gain: 6.1667 | Grad Norm: 10.0916 | Time: 20.2s
Step 0880 | Epoch 01 | Objective: -4.6463 | Coherence: 26.2830 | Separation: 13.9389 | Information gain: 6.1667 | Grad Norm: 9.8767 | Time: 20.4s
Step 0890 | Epoch 01 | Objective: -4.6158 | Coherence: 26.2605 | Separation: 13.8473 | Information gain: 6.1667 | Grad Norm: 10.4299 | Time: 20.6s
Step 0900 | Epoch 01 | Objective: -4.5827 | Coherence: 26.2420 | Separation: 13.7480 | Information gain: 6.1667 | Grad Norm: 10.1576 | Time: 20.8s
Step 0910 | Epoch 01 | Objective: -4.5501 | Coherence: 26.2168 | Separation: 13.6503 | Information gain: 6.1667 | Grad Norm: 9.6762 | Time: 21.1s
Step 0920 | Epoch 01 | Objective: -4.5175 | Coherence: 26.1861 | Separation: 13.5526 | Information gain: 6.1667 | Grad Norm: 10.6114 | Time: 21.3s
Step 0930 | Epoch 01 | Objective: -4.4846 | Coherence: 26.1654 | Separation: 13.4539 | Information gain: 6.1667 | Grad Norm: 10.1319 | Time: 21.5s
Step 0940 | Epoch 01 | Objective: -4.4464 | Coherence: 26.1287 | Separation: 13.3393 | Information gain: 6.1667 | Grad Norm: 10.0251 | Time: 21.7s
Step 0950 | Epoch 01 | Objective: -4.4101 | Coherence: 26.1023 | Separation: 13.2304 | Information gain: 6.1667 | Grad Norm: 9.9616 | Time: 22.0s
Step 0960 | Epoch 01 | Objective: -4.3726 | Coherence: 26.0779 | Separation: 13.1178 | Information gain: 6.1667 | Grad Norm: 10.3689 | Time: 22.2s
Step 0970 | Epoch 01 | Objective: -4.3401 | Coherence: 26.0383 | Separation: 13.0202 | Information gain: 6.1667 | Grad Norm: 10.0069 | Time: 22.4s
Step 0980 | Epoch 01 | Objective: -4.3093 | Coherence: 26.0186 | Separation: 12.9280 | Information gain: 6.1667 | Grad Norm: 9.8585 | Time: 22.6s
Step 0990 | Epoch 01 | Objective: -4.2806 | Coherence: 25.9943 | Separation: 12.8417 | Information gain: 6.1667 | Grad Norm: 10.0803 | Time: 22.9s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.520313  0.436306  0.547647  ...  0.422470  0.468119  0.437468
1 -0.393957  0.613936  0.462677  ...  0.569465  0.465714  0.599761
2 -0.490739  0.454173  0.568537  ...  0.419767  0.460354  0.436937
3 -0.452614  0.349138  0.452845  ...  0.418361  0.417907  0.382755
4 -0.462317  0.332291  0.485112  ...  0.356218  0.405399  0.343529

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7950
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8959
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8784
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0216, accuracy=0.0943
Testing SVM
  SVM Test Accuracy: 0.8631
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8381

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7181, Accuracy: 9495/12000 (79%)

Epoch 1 | Train Acc: 0.6495416666666667 | Test Acc: 0.79125 | Time: 1.0256121158599854 sec

Test set: Average loss: 0.5571, Accuracy: 9921/12000 (83%)

Epoch 2 | Train Acc: 0.826625 | Test Acc: 0.82675 | Time: 1.1403892040252686 sec

Test set: Average loss: 0.4604, Accuracy: 10267/12000 (86%)

Epoch 3 | Train Acc: 0.85775 | Test Acc: 0.8555833333333334 | Time: 1.1883747577667236 sec

Test set: Average loss: 0.4098, Accuracy: 10462/12000 (87%)

Epoch 4 | Train Acc: 0.8726666666666667 | Test Acc: 0.8718333333333333 | Time: 1.1129601001739502 sec

Test set: Average loss: 0.3797, Accuracy: 10576/12000 (88%)

Epoch 5 | Train Acc: 0.8822916666666667 | Test Acc: 0.8813333333333333 | Time: 1.0559618473052979 sec

Test set: Average loss: 0.3605, Accuracy: 10643/12000 (89%)

Epoch 6 | Train Acc: 0.88775 | Test Acc: 0.8869166666666667 | Time: 1.026048183441162 sec

Test set: Average loss: 0.3490, Accuracy: 10690/12000 (89%)

Epoch 7 | Train Acc: 0.8917291666666667 | Test Acc: 0.8908333333333334 | Time: 1.02944016456604 sec

Test set: Average loss: 0.3414, Accuracy: 10722/12000 (89%)

Epoch 8 | Train Acc: 0.8946875 | Test Acc: 0.8935 | Time: 1.0233564376831055 sec

Test set: Average loss: 0.3362, Accuracy: 10739/12000 (89%)

Epoch 9 | Train Acc: 0.8964375 | Test Acc: 0.8949166666666667 | Time: 1.0218639373779297 sec

Test set: Average loss: 0.3325, Accuracy: 10750/12000 (90%)

Epoch 10 | Train Acc: 0.8979791666666667 | Test Acc: 0.8958333333333334 | Time: 1.0251514911651611 sec

Test set: Average loss: 0.3298, Accuracy: 10762/12000 (90%)

Epoch 11 | Train Acc: 0.8989583333333333 | Test Acc: 0.8968333333333334 | Time: 1.1140151023864746 sec

Test set: Average loss: 0.3277, Accuracy: 10769/12000 (90%)

Epoch 12 | Train Acc: 0.8997291666666667 | Test Acc: 0.8974166666666666 | Time: 1.02351975440979 sec

Test set: Average loss: 0.3263, Accuracy: 10775/12000 (90%)

Epoch 13 | Train Acc: 0.9001875 | Test Acc: 0.8979166666666667 | Time: 1.0212817192077637 sec

Test set: Average loss: 0.3255, Accuracy: 10784/12000 (90%)

Epoch 14 | Train Acc: 0.9003541666666667 | Test Acc: 0.8986666666666666 | Time: 1.0254976749420166 sec

Test set: Average loss: 0.3250, Accuracy: 10788/12000 (90%)

Epoch 15 | Train Acc: 0.9005625 | Test Acc: 0.899 | Time: 1.017793893814087 sec

Test set: Average loss: 0.3247, Accuracy: 10794/12000 (90%)

Epoch 16 | Train Acc: 0.9007916666666667 | Test Acc: 0.8995 | Time: 1.0247514247894287 sec

Test set: Average loss: 0.3246, Accuracy: 10795/12000 (90%)

Epoch 17 | Train Acc: 0.9008125 | Test Acc: 0.8995833333333333 | Time: 1.027538537979126 sec

Test set: Average loss: 0.3245, Accuracy: 10796/12000 (90%)

Epoch 18 | Train Acc: 0.9009166666666667 | Test Acc: 0.8996666666666666 | Time: 1.0185956954956055 sec

Test set: Average loss: 0.3244, Accuracy: 10795/12000 (90%)

Epoch 19 | Train Acc: 0.9011041666666667 | Test Acc: 0.8995833333333333 | Time: 1.020512342453003 sec

Test set: Average loss: 0.3243, Accuracy: 10793/12000 (90%)

Epoch 20 | Train Acc: 0.9012083333333333 | Test Acc: 0.8994166666666666 | Time: 1.2091643810272217 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -13.7710 | Coherence: 18.3114 | Separation: 49.1463 | Information gain: 7.8333 | Grad Norm: 11.9596 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: -13.1606 | Coherence: 18.1498 | Separation: 47.3153 | Information gain: 7.8333 | Grad Norm: 11.8655 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -12.6229 | Coherence: 18.0670 | Separation: 45.7021 | Information gain: 7.8333 | Grad Norm: 11.2571 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: -12.1270 | Coherence: 18.0714 | Separation: 44.2142 | Information gain: 7.8333 | Grad Norm: 10.9267 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: -11.6534 | Coherence: 18.1213 | Separation: 42.7935 | Information gain: 7.8333 | Grad Norm: 10.7906 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -11.1458 | Coherence: 18.1166 | Separation: 41.4375 | Information gain: 8.0000 | Grad Norm: 10.4092 | Time: 1.3s
Step 0060 | Epoch 01 | Objective: -10.7107 | Coherence: 18.0546 | Separation: 40.1320 | Information gain: 8.0000 | Grad Norm: 10.3215 | Time: 1.5s
Step 0070 | Epoch 01 | Objective: -10.2750 | Coherence: 17.9158 | Separation: 38.8249 | Information gain: 8.0000 | Grad Norm: 10.5440 | Time: 1.8s
Step 0080 | Epoch 01 | Objective: -9.7745 | Coherence: 17.7790 | Separation: 37.4902 | Information gain: 8.1667 | Grad Norm: 10.2301 | Time: 2.0s
Step 0090 | Epoch 01 | Objective: -9.3716 | Coherence: 17.6653 | Separation: 36.2814 | Information gain: 8.1667 | Grad Norm: 9.4748 | Time: 2.3s
Step 0100 | Epoch 01 | Objective: -9.0112 | Coherence: 17.5253 | Separation: 35.2001 | Information gain: 8.1667 | Grad Norm: 9.0471 | Time: 2.5s
Step 0110 | Epoch 01 | Objective: -8.7103 | Coherence: 17.3594 | Separation: 34.2977 | Information gain: 8.1667 | Grad Norm: 8.8688 | Time: 2.7s
Step 0120 | Epoch 01 | Objective: -8.3911 | Coherence: 17.1936 | Separation: 33.3400 | Information gain: 8.1667 | Grad Norm: 9.5488 | Time: 3.0s
Step 0130 | Epoch 01 | Objective: -8.2086 | Coherence: 17.0360 | Separation: 32.4591 | Information gain: 7.8333 | Grad Norm: 8.8590 | Time: 3.2s
Step 0140 | Epoch 01 | Objective: -7.9567 | Coherence: 16.9357 | Separation: 31.7034 | Information gain: 7.8333 | Grad Norm: 8.7196 | Time: 3.4s
Step 0150 | Epoch 01 | Objective: -7.6744 | Coherence: 16.8678 | Separation: 31.0232 | Information gain: 8.0000 | Grad Norm: 8.2826 | Time: 3.7s
Step 0160 | Epoch 01 | Objective: -7.4547 | Coherence: 16.8160 | Separation: 30.3642 | Information gain: 8.0000 | Grad Norm: 9.1737 | Time: 3.9s
Step 0170 | Epoch 01 | Objective: -7.2403 | Coherence: 16.7913 | Separation: 29.7208 | Information gain: 8.0000 | Grad Norm: 8.5272 | Time: 4.1s
Step 0180 | Epoch 01 | Objective: -7.0398 | Coherence: 16.7683 | Separation: 29.1195 | Information gain: 8.0000 | Grad Norm: 9.2194 | Time: 4.4s
Step 0190 | Epoch 01 | Objective: -6.8506 | Coherence: 16.7302 | Separation: 28.5518 | Information gain: 8.0000 | Grad Norm: 9.1387 | Time: 4.6s
Step 0200 | Epoch 01 | Objective: -6.6153 | Coherence: 16.6724 | Separation: 28.0125 | Information gain: 8.1667 | Grad Norm: 8.6198 | Time: 4.8s
Step 0210 | Epoch 01 | Objective: -6.4678 | Coherence: 16.6385 | Separation: 27.5700 | Information gain: 8.1667 | Grad Norm: 9.0410 | Time: 5.0s
Step 0220 | Epoch 01 | Objective: -6.3256 | Coherence: 16.6296 | Separation: 27.1434 | Information gain: 8.1667 | Grad Norm: 8.8013 | Time: 5.3s
Step 0230 | Epoch 01 | Objective: -6.1363 | Coherence: 16.6663 | Separation: 26.7422 | Information gain: 8.3333 | Grad Norm: 9.2619 | Time: 5.5s
Step 0240 | Epoch 01 | Objective: -6.0467 | Coherence: 16.7331 | Separation: 26.3069 | Information gain: 8.1667 | Grad Norm: 8.0085 | Time: 5.7s
Step 0250 | Epoch 01 | Objective: -5.9071 | Coherence: 16.7689 | Separation: 25.8880 | Information gain: 8.1667 | Grad Norm: 9.1323 | Time: 6.0s
Step 0260 | Epoch 01 | Objective: -5.7641 | Coherence: 16.8045 | Separation: 25.4590 | Information gain: 8.1667 | Grad Norm: 8.5102 | Time: 6.2s
Step 0270 | Epoch 01 | Objective: -5.6224 | Coherence: 16.8365 | Separation: 25.0340 | Information gain: 8.1667 | Grad Norm: 9.1117 | Time: 6.4s
Step 0280 | Epoch 01 | Objective: -5.4856 | Coherence: 16.8514 | Separation: 24.6234 | Information gain: 8.1667 | Grad Norm: 8.5201 | Time: 6.6s
Step 0290 | Epoch 01 | Objective: -5.3654 | Coherence: 16.9193 | Separation: 24.2630 | Information gain: 8.1667 | Grad Norm: 9.0373 | Time: 6.9s
Step 0300 | Epoch 01 | Objective: -5.2459 | Coherence: 16.9792 | Separation: 23.9043 | Information gain: 8.1667 | Grad Norm: 8.8464 | Time: 7.1s
Step 0310 | Epoch 01 | Objective: -5.1326 | Coherence: 16.9997 | Separation: 23.5645 | Information gain: 8.1667 | Grad Norm: 8.4205 | Time: 7.3s
Step 0320 | Epoch 01 | Objective: -4.9641 | Coherence: 17.0582 | Separation: 23.2257 | Information gain: 8.3333 | Grad Norm: 8.7787 | Time: 7.5s
Step 0330 | Epoch 01 | Objective: -4.8573 | Coherence: 17.0828 | Separation: 22.9051 | Information gain: 8.3333 | Grad Norm: 8.6147 | Time: 7.8s
Step 0340 | Epoch 01 | Objective: -4.7504 | Coherence: 17.1052 | Separation: 22.5844 | Information gain: 8.3333 | Grad Norm: 8.6241 | Time: 8.0s
Step 0350 | Epoch 01 | Objective: -4.7074 | Coherence: 17.1505 | Separation: 22.2889 | Information gain: 8.1667 | Grad Norm: 8.8484 | Time: 8.2s
Step 0360 | Epoch 01 | Objective: -4.6641 | Coherence: 17.1857 | Separation: 21.9922 | Information gain: 8.0000 | Grad Norm: 8.4206 | Time: 8.5s
Step 0370 | Epoch 01 | Objective: -4.5600 | Coherence: 17.2196 | Separation: 21.6799 | Information gain: 8.0000 | Grad Norm: 9.0620 | Time: 8.7s
Step 0380 | Epoch 01 | Objective: -4.4539 | Coherence: 17.2602 | Separation: 21.3616 | Information gain: 8.0000 | Grad Norm: 8.0510 | Time: 8.9s
Step 0390 | Epoch 01 | Objective: -4.3525 | Coherence: 17.2938 | Separation: 21.0575 | Information gain: 8.0000 | Grad Norm: 8.5169 | Time: 9.1s
Step 0400 | Epoch 01 | Objective: -4.2504 | Coherence: 17.2974 | Separation: 20.7513 | Information gain: 8.0000 | Grad Norm: 8.5620 | Time: 9.4s
Step 0410 | Epoch 01 | Objective: -4.1459 | Coherence: 17.3273 | Separation: 20.4377 | Information gain: 8.0000 | Grad Norm: 8.4723 | Time: 9.6s
Step 0420 | Epoch 01 | Objective: -4.0387 | Coherence: 17.3637 | Separation: 20.1160 | Information gain: 8.0000 | Grad Norm: 8.4726 | Time: 9.8s
Step 0430 | Epoch 01 | Objective: -3.8762 | Coherence: 17.4038 | Separation: 19.7952 | Information gain: 8.1667 | Grad Norm: 8.9267 | Time: 10.0s
Step 0440 | Epoch 01 | Objective: -3.7764 | Coherence: 17.4485 | Separation: 19.4960 | Information gain: 8.1667 | Grad Norm: 8.3875 | Time: 10.3s
Step 0450 | Epoch 01 | Objective: -3.6681 | Coherence: 17.5016 | Separation: 19.1711 | Information gain: 8.1667 | Grad Norm: 8.7499 | Time: 10.5s
Step 0460 | Epoch 01 | Objective: -3.5640 | Coherence: 17.5728 | Separation: 18.8586 | Information gain: 8.1667 | Grad Norm: 8.9917 | Time: 10.8s
Step 0470 | Epoch 01 | Objective: -3.4548 | Coherence: 17.6980 | Separation: 18.5311 | Information gain: 8.1667 | Grad Norm: 8.6541 | Time: 11.0s
Step 0480 | Epoch 01 | Objective: -3.3398 | Coherence: 17.7898 | Separation: 18.1860 | Information gain: 8.1667 | Grad Norm: 8.2181 | Time: 11.2s
Step 0490 | Epoch 01 | Objective: -3.2179 | Coherence: 17.8948 | Separation: 17.8203 | Information gain: 8.1667 | Grad Norm: 9.3239 | Time: 11.4s
Step 0500 | Epoch 01 | Objective: -3.0925 | Coherence: 17.9982 | Separation: 17.4441 | Information gain: 8.1667 | Grad Norm: 9.2060 | Time: 11.7s
Step 0510 | Epoch 01 | Objective: -2.9646 | Coherence: 18.0999 | Separation: 17.0604 | Information gain: 8.1667 | Grad Norm: 8.5690 | Time: 11.9s
Step 0520 | Epoch 01 | Objective: -2.8348 | Coherence: 18.1958 | Separation: 16.6710 | Information gain: 8.1667 | Grad Norm: 8.6763 | Time: 12.1s
Step 0530 | Epoch 01 | Objective: -2.7113 | Coherence: 18.2855 | Separation: 16.3006 | Information gain: 8.1667 | Grad Norm: 9.0294 | Time: 12.3s
Step 0540 | Epoch 01 | Objective: -2.5912 | Coherence: 18.4041 | Separation: 15.9402 | Information gain: 8.1667 | Grad Norm: 7.8955 | Time: 12.6s
Step 0550 | Epoch 01 | Objective: -2.4774 | Coherence: 18.5054 | Separation: 15.5988 | Information gain: 8.1667 | Grad Norm: 9.2945 | Time: 12.8s
Step 0560 | Epoch 01 | Objective: -2.3044 | Coherence: 18.6144 | Separation: 15.2464 | Information gain: 8.3333 | Grad Norm: 9.0135 | Time: 13.0s
Step 0570 | Epoch 01 | Objective: -2.2589 | Coherence: 18.7141 | Separation: 14.9434 | Information gain: 8.1667 | Grad Norm: 9.0204 | Time: 13.3s
Step 0580 | Epoch 01 | Objective: -2.1686 | Coherence: 18.8292 | Separation: 14.6724 | Information gain: 8.1667 | Grad Norm: 9.4507 | Time: 13.5s
Step 0590 | Epoch 01 | Objective: -1.9714 | Coherence: 18.9356 | Separation: 14.4142 | Information gain: 8.5000 | Grad Norm: 9.6519 | Time: 13.7s
Step 0600 | Epoch 01 | Objective: -1.9076 | Coherence: 19.0264 | Separation: 14.2228 | Information gain: 8.5000 | Grad Norm: 9.3827 | Time: 14.0s
Step 0610 | Epoch 01 | Objective: -1.9020 | Coherence: 19.0632 | Separation: 14.0393 | Information gain: 8.3333 | Grad Norm: 9.9977 | Time: 14.3s
Step 0620 | Epoch 01 | Objective: -1.8071 | Coherence: 19.1105 | Separation: 13.9213 | Information gain: 8.5000 | Grad Norm: 10.0582 | Time: 14.5s
Step 0630 | Epoch 01 | Objective: -1.7652 | Coherence: 19.1232 | Separation: 13.7955 | Information gain: 8.5000 | Grad Norm: 9.9302 | Time: 14.8s
Step 0640 | Epoch 01 | Objective: -1.7820 | Coherence: 19.1386 | Separation: 13.6793 | Information gain: 8.3333 | Grad Norm: 9.6175 | Time: 15.0s
Step 0650 | Epoch 01 | Objective: -1.7462 | Coherence: 19.1693 | Separation: 13.5720 | Information gain: 8.3333 | Grad Norm: 10.2548 | Time: 15.3s
Step 0660 | Epoch 01 | Objective: -1.7186 | Coherence: 19.1946 | Separation: 13.4890 | Information gain: 8.3333 | Grad Norm: 9.7046 | Time: 15.5s
Step 0670 | Epoch 01 | Objective: -1.6871 | Coherence: 19.2222 | Separation: 13.3945 | Information gain: 8.3333 | Grad Norm: 9.7583 | Time: 15.7s
Step 0680 | Epoch 01 | Objective: -1.6557 | Coherence: 19.2496 | Separation: 13.3005 | Information gain: 8.3333 | Grad Norm: 9.3587 | Time: 16.0s
Step 0690 | Epoch 01 | Objective: -1.6263 | Coherence: 19.2687 | Separation: 13.2122 | Information gain: 8.3333 | Grad Norm: 9.9211 | Time: 16.2s
Step 0700 | Epoch 01 | Objective: -1.5956 | Coherence: 19.2986 | Separation: 13.1200 | Information gain: 8.3333 | Grad Norm: 10.3009 | Time: 16.5s
Step 0710 | Epoch 01 | Objective: -1.5676 | Coherence: 19.3203 | Separation: 13.0362 | Information gain: 8.3333 | Grad Norm: 10.2944 | Time: 16.7s
Step 0720 | Epoch 01 | Objective: -1.5464 | Coherence: 19.3330 | Separation: 12.9724 | Information gain: 8.3333 | Grad Norm: 10.5334 | Time: 16.9s
Step 0730 | Epoch 01 | Objective: -1.5264 | Coherence: 19.3564 | Separation: 12.9127 | Information gain: 8.3333 | Grad Norm: 10.5978 | Time: 17.2s
Step 0740 | Epoch 01 | Objective: -1.5025 | Coherence: 19.3710 | Separation: 12.8409 | Information gain: 8.3333 | Grad Norm: 10.3844 | Time: 17.4s
Step 0750 | Epoch 01 | Objective: -1.4809 | Coherence: 19.3825 | Separation: 12.7760 | Information gain: 8.3333 | Grad Norm: 10.3576 | Time: 17.6s
Step 0760 | Epoch 01 | Objective: -1.4550 | Coherence: 19.3958 | Separation: 12.6984 | Information gain: 8.3333 | Grad Norm: 9.9376 | Time: 17.9s
Step 0770 | Epoch 01 | Objective: -1.4310 | Coherence: 19.4142 | Separation: 12.6262 | Information gain: 8.3333 | Grad Norm: 9.8812 | Time: 18.1s
Step 0780 | Epoch 01 | Objective: -1.4132 | Coherence: 19.4257 | Separation: 12.5730 | Information gain: 8.3333 | Grad Norm: 10.4984 | Time: 18.3s
Step 0790 | Epoch 01 | Objective: -1.4513 | Coherence: 19.4564 | Separation: 12.5205 | Information gain: 8.1667 | Grad Norm: 10.5869 | Time: 18.6s
Step 0800 | Epoch 01 | Objective: -1.4418 | Coherence: 19.4723 | Separation: 12.4920 | Information gain: 8.1667 | Grad Norm: 10.6600 | Time: 18.8s
Step 0810 | Epoch 01 | Objective: -1.3753 | Coherence: 19.5096 | Separation: 12.4594 | Information gain: 8.3333 | Grad Norm: 10.3627 | Time: 19.0s
Step 0820 | Epoch 01 | Objective: -1.3657 | Coherence: 19.5416 | Separation: 12.4305 | Information gain: 8.3333 | Grad Norm: 10.5437 | Time: 19.2s
Step 0830 | Epoch 01 | Objective: -1.4144 | Coherence: 19.5689 | Separation: 12.4100 | Information gain: 8.1667 | Grad Norm: 10.3224 | Time: 19.5s
Step 0840 | Epoch 01 | Objective: -1.3509 | Coherence: 19.6026 | Separation: 12.3860 | Information gain: 8.3333 | Grad Norm: 10.4607 | Time: 19.7s
Step 0850 | Epoch 01 | Objective: -1.3949 | Coherence: 19.6345 | Separation: 12.3512 | Information gain: 8.1667 | Grad Norm: 10.3120 | Time: 19.9s
Step 0860 | Epoch 01 | Objective: -1.3881 | Coherence: 19.6584 | Separation: 12.3311 | Information gain: 8.1667 | Grad Norm: 10.6513 | Time: 20.1s
Step 0870 | Epoch 01 | Objective: -1.3220 | Coherence: 19.6952 | Separation: 12.2995 | Information gain: 8.3333 | Grad Norm: 10.3108 | Time: 20.4s
Step 0880 | Epoch 01 | Objective: -1.3662 | Coherence: 19.7283 | Separation: 12.2652 | Information gain: 8.1667 | Grad Norm: 10.2417 | Time: 20.6s
Step 0890 | Epoch 01 | Objective: -1.3574 | Coherence: 19.7558 | Separation: 12.2389 | Information gain: 8.1667 | Grad Norm: 10.4162 | Time: 20.8s
Step 0900 | Epoch 01 | Objective: -1.4013 | Coherence: 19.7831 | Separation: 12.2039 | Information gain: 8.0000 | Grad Norm: 10.6067 | Time: 21.1s
Step 0910 | Epoch 01 | Objective: -1.3923 | Coherence: 19.8132 | Separation: 12.1769 | Information gain: 8.0000 | Grad Norm: 10.3318 | Time: 21.3s
Step 0920 | Epoch 01 | Objective: -1.3289 | Coherence: 19.8460 | Separation: 12.1534 | Information gain: 8.1667 | Grad Norm: 10.5679 | Time: 21.5s
Step 0930 | Epoch 01 | Objective: -1.3174 | Coherence: 19.8740 | Separation: 12.1188 | Information gain: 8.1667 | Grad Norm: 10.7003 | Time: 21.8s
Step 0940 | Epoch 01 | Objective: -1.2505 | Coherence: 19.9067 | Separation: 12.0848 | Information gain: 8.3333 | Grad Norm: 10.6743 | Time: 22.0s
Step 0950 | Epoch 01 | Objective: -1.2392 | Coherence: 19.9345 | Separation: 12.0509 | Information gain: 8.3333 | Grad Norm: 10.7464 | Time: 22.2s
Step 0960 | Epoch 01 | Objective: -1.2275 | Coherence: 19.9587 | Separation: 12.0157 | Information gain: 8.3333 | Grad Norm: 10.5006 | Time: 22.4s
Step 0970 | Epoch 01 | Objective: -1.2167 | Coherence: 19.9938 | Separation: 11.9835 | Information gain: 8.3333 | Grad Norm: 10.4787 | Time: 22.7s
Step 0980 | Epoch 01 | Objective: -1.2028 | Coherence: 20.0155 | Separation: 11.9417 | Information gain: 8.3333 | Grad Norm: 10.1195 | Time: 22.9s
Step 0990 | Epoch 01 | Objective: -1.1906 | Coherence: 20.0441 | Separation: 11.9053 | Information gain: 8.3333 | Grad Norm: 10.6953 | Time: 23.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.653583  0.404405  0.469752  ...  0.476964  0.573781  0.477243
1 -0.418318  0.569223  0.510549  ...  0.472616  0.442812  0.522648
2 -0.475544  0.549232  0.627256  ...  0.578696  0.565427  0.616182
3 -0.401684  0.560910  0.581399  ...  0.504594  0.495025  0.609430
4 -0.430326  0.441172  0.509569  ...  0.571898  0.476821  0.477137

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7804
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8851
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8699
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0140, accuracy=0.0970
Testing SVM
  SVM Test Accuracy: 0.8404
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8114

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7073, Accuracy: 9406/12000 (78%)

Epoch 1 | Train Acc: 0.6406458333333334 | Test Acc: 0.7838333333333334 | Time: 1.0386803150177002 sec

Test set: Average loss: 0.5704, Accuracy: 9842/12000 (82%)

Epoch 2 | Train Acc: 0.802875 | Test Acc: 0.8201666666666667 | Time: 1.2676894664764404 sec

Test set: Average loss: 0.4939, Accuracy: 10110/12000 (84%)

Epoch 3 | Train Acc: 0.83625 | Test Acc: 0.8425 | Time: 1.2681653499603271 sec

Test set: Average loss: 0.4491, Accuracy: 10260/12000 (86%)

Epoch 4 | Train Acc: 0.8522083333333333 | Test Acc: 0.855 | Time: 1.0220959186553955 sec

Test set: Average loss: 0.4244, Accuracy: 10347/12000 (86%)

Epoch 5 | Train Acc: 0.8625625 | Test Acc: 0.86225 | Time: 1.2258634567260742 sec

Test set: Average loss: 0.4120, Accuracy: 10394/12000 (87%)

Epoch 6 | Train Acc: 0.8672291666666667 | Test Acc: 0.8661666666666666 | Time: 1.3565104007720947 sec

Test set: Average loss: 0.4023, Accuracy: 10430/12000 (87%)

Epoch 7 | Train Acc: 0.871125 | Test Acc: 0.8691666666666666 | Time: 1.545912504196167 sec

Test set: Average loss: 0.3959, Accuracy: 10457/12000 (87%)

Epoch 8 | Train Acc: 0.8737083333333333 | Test Acc: 0.8714166666666666 | Time: 1.2994461059570312 sec

Test set: Average loss: 0.3909, Accuracy: 10469/12000 (87%)

Epoch 9 | Train Acc: 0.87525 | Test Acc: 0.8724166666666666 | Time: 1.0239949226379395 sec

Test set: Average loss: 0.3877, Accuracy: 10490/12000 (87%)

Epoch 10 | Train Acc: 0.8762708333333333 | Test Acc: 0.8741666666666666 | Time: 1.0204412937164307 sec

Test set: Average loss: 0.3853, Accuracy: 10496/12000 (87%)

Epoch 11 | Train Acc: 0.8767916666666666 | Test Acc: 0.8746666666666667 | Time: 1.0270428657531738 sec

Test set: Average loss: 0.3836, Accuracy: 10500/12000 (88%)

Epoch 12 | Train Acc: 0.8781875 | Test Acc: 0.875 | Time: 1.2388644218444824 sec

Test set: Average loss: 0.3824, Accuracy: 10508/12000 (88%)

Epoch 13 | Train Acc: 0.8785833333333334 | Test Acc: 0.8756666666666667 | Time: 1.4037389755249023 sec

Test set: Average loss: 0.3816, Accuracy: 10509/12000 (88%)

Epoch 14 | Train Acc: 0.8788541666666667 | Test Acc: 0.87575 | Time: 1.187429666519165 sec

Test set: Average loss: 0.3811, Accuracy: 10500/12000 (88%)

Epoch 15 | Train Acc: 0.8792291666666666 | Test Acc: 0.875 | Time: 1.3267040252685547 sec

Test set: Average loss: 0.3808, Accuracy: 10503/12000 (88%)

Epoch 16 | Train Acc: 0.8792083333333334 | Test Acc: 0.87525 | Time: 1.315169334411621 sec

Test set: Average loss: 0.3806, Accuracy: 10508/12000 (88%)

Epoch 17 | Train Acc: 0.879375 | Test Acc: 0.8756666666666667 | Time: 1.1288611888885498 sec

Test set: Average loss: 0.3805, Accuracy: 10505/12000 (88%)

Epoch 18 | Train Acc: 0.8792708333333333 | Test Acc: 0.8754166666666666 | Time: 1.0702321529388428 sec

Test set: Average loss: 0.3804, Accuracy: 10506/12000 (88%)

Epoch 19 | Train Acc: 0.8793125 | Test Acc: 0.8755 | Time: 1.34568452835083 sec
Early stopping at epoch 19

Testing with M=15
Step 0000 | Epoch 01 | Objective: -12.9405 | Coherence: 9.4806 | Separation: 52.1548 | Information gain: 6.6667 | Grad Norm: 12.6715 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: -12.3862 | Coherence: 9.4557 | Separation: 50.4919 | Information gain: 6.6667 | Grad Norm: 12.2256 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -11.9422 | Coherence: 9.3736 | Separation: 49.1600 | Information gain: 6.6667 | Grad Norm: 11.8932 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: -11.5184 | Coherence: 9.3567 | Separation: 47.8885 | Information gain: 6.6667 | Grad Norm: 11.6480 | Time: 0.9s
Step 0040 | Epoch 01 | Objective: -11.0946 | Coherence: 9.3643 | Separation: 46.6172 | Information gain: 6.6667 | Grad Norm: 11.6589 | Time: 1.2s
Step 0050 | Epoch 01 | Objective: -10.7891 | Coherence: 9.4123 | Separation: 45.3672 | Information gain: 6.5000 | Grad Norm: 11.3721 | Time: 1.5s
Step 0060 | Epoch 01 | Objective: -10.4015 | Coherence: 9.4109 | Separation: 44.2045 | Information gain: 6.5000 | Grad Norm: 10.7643 | Time: 1.8s
Step 0070 | Epoch 01 | Objective: -9.9119 | Coherence: 9.3815 | Separation: 43.0692 | Information gain: 6.6667 | Grad Norm: 10.7749 | Time: 2.1s
Step 0080 | Epoch 01 | Objective: -9.5480 | Coherence: 9.3318 | Separation: 41.9772 | Information gain: 6.6667 | Grad Norm: 10.4732 | Time: 2.4s
Step 0090 | Epoch 01 | Objective: -9.5379 | Coherence: 9.2983 | Separation: 40.9471 | Information gain: 6.1667 | Grad Norm: 10.4390 | Time: 2.6s
Step 0100 | Epoch 01 | Objective: -9.1721 | Coherence: 9.2409 | Separation: 39.8496 | Information gain: 6.1667 | Grad Norm: 10.7574 | Time: 2.9s
Step 0110 | Epoch 01 | Objective: -8.8016 | Coherence: 9.2129 | Separation: 38.7382 | Information gain: 6.1667 | Grad Norm: 10.3291 | Time: 3.1s
Step 0120 | Epoch 01 | Objective: -8.4444 | Coherence: 9.2001 | Separation: 37.6665 | Information gain: 6.1667 | Grad Norm: 10.4749 | Time: 3.4s
Step 0130 | Epoch 01 | Objective: -8.2471 | Coherence: 9.2252 | Separation: 36.7413 | Information gain: 6.0000 | Grad Norm: 9.9637 | Time: 3.6s
Step 0140 | Epoch 01 | Objective: -7.8470 | Coherence: 9.2626 | Separation: 35.8743 | Information gain: 6.1667 | Grad Norm: 9.3958 | Time: 3.8s
Step 0150 | Epoch 01 | Objective: -7.6793 | Coherence: 9.3437 | Separation: 35.0380 | Information gain: 6.0000 | Grad Norm: 9.7750 | Time: 4.0s
Step 0160 | Epoch 01 | Objective: -7.4160 | Coherence: 9.4745 | Separation: 34.2481 | Information gain: 6.0000 | Grad Norm: 9.9111 | Time: 4.3s
Step 0170 | Epoch 01 | Objective: -7.1681 | Coherence: 9.6176 | Separation: 33.5042 | Information gain: 6.0000 | Grad Norm: 9.5132 | Time: 4.5s
Step 0180 | Epoch 01 | Objective: -6.9371 | Coherence: 9.8306 | Separation: 32.8114 | Information gain: 6.0000 | Grad Norm: 9.1803 | Time: 4.7s
Step 0190 | Epoch 01 | Objective: -6.7182 | Coherence: 10.1126 | Separation: 32.1545 | Information gain: 6.0000 | Grad Norm: 9.5075 | Time: 4.9s
Step 0200 | Epoch 01 | Objective: -6.4993 | Coherence: 10.3828 | Separation: 31.4978 | Information gain: 6.0000 | Grad Norm: 9.9066 | Time: 5.2s
Step 0210 | Epoch 01 | Objective: -6.2728 | Coherence: 10.6444 | Separation: 30.8185 | Information gain: 6.0000 | Grad Norm: 9.3626 | Time: 5.4s
Step 0220 | Epoch 01 | Objective: -6.0479 | Coherence: 10.9163 | Separation: 30.1438 | Information gain: 6.0000 | Grad Norm: 8.9427 | Time: 5.6s
Step 0230 | Epoch 01 | Objective: -5.8258 | Coherence: 11.1393 | Separation: 29.4775 | Information gain: 6.0000 | Grad Norm: 9.4697 | Time: 5.8s
Step 0240 | Epoch 01 | Objective: -5.5082 | Coherence: 11.3954 | Separation: 28.8580 | Information gain: 6.1667 | Grad Norm: 9.6617 | Time: 6.1s
Step 0250 | Epoch 01 | Objective: -5.3115 | Coherence: 11.6247 | Separation: 28.2677 | Information gain: 6.1667 | Grad Norm: 9.0736 | Time: 6.3s
Step 0260 | Epoch 01 | Objective: -5.1272 | Coherence: 11.8080 | Separation: 27.7150 | Information gain: 6.1667 | Grad Norm: 9.6548 | Time: 6.5s
Step 0270 | Epoch 01 | Objective: -4.8572 | Coherence: 11.9527 | Separation: 27.2382 | Information gain: 6.3333 | Grad Norm: 9.6474 | Time: 6.7s
Step 0280 | Epoch 01 | Objective: -4.7023 | Coherence: 12.0717 | Separation: 26.7735 | Information gain: 6.3333 | Grad Norm: 9.0738 | Time: 7.0s
Step 0290 | Epoch 01 | Objective: -4.5406 | Coherence: 12.2043 | Separation: 26.2883 | Information gain: 6.3333 | Grad Norm: 9.1724 | Time: 7.3s
Step 0300 | Epoch 01 | Objective: -4.3822 | Coherence: 12.3463 | Separation: 25.8132 | Information gain: 6.3333 | Grad Norm: 9.0284 | Time: 7.5s
Step 0310 | Epoch 01 | Objective: -4.2400 | Coherence: 12.4968 | Separation: 25.3866 | Information gain: 6.3333 | Grad Norm: 9.4766 | Time: 7.8s
Step 0320 | Epoch 01 | Objective: -4.1100 | Coherence: 12.6542 | Separation: 24.9966 | Information gain: 6.3333 | Grad Norm: 8.0899 | Time: 8.1s
Step 0330 | Epoch 01 | Objective: -3.9893 | Coherence: 12.7973 | Separation: 24.6347 | Information gain: 6.3333 | Grad Norm: 8.6464 | Time: 8.4s
Step 0340 | Epoch 01 | Objective: -3.9795 | Coherence: 12.9186 | Separation: 24.2717 | Information gain: 6.1667 | Grad Norm: 8.5538 | Time: 8.7s
Step 0350 | Epoch 01 | Objective: -3.8558 | Coherence: 13.0514 | Separation: 23.9008 | Information gain: 6.1667 | Grad Norm: 9.0586 | Time: 8.9s
Step 0360 | Epoch 01 | Objective: -3.7335 | Coherence: 13.1650 | Separation: 23.5338 | Information gain: 6.1667 | Grad Norm: 9.2893 | Time: 9.2s
Step 0370 | Epoch 01 | Objective: -3.6111 | Coherence: 13.2309 | Separation: 23.1665 | Information gain: 6.1667 | Grad Norm: 9.2975 | Time: 9.5s
Step 0380 | Epoch 01 | Objective: -3.4862 | Coherence: 13.3007 | Separation: 22.7921 | Information gain: 6.1667 | Grad Norm: 8.9888 | Time: 9.7s
Step 0390 | Epoch 01 | Objective: -3.3589 | Coherence: 13.3702 | Separation: 22.4099 | Information gain: 6.1667 | Grad Norm: 9.0229 | Time: 9.9s
Step 0400 | Epoch 01 | Objective: -3.2228 | Coherence: 13.4443 | Separation: 22.0017 | Information gain: 6.1667 | Grad Norm: 9.1257 | Time: 10.2s
Step 0410 | Epoch 01 | Objective: -3.0850 | Coherence: 13.5072 | Separation: 21.5884 | Information gain: 6.1667 | Grad Norm: 8.7744 | Time: 10.4s
Step 0420 | Epoch 01 | Objective: -2.9392 | Coherence: 13.5773 | Separation: 21.1510 | Information gain: 6.1667 | Grad Norm: 9.2400 | Time: 10.6s
Step 0430 | Epoch 01 | Objective: -2.6906 | Coherence: 13.6615 | Separation: 20.7385 | Information gain: 6.3333 | Grad Norm: 9.0625 | Time: 10.9s
Step 0440 | Epoch 01 | Objective: -2.5480 | Coherence: 13.7548 | Separation: 20.3108 | Information gain: 6.3333 | Grad Norm: 9.4646 | Time: 11.2s
Step 0450 | Epoch 01 | Objective: -2.2850 | Coherence: 13.8488 | Separation: 19.8550 | Information gain: 6.5000 | Grad Norm: 9.2111 | Time: 11.5s
Step 0460 | Epoch 01 | Objective: -2.0272 | Coherence: 13.9351 | Separation: 19.4150 | Information gain: 6.6667 | Grad Norm: 9.5193 | Time: 11.8s
Step 0470 | Epoch 01 | Objective: -1.8796 | Coherence: 14.0097 | Separation: 18.9720 | Information gain: 6.6667 | Grad Norm: 9.0565 | Time: 12.0s
Step 0480 | Epoch 01 | Objective: -1.6132 | Coherence: 14.1157 | Separation: 18.5064 | Information gain: 6.8333 | Grad Norm: 10.3600 | Time: 12.3s
Step 0490 | Epoch 01 | Objective: -1.4525 | Coherence: 14.1929 | Separation: 18.0242 | Information gain: 6.8333 | Grad Norm: 9.7168 | Time: 12.6s
Step 0500 | Epoch 01 | Objective: -1.1876 | Coherence: 14.2848 | Separation: 17.5628 | Information gain: 7.0000 | Grad Norm: 9.3699 | Time: 12.8s
Step 0510 | Epoch 01 | Objective: -1.0299 | Coherence: 14.3815 | Separation: 17.0897 | Information gain: 7.0000 | Grad Norm: 9.4738 | Time: 13.0s
Step 0520 | Epoch 01 | Objective: -0.8976 | Coherence: 14.4877 | Separation: 16.6928 | Information gain: 7.0000 | Grad Norm: 9.2996 | Time: 13.2s
Step 0530 | Epoch 01 | Objective: -0.6849 | Coherence: 14.5678 | Separation: 16.3880 | Information gain: 7.1667 | Grad Norm: 8.8167 | Time: 13.5s
Step 0540 | Epoch 01 | Objective: -0.5951 | Coherence: 14.5379 | Separation: 16.1187 | Information gain: 7.1667 | Grad Norm: 9.0913 | Time: 13.7s
Step 0550 | Epoch 01 | Objective: -0.5018 | Coherence: 14.5020 | Separation: 15.8388 | Information gain: 7.1667 | Grad Norm: 9.0817 | Time: 14.0s
Step 0560 | Epoch 01 | Objective: -0.5200 | Coherence: 14.5116 | Separation: 15.5600 | Information gain: 7.0000 | Grad Norm: 9.4926 | Time: 14.3s
Step 0570 | Epoch 01 | Objective: -0.4222 | Coherence: 14.4852 | Separation: 15.2665 | Information gain: 7.0000 | Grad Norm: 9.4182 | Time: 14.5s
Step 0580 | Epoch 01 | Objective: -0.3331 | Coherence: 14.4700 | Separation: 14.9992 | Information gain: 7.0000 | Grad Norm: 8.9686 | Time: 14.8s
Step 0590 | Epoch 01 | Objective: -0.2427 | Coherence: 14.4511 | Separation: 14.7282 | Information gain: 7.0000 | Grad Norm: 9.3776 | Time: 15.1s
Step 0600 | Epoch 01 | Objective: -0.1561 | Coherence: 14.4132 | Separation: 14.4684 | Information gain: 7.0000 | Grad Norm: 9.3148 | Time: 15.3s
Step 0610 | Epoch 01 | Objective: -0.0910 | Coherence: 14.4037 | Separation: 14.2729 | Information gain: 7.0000 | Grad Norm: 9.5926 | Time: 15.6s
Step 0620 | Epoch 01 | Objective: -0.0129 | Coherence: 14.4249 | Separation: 14.0388 | Information gain: 7.0000 | Grad Norm: 9.8835 | Time: 15.9s
Step 0630 | Epoch 01 | Objective: 0.0584 | Coherence: 14.4167 | Separation: 13.8249 | Information gain: 7.0000 | Grad Norm: 9.7264 | Time: 16.2s
Step 0640 | Epoch 01 | Objective: 0.1293 | Coherence: 14.4212 | Separation: 13.6120 | Information gain: 7.0000 | Grad Norm: 9.9328 | Time: 16.5s
Step 0650 | Epoch 01 | Objective: 0.1920 | Coherence: 14.4278 | Separation: 13.4241 | Information gain: 7.0000 | Grad Norm: 9.7092 | Time: 16.8s
Step 0660 | Epoch 01 | Objective: 0.2569 | Coherence: 14.4386 | Separation: 13.2293 | Information gain: 7.0000 | Grad Norm: 9.9162 | Time: 17.0s
Step 0670 | Epoch 01 | Objective: 0.3214 | Coherence: 14.4395 | Separation: 13.0357 | Information gain: 7.0000 | Grad Norm: 10.2076 | Time: 17.3s
Step 0680 | Epoch 01 | Objective: 0.3934 | Coherence: 14.4506 | Separation: 12.8197 | Information gain: 7.0000 | Grad Norm: 10.3058 | Time: 17.6s
Step 0690 | Epoch 01 | Objective: 0.4584 | Coherence: 14.4499 | Separation: 12.6249 | Information gain: 7.0000 | Grad Norm: 9.9997 | Time: 17.9s
Step 0700 | Epoch 01 | Objective: 0.6340 | Coherence: 14.4498 | Separation: 12.4314 | Information gain: 7.1667 | Grad Norm: 10.3474 | Time: 18.1s
Step 0710 | Epoch 01 | Objective: 0.6730 | Coherence: 14.4587 | Separation: 12.3143 | Information gain: 7.1667 | Grad Norm: 10.6606 | Time: 18.4s
Step 0720 | Epoch 01 | Objective: 0.7114 | Coherence: 14.4783 | Separation: 12.1993 | Information gain: 7.1667 | Grad Norm: 10.5518 | Time: 18.6s
Step 0730 | Epoch 01 | Objective: 0.7621 | Coherence: 14.4773 | Separation: 12.0469 | Information gain: 7.1667 | Grad Norm: 11.1456 | Time: 18.8s
Step 0740 | Epoch 01 | Objective: 0.8067 | Coherence: 14.4921 | Separation: 11.9131 | Information gain: 7.1667 | Grad Norm: 10.3529 | Time: 19.0s
Step 0750 | Epoch 01 | Objective: 0.8548 | Coherence: 14.5087 | Separation: 11.7690 | Information gain: 7.1667 | Grad Norm: 10.2013 | Time: 19.3s
Step 0760 | Epoch 01 | Objective: 0.8972 | Coherence: 14.5145 | Separation: 11.6417 | Information gain: 7.1667 | Grad Norm: 10.3708 | Time: 19.5s
Step 0762 | Epoch 01 | Objective: 0.9018 | Coherence: 14.5203 | Separation: 11.6278 | Information gain: 7.1667 | Grad Norm: 10.4049 | Time: 19.5s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.513860  0.485694  0.401810  ...  0.467645  0.438905  0.491884
1  0.420072  0.583529  0.523232  ...  0.515819  0.494648  0.532879
2  0.299766  0.484183  0.569482  ...  0.521317  0.392880  0.428776
3  0.257003  0.458688  0.510047  ...  0.502012  0.383647  0.378389
4  0.195313  0.415147  0.524868  ...  0.490948  0.375773  0.340633

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7777
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9002
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8786
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.8909, accuracy=0.1163
Testing SVM
  SVM Test Accuracy: 0.8590
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8301

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7040, Accuracy: 9344/12000 (78%)

Epoch 1 | Train Acc: 0.6480625 | Test Acc: 0.7786666666666666 | Time: 1.2314808368682861 sec

Test set: Average loss: 0.4970, Accuracy: 10122/12000 (84%)

Epoch 2 | Train Acc: 0.8270625 | Test Acc: 0.8435 | Time: 1.172224521636963 sec

Test set: Average loss: 0.4190, Accuracy: 10399/12000 (87%)

Epoch 3 | Train Acc: 0.8594375 | Test Acc: 0.8665833333333334 | Time: 1.426370620727539 sec

Test set: Average loss: 0.3736, Accuracy: 10605/12000 (88%)

Epoch 4 | Train Acc: 0.875875 | Test Acc: 0.88375 | Time: 1.0327377319335938 sec

Test set: Average loss: 0.3507, Accuracy: 10687/12000 (89%)

Epoch 5 | Train Acc: 0.8857291666666667 | Test Acc: 0.8905833333333333 | Time: 1.133885383605957 sec

Test set: Average loss: 0.3376, Accuracy: 10726/12000 (89%)

Epoch 6 | Train Acc: 0.8926875 | Test Acc: 0.8938333333333334 | Time: 1.0496172904968262 sec

Test set: Average loss: 0.3296, Accuracy: 10759/12000 (90%)

Epoch 7 | Train Acc: 0.8964583333333334 | Test Acc: 0.8965833333333333 | Time: 1.2691409587860107 sec

Test set: Average loss: 0.3238, Accuracy: 10789/12000 (90%)

Epoch 8 | Train Acc: 0.89925 | Test Acc: 0.8990833333333333 | Time: 1.2235419750213623 sec

Test set: Average loss: 0.3196, Accuracy: 10812/12000 (90%)

Epoch 9 | Train Acc: 0.9010416666666666 | Test Acc: 0.901 | Time: 1.1626734733581543 sec

Test set: Average loss: 0.3165, Accuracy: 10820/12000 (90%)

Epoch 10 | Train Acc: 0.9016875 | Test Acc: 0.9016666666666666 | Time: 1.2298781871795654 sec

Test set: Average loss: 0.3143, Accuracy: 10824/12000 (90%)

Epoch 11 | Train Acc: 0.9023958333333333 | Test Acc: 0.902 | Time: 1.2225430011749268 sec

Test set: Average loss: 0.3127, Accuracy: 10828/12000 (90%)

Epoch 12 | Train Acc: 0.9031458333333333 | Test Acc: 0.9023333333333333 | Time: 1.2967925071716309 sec

Test set: Average loss: 0.3117, Accuracy: 10832/12000 (90%)

Epoch 13 | Train Acc: 0.9032083333333333 | Test Acc: 0.9026666666666666 | Time: 1.4714229106903076 sec

Test set: Average loss: 0.3110, Accuracy: 10835/12000 (90%)

Epoch 14 | Train Acc: 0.9036875 | Test Acc: 0.9029166666666667 | Time: 1.173431396484375 sec

Test set: Average loss: 0.3105, Accuracy: 10839/12000 (90%)

Epoch 15 | Train Acc: 0.9041458333333333 | Test Acc: 0.90325 | Time: 1.0208423137664795 sec

Test set: Average loss: 0.3102, Accuracy: 10838/12000 (90%)

Epoch 16 | Train Acc: 0.9044583333333334 | Test Acc: 0.9031666666666667 | Time: 1.0226051807403564 sec

Test set: Average loss: 0.3100, Accuracy: 10836/12000 (90%)

Epoch 17 | Train Acc: 0.9044583333333334 | Test Acc: 0.903 | Time: 1.0361475944519043 sec

Test set: Average loss: 0.3098, Accuracy: 10836/12000 (90%)

Epoch 18 | Train Acc: 0.9045625 | Test Acc: 0.903 | Time: 1.359086036682129 sec

Test set: Average loss: 0.3097, Accuracy: 10837/12000 (90%)

Epoch 19 | Train Acc: 0.9046041666666667 | Test Acc: 0.9030833333333333 | Time: 1.2295451164245605 sec

Test set: Average loss: 0.3097, Accuracy: 10837/12000 (90%)

Epoch 20 | Train Acc: 0.9047916666666667 | Test Acc: 0.9030833333333333 | Time: 1.1454033851623535 sec
Early stopping at epoch 20

Testing with M=15
Step 0000 | Epoch 01 | Objective: -9.9161 | Coherence: 19.3122 | Separation: 52.2484 | Information gain: 7.5000 | Grad Norm: 12.9633 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: -9.2863 | Coherence: 19.5333 | Separation: 50.3589 | Information gain: 7.5000 | Grad Norm: 12.3102 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -8.7176 | Coherence: 19.6493 | Separation: 48.6527 | Information gain: 7.5000 | Grad Norm: 11.9200 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: -8.1884 | Coherence: 19.7113 | Separation: 47.0651 | Information gain: 7.5000 | Grad Norm: 11.6716 | Time: 0.9s
Step 0040 | Epoch 01 | Objective: -7.6808 | Coherence: 19.7474 | Separation: 45.5423 | Information gain: 7.5000 | Grad Norm: 11.0739 | Time: 1.1s
Step 0050 | Epoch 01 | Objective: -7.2621 | Coherence: 19.7706 | Separation: 44.2864 | Information gain: 7.5000 | Grad Norm: 10.7539 | Time: 1.3s
Step 0060 | Epoch 01 | Objective: -7.0240 | Coherence: 19.8485 | Separation: 43.0719 | Information gain: 7.3333 | Grad Norm: 10.7022 | Time: 1.5s
Step 0070 | Epoch 01 | Objective: -6.7791 | Coherence: 19.9249 | Separation: 41.8374 | Information gain: 7.1667 | Grad Norm: 11.0093 | Time: 1.8s
Step 0080 | Epoch 01 | Objective: -6.2202 | Coherence: 19.9107 | Separation: 40.6605 | Information gain: 7.3333 | Grad Norm: 10.7437 | Time: 2.0s
Step 0090 | Epoch 01 | Objective: -5.9809 | Coherence: 19.8260 | Separation: 39.4427 | Information gain: 7.1667 | Grad Norm: 10.4981 | Time: 2.2s
Step 0100 | Epoch 01 | Objective: -5.4457 | Coherence: 19.7264 | Separation: 38.3371 | Information gain: 7.3333 | Grad Norm: 10.3558 | Time: 2.5s
Step 0110 | Epoch 01 | Objective: -5.0874 | Coherence: 19.6885 | Separation: 37.2622 | Information gain: 7.3333 | Grad Norm: 10.1287 | Time: 2.8s
Step 0120 | Epoch 01 | Objective: -4.7361 | Coherence: 19.6231 | Separation: 36.2083 | Information gain: 7.3333 | Grad Norm: 10.1680 | Time: 3.0s
Step 0130 | Epoch 01 | Objective: -4.5838 | Coherence: 19.5482 | Separation: 35.2513 | Information gain: 7.1667 | Grad Norm: 10.0700 | Time: 3.3s
Step 0140 | Epoch 01 | Objective: -4.2881 | Coherence: 19.5572 | Separation: 34.3644 | Information gain: 7.1667 | Grad Norm: 9.8616 | Time: 3.6s
Step 0150 | Epoch 01 | Objective: -4.0299 | Coherence: 19.5656 | Separation: 33.5898 | Information gain: 7.1667 | Grad Norm: 9.6791 | Time: 3.8s
Step 0160 | Epoch 01 | Objective: -3.7870 | Coherence: 19.5422 | Separation: 32.8610 | Information gain: 7.1667 | Grad Norm: 9.9274 | Time: 4.1s
Step 0170 | Epoch 01 | Objective: -3.9064 | Coherence: 19.4451 | Separation: 32.2192 | Information gain: 6.8333 | Grad Norm: 9.8955 | Time: 4.4s
Step 0180 | Epoch 01 | Objective: -3.5432 | Coherence: 19.3608 | Separation: 31.6296 | Information gain: 7.0000 | Grad Norm: 9.1695 | Time: 4.7s
Step 0190 | Epoch 01 | Objective: -3.3517 | Coherence: 19.2643 | Separation: 31.0551 | Information gain: 7.0000 | Grad Norm: 9.5787 | Time: 4.9s
Step 0200 | Epoch 01 | Objective: -3.1559 | Coherence: 19.1864 | Separation: 30.4676 | Information gain: 7.0000 | Grad Norm: 9.6814 | Time: 5.2s
Step 0210 | Epoch 01 | Objective: -2.9503 | Coherence: 19.0765 | Separation: 29.8510 | Information gain: 7.0000 | Grad Norm: 9.2730 | Time: 5.5s
Step 0220 | Epoch 01 | Objective: -2.7415 | Coherence: 18.9720 | Separation: 29.2246 | Information gain: 7.0000 | Grad Norm: 9.5653 | Time: 5.8s
Step 0230 | Epoch 01 | Objective: -2.5528 | Coherence: 18.8715 | Separation: 28.6585 | Information gain: 7.0000 | Grad Norm: 9.3239 | Time: 6.1s
Step 0240 | Epoch 01 | Objective: -2.2236 | Coherence: 18.7722 | Separation: 28.1708 | Information gain: 7.1667 | Grad Norm: 9.2313 | Time: 6.3s
Step 0250 | Epoch 01 | Objective: -2.0610 | Coherence: 18.7306 | Separation: 27.6830 | Information gain: 7.1667 | Grad Norm: 9.4843 | Time: 6.5s
Step 0260 | Epoch 01 | Objective: -1.8976 | Coherence: 18.7115 | Separation: 27.1929 | Information gain: 7.1667 | Grad Norm: 9.3277 | Time: 6.8s
Step 0270 | Epoch 01 | Objective: -1.5689 | Coherence: 18.7099 | Separation: 26.7066 | Information gain: 7.3333 | Grad Norm: 9.3471 | Time: 7.0s
Step 0280 | Epoch 01 | Objective: -1.4021 | Coherence: 18.6571 | Separation: 26.2062 | Information gain: 7.3333 | Grad Norm: 9.3087 | Time: 7.2s
Step 0290 | Epoch 01 | Objective: -1.2400 | Coherence: 18.5973 | Separation: 25.7201 | Information gain: 7.3333 | Grad Norm: 9.0204 | Time: 7.4s
Step 0300 | Epoch 01 | Objective: -1.0785 | Coherence: 18.5931 | Separation: 25.2354 | Information gain: 7.3333 | Grad Norm: 9.0044 | Time: 7.6s
Step 0310 | Epoch 01 | Objective: -0.9344 | Coherence: 18.5908 | Separation: 24.8033 | Information gain: 7.3333 | Grad Norm: 9.4496 | Time: 7.9s
Step 0320 | Epoch 01 | Objective: -0.7879 | Coherence: 18.5910 | Separation: 24.3637 | Information gain: 7.3333 | Grad Norm: 9.8313 | Time: 8.1s
Step 0330 | Epoch 01 | Objective: -0.6353 | Coherence: 18.5742 | Separation: 23.9058 | Information gain: 7.3333 | Grad Norm: 9.9490 | Time: 8.3s
Step 0340 | Epoch 01 | Objective: -0.3127 | Coherence: 18.5613 | Separation: 23.4382 | Information gain: 7.5000 | Grad Norm: 9.4428 | Time: 8.5s
Step 0350 | Epoch 01 | Objective: -0.3431 | Coherence: 18.5492 | Separation: 23.0293 | Information gain: 7.3333 | Grad Norm: 8.2357 | Time: 8.8s
Step 0360 | Epoch 01 | Objective: -0.0658 | Coherence: 18.5718 | Separation: 22.6975 | Information gain: 7.5000 | Grad Norm: 8.5972 | Time: 9.0s
Step 0370 | Epoch 01 | Objective: 0.0404 | Coherence: 18.6336 | Separation: 22.3788 | Information gain: 7.5000 | Grad Norm: 8.7570 | Time: 9.3s
Step 0380 | Epoch 01 | Objective: 0.1459 | Coherence: 18.6520 | Separation: 22.0624 | Information gain: 7.5000 | Grad Norm: 8.8661 | Time: 9.5s
Step 0390 | Epoch 01 | Objective: 0.2542 | Coherence: 18.6705 | Separation: 21.7375 | Information gain: 7.5000 | Grad Norm: 8.2009 | Time: 9.7s
Step 0400 | Epoch 01 | Objective: 0.5273 | Coherence: 18.6680 | Separation: 21.4181 | Information gain: 7.6667 | Grad Norm: 8.8542 | Time: 9.9s
Step 0410 | Epoch 01 | Objective: 0.6435 | Coherence: 18.6725 | Separation: 21.0696 | Information gain: 7.6667 | Grad Norm: 9.2829 | Time: 10.2s
Step 0420 | Epoch 01 | Objective: 0.7393 | Coherence: 18.6645 | Separation: 20.7820 | Information gain: 7.6667 | Grad Norm: 8.4914 | Time: 10.5s
Step 0430 | Epoch 01 | Objective: 0.8333 | Coherence: 18.6504 | Separation: 20.5001 | Information gain: 7.6667 | Grad Norm: 8.6540 | Time: 10.7s
Step 0432 | Epoch 01 | Objective: 1.0194 | Coherence: 18.6572 | Separation: 20.4417 | Information gain: 7.8333 | Grad Norm: 8.9873 | Time: 10.8s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.600159  0.518407  0.521651  ...  0.564409  0.444040 -0.528181
1  0.531308  0.621749  0.418621  ...  0.494704  0.485224 -0.565800
2  0.524111  0.429522  0.579463  ...  0.511115  0.455007 -0.457194
3  0.452237  0.487982  0.441180  ...  0.434443  0.543257 -0.470002
4  0.559369  0.577255  0.483596  ...  0.518553  0.601942 -0.608663

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8123
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8982
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8834
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0257, accuracy=0.1133
Testing SVM
  SVM Test Accuracy: 0.8643
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8400

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7059, Accuracy: 9424/12000 (79%)

Epoch 1 | Train Acc: 0.6542708333333334 | Test Acc: 0.7853333333333333 | Time: 1.0292751789093018 sec

Test set: Average loss: 0.5537, Accuracy: 9834/12000 (82%)

Epoch 2 | Train Acc: 0.8275416666666666 | Test Acc: 0.8195 | Time: 1.0256004333496094 sec

Test set: Average loss: 0.4806, Accuracy: 10134/12000 (84%)

Epoch 3 | Train Acc: 0.8524583333333333 | Test Acc: 0.8445 | Time: 1.0229520797729492 sec

Test set: Average loss: 0.4335, Accuracy: 10328/12000 (86%)

Epoch 4 | Train Acc: 0.8670416666666667 | Test Acc: 0.8606666666666667 | Time: 1.0283620357513428 sec

Test set: Average loss: 0.4025, Accuracy: 10430/12000 (87%)

Epoch 5 | Train Acc: 0.8761458333333333 | Test Acc: 0.8691666666666666 | Time: 1.0669631958007812 sec

Test set: Average loss: 0.3821, Accuracy: 10493/12000 (87%)

Epoch 6 | Train Acc: 0.88225 | Test Acc: 0.8744166666666666 | Time: 1.080031156539917 sec

Test set: Average loss: 0.3705, Accuracy: 10530/12000 (88%)

Epoch 7 | Train Acc: 0.8863541666666667 | Test Acc: 0.8775 | Time: 1.0217032432556152 sec

Test set: Average loss: 0.3608, Accuracy: 10591/12000 (88%)

Epoch 8 | Train Acc: 0.88925 | Test Acc: 0.8825833333333334 | Time: 1.0308325290679932 sec

Test set: Average loss: 0.3532, Accuracy: 10624/12000 (89%)

Epoch 9 | Train Acc: 0.8915 | Test Acc: 0.8853333333333333 | Time: 1.0305275917053223 sec

Test set: Average loss: 0.3491, Accuracy: 10646/12000 (89%)

Epoch 10 | Train Acc: 0.8934791666666667 | Test Acc: 0.8871666666666667 | Time: 1.1413912773132324 sec

Test set: Average loss: 0.3459, Accuracy: 10662/12000 (89%)

Epoch 11 | Train Acc: 0.8947708333333333 | Test Acc: 0.8885 | Time: 1.0369043350219727 sec

Test set: Average loss: 0.3438, Accuracy: 10667/12000 (89%)

Epoch 12 | Train Acc: 0.895125 | Test Acc: 0.8889166666666667 | Time: 1.0374341011047363 sec

Test set: Average loss: 0.3424, Accuracy: 10671/12000 (89%)

Epoch 13 | Train Acc: 0.8956875 | Test Acc: 0.88925 | Time: 1.065183162689209 sec

Test set: Average loss: 0.3415, Accuracy: 10673/12000 (89%)

Epoch 14 | Train Acc: 0.8958541666666666 | Test Acc: 0.8894166666666666 | Time: 1.4200780391693115 sec

Test set: Average loss: 0.3410, Accuracy: 10680/12000 (89%)

Epoch 15 | Train Acc: 0.8957916666666667 | Test Acc: 0.89 | Time: 1.0390830039978027 sec

Test set: Average loss: 0.3406, Accuracy: 10688/12000 (89%)

Epoch 16 | Train Acc: 0.8962291666666666 | Test Acc: 0.8906666666666667 | Time: 1.032473087310791 sec

Test set: Average loss: 0.3404, Accuracy: 10692/12000 (89%)

Epoch 17 | Train Acc: 0.8964583333333334 | Test Acc: 0.891 | Time: 1.0367457866668701 sec

Test set: Average loss: 0.3402, Accuracy: 10696/12000 (89%)

Epoch 18 | Train Acc: 0.8965833333333333 | Test Acc: 0.8913333333333333 | Time: 1.1249279975891113 sec

Test set: Average loss: 0.3401, Accuracy: 10694/12000 (89%)

Epoch 19 | Train Acc: 0.8967916666666667 | Test Acc: 0.8911666666666667 | Time: 1.033045768737793 sec

Test set: Average loss: 0.3400, Accuracy: 10694/12000 (89%)

Epoch 20 | Train Acc: 0.8968541666666666 | Test Acc: 0.8911666666666667 | Time: 1.0404205322265625 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -33.9618 | Coherence: 13.5084 | Separation: 50.9427 | Information gain: 7.1667 | Grad Norm: 24.0903 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: -32.9511 | Coherence: 13.6818 | Separation: 49.4266 | Information gain: 7.1667 | Grad Norm: 23.3007 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -32.0793 | Coherence: 13.8556 | Separation: 48.1189 | Information gain: 7.1667 | Grad Norm: 22.7261 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: -31.2316 | Coherence: 14.0525 | Separation: 46.8473 | Information gain: 7.3333 | Grad Norm: 21.8456 | Time: 0.9s
Step 0040 | Epoch 01 | Objective: -30.4897 | Coherence: 14.1640 | Separation: 45.7345 | Information gain: 7.5000 | Grad Norm: 22.0095 | Time: 1.1s
Step 0050 | Epoch 01 | Objective: -29.7683 | Coherence: 14.2079 | Separation: 44.6525 | Information gain: 7.6667 | Grad Norm: 21.7891 | Time: 1.4s
Step 0060 | Epoch 01 | Objective: -29.0459 | Coherence: 14.2219 | Separation: 43.5688 | Information gain: 7.5000 | Grad Norm: 21.1609 | Time: 1.6s
Step 0070 | Epoch 01 | Objective: -28.3459 | Coherence: 14.1741 | Separation: 42.5189 | Information gain: 7.3333 | Grad Norm: 20.7577 | Time: 1.9s
Step 0080 | Epoch 01 | Objective: -27.6637 | Coherence: 14.1024 | Separation: 41.4955 | Information gain: 7.3333 | Grad Norm: 20.3631 | Time: 2.2s
Step 0090 | Epoch 01 | Objective: -26.9546 | Coherence: 14.0724 | Separation: 40.4319 | Information gain: 7.3333 | Grad Norm: 20.2313 | Time: 2.4s
Step 0100 | Epoch 01 | Objective: -26.2605 | Coherence: 14.0511 | Separation: 39.3908 | Information gain: 7.3333 | Grad Norm: 19.8098 | Time: 2.6s
Step 0110 | Epoch 01 | Objective: -25.5938 | Coherence: 13.9993 | Separation: 38.3907 | Information gain: 7.3333 | Grad Norm: 20.2703 | Time: 2.9s
Step 0120 | Epoch 01 | Objective: -24.9668 | Coherence: 13.8661 | Separation: 37.4501 | Information gain: 7.3333 | Grad Norm: 18.5929 | Time: 3.1s
Step 0130 | Epoch 01 | Objective: -24.3620 | Coherence: 13.6676 | Separation: 36.5431 | Information gain: 7.3333 | Grad Norm: 19.0515 | Time: 3.3s
Step 0140 | Epoch 01 | Objective: -23.8044 | Coherence: 13.3678 | Separation: 35.7065 | Information gain: 7.3333 | Grad Norm: 18.2874 | Time: 3.6s
Step 0150 | Epoch 01 | Objective: -23.2621 | Coherence: 13.1258 | Separation: 34.8932 | Information gain: 7.3333 | Grad Norm: 18.5730 | Time: 3.8s
Step 0160 | Epoch 01 | Objective: -22.7516 | Coherence: 12.9481 | Separation: 34.1273 | Information gain: 7.3333 | Grad Norm: 18.6531 | Time: 4.0s
Step 0170 | Epoch 01 | Objective: -22.2604 | Coherence: 12.8006 | Separation: 33.3906 | Information gain: 7.3333 | Grad Norm: 18.0875 | Time: 4.3s
Step 0180 | Epoch 01 | Objective: -21.7979 | Coherence: 12.6364 | Separation: 32.6969 | Information gain: 7.1667 | Grad Norm: 17.9877 | Time: 4.5s
Step 0190 | Epoch 01 | Objective: -21.3678 | Coherence: 12.4912 | Separation: 32.0517 | Information gain: 7.1667 | Grad Norm: 18.1325 | Time: 4.7s
Step 0200 | Epoch 01 | Objective: -20.9568 | Coherence: 12.3674 | Separation: 31.4352 | Information gain: 7.1667 | Grad Norm: 17.6039 | Time: 4.9s
Step 0210 | Epoch 01 | Objective: -20.5424 | Coherence: 12.2744 | Separation: 30.8136 | Information gain: 7.1667 | Grad Norm: 16.8964 | Time: 5.2s
Step 0220 | Epoch 01 | Objective: -20.1247 | Coherence: 12.2449 | Separation: 30.1870 | Information gain: 7.5000 | Grad Norm: 18.3120 | Time: 5.4s
Step 0230 | Epoch 01 | Objective: -19.7016 | Coherence: 12.2263 | Separation: 29.5524 | Information gain: 7.5000 | Grad Norm: 17.2843 | Time: 5.6s
Step 0240 | Epoch 01 | Objective: -19.3084 | Coherence: 12.2349 | Separation: 28.9626 | Information gain: 7.3333 | Grad Norm: 17.9579 | Time: 5.9s
Step 0250 | Epoch 01 | Objective: -18.8974 | Coherence: 12.2591 | Separation: 28.3461 | Information gain: 7.1667 | Grad Norm: 17.9424 | Time: 6.1s
Step 0260 | Epoch 01 | Objective: -18.4737 | Coherence: 12.2681 | Separation: 27.7105 | Information gain: 7.0000 | Grad Norm: 17.9874 | Time: 6.3s
Step 0270 | Epoch 01 | Objective: -18.0774 | Coherence: 12.3006 | Separation: 27.1161 | Information gain: 7.0000 | Grad Norm: 17.2527 | Time: 6.6s
Step 0280 | Epoch 01 | Objective: -17.7281 | Coherence: 12.3723 | Separation: 26.5921 | Information gain: 6.8333 | Grad Norm: 16.5611 | Time: 6.8s
Step 0290 | Epoch 01 | Objective: -17.4095 | Coherence: 12.4693 | Separation: 26.1143 | Information gain: 6.8333 | Grad Norm: 17.3326 | Time: 7.0s
Step 0300 | Epoch 01 | Objective: -17.1005 | Coherence: 12.5703 | Separation: 25.6507 | Information gain: 6.8333 | Grad Norm: 18.0882 | Time: 7.2s
Step 0310 | Epoch 01 | Objective: -16.8056 | Coherence: 12.6672 | Separation: 25.2084 | Information gain: 6.8333 | Grad Norm: 17.5368 | Time: 7.4s
Step 0320 | Epoch 01 | Objective: -16.5063 | Coherence: 12.7414 | Separation: 24.7595 | Information gain: 6.8333 | Grad Norm: 17.7845 | Time: 7.7s
Step 0330 | Epoch 01 | Objective: -16.2498 | Coherence: 12.8361 | Separation: 24.3748 | Information gain: 7.0000 | Grad Norm: 17.1748 | Time: 7.9s
Step 0340 | Epoch 01 | Objective: -16.0026 | Coherence: 12.9248 | Separation: 24.0039 | Information gain: 7.0000 | Grad Norm: 16.7298 | Time: 8.1s
Step 0350 | Epoch 01 | Objective: -15.7848 | Coherence: 12.9871 | Separation: 23.6772 | Information gain: 7.0000 | Grad Norm: 16.8353 | Time: 8.3s
Step 0360 | Epoch 01 | Objective: -15.6163 | Coherence: 13.0454 | Separation: 23.4244 | Information gain: 7.0000 | Grad Norm: 17.4075 | Time: 8.6s
Step 0370 | Epoch 01 | Objective: -15.4463 | Coherence: 13.1017 | Separation: 23.1694 | Information gain: 7.0000 | Grad Norm: 16.5813 | Time: 8.8s
Step 0380 | Epoch 01 | Objective: -15.2692 | Coherence: 13.1562 | Separation: 22.9037 | Information gain: 7.0000 | Grad Norm: 16.5547 | Time: 9.0s
Step 0390 | Epoch 01 | Objective: -15.0905 | Coherence: 13.2230 | Separation: 22.6357 | Information gain: 7.0000 | Grad Norm: 18.6354 | Time: 9.3s
Step 0400 | Epoch 01 | Objective: -14.9280 | Coherence: 13.2833 | Separation: 22.3920 | Information gain: 7.0000 | Grad Norm: 16.2606 | Time: 9.5s
Step 0410 | Epoch 01 | Objective: -14.7562 | Coherence: 13.3476 | Separation: 22.1343 | Information gain: 6.8333 | Grad Norm: 16.7914 | Time: 9.7s
Step 0420 | Epoch 01 | Objective: -14.5926 | Coherence: 13.3790 | Separation: 21.8889 | Information gain: 7.0000 | Grad Norm: 17.9097 | Time: 9.9s
Step 0430 | Epoch 01 | Objective: -14.4223 | Coherence: 13.4261 | Separation: 21.6335 | Information gain: 7.0000 | Grad Norm: 16.6834 | Time: 10.2s
Step 0440 | Epoch 01 | Objective: -14.2544 | Coherence: 13.4828 | Separation: 21.3817 | Information gain: 7.0000 | Grad Norm: 16.9590 | Time: 10.4s
Step 0450 | Epoch 01 | Objective: -14.1100 | Coherence: 13.5466 | Separation: 21.1650 | Information gain: 7.0000 | Grad Norm: 17.3386 | Time: 10.6s
Step 0460 | Epoch 01 | Objective: -13.9494 | Coherence: 13.6138 | Separation: 20.9241 | Information gain: 7.0000 | Grad Norm: 17.0050 | Time: 10.8s
Step 0470 | Epoch 01 | Objective: -13.8005 | Coherence: 13.6797 | Separation: 20.7008 | Information gain: 7.0000 | Grad Norm: 16.6334 | Time: 11.1s
Step 0480 | Epoch 01 | Objective: -13.6407 | Coherence: 13.7850 | Separation: 20.4610 | Information gain: 7.0000 | Grad Norm: 17.1615 | Time: 11.3s
Step 0490 | Epoch 01 | Objective: -13.4718 | Coherence: 13.9071 | Separation: 20.2077 | Information gain: 7.0000 | Grad Norm: 17.5132 | Time: 11.5s
Step 0500 | Epoch 01 | Objective: -13.2965 | Coherence: 14.0026 | Separation: 19.9448 | Information gain: 7.0000 | Grad Norm: 16.4233 | Time: 11.8s
Step 0510 | Epoch 01 | Objective: -13.1148 | Coherence: 14.1075 | Separation: 19.6722 | Information gain: 7.0000 | Grad Norm: 19.8392 | Time: 12.0s
Step 0520 | Epoch 01 | Objective: -12.9305 | Coherence: 14.2295 | Separation: 19.3958 | Information gain: 7.0000 | Grad Norm: 17.5633 | Time: 12.2s
Step 0530 | Epoch 01 | Objective: -12.7585 | Coherence: 14.3440 | Separation: 19.1378 | Information gain: 7.0000 | Grad Norm: 17.3973 | Time: 12.5s
Step 0540 | Epoch 01 | Objective: -12.6008 | Coherence: 14.4702 | Separation: 18.9012 | Information gain: 7.0000 | Grad Norm: 18.3994 | Time: 12.7s
Step 0550 | Epoch 01 | Objective: -12.4657 | Coherence: 14.5815 | Separation: 18.6985 | Information gain: 7.0000 | Grad Norm: 18.8373 | Time: 12.9s
Step 0560 | Epoch 01 | Objective: -12.3287 | Coherence: 14.6394 | Separation: 18.4930 | Information gain: 7.0000 | Grad Norm: 20.2625 | Time: 13.2s
Step 0570 | Epoch 01 | Objective: -12.1847 | Coherence: 14.7375 | Separation: 18.2770 | Information gain: 7.0000 | Grad Norm: 18.4481 | Time: 13.5s
Step 0580 | Epoch 01 | Objective: -12.0382 | Coherence: 14.8134 | Separation: 18.0574 | Information gain: 7.0000 | Grad Norm: 17.5419 | Time: 13.8s
Step 0590 | Epoch 01 | Objective: -11.9074 | Coherence: 14.8763 | Separation: 17.8611 | Information gain: 7.0000 | Grad Norm: 18.4333 | Time: 14.0s
Step 0600 | Epoch 01 | Objective: -11.7673 | Coherence: 14.9652 | Separation: 17.6509 | Information gain: 7.0000 | Grad Norm: 19.5772 | Time: 14.3s
Step 0610 | Epoch 01 | Objective: -11.6191 | Coherence: 15.0354 | Separation: 17.4286 | Information gain: 7.0000 | Grad Norm: 18.5146 | Time: 14.5s
Step 0620 | Epoch 01 | Objective: -11.4719 | Coherence: 15.1078 | Separation: 17.2078 | Information gain: 7.0000 | Grad Norm: 19.0781 | Time: 14.8s
Step 0630 | Epoch 01 | Objective: -11.3481 | Coherence: 15.1817 | Separation: 17.0221 | Information gain: 7.1667 | Grad Norm: 17.9973 | Time: 15.0s
Step 0640 | Epoch 01 | Objective: -11.2479 | Coherence: 15.2768 | Separation: 16.8719 | Information gain: 7.1667 | Grad Norm: 19.8366 | Time: 15.2s
Step 0650 | Epoch 01 | Objective: -11.1440 | Coherence: 15.3720 | Separation: 16.7159 | Information gain: 7.3333 | Grad Norm: 20.9130 | Time: 15.5s
Step 0660 | Epoch 01 | Objective: -11.0517 | Coherence: 15.4816 | Separation: 16.5776 | Information gain: 7.1667 | Grad Norm: 19.3046 | Time: 15.7s
Step 0670 | Epoch 01 | Objective: -10.9453 | Coherence: 15.5769 | Separation: 16.4179 | Information gain: 7.3333 | Grad Norm: 18.9423 | Time: 15.9s
Step 0680 | Epoch 01 | Objective: -10.8408 | Coherence: 15.6694 | Separation: 16.2612 | Information gain: 7.3333 | Grad Norm: 18.9595 | Time: 16.2s
Step 0690 | Epoch 01 | Objective: -10.7631 | Coherence: 15.7708 | Separation: 16.1447 | Information gain: 7.3333 | Grad Norm: 19.9727 | Time: 16.4s
Step 0700 | Epoch 01 | Objective: -10.7048 | Coherence: 15.8519 | Separation: 16.0572 | Information gain: 7.3333 | Grad Norm: 19.3175 | Time: 16.6s
Step 0710 | Epoch 01 | Objective: -10.6314 | Coherence: 15.9412 | Separation: 15.9471 | Information gain: 7.3333 | Grad Norm: 20.0722 | Time: 16.9s
Step 0720 | Epoch 01 | Objective: -10.5730 | Coherence: 16.0258 | Separation: 15.8595 | Information gain: 7.1667 | Grad Norm: 20.8030 | Time: 17.1s
Step 0730 | Epoch 01 | Objective: -10.5010 | Coherence: 16.1093 | Separation: 15.7516 | Information gain: 7.1667 | Grad Norm: 20.0649 | Time: 17.3s
Step 0740 | Epoch 01 | Objective: -10.4370 | Coherence: 16.2010 | Separation: 15.6555 | Information gain: 7.1667 | Grad Norm: 20.3090 | Time: 17.5s
Step 0750 | Epoch 01 | Objective: -10.3619 | Coherence: 16.2903 | Separation: 15.5429 | Information gain: 7.1667 | Grad Norm: 19.7499 | Time: 17.8s
Step 0760 | Epoch 01 | Objective: -10.2909 | Coherence: 16.3785 | Separation: 15.4363 | Information gain: 7.1667 | Grad Norm: 19.4776 | Time: 18.0s
Step 0770 | Epoch 01 | Objective: -10.2176 | Coherence: 16.4727 | Separation: 15.3263 | Information gain: 7.1667 | Grad Norm: 19.7740 | Time: 18.2s
Step 0780 | Epoch 01 | Objective: -10.1359 | Coherence: 16.5553 | Separation: 15.2039 | Information gain: 7.1667 | Grad Norm: 20.6630 | Time: 18.4s
Step 0790 | Epoch 01 | Objective: -10.0526 | Coherence: 16.6419 | Separation: 15.0789 | Information gain: 7.1667 | Grad Norm: 19.0887 | Time: 18.7s
Step 0800 | Epoch 01 | Objective: -9.9720 | Coherence: 16.7367 | Separation: 14.9580 | Information gain: 7.1667 | Grad Norm: 20.4985 | Time: 18.9s
Step 0810 | Epoch 01 | Objective: -9.8923 | Coherence: 16.8222 | Separation: 14.8384 | Information gain: 7.1667 | Grad Norm: 18.9287 | Time: 19.2s
Step 0820 | Epoch 01 | Objective: -9.8163 | Coherence: 16.8729 | Separation: 14.7245 | Information gain: 7.1667 | Grad Norm: 20.3310 | Time: 19.4s
Step 0830 | Epoch 01 | Objective: -9.7411 | Coherence: 16.9400 | Separation: 14.6116 | Information gain: 7.1667 | Grad Norm: 19.8470 | Time: 19.6s
Step 0840 | Epoch 01 | Objective: -9.6664 | Coherence: 16.9949 | Separation: 14.4996 | Information gain: 7.1667 | Grad Norm: 19.0500 | Time: 19.8s
Step 0850 | Epoch 01 | Objective: -9.5947 | Coherence: 17.0629 | Separation: 14.3921 | Information gain: 7.1667 | Grad Norm: 20.2809 | Time: 20.1s
Step 0860 | Epoch 01 | Objective: -9.5477 | Coherence: 17.1103 | Separation: 14.3216 | Information gain: 7.1667 | Grad Norm: 19.6958 | Time: 20.3s
Step 0870 | Epoch 01 | Objective: -9.4866 | Coherence: 17.1284 | Separation: 14.2299 | Information gain: 7.1667 | Grad Norm: 20.1563 | Time: 20.6s
Step 0880 | Epoch 01 | Objective: -9.4303 | Coherence: 17.1601 | Separation: 14.1455 | Information gain: 7.1667 | Grad Norm: 19.1211 | Time: 20.8s
Step 0890 | Epoch 01 | Objective: -9.3808 | Coherence: 17.1894 | Separation: 14.0712 | Information gain: 7.1667 | Grad Norm: 20.6468 | Time: 21.0s
Step 0900 | Epoch 01 | Objective: -9.3229 | Coherence: 17.2100 | Separation: 13.9844 | Information gain: 7.1667 | Grad Norm: 20.8035 | Time: 21.3s
Step 0910 | Epoch 01 | Objective: -9.2614 | Coherence: 17.2523 | Separation: 13.8921 | Information gain: 7.1667 | Grad Norm: 20.0956 | Time: 21.5s
Step 0920 | Epoch 01 | Objective: -9.2016 | Coherence: 17.2765 | Separation: 13.8023 | Information gain: 7.1667 | Grad Norm: 20.6821 | Time: 21.7s
Step 0930 | Epoch 01 | Objective: -9.1380 | Coherence: 17.3085 | Separation: 13.7070 | Information gain: 7.3333 | Grad Norm: 20.9542 | Time: 21.9s
Step 0940 | Epoch 01 | Objective: -9.0682 | Coherence: 17.3513 | Separation: 13.6023 | Information gain: 7.5000 | Grad Norm: 18.9537 | Time: 22.2s
Step 0950 | Epoch 01 | Objective: -8.9985 | Coherence: 17.3788 | Separation: 13.4977 | Information gain: 7.5000 | Grad Norm: 19.8982 | Time: 22.4s
Step 0960 | Epoch 01 | Objective: -8.9330 | Coherence: 17.4091 | Separation: 13.3994 | Information gain: 7.5000 | Grad Norm: 20.1497 | Time: 22.6s
Step 0970 | Epoch 01 | Objective: -8.8616 | Coherence: 17.4438 | Separation: 13.2924 | Information gain: 7.5000 | Grad Norm: 20.7407 | Time: 22.9s
Step 0980 | Epoch 01 | Objective: -8.7878 | Coherence: 17.4741 | Separation: 13.1817 | Information gain: 7.5000 | Grad Norm: 20.4002 | Time: 23.1s
Step 0990 | Epoch 01 | Objective: -8.7157 | Coherence: 17.5054 | Separation: 13.0735 | Information gain: 7.5000 | Grad Norm: 20.5769 | Time: 23.3s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.548917  0.467283  0.476579  ... -0.501748 -0.455942  0.464395
1 -0.531579  0.628085  0.450387  ... -0.529113 -0.570803  0.514486
2 -0.470902  0.419488  0.567229  ... -0.460508 -0.311525  0.498971
3 -0.550354  0.552697  0.473862  ... -0.554467 -0.524168  0.514595
4 -0.554808  0.523317  0.400933  ... -0.532322 -0.577519  0.460800

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8035
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9021
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8882
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.9561, accuracy=0.0930
Testing SVM
  SVM Test Accuracy: 0.8670
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8468

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6664, Accuracy: 9635/12000 (80%)

Epoch 1 | Train Acc: 0.6400625 | Test Acc: 0.8029166666666666 | Time: 1.0331475734710693 sec

Test set: Average loss: 0.4784, Accuracy: 10273/12000 (86%)

Epoch 2 | Train Acc: 0.8321458333333334 | Test Acc: 0.8560833333333333 | Time: 1.025545358657837 sec

Test set: Average loss: 0.4165, Accuracy: 10495/12000 (87%)

Epoch 3 | Train Acc: 0.8619375 | Test Acc: 0.8745833333333334 | Time: 1.2208068370819092 sec

Test set: Average loss: 0.3798, Accuracy: 10587/12000 (88%)

Epoch 4 | Train Acc: 0.8787708333333333 | Test Acc: 0.88225 | Time: 1.2484512329101562 sec

Test set: Average loss: 0.3547, Accuracy: 10662/12000 (89%)

Epoch 5 | Train Acc: 0.8883958333333334 | Test Acc: 0.8885 | Time: 1.0638983249664307 sec

Test set: Average loss: 0.3391, Accuracy: 10729/12000 (89%)

Epoch 6 | Train Acc: 0.8942916666666667 | Test Acc: 0.8940833333333333 | Time: 1.146242618560791 sec

Test set: Average loss: 0.3277, Accuracy: 10753/12000 (90%)

Epoch 7 | Train Acc: 0.8979375 | Test Acc: 0.8960833333333333 | Time: 1.0273466110229492 sec

Test set: Average loss: 0.3202, Accuracy: 10777/12000 (90%)

Epoch 8 | Train Acc: 0.900875 | Test Acc: 0.8980833333333333 | Time: 1.0201919078826904 sec

Test set: Average loss: 0.3149, Accuracy: 10797/12000 (90%)

Epoch 9 | Train Acc: 0.9026666666666666 | Test Acc: 0.89975 | Time: 1.0220160484313965 sec

Test set: Average loss: 0.3109, Accuracy: 10810/12000 (90%)

Epoch 10 | Train Acc: 0.9040416666666666 | Test Acc: 0.9008333333333334 | Time: 1.0285155773162842 sec

Test set: Average loss: 0.3083, Accuracy: 10817/12000 (90%)

Epoch 11 | Train Acc: 0.905125 | Test Acc: 0.9014166666666666 | Time: 1.0426292419433594 sec

Test set: Average loss: 0.3066, Accuracy: 10820/12000 (90%)

Epoch 12 | Train Acc: 0.9059375 | Test Acc: 0.9016666666666666 | Time: 1.2878773212432861 sec

Test set: Average loss: 0.3055, Accuracy: 10824/12000 (90%)

Epoch 13 | Train Acc: 0.9064375 | Test Acc: 0.902 | Time: 1.201202392578125 sec

Test set: Average loss: 0.3048, Accuracy: 10826/12000 (90%)

Epoch 14 | Train Acc: 0.9066458333333334 | Test Acc: 0.9021666666666667 | Time: 1.0291051864624023 sec

Test set: Average loss: 0.3044, Accuracy: 10826/12000 (90%)

Epoch 15 | Train Acc: 0.906875 | Test Acc: 0.9021666666666667 | Time: 1.1425449848175049 sec

Test set: Average loss: 0.3041, Accuracy: 10824/12000 (90%)

Epoch 16 | Train Acc: 0.9069583333333333 | Test Acc: 0.902 | Time: 1.0194034576416016 sec

Test set: Average loss: 0.3039, Accuracy: 10823/12000 (90%)

Epoch 17 | Train Acc: 0.907 | Test Acc: 0.9019166666666667 | Time: 1.0229074954986572 sec

Test set: Average loss: 0.3038, Accuracy: 10824/12000 (90%)

Epoch 18 | Train Acc: 0.907125 | Test Acc: 0.902 | Time: 1.0242109298706055 sec

Test set: Average loss: 0.3037, Accuracy: 10830/12000 (90%)

Epoch 19 | Train Acc: 0.9072083333333333 | Test Acc: 0.9025 | Time: 1.0220205783843994 sec

Test set: Average loss: 0.3036, Accuracy: 10832/12000 (90%)

Epoch 20 | Train Acc: 0.9072083333333333 | Test Acc: 0.9026666666666666 | Time: 1.0209360122680664 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -32.6646 | Coherence: 15.5080 | Separation: 51.9135 | Information gain: 5.8333 | Grad Norm: 26.0110 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -31.5221 | Coherence: 15.6008 | Separation: 50.1999 | Information gain: 5.8333 | Grad Norm: 24.5529 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -30.3958 | Coherence: 15.7294 | Separation: 48.5937 | Information gain: 6.0000 | Grad Norm: 23.9908 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -29.2014 | Coherence: 15.8462 | Separation: 46.8855 | Information gain: 6.1667 | Grad Norm: 23.8132 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: -28.1939 | Coherence: 15.9601 | Separation: 45.2908 | Information gain: 6.0000 | Grad Norm: 23.2085 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -27.0672 | Coherence: 16.1002 | Separation: 43.6841 | Information gain: 6.1667 | Grad Norm: 22.0760 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -26.0003 | Coherence: 16.2564 | Separation: 42.0838 | Information gain: 6.1667 | Grad Norm: 22.4952 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -24.9416 | Coherence: 16.3851 | Separation: 40.5790 | Information gain: 6.3333 | Grad Norm: 20.9704 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -23.9625 | Coherence: 16.4788 | Separation: 39.1104 | Information gain: 6.3333 | Grad Norm: 21.0202 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -22.9454 | Coherence: 16.5856 | Separation: 37.5848 | Information gain: 6.3333 | Grad Norm: 21.1202 | Time: 2.2s
Step 0100 | Epoch 01 | Objective: -22.0525 | Coherence: 16.7216 | Separation: 36.2454 | Information gain: 6.3333 | Grad Norm: 20.0242 | Time: 2.5s
Step 0110 | Epoch 01 | Objective: -21.2147 | Coherence: 17.0256 | Separation: 34.9887 | Information gain: 6.3333 | Grad Norm: 19.7343 | Time: 2.7s
Step 0120 | Epoch 01 | Objective: -20.5174 | Coherence: 17.3246 | Separation: 33.8594 | Information gain: 6.1667 | Grad Norm: 18.8004 | Time: 3.0s
Step 0130 | Epoch 01 | Objective: -19.9498 | Coherence: 17.4886 | Separation: 33.0081 | Information gain: 6.1667 | Grad Norm: 18.0737 | Time: 3.2s
Step 0140 | Epoch 01 | Objective: -19.4137 | Coherence: 17.5941 | Separation: 32.2039 | Information gain: 6.1667 | Grad Norm: 17.5278 | Time: 3.5s
Step 0150 | Epoch 01 | Objective: -18.9437 | Coherence: 17.6517 | Separation: 31.4988 | Information gain: 6.1667 | Grad Norm: 18.1041 | Time: 3.7s
Step 0160 | Epoch 01 | Objective: -18.4814 | Coherence: 17.6575 | Separation: 30.8055 | Information gain: 6.1667 | Grad Norm: 18.3744 | Time: 4.0s
Step 0170 | Epoch 01 | Objective: -18.0559 | Coherence: 17.6510 | Separation: 30.1672 | Information gain: 6.1667 | Grad Norm: 17.3544 | Time: 4.2s
Step 0180 | Epoch 01 | Objective: -17.6204 | Coherence: 17.6747 | Separation: 29.5139 | Information gain: 6.1667 | Grad Norm: 17.1417 | Time: 4.5s
Step 0190 | Epoch 01 | Objective: -17.2381 | Coherence: 17.7502 | Separation: 28.8571 | Information gain: 6.0000 | Grad Norm: 18.8002 | Time: 4.7s
Step 0200 | Epoch 01 | Objective: -16.8565 | Coherence: 17.7873 | Separation: 28.2848 | Information gain: 6.0000 | Grad Norm: 17.5829 | Time: 4.9s
Step 0210 | Epoch 01 | Objective: -16.6333 | Coherence: 17.8131 | Separation: 27.8666 | Information gain: 5.8333 | Grad Norm: 16.6186 | Time: 5.2s
Step 0220 | Epoch 01 | Objective: -16.3483 | Coherence: 17.8707 | Separation: 27.5224 | Information gain: 6.0000 | Grad Norm: 16.7519 | Time: 5.4s
Step 0230 | Epoch 01 | Objective: -16.1062 | Coherence: 17.9419 | Separation: 27.1594 | Information gain: 6.0000 | Grad Norm: 18.2225 | Time: 5.6s
Step 0240 | Epoch 01 | Objective: -15.8023 | Coherence: 17.9995 | Separation: 26.7868 | Information gain: 6.1667 | Grad Norm: 17.6398 | Time: 5.8s
Step 0250 | Epoch 01 | Objective: -15.5535 | Coherence: 18.0409 | Separation: 26.4136 | Information gain: 6.1667 | Grad Norm: 17.3861 | Time: 6.0s
Step 0260 | Epoch 01 | Objective: -15.2474 | Coherence: 18.1130 | Separation: 26.0378 | Information gain: 6.3333 | Grad Norm: 17.1179 | Time: 6.3s
Step 0270 | Epoch 01 | Objective: -14.9814 | Coherence: 18.1878 | Separation: 25.6387 | Information gain: 6.3333 | Grad Norm: 17.9652 | Time: 6.5s
Step 0280 | Epoch 01 | Objective: -14.7011 | Coherence: 18.2281 | Separation: 25.2183 | Information gain: 6.3333 | Grad Norm: 16.7914 | Time: 6.8s
Step 0290 | Epoch 01 | Objective: -14.4246 | Coherence: 18.2677 | Separation: 24.8035 | Information gain: 6.3333 | Grad Norm: 18.6265 | Time: 7.0s
Step 0300 | Epoch 01 | Objective: -14.1514 | Coherence: 18.2984 | Separation: 24.3937 | Information gain: 6.3333 | Grad Norm: 18.0399 | Time: 7.2s
Step 0310 | Epoch 01 | Objective: -13.9458 | Coherence: 18.3321 | Separation: 24.0020 | Information gain: 6.1667 | Grad Norm: 18.0350 | Time: 7.4s
Step 0320 | Epoch 01 | Objective: -13.6952 | Coherence: 18.3033 | Separation: 23.6261 | Information gain: 6.1667 | Grad Norm: 18.5046 | Time: 7.7s
Step 0330 | Epoch 01 | Objective: -13.4519 | Coherence: 18.3281 | Separation: 23.2612 | Information gain: 6.1667 | Grad Norm: 18.3562 | Time: 7.9s
Step 0340 | Epoch 01 | Objective: -13.1460 | Coherence: 18.3640 | Separation: 22.8856 | Information gain: 6.3333 | Grad Norm: 17.8494 | Time: 8.1s
Step 0350 | Epoch 01 | Objective: -12.8917 | Coherence: 18.3620 | Separation: 22.5042 | Information gain: 6.3333 | Grad Norm: 17.3248 | Time: 8.4s
Step 0360 | Epoch 01 | Objective: -12.6405 | Coherence: 18.3780 | Separation: 22.1273 | Information gain: 6.3333 | Grad Norm: 19.0242 | Time: 8.6s
Step 0370 | Epoch 01 | Objective: -12.3888 | Coherence: 18.3825 | Separation: 21.7498 | Information gain: 6.3333 | Grad Norm: 18.7169 | Time: 8.8s
Step 0380 | Epoch 01 | Objective: -12.2274 | Coherence: 18.3635 | Separation: 21.5078 | Information gain: 6.3333 | Grad Norm: 19.1066 | Time: 9.0s
Step 0390 | Epoch 01 | Objective: -12.0389 | Coherence: 18.2830 | Separation: 21.2251 | Information gain: 6.3333 | Grad Norm: 17.2038 | Time: 9.3s
Step 0400 | Epoch 01 | Objective: -11.8545 | Coherence: 18.2280 | Separation: 20.9483 | Information gain: 6.3333 | Grad Norm: 19.2539 | Time: 9.5s
Step 0410 | Epoch 01 | Objective: -11.6733 | Coherence: 18.1685 | Separation: 20.6766 | Information gain: 6.3333 | Grad Norm: 19.0839 | Time: 9.7s
Step 0420 | Epoch 01 | Objective: -11.4258 | Coherence: 18.1017 | Separation: 20.3886 | Information gain: 6.5000 | Grad Norm: 19.5647 | Time: 10.0s
Step 0430 | Epoch 01 | Objective: -11.2247 | Coherence: 18.0443 | Separation: 20.0870 | Information gain: 6.5000 | Grad Norm: 17.8274 | Time: 10.2s
Step 0440 | Epoch 01 | Objective: -11.0237 | Coherence: 17.9862 | Separation: 19.7855 | Information gain: 6.5000 | Grad Norm: 19.2637 | Time: 10.4s
Step 0450 | Epoch 01 | Objective: -10.8301 | Coherence: 17.9208 | Separation: 19.4951 | Information gain: 6.5000 | Grad Norm: 19.4358 | Time: 10.7s
Step 0460 | Epoch 01 | Objective: -10.6315 | Coherence: 17.8749 | Separation: 19.1973 | Information gain: 6.5000 | Grad Norm: 18.1905 | Time: 10.9s
Step 0470 | Epoch 01 | Objective: -10.5165 | Coherence: 17.8676 | Separation: 19.0247 | Information gain: 6.5000 | Grad Norm: 18.2994 | Time: 11.1s
Step 0480 | Epoch 01 | Objective: -10.3845 | Coherence: 17.8997 | Separation: 18.8268 | Information gain: 6.5000 | Grad Norm: 18.0458 | Time: 11.3s
Step 0490 | Epoch 01 | Objective: -10.2641 | Coherence: 17.8903 | Separation: 18.6462 | Information gain: 6.5000 | Grad Norm: 18.6613 | Time: 11.6s
Step 0500 | Epoch 01 | Objective: -10.1564 | Coherence: 17.8473 | Separation: 18.4846 | Information gain: 6.5000 | Grad Norm: 19.4597 | Time: 11.8s
Step 0510 | Epoch 01 | Objective: -10.0699 | Coherence: 17.8026 | Separation: 18.3548 | Information gain: 6.5000 | Grad Norm: 18.7190 | Time: 12.0s
Step 0520 | Epoch 01 | Objective: -9.9719 | Coherence: 17.7754 | Separation: 18.2079 | Information gain: 6.5000 | Grad Norm: 18.2081 | Time: 12.2s
Step 0530 | Epoch 01 | Objective: -9.8853 | Coherence: 17.7243 | Separation: 18.0779 | Information gain: 6.5000 | Grad Norm: 19.4898 | Time: 12.5s
Step 0540 | Epoch 01 | Objective: -9.8336 | Coherence: 17.6899 | Separation: 18.0003 | Information gain: 6.5000 | Grad Norm: 19.1781 | Time: 12.7s
Step 0550 | Epoch 01 | Objective: -9.7790 | Coherence: 17.6600 | Separation: 17.9185 | Information gain: 6.5000 | Grad Norm: 19.7001 | Time: 12.9s
Step 0560 | Epoch 01 | Objective: -9.7286 | Coherence: 17.6337 | Separation: 17.8429 | Information gain: 6.5000 | Grad Norm: 18.4953 | Time: 13.2s
Step 0570 | Epoch 01 | Objective: -9.6751 | Coherence: 17.5992 | Separation: 17.7626 | Information gain: 6.5000 | Grad Norm: 20.1103 | Time: 13.4s
Step 0580 | Epoch 01 | Objective: -9.5628 | Coherence: 17.5660 | Separation: 17.6775 | Information gain: 6.6667 | Grad Norm: 19.4294 | Time: 13.6s
Step 0590 | Epoch 01 | Objective: -9.5039 | Coherence: 17.5350 | Separation: 17.5892 | Information gain: 6.6667 | Grad Norm: 19.7569 | Time: 13.9s
Step 0600 | Epoch 01 | Objective: -9.4549 | Coherence: 17.5084 | Separation: 17.5157 | Information gain: 6.6667 | Grad Norm: 20.3696 | Time: 14.1s
Step 0610 | Epoch 01 | Objective: -9.4037 | Coherence: 17.4841 | Separation: 17.4389 | Information gain: 6.6667 | Grad Norm: 20.1700 | Time: 14.3s
Step 0620 | Epoch 01 | Objective: -9.3567 | Coherence: 17.4604 | Separation: 17.3684 | Information gain: 6.6667 | Grad Norm: 20.7023 | Time: 14.6s
Step 0630 | Epoch 01 | Objective: -9.3108 | Coherence: 17.4328 | Separation: 17.2995 | Information gain: 6.6667 | Grad Norm: 19.8277 | Time: 14.8s
Step 0640 | Epoch 01 | Objective: -9.2548 | Coherence: 17.4110 | Separation: 17.2155 | Information gain: 6.6667 | Grad Norm: 19.5547 | Time: 15.0s
Step 0650 | Epoch 01 | Objective: -9.1945 | Coherence: 17.3850 | Separation: 17.1251 | Information gain: 6.6667 | Grad Norm: 21.3257 | Time: 15.3s
Step 0660 | Epoch 01 | Objective: -9.1360 | Coherence: 17.3668 | Separation: 17.0374 | Information gain: 6.6667 | Grad Norm: 19.7278 | Time: 15.6s
Step 0670 | Epoch 01 | Objective: -9.0783 | Coherence: 17.3243 | Separation: 16.9508 | Information gain: 6.6667 | Grad Norm: 20.0990 | Time: 15.8s
Step 0680 | Epoch 01 | Objective: -9.0202 | Coherence: 17.3023 | Separation: 16.8636 | Information gain: 6.6667 | Grad Norm: 21.2804 | Time: 16.1s
Step 0690 | Epoch 01 | Objective: -8.9483 | Coherence: 17.2680 | Separation: 16.7558 | Information gain: 6.6667 | Grad Norm: 19.9102 | Time: 16.3s
Step 0700 | Epoch 01 | Objective: -8.8804 | Coherence: 17.2500 | Separation: 16.6539 | Information gain: 6.6667 | Grad Norm: 20.5937 | Time: 16.6s
Step 0710 | Epoch 01 | Objective: -8.8172 | Coherence: 17.2271 | Separation: 16.5591 | Information gain: 6.6667 | Grad Norm: 19.7319 | Time: 16.8s
Step 0720 | Epoch 01 | Objective: -8.6878 | Coherence: 17.1800 | Separation: 16.4484 | Information gain: 6.8333 | Grad Norm: 19.2478 | Time: 17.1s
Step 0730 | Epoch 01 | Objective: -8.6160 | Coherence: 17.1488 | Separation: 16.3406 | Information gain: 6.8333 | Grad Norm: 19.9572 | Time: 17.3s
Step 0740 | Epoch 01 | Objective: -8.5409 | Coherence: 17.1315 | Separation: 16.2281 | Information gain: 6.8333 | Grad Norm: 19.7238 | Time: 17.5s
Step 0750 | Epoch 01 | Objective: -8.4592 | Coherence: 17.0973 | Separation: 16.1055 | Information gain: 6.8333 | Grad Norm: 19.4187 | Time: 17.8s
Step 0760 | Epoch 01 | Objective: -8.3787 | Coherence: 17.0659 | Separation: 15.9847 | Information gain: 6.8333 | Grad Norm: 18.4058 | Time: 18.0s
Step 0770 | Epoch 01 | Objective: -8.2990 | Coherence: 17.0327 | Separation: 15.8651 | Information gain: 6.8333 | Grad Norm: 18.7664 | Time: 18.2s
Step 0780 | Epoch 01 | Objective: -8.2092 | Coherence: 16.9903 | Separation: 15.7305 | Information gain: 6.8333 | Grad Norm: 19.1951 | Time: 18.5s
Step 0790 | Epoch 01 | Objective: -8.1182 | Coherence: 16.9548 | Separation: 15.5939 | Information gain: 6.8333 | Grad Norm: 19.8947 | Time: 18.7s
Step 0800 | Epoch 01 | Objective: -8.0264 | Coherence: 16.9157 | Separation: 15.4563 | Information gain: 6.8333 | Grad Norm: 21.1856 | Time: 18.9s
Step 0810 | Epoch 01 | Objective: -7.9215 | Coherence: 16.8736 | Separation: 15.2990 | Information gain: 6.8333 | Grad Norm: 19.4780 | Time: 19.2s
Step 0820 | Epoch 01 | Objective: -7.8234 | Coherence: 16.8483 | Separation: 15.1518 | Information gain: 6.8333 | Grad Norm: 19.4955 | Time: 19.4s
Step 0830 | Epoch 01 | Objective: -7.7254 | Coherence: 16.7924 | Separation: 15.0048 | Information gain: 6.8333 | Grad Norm: 20.4198 | Time: 19.6s
Step 0840 | Epoch 01 | Objective: -7.5587 | Coherence: 16.7624 | Separation: 14.8380 | Information gain: 7.0000 | Grad Norm: 19.0046 | Time: 19.9s
Step 0850 | Epoch 01 | Objective: -7.4489 | Coherence: 16.7195 | Separation: 14.6734 | Information gain: 7.0000 | Grad Norm: 19.5406 | Time: 20.1s
Step 0860 | Epoch 01 | Objective: -7.3381 | Coherence: 16.6818 | Separation: 14.5071 | Information gain: 7.0000 | Grad Norm: 19.8025 | Time: 20.3s
Step 0870 | Epoch 01 | Objective: -7.2319 | Coherence: 16.6281 | Separation: 14.3478 | Information gain: 7.0000 | Grad Norm: 20.0441 | Time: 20.5s
Step 0880 | Epoch 01 | Objective: -7.1163 | Coherence: 16.5820 | Separation: 14.1745 | Information gain: 7.0000 | Grad Norm: 19.5361 | Time: 20.8s
Step 0890 | Epoch 01 | Objective: -7.0002 | Coherence: 16.5228 | Separation: 14.0002 | Information gain: 7.0000 | Grad Norm: 19.5678 | Time: 21.0s
Step 0900 | Epoch 01 | Objective: -6.8767 | Coherence: 16.4644 | Separation: 13.8151 | Information gain: 7.0000 | Grad Norm: 19.2279 | Time: 21.2s
Step 0910 | Epoch 01 | Objective: -6.7620 | Coherence: 16.4149 | Separation: 13.6430 | Information gain: 7.0000 | Grad Norm: 20.8972 | Time: 21.5s
Step 0920 | Epoch 01 | Objective: -6.6421 | Coherence: 16.3567 | Separation: 13.4631 | Information gain: 7.0000 | Grad Norm: 20.2380 | Time: 21.7s
Step 0930 | Epoch 01 | Objective: -6.5211 | Coherence: 16.3040 | Separation: 13.2817 | Information gain: 7.0000 | Grad Norm: 21.1136 | Time: 21.9s
Step 0940 | Epoch 01 | Objective: -6.3387 | Coherence: 16.2429 | Separation: 13.0913 | Information gain: 7.1667 | Grad Norm: 21.1511 | Time: 22.2s
Step 0950 | Epoch 01 | Objective: -6.2020 | Coherence: 16.1973 | Separation: 12.8864 | Information gain: 7.1667 | Grad Norm: 19.6391 | Time: 22.4s
Step 0960 | Epoch 01 | Objective: -6.1319 | Coherence: 16.1645 | Separation: 12.7812 | Information gain: 7.1667 | Grad Norm: 21.1549 | Time: 22.6s
Step 0970 | Epoch 01 | Objective: -6.0453 | Coherence: 16.1838 | Separation: 12.6513 | Information gain: 7.1667 | Grad Norm: 20.3529 | Time: 22.9s
Step 0980 | Epoch 01 | Objective: -5.9635 | Coherence: 16.1758 | Separation: 12.5285 | Information gain: 7.1667 | Grad Norm: 20.7969 | Time: 23.1s
Step 0990 | Epoch 01 | Objective: -5.8820 | Coherence: 16.1793 | Separation: 12.4064 | Information gain: 7.1667 | Grad Norm: 21.7459 | Time: 23.3s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.583333  0.411064  0.495849  ...  0.448399  0.537291  0.488796
1  0.444741  0.638396  0.491887  ...  0.569826  0.399729  0.478782
2  0.518737  0.482908  0.605033  ...  0.498670  0.505190  0.559622
3  0.467254  0.600029  0.515107  ...  0.633702  0.434445  0.462459
4  0.480309  0.571875  0.516719  ...  0.629844  0.454186  0.462628

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7957
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8897
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8723
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.1870, accuracy=0.0963
Testing SVM
  SVM Test Accuracy: 0.8502
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8273

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6670, Accuracy: 9475/12000 (79%)

Epoch 1 | Train Acc: 0.6731458333333333 | Test Acc: 0.7895833333333333 | Time: 1.1494057178497314 sec

Test set: Average loss: 0.5399, Accuracy: 9883/12000 (82%)

Epoch 2 | Train Acc: 0.8239166666666666 | Test Acc: 0.8235833333333333 | Time: 1.0271925926208496 sec

Test set: Average loss: 0.4836, Accuracy: 10125/12000 (84%)

Epoch 3 | Train Acc: 0.850625 | Test Acc: 0.84375 | Time: 1.0241518020629883 sec

Test set: Average loss: 0.4421, Accuracy: 10301/12000 (86%)

Epoch 4 | Train Acc: 0.8663958333333334 | Test Acc: 0.8584166666666667 | Time: 1.0954599380493164 sec

Test set: Average loss: 0.4123, Accuracy: 10417/12000 (87%)

Epoch 5 | Train Acc: 0.8768958333333333 | Test Acc: 0.8680833333333333 | Time: 1.3329613208770752 sec

Test set: Average loss: 0.3911, Accuracy: 10483/12000 (87%)

Epoch 6 | Train Acc: 0.8834166666666666 | Test Acc: 0.8735833333333334 | Time: 1.0415902137756348 sec

Test set: Average loss: 0.3752, Accuracy: 10542/12000 (88%)

Epoch 7 | Train Acc: 0.888125 | Test Acc: 0.8785 | Time: 1.0312514305114746 sec

Test set: Average loss: 0.3641, Accuracy: 10589/12000 (88%)

Epoch 8 | Train Acc: 0.8914791666666667 | Test Acc: 0.8824166666666666 | Time: 1.0263714790344238 sec

Test set: Average loss: 0.3569, Accuracy: 10612/12000 (88%)

Epoch 9 | Train Acc: 0.8943541666666667 | Test Acc: 0.8843333333333333 | Time: 1.0213732719421387 sec

Test set: Average loss: 0.3521, Accuracy: 10630/12000 (89%)

Epoch 10 | Train Acc: 0.8959791666666667 | Test Acc: 0.8858333333333334 | Time: 1.1217405796051025 sec

Test set: Average loss: 0.3492, Accuracy: 10640/12000 (89%)

Epoch 11 | Train Acc: 0.8965833333333333 | Test Acc: 0.8866666666666667 | Time: 1.0270614624023438 sec

Test set: Average loss: 0.3474, Accuracy: 10647/12000 (89%)

Epoch 12 | Train Acc: 0.8973333333333333 | Test Acc: 0.88725 | Time: 1.0340216159820557 sec

Test set: Average loss: 0.3463, Accuracy: 10660/12000 (89%)

Epoch 13 | Train Acc: 0.898 | Test Acc: 0.8883333333333333 | Time: 1.0282790660858154 sec

Test set: Average loss: 0.3455, Accuracy: 10657/12000 (89%)

Epoch 14 | Train Acc: 0.8984166666666666 | Test Acc: 0.8880833333333333 | Time: 1.0299487113952637 sec

Test set: Average loss: 0.3450, Accuracy: 10659/12000 (89%)

Epoch 15 | Train Acc: 0.8984166666666666 | Test Acc: 0.88825 | Time: 1.2796001434326172 sec

Test set: Average loss: 0.3446, Accuracy: 10663/12000 (89%)

Epoch 16 | Train Acc: 0.8985833333333333 | Test Acc: 0.8885833333333333 | Time: 1.1102900505065918 sec

Test set: Average loss: 0.3443, Accuracy: 10666/12000 (89%)

Epoch 17 | Train Acc: 0.8986458333333334 | Test Acc: 0.8888333333333334 | Time: 1.0300438404083252 sec

Test set: Average loss: 0.3441, Accuracy: 10670/12000 (89%)

Epoch 18 | Train Acc: 0.8987916666666667 | Test Acc: 0.8891666666666667 | Time: 1.0274841785430908 sec

Test set: Average loss: 0.3440, Accuracy: 10671/12000 (89%)

Epoch 19 | Train Acc: 0.8987708333333333 | Test Acc: 0.88925 | Time: 1.1210911273956299 sec

Test set: Average loss: 0.3439, Accuracy: 10670/12000 (89%)

Epoch 20 | Train Acc: 0.8988125 | Test Acc: 0.8891666666666667 | Time: 1.0260124206542969 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -29.0722 | Coherence: 15.3745 | Separation: 50.6083 | Information gain: 7.0000 | Grad Norm: 25.5772 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -27.7132 | Coherence: 15.2174 | Separation: 48.5697 | Information gain: 7.0000 | Grad Norm: 25.1096 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -26.5318 | Coherence: 15.0635 | Separation: 46.6310 | Information gain: 6.8333 | Grad Norm: 24.3830 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -25.3411 | Coherence: 14.9026 | Separation: 44.8450 | Information gain: 6.8333 | Grad Norm: 22.9878 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: -24.2789 | Coherence: 14.7871 | Separation: 43.2518 | Information gain: 6.8333 | Grad Norm: 22.5511 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -23.3014 | Coherence: 14.6158 | Separation: 41.7854 | Information gain: 6.8333 | Grad Norm: 21.3389 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -22.5057 | Coherence: 14.4521 | Separation: 40.5919 | Information gain: 6.8333 | Grad Norm: 20.8278 | Time: 1.5s
Step 0070 | Epoch 01 | Objective: -21.7000 | Coherence: 14.3598 | Separation: 39.3834 | Information gain: 6.8333 | Grad Norm: 20.6263 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -20.8906 | Coherence: 14.1837 | Separation: 38.1693 | Information gain: 6.8333 | Grad Norm: 20.0131 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -20.2965 | Coherence: 14.0674 | Separation: 37.1113 | Information gain: 6.6667 | Grad Norm: 19.8179 | Time: 2.2s
Step 0100 | Epoch 01 | Objective: -19.6378 | Coherence: 14.0335 | Separation: 36.1234 | Information gain: 6.6667 | Grad Norm: 19.4297 | Time: 2.4s
Step 0110 | Epoch 01 | Objective: -19.1002 | Coherence: 14.0430 | Separation: 35.1503 | Information gain: 6.5000 | Grad Norm: 20.0435 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -18.4643 | Coherence: 14.0553 | Separation: 34.1965 | Information gain: 6.5000 | Grad Norm: 19.1254 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -17.9225 | Coherence: 14.0375 | Separation: 33.3837 | Information gain: 6.5000 | Grad Norm: 18.7379 | Time: 3.1s
Step 0140 | Epoch 01 | Objective: -17.3778 | Coherence: 13.9576 | Separation: 32.5667 | Information gain: 6.5000 | Grad Norm: 19.4511 | Time: 3.3s
Step 0150 | Epoch 01 | Objective: -16.8428 | Coherence: 13.8828 | Separation: 31.7642 | Information gain: 6.5000 | Grad Norm: 18.5215 | Time: 3.6s
Step 0160 | Epoch 01 | Objective: -16.3857 | Coherence: 13.8048 | Separation: 31.0785 | Information gain: 6.5000 | Grad Norm: 18.8888 | Time: 3.8s
Step 0170 | Epoch 01 | Objective: -15.9552 | Coherence: 13.7568 | Separation: 30.4329 | Information gain: 6.5000 | Grad Norm: 18.3916 | Time: 4.1s
Step 0180 | Epoch 01 | Objective: -15.5047 | Coherence: 13.7131 | Separation: 29.7570 | Information gain: 6.5000 | Grad Norm: 18.5552 | Time: 4.4s
Step 0190 | Epoch 01 | Objective: -14.9510 | Coherence: 13.6581 | Separation: 29.0932 | Information gain: 6.6667 | Grad Norm: 19.7360 | Time: 4.6s
Step 0200 | Epoch 01 | Objective: -14.5384 | Coherence: 13.6508 | Separation: 28.4743 | Information gain: 6.6667 | Grad Norm: 18.1335 | Time: 4.9s
Step 0210 | Epoch 01 | Objective: -14.1555 | Coherence: 13.5941 | Separation: 27.8999 | Information gain: 6.6667 | Grad Norm: 19.3204 | Time: 5.1s
Step 0220 | Epoch 01 | Objective: -13.6579 | Coherence: 13.4979 | Separation: 27.3202 | Information gain: 6.8333 | Grad Norm: 18.2564 | Time: 5.4s
Step 0230 | Epoch 01 | Objective: -13.2314 | Coherence: 13.4233 | Separation: 26.8472 | Information gain: 7.0000 | Grad Norm: 17.6065 | Time: 5.6s
Step 0240 | Epoch 01 | Objective: -12.9949 | Coherence: 13.3428 | Separation: 26.4924 | Information gain: 7.0000 | Grad Norm: 17.4195 | Time: 5.8s
Step 0250 | Epoch 01 | Objective: -12.7983 | Coherence: 13.2817 | Separation: 26.1975 | Information gain: 7.0000 | Grad Norm: 18.0507 | Time: 6.1s
Step 0260 | Epoch 01 | Objective: -12.6025 | Coherence: 13.2136 | Separation: 25.9037 | Information gain: 7.0000 | Grad Norm: 18.1771 | Time: 6.3s
Step 0270 | Epoch 01 | Objective: -12.3917 | Coherence: 13.1498 | Separation: 25.5876 | Information gain: 7.0000 | Grad Norm: 18.9927 | Time: 6.5s
Step 0280 | Epoch 01 | Objective: -12.1672 | Coherence: 13.1110 | Separation: 25.2508 | Information gain: 7.0000 | Grad Norm: 17.3872 | Time: 6.8s
Step 0290 | Epoch 01 | Objective: -11.9978 | Coherence: 13.0802 | Separation: 24.9967 | Information gain: 7.0000 | Grad Norm: 17.3593 | Time: 7.0s
Step 0300 | Epoch 01 | Objective: -11.8389 | Coherence: 13.0696 | Separation: 24.7583 | Information gain: 7.0000 | Grad Norm: 17.7434 | Time: 7.2s
Step 0310 | Epoch 01 | Objective: -11.6696 | Coherence: 13.0581 | Separation: 24.5044 | Information gain: 7.0000 | Grad Norm: 18.0808 | Time: 7.5s
Step 0320 | Epoch 01 | Objective: -11.4845 | Coherence: 13.0510 | Separation: 24.2267 | Information gain: 7.0000 | Grad Norm: 17.8025 | Time: 7.7s
Step 0330 | Epoch 01 | Objective: -11.2897 | Coherence: 13.0478 | Separation: 23.9346 | Information gain: 7.0000 | Grad Norm: 18.6689 | Time: 7.9s
Step 0340 | Epoch 01 | Objective: -11.0903 | Coherence: 13.0506 | Separation: 23.6354 | Information gain: 7.0000 | Grad Norm: 17.6443 | Time: 8.1s
Step 0350 | Epoch 01 | Objective: -10.9009 | Coherence: 13.0773 | Separation: 23.3514 | Information gain: 7.0000 | Grad Norm: 17.9393 | Time: 8.4s
Step 0360 | Epoch 01 | Objective: -10.7024 | Coherence: 13.1045 | Separation: 23.0535 | Information gain: 7.0000 | Grad Norm: 17.6590 | Time: 8.6s
Step 0370 | Epoch 01 | Objective: -10.5315 | Coherence: 13.1283 | Separation: 22.7973 | Information gain: 7.0000 | Grad Norm: 16.3157 | Time: 8.8s
Step 0380 | Epoch 01 | Objective: -10.3583 | Coherence: 13.1578 | Separation: 22.5374 | Information gain: 7.0000 | Grad Norm: 17.3968 | Time: 9.0s
Step 0390 | Epoch 01 | Objective: -10.1788 | Coherence: 13.1895 | Separation: 22.2681 | Information gain: 7.0000 | Grad Norm: 17.4981 | Time: 9.3s
Step 0400 | Epoch 01 | Objective: -10.0053 | Coherence: 13.2440 | Separation: 22.0079 | Information gain: 7.0000 | Grad Norm: 18.5374 | Time: 9.5s
Step 0410 | Epoch 01 | Objective: -9.8408 | Coherence: 13.2480 | Separation: 21.7612 | Information gain: 7.0000 | Grad Norm: 17.3757 | Time: 9.7s
Step 0420 | Epoch 01 | Objective: -9.5722 | Coherence: 13.2946 | Separation: 21.5249 | Information gain: 7.1667 | Grad Norm: 17.4661 | Time: 9.9s
Step 0430 | Epoch 01 | Objective: -9.4186 | Coherence: 13.3615 | Separation: 21.2945 | Information gain: 7.1667 | Grad Norm: 17.8828 | Time: 10.2s
Step 0440 | Epoch 01 | Objective: -9.2858 | Coherence: 13.4081 | Separation: 21.0954 | Information gain: 7.1667 | Grad Norm: 17.5271 | Time: 10.4s
Step 0450 | Epoch 01 | Objective: -9.1545 | Coherence: 13.4518 | Separation: 20.8984 | Information gain: 7.1667 | Grad Norm: 18.9800 | Time: 10.6s
Step 0460 | Epoch 01 | Objective: -9.0311 | Coherence: 13.4953 | Separation: 20.7134 | Information gain: 7.1667 | Grad Norm: 16.9796 | Time: 10.9s
Step 0470 | Epoch 01 | Objective: -8.8899 | Coherence: 13.5368 | Separation: 20.5015 | Information gain: 7.1667 | Grad Norm: 18.2075 | Time: 11.1s
Step 0480 | Epoch 01 | Objective: -8.7744 | Coherence: 13.5810 | Separation: 20.3283 | Information gain: 7.1667 | Grad Norm: 17.3073 | Time: 11.4s
Step 0490 | Epoch 01 | Objective: -8.6557 | Coherence: 13.5452 | Separation: 20.1502 | Information gain: 7.1667 | Grad Norm: 18.1913 | Time: 11.6s
Step 0500 | Epoch 01 | Objective: -8.5388 | Coherence: 13.5322 | Separation: 19.9749 | Information gain: 7.1667 | Grad Norm: 19.5776 | Time: 11.8s
Step 0510 | Epoch 01 | Objective: -8.4224 | Coherence: 13.5177 | Separation: 19.8003 | Information gain: 7.1667 | Grad Norm: 17.5860 | Time: 12.0s
Step 0520 | Epoch 01 | Objective: -8.3073 | Coherence: 13.4984 | Separation: 19.6277 | Information gain: 7.1667 | Grad Norm: 17.6998 | Time: 12.3s
Step 0530 | Epoch 01 | Objective: -8.1870 | Coherence: 13.4906 | Separation: 19.4472 | Information gain: 7.1667 | Grad Norm: 17.5143 | Time: 12.5s
Step 0540 | Epoch 01 | Objective: -8.0875 | Coherence: 13.4780 | Separation: 19.2979 | Information gain: 7.1667 | Grad Norm: 18.4426 | Time: 12.7s
Step 0550 | Epoch 01 | Objective: -7.9886 | Coherence: 13.4554 | Separation: 19.1496 | Information gain: 7.1667 | Grad Norm: 17.3919 | Time: 13.0s
Step 0560 | Epoch 01 | Objective: -7.9105 | Coherence: 13.4311 | Separation: 19.0324 | Information gain: 7.1667 | Grad Norm: 17.0392 | Time: 13.2s
Step 0570 | Epoch 01 | Objective: -7.8359 | Coherence: 13.4399 | Separation: 18.9205 | Information gain: 7.1667 | Grad Norm: 19.4589 | Time: 13.4s
Step 0580 | Epoch 01 | Objective: -7.7654 | Coherence: 13.4388 | Separation: 18.8148 | Information gain: 7.1667 | Grad Norm: 18.1549 | Time: 13.7s
Step 0590 | Epoch 01 | Objective: -7.7031 | Coherence: 13.4347 | Separation: 18.7213 | Information gain: 7.1667 | Grad Norm: 17.9863 | Time: 13.9s
Step 0600 | Epoch 01 | Objective: -7.6365 | Coherence: 13.4332 | Separation: 18.6214 | Information gain: 7.1667 | Grad Norm: 19.6977 | Time: 14.1s
Step 0610 | Epoch 01 | Objective: -7.5667 | Coherence: 13.4368 | Separation: 18.5167 | Information gain: 7.1667 | Grad Norm: 19.9014 | Time: 14.4s
Step 0620 | Epoch 01 | Objective: -7.4933 | Coherence: 13.4291 | Separation: 18.4066 | Information gain: 7.1667 | Grad Norm: 18.9983 | Time: 14.7s
Step 0630 | Epoch 01 | Objective: -7.4213 | Coherence: 13.4234 | Separation: 18.2986 | Information gain: 7.1667 | Grad Norm: 19.0933 | Time: 15.0s
Step 0640 | Epoch 01 | Objective: -7.3738 | Coherence: 13.4283 | Separation: 18.2274 | Information gain: 7.1667 | Grad Norm: 18.9015 | Time: 15.2s
Step 0650 | Epoch 01 | Objective: -7.3253 | Coherence: 13.4389 | Separation: 18.1546 | Information gain: 7.1667 | Grad Norm: 20.1652 | Time: 15.5s
Step 0660 | Epoch 01 | Objective: -7.2703 | Coherence: 13.4378 | Separation: 18.0721 | Information gain: 7.1667 | Grad Norm: 20.4927 | Time: 15.7s
Step 0670 | Epoch 01 | Objective: -7.2192 | Coherence: 13.4366 | Separation: 17.9955 | Information gain: 7.1667 | Grad Norm: 20.2038 | Time: 15.9s
Step 0680 | Epoch 01 | Objective: -7.1600 | Coherence: 13.4422 | Separation: 17.9067 | Information gain: 7.1667 | Grad Norm: 18.9376 | Time: 16.2s
Step 0690 | Epoch 01 | Objective: -7.2124 | Coherence: 13.4353 | Separation: 17.8187 | Information gain: 7.0000 | Grad Norm: 19.4264 | Time: 16.4s
Step 0700 | Epoch 01 | Objective: -7.1457 | Coherence: 13.4344 | Separation: 17.7186 | Information gain: 7.0000 | Grad Norm: 18.6757 | Time: 16.6s
Step 0710 | Epoch 01 | Objective: -7.0801 | Coherence: 13.4326 | Separation: 17.6201 | Information gain: 7.0000 | Grad Norm: 20.3777 | Time: 16.9s
Step 0720 | Epoch 01 | Objective: -7.0167 | Coherence: 13.4209 | Separation: 17.5251 | Information gain: 7.0000 | Grad Norm: 20.0142 | Time: 17.1s
Step 0730 | Epoch 01 | Objective: -6.9583 | Coherence: 13.4078 | Separation: 17.4374 | Information gain: 7.0000 | Grad Norm: 19.5129 | Time: 17.3s
Step 0740 | Epoch 01 | Objective: -6.9053 | Coherence: 13.3901 | Separation: 17.3579 | Information gain: 7.0000 | Grad Norm: 19.9281 | Time: 17.6s
Step 0750 | Epoch 01 | Objective: -6.7306 | Coherence: 13.3823 | Separation: 17.2626 | Information gain: 7.1667 | Grad Norm: 20.1487 | Time: 17.8s
Step 0760 | Epoch 01 | Objective: -6.6644 | Coherence: 13.3652 | Separation: 17.1633 | Information gain: 7.1667 | Grad Norm: 22.1639 | Time: 18.0s
Step 0770 | Epoch 01 | Objective: -6.5972 | Coherence: 13.3465 | Separation: 17.0624 | Information gain: 7.1667 | Grad Norm: 20.1475 | Time: 18.3s
Step 0780 | Epoch 01 | Objective: -6.5254 | Coherence: 13.3372 | Separation: 16.9548 | Information gain: 7.1667 | Grad Norm: 19.5809 | Time: 18.5s
Step 0790 | Epoch 01 | Objective: -6.4567 | Coherence: 13.3119 | Separation: 16.8518 | Information gain: 7.1667 | Grad Norm: 19.6654 | Time: 18.7s
Step 0800 | Epoch 01 | Objective: -6.3735 | Coherence: 13.2980 | Separation: 16.7269 | Information gain: 7.1667 | Grad Norm: 19.5023 | Time: 18.9s
Step 0810 | Epoch 01 | Objective: -6.2938 | Coherence: 13.2710 | Separation: 16.6074 | Information gain: 7.1667 | Grad Norm: 19.4236 | Time: 19.2s
Step 0820 | Epoch 01 | Objective: -6.2139 | Coherence: 13.2608 | Separation: 16.4875 | Information gain: 7.1667 | Grad Norm: 20.8858 | Time: 19.4s
Step 0830 | Epoch 01 | Objective: -6.1300 | Coherence: 13.2296 | Separation: 16.3617 | Information gain: 7.1667 | Grad Norm: 19.0158 | Time: 19.6s
Step 0840 | Epoch 01 | Objective: -6.0364 | Coherence: 13.2102 | Separation: 16.2213 | Information gain: 7.1667 | Grad Norm: 18.7969 | Time: 19.8s
Step 0850 | Epoch 01 | Objective: -5.9584 | Coherence: 13.1736 | Separation: 16.1043 | Information gain: 7.1667 | Grad Norm: 19.3544 | Time: 20.1s
Step 0860 | Epoch 01 | Objective: -5.8738 | Coherence: 13.1544 | Separation: 15.9773 | Information gain: 7.1667 | Grad Norm: 19.2553 | Time: 20.3s
Step 0870 | Epoch 01 | Objective: -5.7915 | Coherence: 13.1300 | Separation: 15.8539 | Information gain: 7.1667 | Grad Norm: 20.8784 | Time: 20.5s
Step 0880 | Epoch 01 | Objective: -5.7105 | Coherence: 13.1019 | Separation: 15.7324 | Information gain: 7.1667 | Grad Norm: 20.5728 | Time: 20.8s
Step 0890 | Epoch 01 | Objective: -5.6668 | Coherence: 13.0932 | Separation: 15.6668 | Information gain: 7.1667 | Grad Norm: 19.3931 | Time: 21.0s
Step 0900 | Epoch 01 | Objective: -5.6146 | Coherence: 13.0860 | Separation: 15.5886 | Information gain: 7.1667 | Grad Norm: 20.3900 | Time: 21.2s
Step 0910 | Epoch 01 | Objective: -5.5571 | Coherence: 13.0718 | Separation: 15.5023 | Information gain: 7.1667 | Grad Norm: 19.6911 | Time: 21.5s
Step 0920 | Epoch 01 | Objective: -5.4986 | Coherence: 13.0585 | Separation: 15.4145 | Information gain: 7.1667 | Grad Norm: 19.8382 | Time: 21.7s
Step 0930 | Epoch 01 | Objective: -5.4381 | Coherence: 13.0376 | Separation: 15.3237 | Information gain: 7.1667 | Grad Norm: 20.5084 | Time: 21.9s
Step 0940 | Epoch 01 | Objective: -5.3780 | Coherence: 13.0254 | Separation: 15.2337 | Information gain: 7.1667 | Grad Norm: 20.2164 | Time: 22.2s
Step 0950 | Epoch 01 | Objective: -5.3184 | Coherence: 13.0149 | Separation: 15.1442 | Information gain: 7.1667 | Grad Norm: 19.8038 | Time: 22.4s
Step 0960 | Epoch 01 | Objective: -5.2518 | Coherence: 12.9893 | Separation: 15.0444 | Information gain: 7.1667 | Grad Norm: 20.5636 | Time: 22.6s
Step 0970 | Epoch 01 | Objective: -5.0754 | Coherence: 12.9713 | Separation: 14.9465 | Information gain: 7.3333 | Grad Norm: 22.2352 | Time: 22.9s
Step 0980 | Epoch 01 | Objective: -4.9998 | Coherence: 12.9485 | Separation: 14.8331 | Information gain: 7.3333 | Grad Norm: 20.9307 | Time: 23.1s
Step 0990 | Epoch 01 | Objective: -4.9244 | Coherence: 12.9355 | Separation: 14.7199 | Information gain: 7.3333 | Grad Norm: 21.2376 | Time: 23.3s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.577250  0.266798  0.421680  ... -0.468470  0.266409 -0.393702
1  0.224615  0.509975  0.452882  ... -0.454227  0.509707 -0.460381
2  0.316498  0.474082  0.586296  ... -0.521130  0.473933 -0.459825
3  0.230226  0.504603  0.510933  ... -0.548922  0.504538 -0.505831
4  0.261599  0.496343  0.517820  ... -0.559215  0.496260 -0.503901

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8066
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8972
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8837
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.9301, accuracy=0.0867
Testing SVM
  SVM Test Accuracy: 0.8600
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8356

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6680, Accuracy: 9611/12000 (80%)

Epoch 1 | Train Acc: 0.6645 | Test Acc: 0.8009166666666667 | Time: 1.128911018371582 sec

Test set: Average loss: 0.4790, Accuracy: 10226/12000 (85%)

Epoch 2 | Train Acc: 0.8319583333333334 | Test Acc: 0.8521666666666666 | Time: 1.0304279327392578 sec

Test set: Average loss: 0.4286, Accuracy: 10381/12000 (87%)

Epoch 3 | Train Acc: 0.8550208333333333 | Test Acc: 0.8650833333333333 | Time: 1.0294163227081299 sec

Test set: Average loss: 0.3955, Accuracy: 10504/12000 (88%)

Epoch 4 | Train Acc: 0.8677708333333334 | Test Acc: 0.8753333333333333 | Time: 1.0256013870239258 sec

Test set: Average loss: 0.3762, Accuracy: 10559/12000 (88%)

Epoch 5 | Train Acc: 0.8759583333333333 | Test Acc: 0.8799166666666667 | Time: 1.0234882831573486 sec

Test set: Average loss: 0.3637, Accuracy: 10605/12000 (88%)

Epoch 6 | Train Acc: 0.8812708333333333 | Test Acc: 0.88375 | Time: 1.0264084339141846 sec

Test set: Average loss: 0.3556, Accuracy: 10632/12000 (89%)

Epoch 7 | Train Acc: 0.8853125 | Test Acc: 0.886 | Time: 1.1275403499603271 sec

Test set: Average loss: 0.3494, Accuracy: 10645/12000 (89%)

Epoch 8 | Train Acc: 0.8884791666666667 | Test Acc: 0.8870833333333333 | Time: 1.0240530967712402 sec

Test set: Average loss: 0.3456, Accuracy: 10667/12000 (89%)

Epoch 9 | Train Acc: 0.8902291666666666 | Test Acc: 0.8889166666666667 | Time: 1.0305089950561523 sec

Test set: Average loss: 0.3426, Accuracy: 10678/12000 (89%)

Epoch 10 | Train Acc: 0.891625 | Test Acc: 0.8898333333333334 | Time: 1.0235648155212402 sec

Test set: Average loss: 0.3406, Accuracy: 10688/12000 (89%)

Epoch 11 | Train Acc: 0.8927708333333333 | Test Acc: 0.8906666666666667 | Time: 1.0209996700286865 sec

Test set: Average loss: 0.3389, Accuracy: 10693/12000 (89%)

Epoch 12 | Train Acc: 0.8933125 | Test Acc: 0.8910833333333333 | Time: 1.0284502506256104 sec

Test set: Average loss: 0.3378, Accuracy: 10696/12000 (89%)

Epoch 13 | Train Acc: 0.8938541666666666 | Test Acc: 0.8913333333333333 | Time: 1.0224769115447998 sec

Test set: Average loss: 0.3369, Accuracy: 10708/12000 (89%)

Epoch 14 | Train Acc: 0.8943958333333333 | Test Acc: 0.8923333333333333 | Time: 1.0255763530731201 sec

Test set: Average loss: 0.3364, Accuracy: 10712/12000 (89%)

Epoch 15 | Train Acc: 0.8947916666666667 | Test Acc: 0.8926666666666667 | Time: 1.1004846096038818 sec

Test set: Average loss: 0.3360, Accuracy: 10708/12000 (89%)

Epoch 16 | Train Acc: 0.8951458333333333 | Test Acc: 0.8923333333333333 | Time: 1.3441884517669678 sec

Test set: Average loss: 0.3358, Accuracy: 10707/12000 (89%)

Epoch 17 | Train Acc: 0.8953125 | Test Acc: 0.89225 | Time: 1.1359734535217285 sec

Test set: Average loss: 0.3357, Accuracy: 10710/12000 (89%)

Epoch 18 | Train Acc: 0.8952916666666667 | Test Acc: 0.8925 | Time: 1.0268187522888184 sec

Test set: Average loss: 0.3356, Accuracy: 10711/12000 (89%)

Epoch 19 | Train Acc: 0.8954166666666666 | Test Acc: 0.8925833333333333 | Time: 1.0253264904022217 sec

Test set: Average loss: 0.3355, Accuracy: 10710/12000 (89%)

Epoch 20 | Train Acc: 0.8954791666666667 | Test Acc: 0.8925 | Time: 1.0186283588409424 sec
Early stopping at epoch 20

Testing with M=15
Step 0000 | Epoch 01 | Objective: -24.7159 | Coherence: 10.8928 | Separation: 50.3239 | Information gain: 8.8333 | Grad Norm: 21.9803 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -24.1267 | Coherence: 10.7917 | Separation: 49.1901 | Information gain: 8.6667 | Grad Norm: 21.9167 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -23.3376 | Coherence: 10.6412 | Separation: 48.0064 | Information gain: 8.6667 | Grad Norm: 21.7896 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -22.3631 | Coherence: 10.5316 | Separation: 46.7946 | Information gain: 8.8333 | Grad Norm: 21.7330 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -21.5381 | Coherence: 10.4402 | Separation: 45.5571 | Information gain: 8.8333 | Grad Norm: 21.5555 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -20.8938 | Coherence: 10.3547 | Separation: 44.3406 | Information gain: 8.6667 | Grad Norm: 21.6199 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -20.0674 | Coherence: 10.2607 | Separation: 43.1011 | Information gain: 8.6667 | Grad Norm: 20.6894 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -19.2624 | Coherence: 10.1309 | Separation: 41.8936 | Information gain: 8.6667 | Grad Norm: 20.5512 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -18.5516 | Coherence: 9.9223 | Separation: 40.8275 | Information gain: 8.6667 | Grad Norm: 20.0935 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -18.0406 | Coherence: 9.7663 | Separation: 39.8109 | Information gain: 8.5000 | Grad Norm: 20.7237 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -17.3954 | Coherence: 9.6770 | Separation: 38.8431 | Information gain: 8.5000 | Grad Norm: 20.1450 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -16.8018 | Coherence: 9.5131 | Separation: 37.9527 | Information gain: 8.5000 | Grad Norm: 19.8801 | Time: 2.5s
Step 0120 | Epoch 01 | Objective: -16.1517 | Coherence: 9.2844 | Separation: 36.9776 | Information gain: 8.5000 | Grad Norm: 20.1150 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -15.5205 | Coherence: 9.0759 | Separation: 36.0307 | Information gain: 8.5000 | Grad Norm: 19.5567 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -14.9794 | Coherence: 8.8657 | Separation: 35.2191 | Information gain: 8.5000 | Grad Norm: 18.9646 | Time: 3.2s
Step 0150 | Epoch 01 | Objective: -14.4448 | Coherence: 8.7367 | Separation: 34.4172 | Information gain: 8.5000 | Grad Norm: 19.2094 | Time: 3.4s
Step 0160 | Epoch 01 | Objective: -13.7164 | Coherence: 8.6496 | Separation: 33.5746 | Information gain: 8.6667 | Grad Norm: 19.0499 | Time: 3.7s
Step 0170 | Epoch 01 | Objective: -12.9679 | Coherence: 8.5140 | Separation: 32.7018 | Information gain: 8.8333 | Grad Norm: 19.2251 | Time: 3.9s
Step 0180 | Epoch 01 | Objective: -12.5306 | Coherence: 8.4124 | Separation: 31.7959 | Information gain: 8.6667 | Grad Norm: 19.1694 | Time: 4.1s
Step 0190 | Epoch 01 | Objective: -11.9975 | Coherence: 8.3062 | Separation: 30.9963 | Information gain: 8.6667 | Grad Norm: 18.6017 | Time: 4.4s
Step 0200 | Epoch 01 | Objective: -11.6439 | Coherence: 8.1987 | Separation: 30.2158 | Information gain: 8.5000 | Grad Norm: 19.8972 | Time: 4.6s
Step 0210 | Epoch 01 | Objective: -11.1467 | Coherence: 8.1197 | Separation: 29.4701 | Information gain: 8.5000 | Grad Norm: 18.6156 | Time: 4.8s
Step 0220 | Epoch 01 | Objective: -10.4919 | Coherence: 8.0594 | Separation: 28.7379 | Information gain: 8.6667 | Grad Norm: 18.8748 | Time: 5.1s
Step 0230 | Epoch 01 | Objective: -10.0336 | Coherence: 8.0011 | Separation: 28.0505 | Information gain: 8.6667 | Grad Norm: 17.1234 | Time: 5.3s
Step 0240 | Epoch 01 | Objective: -9.6386 | Coherence: 7.9326 | Separation: 27.4578 | Information gain: 8.6667 | Grad Norm: 16.8584 | Time: 5.5s
Step 0250 | Epoch 01 | Objective: -9.2416 | Coherence: 7.9171 | Separation: 26.8624 | Information gain: 8.6667 | Grad Norm: 19.3403 | Time: 5.7s
Step 0260 | Epoch 01 | Objective: -8.8226 | Coherence: 7.8699 | Separation: 26.2339 | Information gain: 8.6667 | Grad Norm: 17.7582 | Time: 6.0s
Step 0270 | Epoch 01 | Objective: -8.4184 | Coherence: 7.8285 | Separation: 25.6276 | Information gain: 8.6667 | Grad Norm: 18.0596 | Time: 6.2s
Step 0280 | Epoch 01 | Objective: -8.0236 | Coherence: 7.7805 | Separation: 25.0353 | Information gain: 8.6667 | Grad Norm: 17.7558 | Time: 6.4s
Step 0290 | Epoch 01 | Objective: -7.6164 | Coherence: 7.7135 | Separation: 24.4246 | Information gain: 8.6667 | Grad Norm: 18.8343 | Time: 6.6s
Step 0300 | Epoch 01 | Objective: -7.2473 | Coherence: 7.6134 | Separation: 23.8709 | Information gain: 8.6667 | Grad Norm: 18.3528 | Time: 6.9s
Step 0310 | Epoch 01 | Objective: -6.8694 | Coherence: 7.5275 | Separation: 23.3041 | Information gain: 8.6667 | Grad Norm: 18.4626 | Time: 7.1s
Step 0320 | Epoch 01 | Objective: -6.3405 | Coherence: 7.4097 | Separation: 22.7607 | Information gain: 8.8333 | Grad Norm: 17.2152 | Time: 7.3s
Step 0330 | Epoch 01 | Objective: -5.8495 | Coherence: 7.2560 | Separation: 22.2742 | Information gain: 9.0000 | Grad Norm: 17.4763 | Time: 7.5s
Step 0340 | Epoch 01 | Objective: -5.5191 | Coherence: 7.1500 | Separation: 21.7787 | Information gain: 9.0000 | Grad Norm: 19.1070 | Time: 7.8s
Step 0350 | Epoch 01 | Objective: -5.3934 | Coherence: 7.0604 | Separation: 21.3401 | Information gain: 8.8333 | Grad Norm: 18.6144 | Time: 8.0s
Step 0360 | Epoch 01 | Objective: -5.1103 | Coherence: 6.9877 | Separation: 20.9154 | Information gain: 8.8333 | Grad Norm: 17.2359 | Time: 8.3s
Step 0370 | Epoch 01 | Objective: -4.8503 | Coherence: 6.9694 | Separation: 20.5254 | Information gain: 8.8333 | Grad Norm: 17.7440 | Time: 8.6s
Step 0380 | Epoch 01 | Objective: -4.5673 | Coherence: 6.9285 | Separation: 20.1009 | Information gain: 8.8333 | Grad Norm: 18.3588 | Time: 8.8s
Step 0390 | Epoch 01 | Objective: -4.2944 | Coherence: 6.8749 | Separation: 19.6916 | Information gain: 8.8333 | Grad Norm: 18.1882 | Time: 9.1s
Step 0400 | Epoch 01 | Objective: -4.0198 | Coherence: 6.8499 | Separation: 19.2797 | Information gain: 8.8333 | Grad Norm: 19.3465 | Time: 9.3s
Step 0410 | Epoch 01 | Objective: -3.7349 | Coherence: 6.8132 | Separation: 18.8523 | Information gain: 8.8333 | Grad Norm: 17.8364 | Time: 9.6s
Step 0420 | Epoch 01 | Objective: -3.4690 | Coherence: 6.8338 | Separation: 18.4535 | Information gain: 8.8333 | Grad Norm: 18.3350 | Time: 9.8s
Step 0430 | Epoch 01 | Objective: -2.8749 | Coherence: 6.8354 | Separation: 18.0624 | Information gain: 9.1667 | Grad Norm: 17.9510 | Time: 10.1s
Step 0440 | Epoch 01 | Objective: -2.6080 | Coherence: 6.8433 | Separation: 17.6620 | Information gain: 9.1667 | Grad Norm: 17.5686 | Time: 10.3s
Step 0450 | Epoch 01 | Objective: -2.3610 | Coherence: 6.8624 | Separation: 17.2915 | Information gain: 9.1667 | Grad Norm: 17.6310 | Time: 10.6s
Step 0460 | Epoch 01 | Objective: -2.1324 | Coherence: 6.8567 | Separation: 16.9485 | Information gain: 9.1667 | Grad Norm: 18.1924 | Time: 10.8s
Step 0470 | Epoch 01 | Objective: -1.9004 | Coherence: 6.8699 | Separation: 16.6007 | Information gain: 9.1667 | Grad Norm: 18.3891 | Time: 11.0s
Step 0480 | Epoch 01 | Objective: -1.6979 | Coherence: 6.8873 | Separation: 16.2968 | Information gain: 9.1667 | Grad Norm: 18.4272 | Time: 11.3s
Step 0490 | Epoch 01 | Objective: -1.5078 | Coherence: 6.8930 | Separation: 16.0117 | Information gain: 9.1667 | Grad Norm: 19.6869 | Time: 11.5s
Step 0500 | Epoch 01 | Objective: -1.3534 | Coherence: 6.8921 | Separation: 15.7801 | Information gain: 9.1667 | Grad Norm: 18.8027 | Time: 11.7s
Step 0510 | Epoch 01 | Objective: -1.1915 | Coherence: 6.8846 | Separation: 15.5373 | Information gain: 9.1667 | Grad Norm: 18.9713 | Time: 12.0s
Step 0520 | Epoch 01 | Objective: -1.0348 | Coherence: 6.8904 | Separation: 15.3022 | Information gain: 9.1667 | Grad Norm: 19.9281 | Time: 12.2s
Step 0530 | Epoch 01 | Objective: -0.8748 | Coherence: 6.8903 | Separation: 15.0622 | Information gain: 9.1667 | Grad Norm: 21.1069 | Time: 12.4s
Step 0540 | Epoch 01 | Objective: -0.7510 | Coherence: 6.9020 | Separation: 14.8765 | Information gain: 9.1667 | Grad Norm: 20.6299 | Time: 12.7s
Step 0550 | Epoch 01 | Objective: -0.6194 | Coherence: 6.9432 | Separation: 14.6791 | Information gain: 9.1667 | Grad Norm: 19.5621 | Time: 12.9s
Step 0560 | Epoch 01 | Objective: -0.4972 | Coherence: 7.0065 | Separation: 14.4958 | Information gain: 9.1667 | Grad Norm: 18.8458 | Time: 13.1s
Step 0570 | Epoch 01 | Objective: -0.3656 | Coherence: 7.0478 | Separation: 14.2984 | Information gain: 9.1667 | Grad Norm: 19.7846 | Time: 13.3s
Step 0580 | Epoch 01 | Objective: -0.2792 | Coherence: 7.0919 | Separation: 14.1687 | Information gain: 9.1667 | Grad Norm: 19.0927 | Time: 13.6s
Step 0590 | Epoch 01 | Objective: -0.2026 | Coherence: 7.1343 | Separation: 14.0539 | Information gain: 9.1667 | Grad Norm: 19.8419 | Time: 13.8s
Step 0600 | Epoch 01 | Objective: -0.1290 | Coherence: 7.1413 | Separation: 13.9435 | Information gain: 9.1667 | Grad Norm: 20.0786 | Time: 14.0s
Step 0610 | Epoch 01 | Objective: -0.0619 | Coherence: 7.1574 | Separation: 13.8428 | Information gain: 9.1667 | Grad Norm: 20.5416 | Time: 14.2s
Step 0620 | Epoch 01 | Objective: 0.0102 | Coherence: 7.1727 | Separation: 13.7347 | Information gain: 9.1667 | Grad Norm: 21.7012 | Time: 14.5s
Step 0630 | Epoch 01 | Objective: 0.0812 | Coherence: 7.1905 | Separation: 13.6281 | Information gain: 9.1667 | Grad Norm: 19.3146 | Time: 14.7s
Step 0640 | Epoch 01 | Objective: 0.1509 | Coherence: 7.2014 | Separation: 13.5237 | Information gain: 9.1667 | Grad Norm: 20.6701 | Time: 14.9s
Step 0650 | Epoch 01 | Objective: 0.2290 | Coherence: 7.2179 | Separation: 13.4065 | Information gain: 9.1667 | Grad Norm: 19.0847 | Time: 15.2s
Step 0660 | Epoch 01 | Objective: 0.2769 | Coherence: 7.2275 | Separation: 13.3346 | Information gain: 9.1667 | Grad Norm: 21.4531 | Time: 15.4s
Step 0670 | Epoch 01 | Objective: 0.3294 | Coherence: 7.2555 | Separation: 13.2559 | Information gain: 9.1667 | Grad Norm: 20.8751 | Time: 15.6s
Step 0680 | Epoch 01 | Objective: 0.3863 | Coherence: 7.2775 | Separation: 13.1706 | Information gain: 9.1667 | Grad Norm: 21.2044 | Time: 15.8s
Step 0690 | Epoch 01 | Objective: 0.4166 | Coherence: 7.2978 | Separation: 13.1251 | Information gain: 9.1667 | Grad Norm: 19.8677 | Time: 16.1s
Step 0700 | Epoch 01 | Objective: 0.4537 | Coherence: 7.3127 | Separation: 13.0695 | Information gain: 9.1667 | Grad Norm: 20.7647 | Time: 16.3s
Step 0710 | Epoch 01 | Objective: 0.4851 | Coherence: 7.3367 | Separation: 13.0223 | Information gain: 9.1667 | Grad Norm: 20.7733 | Time: 16.5s
Step 0720 | Epoch 01 | Objective: 0.5240 | Coherence: 7.3507 | Separation: 12.9641 | Information gain: 9.1667 | Grad Norm: 21.2112 | Time: 16.7s
Step 0730 | Epoch 01 | Objective: 0.5679 | Coherence: 7.3771 | Separation: 12.8982 | Information gain: 9.1667 | Grad Norm: 20.0435 | Time: 17.0s
Step 0740 | Epoch 01 | Objective: 0.6038 | Coherence: 7.3872 | Separation: 12.8443 | Information gain: 9.1667 | Grad Norm: 21.4615 | Time: 17.2s
Step 0750 | Epoch 01 | Objective: 0.6501 | Coherence: 7.4170 | Separation: 12.7748 | Information gain: 9.1667 | Grad Norm: 19.9560 | Time: 17.4s
Step 0760 | Epoch 01 | Objective: 0.6931 | Coherence: 7.4345 | Separation: 12.7103 | Information gain: 9.1667 | Grad Norm: 20.2247 | Time: 17.6s
Step 0770 | Epoch 01 | Objective: 0.7390 | Coherence: 7.4588 | Separation: 12.6415 | Information gain: 9.1667 | Grad Norm: 20.8208 | Time: 17.9s
Step 0780 | Epoch 01 | Objective: 0.7841 | Coherence: 7.4810 | Separation: 12.5738 | Information gain: 9.1667 | Grad Norm: 21.2954 | Time: 18.1s
Step 0790 | Epoch 01 | Objective: 0.8200 | Coherence: 7.4993 | Separation: 12.5201 | Information gain: 9.1667 | Grad Norm: 20.5539 | Time: 18.3s
Step 0800 | Epoch 01 | Objective: 0.8505 | Coherence: 7.5164 | Separation: 12.4743 | Information gain: 9.1667 | Grad Norm: 20.4763 | Time: 18.5s
Step 0810 | Epoch 01 | Objective: 0.8814 | Coherence: 7.5256 | Separation: 12.4279 | Information gain: 9.1667 | Grad Norm: 21.0194 | Time: 18.8s
Step 0817 | Epoch 01 | Objective: 0.9047 | Coherence: 7.5282 | Separation: 12.3929 | Information gain: 9.1667 | Grad Norm: 19.9169 | Time: 18.9s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.535726  0.479107  0.545342  ...  0.535069  0.473762  0.385920
1  0.430488  0.617342  0.564724  ...  0.429335  0.497753  0.449944
2  0.558906  0.591918  0.646676  ...  0.557897  0.528378  0.437686
3  0.282221  0.468941  0.446903  ...  0.280595  0.470803  0.624349
4  0.245205  0.483000  0.433361  ...  0.243169  0.427524  0.604348

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7770
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8906
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8706
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.2886, accuracy=0.0889
Testing SVM
  SVM Test Accuracy: 0.8532
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8299

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.8072, Accuracy: 8877/12000 (74%)

Epoch 1 | Train Acc: 0.632875 | Test Acc: 0.73975 | Time: 1.0273568630218506 sec

Test set: Average loss: 0.6091, Accuracy: 9647/12000 (80%)

Epoch 2 | Train Acc: 0.8056458333333333 | Test Acc: 0.8039166666666666 | Time: 1.0170772075653076 sec

Test set: Average loss: 0.5171, Accuracy: 10003/12000 (83%)

Epoch 3 | Train Acc: 0.8394166666666667 | Test Acc: 0.8335833333333333 | Time: 1.1393499374389648 sec

Test set: Average loss: 0.4617, Accuracy: 10209/12000 (85%)

Epoch 4 | Train Acc: 0.8573958333333334 | Test Acc: 0.85075 | Time: 1.2442293167114258 sec

Test set: Average loss: 0.4244, Accuracy: 10346/12000 (86%)

Epoch 5 | Train Acc: 0.8668125 | Test Acc: 0.8621666666666666 | Time: 1.3953886032104492 sec

Test set: Average loss: 0.4053, Accuracy: 10415/12000 (87%)

Epoch 6 | Train Acc: 0.8731666666666666 | Test Acc: 0.8679166666666667 | Time: 1.1804587841033936 sec

Test set: Average loss: 0.3921, Accuracy: 10495/12000 (87%)

Epoch 7 | Train Acc: 0.877875 | Test Acc: 0.8745833333333334 | Time: 1.2427318096160889 sec

Test set: Average loss: 0.3839, Accuracy: 10524/12000 (88%)

Epoch 8 | Train Acc: 0.8806875 | Test Acc: 0.877 | Time: 1.2595388889312744 sec

Test set: Average loss: 0.3783, Accuracy: 10545/12000 (88%)

Epoch 9 | Train Acc: 0.8824583333333333 | Test Acc: 0.87875 | Time: 1.023716688156128 sec

Test set: Average loss: 0.3740, Accuracy: 10554/12000 (88%)

Epoch 10 | Train Acc: 0.8844375 | Test Acc: 0.8795 | Time: 1.149594783782959 sec

Test set: Average loss: 0.3709, Accuracy: 10566/12000 (88%)

Epoch 11 | Train Acc: 0.8856666666666667 | Test Acc: 0.8805 | Time: 1.2909889221191406 sec

Test set: Average loss: 0.3682, Accuracy: 10577/12000 (88%)

Epoch 12 | Train Acc: 0.886375 | Test Acc: 0.8814166666666666 | Time: 1.5602610111236572 sec

Test set: Average loss: 0.3662, Accuracy: 10582/12000 (88%)

Epoch 13 | Train Acc: 0.8867291666666667 | Test Acc: 0.8818333333333334 | Time: 1.2706003189086914 sec

Test set: Average loss: 0.3648, Accuracy: 10587/12000 (88%)

Epoch 14 | Train Acc: 0.8866041666666666 | Test Acc: 0.88225 | Time: 1.026510238647461 sec

Test set: Average loss: 0.3638, Accuracy: 10583/12000 (88%)

Epoch 15 | Train Acc: 0.8868541666666667 | Test Acc: 0.8819166666666667 | Time: 1.0211522579193115 sec

Test set: Average loss: 0.3633, Accuracy: 10592/12000 (88%)

Epoch 16 | Train Acc: 0.8869791666666667 | Test Acc: 0.8826666666666667 | Time: 1.0242128372192383 sec

Test set: Average loss: 0.3629, Accuracy: 10598/12000 (88%)

Epoch 17 | Train Acc: 0.8870833333333333 | Test Acc: 0.8831666666666667 | Time: 1.09242582321167 sec

Test set: Average loss: 0.3627, Accuracy: 10603/12000 (88%)

Epoch 18 | Train Acc: 0.8870625 | Test Acc: 0.8835833333333334 | Time: 1.252243995666504 sec

Test set: Average loss: 0.3626, Accuracy: 10604/12000 (88%)

Epoch 19 | Train Acc: 0.8871666666666667 | Test Acc: 0.8836666666666667 | Time: 1.2808372974395752 sec

Test set: Average loss: 0.3625, Accuracy: 10604/12000 (88%)

Epoch 20 | Train Acc: 0.8871458333333333 | Test Acc: 0.8836666666666667 | Time: 1.425741195678711 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -51.2649 | Coherence: 5.1734 | Separation: 51.2649 | Information gain: 8.6667 | Grad Norm: 36.7708 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -49.6551 | Coherence: 5.2399 | Separation: 49.6551 | Information gain: 8.6667 | Grad Norm: 35.0774 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -48.1156 | Coherence: 5.4471 | Separation: 48.1156 | Information gain: 8.3333 | Grad Norm: 34.4743 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -46.5489 | Coherence: 5.6227 | Separation: 46.5489 | Information gain: 8.3333 | Grad Norm: 34.1701 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -45.0029 | Coherence: 5.7172 | Separation: 45.0029 | Information gain: 8.1667 | Grad Norm: 33.8318 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -43.4856 | Coherence: 5.7949 | Separation: 43.4856 | Information gain: 8.1667 | Grad Norm: 32.4706 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -42.0631 | Coherence: 5.9519 | Separation: 42.0631 | Information gain: 8.1667 | Grad Norm: 32.2254 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -40.7264 | Coherence: 6.0983 | Separation: 40.7264 | Information gain: 8.1667 | Grad Norm: 32.0660 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -39.3969 | Coherence: 6.2520 | Separation: 39.3969 | Information gain: 8.0000 | Grad Norm: 31.0890 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -38.0688 | Coherence: 6.3744 | Separation: 38.0688 | Information gain: 8.0000 | Grad Norm: 31.2031 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -36.9052 | Coherence: 6.5085 | Separation: 36.9052 | Information gain: 7.6667 | Grad Norm: 32.4041 | Time: 2.4s
Step 0110 | Epoch 01 | Objective: -35.7212 | Coherence: 6.5904 | Separation: 35.7212 | Information gain: 7.6667 | Grad Norm: 31.4074 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -34.5759 | Coherence: 6.7221 | Separation: 34.5759 | Information gain: 7.8333 | Grad Norm: 30.7111 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -33.4903 | Coherence: 6.8292 | Separation: 33.4903 | Information gain: 7.8333 | Grad Norm: 29.6224 | Time: 3.1s
Step 0140 | Epoch 01 | Objective: -32.5387 | Coherence: 6.9078 | Separation: 32.5387 | Information gain: 7.8333 | Grad Norm: 28.2886 | Time: 3.4s
Step 0150 | Epoch 01 | Objective: -31.6518 | Coherence: 6.9804 | Separation: 31.6518 | Information gain: 7.8333 | Grad Norm: 29.7042 | Time: 3.6s
Step 0160 | Epoch 01 | Objective: -30.8377 | Coherence: 7.0085 | Separation: 30.8377 | Information gain: 7.8333 | Grad Norm: 27.2494 | Time: 3.9s
Step 0170 | Epoch 01 | Objective: -30.0709 | Coherence: 6.9483 | Separation: 30.0709 | Information gain: 7.8333 | Grad Norm: 28.7845 | Time: 4.1s
Step 0180 | Epoch 01 | Objective: -29.3598 | Coherence: 6.9369 | Separation: 29.3598 | Information gain: 7.8333 | Grad Norm: 25.8706 | Time: 4.4s
Step 0190 | Epoch 01 | Objective: -28.6663 | Coherence: 7.0226 | Separation: 28.6663 | Information gain: 7.8333 | Grad Norm: 28.6024 | Time: 4.6s
Step 0200 | Epoch 01 | Objective: -27.9885 | Coherence: 7.1119 | Separation: 27.9885 | Information gain: 7.8333 | Grad Norm: 26.9460 | Time: 4.9s
Step 0210 | Epoch 01 | Objective: -27.3567 | Coherence: 7.2292 | Separation: 27.3567 | Information gain: 7.6667 | Grad Norm: 28.2468 | Time: 5.1s
Step 0220 | Epoch 01 | Objective: -26.7056 | Coherence: 7.3417 | Separation: 26.7056 | Information gain: 7.6667 | Grad Norm: 27.2291 | Time: 5.4s
Step 0230 | Epoch 01 | Objective: -26.0591 | Coherence: 7.4612 | Separation: 26.0591 | Information gain: 8.0000 | Grad Norm: 27.7167 | Time: 5.6s
Step 0240 | Epoch 01 | Objective: -25.4427 | Coherence: 7.5983 | Separation: 25.4427 | Information gain: 8.0000 | Grad Norm: 27.0787 | Time: 5.8s
Step 0250 | Epoch 01 | Objective: -24.9913 | Coherence: 7.7205 | Separation: 24.9913 | Information gain: 8.1667 | Grad Norm: 25.5498 | Time: 6.1s
Step 0260 | Epoch 01 | Objective: -24.5788 | Coherence: 7.7813 | Separation: 24.5788 | Information gain: 8.1667 | Grad Norm: 24.9196 | Time: 6.3s
Step 0270 | Epoch 01 | Objective: -24.2403 | Coherence: 7.8025 | Separation: 24.2403 | Information gain: 8.1667 | Grad Norm: 25.3024 | Time: 6.5s
Step 0280 | Epoch 01 | Objective: -23.9694 | Coherence: 7.8013 | Separation: 23.9694 | Information gain: 8.1667 | Grad Norm: 22.9918 | Time: 6.8s
Step 0290 | Epoch 01 | Objective: -23.7038 | Coherence: 7.7835 | Separation: 23.7038 | Information gain: 8.1667 | Grad Norm: 24.5499 | Time: 7.1s
Step 0300 | Epoch 01 | Objective: -23.4679 | Coherence: 7.7825 | Separation: 23.4679 | Information gain: 8.1667 | Grad Norm: 24.9599 | Time: 7.4s
Step 0310 | Epoch 01 | Objective: -23.2217 | Coherence: 7.7962 | Separation: 23.2217 | Information gain: 8.1667 | Grad Norm: 24.8472 | Time: 7.7s
Step 0320 | Epoch 01 | Objective: -22.9734 | Coherence: 7.8102 | Separation: 22.9734 | Information gain: 8.1667 | Grad Norm: 27.0668 | Time: 8.0s
Step 0330 | Epoch 01 | Objective: -22.7270 | Coherence: 7.8211 | Separation: 22.7270 | Information gain: 8.1667 | Grad Norm: 25.9463 | Time: 8.3s
Step 0340 | Epoch 01 | Objective: -22.4620 | Coherence: 7.8553 | Separation: 22.4620 | Information gain: 8.1667 | Grad Norm: 26.4699 | Time: 8.5s
Step 0350 | Epoch 01 | Objective: -22.1824 | Coherence: 7.8807 | Separation: 22.1824 | Information gain: 8.1667 | Grad Norm: 27.9450 | Time: 8.8s
Step 0360 | Epoch 01 | Objective: -21.8823 | Coherence: 7.8978 | Separation: 21.8823 | Information gain: 8.1667 | Grad Norm: 27.4779 | Time: 9.0s
Step 0370 | Epoch 01 | Objective: -21.5795 | Coherence: 7.9148 | Separation: 21.5795 | Information gain: 8.1667 | Grad Norm: 25.9257 | Time: 9.2s
Step 0380 | Epoch 01 | Objective: -21.2892 | Coherence: 7.9452 | Separation: 21.2892 | Information gain: 8.0000 | Grad Norm: 25.1926 | Time: 9.5s
Step 0390 | Epoch 01 | Objective: -21.0030 | Coherence: 8.0053 | Separation: 21.0030 | Information gain: 8.0000 | Grad Norm: 24.8766 | Time: 9.7s
Step 0400 | Epoch 01 | Objective: -20.7117 | Coherence: 8.0860 | Separation: 20.7117 | Information gain: 7.8333 | Grad Norm: 26.3051 | Time: 10.0s
Step 0410 | Epoch 01 | Objective: -20.4166 | Coherence: 8.1485 | Separation: 20.4166 | Information gain: 7.8333 | Grad Norm: 26.3758 | Time: 10.2s
Step 0420 | Epoch 01 | Objective: -20.1199 | Coherence: 8.2247 | Separation: 20.1199 | Information gain: 7.8333 | Grad Norm: 26.7374 | Time: 10.5s
Step 0430 | Epoch 01 | Objective: -19.8246 | Coherence: 8.2841 | Separation: 19.8246 | Information gain: 7.8333 | Grad Norm: 26.2441 | Time: 10.7s
Step 0440 | Epoch 01 | Objective: -19.5264 | Coherence: 8.3668 | Separation: 19.5264 | Information gain: 7.8333 | Grad Norm: 27.8297 | Time: 11.0s
Step 0450 | Epoch 01 | Objective: -19.2379 | Coherence: 8.4561 | Separation: 19.2379 | Information gain: 8.0000 | Grad Norm: 27.7755 | Time: 11.3s
Step 0460 | Epoch 01 | Objective: -18.9411 | Coherence: 8.5636 | Separation: 18.9411 | Information gain: 8.0000 | Grad Norm: 27.8710 | Time: 11.5s
Step 0470 | Epoch 01 | Objective: -18.6288 | Coherence: 8.6506 | Separation: 18.6288 | Information gain: 8.0000 | Grad Norm: 28.2033 | Time: 11.8s
Step 0480 | Epoch 01 | Objective: -18.2945 | Coherence: 8.7539 | Separation: 18.2945 | Information gain: 8.0000 | Grad Norm: 25.9997 | Time: 12.1s
Step 0490 | Epoch 01 | Objective: -17.9576 | Coherence: 8.8498 | Separation: 17.9576 | Information gain: 8.0000 | Grad Norm: 26.6366 | Time: 12.4s
Step 0500 | Epoch 01 | Objective: -17.6188 | Coherence: 8.9369 | Separation: 17.6188 | Information gain: 7.8333 | Grad Norm: 28.7689 | Time: 12.6s
Step 0510 | Epoch 01 | Objective: -17.2735 | Coherence: 9.0174 | Separation: 17.2735 | Information gain: 7.8333 | Grad Norm: 28.3483 | Time: 12.9s
Step 0520 | Epoch 01 | Objective: -16.9216 | Coherence: 9.0756 | Separation: 16.9216 | Information gain: 7.8333 | Grad Norm: 29.2283 | Time: 13.2s
Step 0530 | Epoch 01 | Objective: -16.5944 | Coherence: 9.1403 | Separation: 16.5944 | Information gain: 8.0000 | Grad Norm: 28.4185 | Time: 13.5s
Step 0540 | Epoch 01 | Objective: -16.3407 | Coherence: 9.2120 | Separation: 16.3407 | Information gain: 8.0000 | Grad Norm: 27.6596 | Time: 13.8s
Step 0550 | Epoch 01 | Objective: -16.0792 | Coherence: 9.2732 | Separation: 16.0792 | Information gain: 8.0000 | Grad Norm: 27.2861 | Time: 14.1s
Step 0560 | Epoch 01 | Objective: -15.8082 | Coherence: 9.3499 | Separation: 15.8082 | Information gain: 8.0000 | Grad Norm: 28.6240 | Time: 14.3s
Step 0570 | Epoch 01 | Objective: -15.5300 | Coherence: 9.4129 | Separation: 15.5300 | Information gain: 8.0000 | Grad Norm: 28.9349 | Time: 14.6s
Step 0580 | Epoch 01 | Objective: -15.2488 | Coherence: 9.4854 | Separation: 15.2488 | Information gain: 8.1667 | Grad Norm: 29.0223 | Time: 14.9s
Step 0590 | Epoch 01 | Objective: -14.9960 | Coherence: 9.5456 | Separation: 14.9960 | Information gain: 8.1667 | Grad Norm: 27.4083 | Time: 15.1s
Step 0600 | Epoch 01 | Objective: -14.7703 | Coherence: 9.6058 | Separation: 14.7703 | Information gain: 8.1667 | Grad Norm: 26.7306 | Time: 15.3s
Step 0610 | Epoch 01 | Objective: -14.5613 | Coherence: 9.6685 | Separation: 14.5613 | Information gain: 8.1667 | Grad Norm: 29.8536 | Time: 15.6s
Step 0620 | Epoch 01 | Objective: -14.3792 | Coherence: 9.6944 | Separation: 14.3792 | Information gain: 8.1667 | Grad Norm: 29.3408 | Time: 15.8s
Step 0630 | Epoch 01 | Objective: -14.2000 | Coherence: 9.7159 | Separation: 14.2000 | Information gain: 8.1667 | Grad Norm: 30.0902 | Time: 16.0s
Step 0640 | Epoch 01 | Objective: -14.0417 | Coherence: 9.7346 | Separation: 14.0417 | Information gain: 8.1667 | Grad Norm: 29.4471 | Time: 16.3s
Step 0650 | Epoch 01 | Objective: -13.9122 | Coherence: 9.7584 | Separation: 13.9122 | Information gain: 8.0000 | Grad Norm: 31.2258 | Time: 16.5s
Step 0660 | Epoch 01 | Objective: -13.8001 | Coherence: 9.7368 | Separation: 13.8001 | Information gain: 7.8333 | Grad Norm: 29.9849 | Time: 16.7s
Step 0670 | Epoch 01 | Objective: -13.6839 | Coherence: 9.7132 | Separation: 13.6839 | Information gain: 7.8333 | Grad Norm: 31.7332 | Time: 16.9s
Step 0680 | Epoch 01 | Objective: -13.5570 | Coherence: 9.6979 | Separation: 13.5570 | Information gain: 7.8333 | Grad Norm: 29.1226 | Time: 17.2s
Step 0690 | Epoch 01 | Objective: -13.4369 | Coherence: 9.6878 | Separation: 13.4369 | Information gain: 7.8333 | Grad Norm: 31.4777 | Time: 17.4s
Step 0700 | Epoch 01 | Objective: -13.3169 | Coherence: 9.6802 | Separation: 13.3169 | Information gain: 7.8333 | Grad Norm: 32.6346 | Time: 17.6s
Step 0710 | Epoch 01 | Objective: -13.1798 | Coherence: 9.6585 | Separation: 13.1798 | Information gain: 7.8333 | Grad Norm: 31.8383 | Time: 17.8s
Step 0720 | Epoch 01 | Objective: -13.0471 | Coherence: 9.6436 | Separation: 13.0471 | Information gain: 7.8333 | Grad Norm: 30.5881 | Time: 18.1s
Step 0730 | Epoch 01 | Objective: -12.9690 | Coherence: 9.6079 | Separation: 12.9690 | Information gain: 8.0000 | Grad Norm: 29.3870 | Time: 18.3s
Step 0740 | Epoch 01 | Objective: -12.8711 | Coherence: 9.5873 | Separation: 12.8711 | Information gain: 8.0000 | Grad Norm: 30.9137 | Time: 18.5s
Step 0750 | Epoch 01 | Objective: -12.7794 | Coherence: 9.5490 | Separation: 12.7794 | Information gain: 8.0000 | Grad Norm: 28.7205 | Time: 18.7s
Step 0760 | Epoch 01 | Objective: -12.6922 | Coherence: 9.5107 | Separation: 12.6922 | Information gain: 8.0000 | Grad Norm: 31.8108 | Time: 19.0s
Step 0770 | Epoch 01 | Objective: -12.6079 | Coherence: 9.4766 | Separation: 12.6079 | Information gain: 8.0000 | Grad Norm: 29.4936 | Time: 19.2s
Step 0780 | Epoch 01 | Objective: -12.5622 | Coherence: 9.4508 | Separation: 12.5622 | Information gain: 8.0000 | Grad Norm: 29.7130 | Time: 19.5s
Step 0790 | Epoch 01 | Objective: -12.4969 | Coherence: 9.4413 | Separation: 12.4969 | Information gain: 8.0000 | Grad Norm: 31.4718 | Time: 19.8s
Step 0800 | Epoch 01 | Objective: -12.4305 | Coherence: 9.4118 | Separation: 12.4305 | Information gain: 8.0000 | Grad Norm: 30.8098 | Time: 20.0s
Step 0810 | Epoch 01 | Objective: -12.3837 | Coherence: 9.3976 | Separation: 12.3837 | Information gain: 8.0000 | Grad Norm: 31.6162 | Time: 20.3s
Step 0820 | Epoch 01 | Objective: -12.3465 | Coherence: 9.3852 | Separation: 12.3465 | Information gain: 8.0000 | Grad Norm: 30.7839 | Time: 20.6s
Step 0830 | Epoch 01 | Objective: -12.3095 | Coherence: 9.3729 | Separation: 12.3095 | Information gain: 8.0000 | Grad Norm: 30.0187 | Time: 20.8s
Step 0840 | Epoch 01 | Objective: -12.2837 | Coherence: 9.3600 | Separation: 12.2837 | Information gain: 8.0000 | Grad Norm: 31.7172 | Time: 21.1s
Step 0850 | Epoch 01 | Objective: -12.2649 | Coherence: 9.3673 | Separation: 12.2649 | Information gain: 8.0000 | Grad Norm: 31.5905 | Time: 21.3s
Step 0860 | Epoch 01 | Objective: -12.2570 | Coherence: 9.3634 | Separation: 12.2570 | Information gain: 8.0000 | Grad Norm: 32.7014 | Time: 21.6s
Step 0870 | Epoch 01 | Objective: -12.2426 | Coherence: 9.3747 | Separation: 12.2426 | Information gain: 8.0000 | Grad Norm: 30.9607 | Time: 21.8s
Step 0880 | Epoch 01 | Objective: -12.2212 | Coherence: 9.3763 | Separation: 12.2212 | Information gain: 8.0000 | Grad Norm: 29.8712 | Time: 22.1s
Step 0890 | Epoch 01 | Objective: -12.2107 | Coherence: 9.3733 | Separation: 12.2107 | Information gain: 8.0000 | Grad Norm: 30.8242 | Time: 22.3s
Step 0900 | Epoch 01 | Objective: -12.1849 | Coherence: 9.3821 | Separation: 12.1849 | Information gain: 8.0000 | Grad Norm: 29.5572 | Time: 22.5s
Step 0910 | Epoch 01 | Objective: -12.1704 | Coherence: 9.3771 | Separation: 12.1704 | Information gain: 8.0000 | Grad Norm: 30.4537 | Time: 22.7s
Step 0920 | Epoch 01 | Objective: -12.1570 | Coherence: 9.3831 | Separation: 12.1570 | Information gain: 8.0000 | Grad Norm: 30.6374 | Time: 23.0s
Step 0930 | Epoch 01 | Objective: -12.1358 | Coherence: 9.3754 | Separation: 12.1358 | Information gain: 8.0000 | Grad Norm: 30.5596 | Time: 23.3s
Step 0940 | Epoch 01 | Objective: -12.1197 | Coherence: 9.3802 | Separation: 12.1197 | Information gain: 8.0000 | Grad Norm: 31.1245 | Time: 23.5s
Step 0950 | Epoch 01 | Objective: -12.1007 | Coherence: 9.3798 | Separation: 12.1007 | Information gain: 8.0000 | Grad Norm: 31.9092 | Time: 23.8s
Step 0960 | Epoch 01 | Objective: -12.0859 | Coherence: 9.3829 | Separation: 12.0859 | Information gain: 8.0000 | Grad Norm: 31.5786 | Time: 24.1s
Step 0970 | Epoch 01 | Objective: -12.0553 | Coherence: 9.3791 | Separation: 12.0553 | Information gain: 8.0000 | Grad Norm: 31.7213 | Time: 24.4s
Step 0980 | Epoch 01 | Objective: -12.0364 | Coherence: 9.3780 | Separation: 12.0364 | Information gain: 8.0000 | Grad Norm: 30.9635 | Time: 24.6s
Step 0990 | Epoch 01 | Objective: -12.0167 | Coherence: 9.3805 | Separation: 12.0167 | Information gain: 8.0000 | Grad Norm: 31.9408 | Time: 24.9s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.567229 -0.511175 -0.539165  ...  0.569435  0.602572  0.527486
1 -0.424470 -0.591278 -0.403479  ...  0.468720  0.451949  0.527164
2 -0.567621 -0.507469 -0.549421  ...  0.567390  0.610216  0.539253
3 -0.341383 -0.454998 -0.308686  ...  0.479432  0.384868  0.417910
4 -0.312639 -0.478399 -0.297298  ...  0.486718  0.328165  0.428524

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8061
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9118
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8969
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.9442, accuracy=0.1153
Testing SVM
  SVM Test Accuracy: 0.8710
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8441

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6416, Accuracy: 9750/12000 (81%)

Epoch 1 | Train Acc: 0.6752291666666667 | Test Acc: 0.8125 | Time: 1.172389268875122 sec

Test set: Average loss: 0.4620, Accuracy: 10307/12000 (86%)

Epoch 2 | Train Acc: 0.8442708333333333 | Test Acc: 0.8589166666666667 | Time: 1.0258443355560303 sec

Test set: Average loss: 0.3834, Accuracy: 10561/12000 (88%)

Epoch 3 | Train Acc: 0.8731875 | Test Acc: 0.8800833333333333 | Time: 1.0290453433990479 sec

Test set: Average loss: 0.3473, Accuracy: 10663/12000 (89%)

Epoch 4 | Train Acc: 0.888125 | Test Acc: 0.8885833333333333 | Time: 1.0461361408233643 sec

Test set: Average loss: 0.3278, Accuracy: 10746/12000 (90%)

Epoch 5 | Train Acc: 0.8974166666666666 | Test Acc: 0.8955 | Time: 1.4424524307250977 sec

Test set: Average loss: 0.3148, Accuracy: 10804/12000 (90%)

Epoch 6 | Train Acc: 0.9029375 | Test Acc: 0.9003333333333333 | Time: 1.0605120658874512 sec

Test set: Average loss: 0.3057, Accuracy: 10836/12000 (90%)

Epoch 7 | Train Acc: 0.906875 | Test Acc: 0.903 | Time: 1.0256812572479248 sec

Test set: Average loss: 0.2997, Accuracy: 10857/12000 (90%)

Epoch 8 | Train Acc: 0.90975 | Test Acc: 0.90475 | Time: 1.026853084564209 sec

Test set: Average loss: 0.2954, Accuracy: 10879/12000 (91%)

Epoch 9 | Train Acc: 0.9115625 | Test Acc: 0.9065833333333333 | Time: 1.2614352703094482 sec

Test set: Average loss: 0.2919, Accuracy: 10885/12000 (91%)

Epoch 10 | Train Acc: 0.9129166666666667 | Test Acc: 0.9070833333333334 | Time: 1.6272540092468262 sec

Test set: Average loss: 0.2897, Accuracy: 10892/12000 (91%)

Epoch 11 | Train Acc: 0.9139583333333333 | Test Acc: 0.9076666666666666 | Time: 1.2165513038635254 sec

Test set: Average loss: 0.2882, Accuracy: 10890/12000 (91%)

Epoch 12 | Train Acc: 0.9142916666666666 | Test Acc: 0.9075 | Time: 1.0262229442596436 sec

Test set: Average loss: 0.2872, Accuracy: 10900/12000 (91%)

Epoch 13 | Train Acc: 0.9148541666666666 | Test Acc: 0.9083333333333333 | Time: 1.033804178237915 sec

Test set: Average loss: 0.2865, Accuracy: 10898/12000 (91%)

Epoch 14 | Train Acc: 0.9149583333333333 | Test Acc: 0.9081666666666667 | Time: 1.378279685974121 sec

Test set: Average loss: 0.2861, Accuracy: 10897/12000 (91%)

Epoch 15 | Train Acc: 0.9152083333333333 | Test Acc: 0.9080833333333334 | Time: 1.2331838607788086 sec

Test set: Average loss: 0.2858, Accuracy: 10901/12000 (91%)

Epoch 16 | Train Acc: 0.9153125 | Test Acc: 0.9084166666666667 | Time: 1.0913193225860596 sec

Test set: Average loss: 0.2856, Accuracy: 10903/12000 (91%)

Epoch 17 | Train Acc: 0.9153541666666667 | Test Acc: 0.9085833333333333 | Time: 1.1586644649505615 sec

Test set: Average loss: 0.2854, Accuracy: 10904/12000 (91%)

Epoch 18 | Train Acc: 0.9154791666666666 | Test Acc: 0.9086666666666666 | Time: 1.021536111831665 sec

Test set: Average loss: 0.2854, Accuracy: 10905/12000 (91%)

Epoch 19 | Train Acc: 0.9155208333333333 | Test Acc: 0.90875 | Time: 1.269063949584961 sec

Test set: Average loss: 0.2853, Accuracy: 10901/12000 (91%)

Epoch 20 | Train Acc: 0.9155208333333333 | Test Acc: 0.9084166666666667 | Time: 1.186638593673706 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -57.8787 | Coherence: 9.2536 | Separation: 60.4343 | Information gain: 7.6667 | Grad Norm: 43.2164 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: -55.8900 | Coherence: 9.4742 | Separation: 58.5012 | Information gain: 7.8333 | Grad Norm: 41.6131 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -54.0609 | Coherence: 9.6612 | Separation: 56.6721 | Information gain: 7.8333 | Grad Norm: 40.6672 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: -52.2706 | Coherence: 9.8714 | Separation: 54.8262 | Information gain: 7.6667 | Grad Norm: 39.6857 | Time: 0.9s
Step 0040 | Epoch 01 | Objective: -50.5392 | Coherence: 10.1532 | Separation: 53.0947 | Information gain: 7.6667 | Grad Norm: 38.4600 | Time: 1.2s
Step 0050 | Epoch 01 | Objective: -48.6918 | Coherence: 10.4396 | Separation: 51.3029 | Information gain: 7.8333 | Grad Norm: 38.1359 | Time: 1.4s
Step 0060 | Epoch 01 | Objective: -46.9075 | Coherence: 10.7091 | Separation: 49.5187 | Information gain: 7.8333 | Grad Norm: 37.0796 | Time: 1.7s
Step 0070 | Epoch 01 | Objective: -45.1909 | Coherence: 10.8508 | Separation: 47.8021 | Information gain: 7.8333 | Grad Norm: 33.9542 | Time: 1.9s
Step 0080 | Epoch 01 | Objective: -43.7154 | Coherence: 10.8722 | Separation: 46.3265 | Information gain: 7.8333 | Grad Norm: 35.1783 | Time: 2.1s
Step 0090 | Epoch 01 | Objective: -42.2801 | Coherence: 10.8625 | Separation: 44.8912 | Information gain: 7.8333 | Grad Norm: 33.4502 | Time: 2.4s
Step 0100 | Epoch 01 | Objective: -41.0472 | Coherence: 10.8522 | Separation: 43.6583 | Information gain: 7.8333 | Grad Norm: 32.3671 | Time: 2.6s
Step 0110 | Epoch 01 | Objective: -39.9593 | Coherence: 10.8826 | Separation: 42.5704 | Information gain: 7.8333 | Grad Norm: 32.3453 | Time: 2.8s
Step 0120 | Epoch 01 | Objective: -38.8739 | Coherence: 10.9306 | Separation: 41.4850 | Information gain: 7.8333 | Grad Norm: 32.3154 | Time: 3.1s
Step 0130 | Epoch 01 | Objective: -37.7827 | Coherence: 11.0119 | Separation: 40.3938 | Information gain: 7.8333 | Grad Norm: 32.6098 | Time: 3.3s
Step 0140 | Epoch 01 | Objective: -36.6494 | Coherence: 11.0915 | Separation: 39.2605 | Information gain: 7.8333 | Grad Norm: 32.7199 | Time: 3.5s
Step 0150 | Epoch 01 | Objective: -35.5044 | Coherence: 11.1553 | Separation: 38.1155 | Information gain: 7.8333 | Grad Norm: 32.4558 | Time: 3.8s
Step 0160 | Epoch 01 | Objective: -34.5001 | Coherence: 11.2250 | Separation: 37.1112 | Information gain: 7.8333 | Grad Norm: 29.6784 | Time: 4.0s
Step 0170 | Epoch 01 | Objective: -33.6616 | Coherence: 11.3342 | Separation: 36.2727 | Information gain: 7.8333 | Grad Norm: 29.3845 | Time: 4.2s
Step 0180 | Epoch 01 | Objective: -32.9013 | Coherence: 11.4855 | Separation: 35.5124 | Information gain: 7.8333 | Grad Norm: 28.4956 | Time: 4.5s
Step 0190 | Epoch 01 | Objective: -32.2472 | Coherence: 11.5256 | Separation: 34.8583 | Information gain: 7.8333 | Grad Norm: 28.7145 | Time: 4.7s
Step 0200 | Epoch 01 | Objective: -31.6509 | Coherence: 11.4937 | Separation: 34.2620 | Information gain: 7.8333 | Grad Norm: 27.9651 | Time: 4.9s
Step 0210 | Epoch 01 | Objective: -30.9593 | Coherence: 11.4393 | Separation: 33.6260 | Information gain: 8.0000 | Grad Norm: 30.2603 | Time: 5.2s
Step 0220 | Epoch 01 | Objective: -30.2475 | Coherence: 11.4021 | Separation: 32.9697 | Information gain: 8.1667 | Grad Norm: 27.8363 | Time: 5.4s
Step 0230 | Epoch 01 | Objective: -29.6265 | Coherence: 11.3713 | Separation: 32.2932 | Information gain: 8.0000 | Grad Norm: 29.0274 | Time: 5.6s
Step 0240 | Epoch 01 | Objective: -28.9488 | Coherence: 11.3431 | Separation: 31.6154 | Information gain: 8.0000 | Grad Norm: 28.1939 | Time: 5.8s
Step 0250 | Epoch 01 | Objective: -28.2693 | Coherence: 11.3123 | Separation: 30.9360 | Information gain: 8.0000 | Grad Norm: 27.2042 | Time: 6.1s
Step 0260 | Epoch 01 | Objective: -27.6154 | Coherence: 11.2450 | Separation: 30.2821 | Information gain: 8.0000 | Grad Norm: 25.5573 | Time: 6.3s
Step 0270 | Epoch 01 | Objective: -26.9808 | Coherence: 11.1684 | Separation: 29.6474 | Information gain: 8.0000 | Grad Norm: 27.1175 | Time: 6.6s
Step 0280 | Epoch 01 | Objective: -26.3325 | Coherence: 11.0929 | Separation: 28.9992 | Information gain: 8.0000 | Grad Norm: 27.3367 | Time: 6.8s
Step 0290 | Epoch 01 | Objective: -25.7306 | Coherence: 11.0652 | Separation: 28.4528 | Information gain: 8.1667 | Grad Norm: 26.8225 | Time: 7.1s
Step 0300 | Epoch 01 | Objective: -25.2189 | Coherence: 11.0632 | Separation: 27.8856 | Information gain: 8.0000 | Grad Norm: 27.5372 | Time: 7.4s
Step 0310 | Epoch 01 | Objective: -24.6141 | Coherence: 11.0546 | Separation: 27.3363 | Information gain: 8.1667 | Grad Norm: 28.0421 | Time: 7.6s
Step 0320 | Epoch 01 | Objective: -24.2281 | Coherence: 11.0988 | Separation: 26.9503 | Information gain: 8.1667 | Grad Norm: 26.2884 | Time: 7.8s
Step 0330 | Epoch 01 | Objective: -23.8540 | Coherence: 11.2126 | Separation: 26.5763 | Information gain: 8.1667 | Grad Norm: 27.3670 | Time: 8.1s
Step 0340 | Epoch 01 | Objective: -23.4542 | Coherence: 11.3629 | Separation: 26.1764 | Information gain: 8.1667 | Grad Norm: 24.7500 | Time: 8.3s
Step 0350 | Epoch 01 | Objective: -23.0381 | Coherence: 11.4877 | Separation: 25.7603 | Information gain: 8.1667 | Grad Norm: 26.0167 | Time: 8.5s
Step 0360 | Epoch 01 | Objective: -22.6043 | Coherence: 11.6352 | Separation: 25.3265 | Information gain: 8.1667 | Grad Norm: 26.0841 | Time: 8.8s
Step 0370 | Epoch 01 | Objective: -22.2404 | Coherence: 11.7662 | Separation: 24.9070 | Information gain: 8.0000 | Grad Norm: 25.2726 | Time: 9.0s
Step 0380 | Epoch 01 | Objective: -21.8222 | Coherence: 11.8721 | Separation: 24.4889 | Information gain: 8.0000 | Grad Norm: 26.4645 | Time: 9.2s
Step 0390 | Epoch 01 | Objective: -21.4253 | Coherence: 11.9141 | Separation: 24.0920 | Information gain: 8.0000 | Grad Norm: 23.2326 | Time: 9.5s
Step 0400 | Epoch 01 | Objective: -20.9944 | Coherence: 11.9551 | Separation: 23.6611 | Information gain: 8.0000 | Grad Norm: 24.3103 | Time: 9.7s
Step 0410 | Epoch 01 | Objective: -20.6085 | Coherence: 12.0122 | Separation: 23.2196 | Information gain: 7.8333 | Grad Norm: 28.5252 | Time: 9.9s
Step 0420 | Epoch 01 | Objective: -20.1339 | Coherence: 12.0845 | Separation: 22.8006 | Information gain: 8.0000 | Grad Norm: 25.4530 | Time: 10.2s
Step 0430 | Epoch 01 | Objective: -19.8042 | Coherence: 12.1367 | Separation: 22.4153 | Information gain: 7.8333 | Grad Norm: 23.9373 | Time: 10.4s
Step 0440 | Epoch 01 | Objective: -19.4131 | Coherence: 12.1552 | Separation: 22.0242 | Information gain: 7.8333 | Grad Norm: 25.8347 | Time: 10.6s
Step 0450 | Epoch 01 | Objective: -19.0337 | Coherence: 12.2107 | Separation: 21.6448 | Information gain: 7.8333 | Grad Norm: 24.7056 | Time: 10.9s
Step 0460 | Epoch 01 | Objective: -18.6856 | Coherence: 12.3012 | Separation: 21.2967 | Information gain: 7.8333 | Grad Norm: 29.2643 | Time: 11.1s
Step 0470 | Epoch 01 | Objective: -18.2936 | Coherence: 12.3582 | Separation: 20.9602 | Information gain: 8.0000 | Grad Norm: 27.9111 | Time: 11.4s
Step 0480 | Epoch 01 | Objective: -17.9415 | Coherence: 12.4422 | Separation: 20.6082 | Information gain: 8.0000 | Grad Norm: 28.1366 | Time: 11.6s
Step 0490 | Epoch 01 | Objective: -17.6314 | Coherence: 12.5039 | Separation: 20.2981 | Information gain: 8.0000 | Grad Norm: 27.9064 | Time: 11.9s
Step 0500 | Epoch 01 | Objective: -17.2893 | Coherence: 12.5823 | Separation: 19.9560 | Information gain: 8.0000 | Grad Norm: 26.5253 | Time: 12.1s
Step 0510 | Epoch 01 | Objective: -16.9412 | Coherence: 12.6482 | Separation: 19.6079 | Information gain: 8.0000 | Grad Norm: 25.3638 | Time: 12.4s
Step 0520 | Epoch 01 | Objective: -16.6035 | Coherence: 12.7063 | Separation: 19.2701 | Information gain: 8.0000 | Grad Norm: 25.8699 | Time: 12.6s
Step 0530 | Epoch 01 | Objective: -16.2598 | Coherence: 12.7818 | Separation: 18.9265 | Information gain: 8.0000 | Grad Norm: 26.5713 | Time: 12.9s
Step 0540 | Epoch 01 | Objective: -15.9329 | Coherence: 12.8182 | Separation: 18.5996 | Information gain: 8.0000 | Grad Norm: 26.3410 | Time: 13.1s
Step 0550 | Epoch 01 | Objective: -15.5848 | Coherence: 12.8645 | Separation: 18.2515 | Information gain: 8.0000 | Grad Norm: 27.9962 | Time: 13.3s
Step 0560 | Epoch 01 | Objective: -15.2486 | Coherence: 12.9168 | Separation: 17.9153 | Information gain: 8.0000 | Grad Norm: 27.1465 | Time: 13.6s
Step 0570 | Epoch 01 | Objective: -14.9450 | Coherence: 12.9600 | Separation: 17.6117 | Information gain: 8.0000 | Grad Norm: 26.7063 | Time: 13.8s
Step 0580 | Epoch 01 | Objective: -14.6693 | Coherence: 12.9962 | Separation: 17.3360 | Information gain: 8.0000 | Grad Norm: 31.6757 | Time: 14.0s
Step 0590 | Epoch 01 | Objective: -14.4074 | Coherence: 13.0191 | Separation: 17.0740 | Information gain: 8.0000 | Grad Norm: 29.3419 | Time: 14.3s
Step 0600 | Epoch 01 | Objective: -14.1314 | Coherence: 13.0301 | Separation: 16.7981 | Information gain: 8.0000 | Grad Norm: 27.7135 | Time: 14.5s
Step 0610 | Epoch 01 | Objective: -13.8650 | Coherence: 13.0469 | Separation: 16.5317 | Information gain: 8.0000 | Grad Norm: 30.5517 | Time: 14.8s
Step 0620 | Epoch 01 | Objective: -13.6370 | Coherence: 13.0281 | Separation: 16.3037 | Information gain: 8.0000 | Grad Norm: 28.7607 | Time: 15.1s
Step 0630 | Epoch 01 | Objective: -13.4160 | Coherence: 12.9792 | Separation: 16.0827 | Information gain: 8.0000 | Grad Norm: 30.0494 | Time: 15.4s
Step 0640 | Epoch 01 | Objective: -13.1916 | Coherence: 12.9050 | Separation: 15.8583 | Information gain: 8.0000 | Grad Norm: 29.4311 | Time: 15.6s
Step 0650 | Epoch 01 | Objective: -12.9932 | Coherence: 12.8549 | Separation: 15.6598 | Information gain: 8.0000 | Grad Norm: 29.5142 | Time: 15.8s
Step 0660 | Epoch 01 | Objective: -12.8104 | Coherence: 12.8048 | Separation: 15.4771 | Information gain: 8.0000 | Grad Norm: 30.3964 | Time: 16.1s
Step 0670 | Epoch 01 | Objective: -12.6084 | Coherence: 12.7611 | Separation: 15.2751 | Information gain: 8.0000 | Grad Norm: 29.6533 | Time: 16.3s
Step 0680 | Epoch 01 | Objective: -12.4119 | Coherence: 12.7024 | Separation: 15.0786 | Information gain: 8.0000 | Grad Norm: 28.4701 | Time: 16.6s
Step 0690 | Epoch 01 | Objective: -12.2148 | Coherence: 12.6358 | Separation: 14.8815 | Information gain: 8.0000 | Grad Norm: 27.1166 | Time: 16.8s
Step 0700 | Epoch 01 | Objective: -12.0017 | Coherence: 12.5830 | Separation: 14.6683 | Information gain: 8.0000 | Grad Norm: 28.8952 | Time: 17.1s
Step 0710 | Epoch 01 | Objective: -11.8412 | Coherence: 12.5159 | Separation: 14.4523 | Information gain: 7.8333 | Grad Norm: 30.4844 | Time: 17.3s
Step 0720 | Epoch 01 | Objective: -11.6461 | Coherence: 12.4643 | Separation: 14.2572 | Information gain: 7.8333 | Grad Norm: 27.6975 | Time: 17.6s
Step 0730 | Epoch 01 | Objective: -11.5070 | Coherence: 12.4547 | Separation: 14.1181 | Information gain: 7.8333 | Grad Norm: 29.2352 | Time: 17.8s
Step 0740 | Epoch 01 | Objective: -11.3617 | Coherence: 12.4624 | Separation: 13.9728 | Information gain: 7.8333 | Grad Norm: 29.1977 | Time: 18.1s
Step 0750 | Epoch 01 | Objective: -11.2214 | Coherence: 12.4842 | Separation: 13.8325 | Information gain: 7.8333 | Grad Norm: 29.8294 | Time: 18.4s
Step 0760 | Epoch 01 | Objective: -11.0965 | Coherence: 12.4910 | Separation: 13.7076 | Information gain: 7.8333 | Grad Norm: 32.4429 | Time: 18.6s
Step 0770 | Epoch 01 | Objective: -10.9810 | Coherence: 12.4892 | Separation: 13.5922 | Information gain: 7.8333 | Grad Norm: 31.6560 | Time: 18.9s
Step 0780 | Epoch 01 | Objective: -10.8686 | Coherence: 12.4965 | Separation: 13.4797 | Information gain: 7.8333 | Grad Norm: 30.8790 | Time: 19.1s
Step 0790 | Epoch 01 | Objective: -10.7488 | Coherence: 12.5013 | Separation: 13.3599 | Information gain: 7.8333 | Grad Norm: 31.8476 | Time: 19.4s
Step 0800 | Epoch 01 | Objective: -10.6305 | Coherence: 12.5086 | Separation: 13.2416 | Information gain: 7.8333 | Grad Norm: 30.3443 | Time: 19.7s
Step 0810 | Epoch 01 | Objective: -10.5378 | Coherence: 12.5057 | Separation: 13.1490 | Information gain: 7.8333 | Grad Norm: 30.5616 | Time: 19.9s
Step 0820 | Epoch 01 | Objective: -10.4749 | Coherence: 12.5276 | Separation: 13.0860 | Information gain: 7.8333 | Grad Norm: 30.3225 | Time: 20.2s
Step 0830 | Epoch 01 | Objective: -10.4197 | Coherence: 12.5581 | Separation: 13.0309 | Information gain: 7.8333 | Grad Norm: 30.3993 | Time: 20.5s
Step 0840 | Epoch 01 | Objective: -10.3562 | Coherence: 12.5756 | Separation: 12.9673 | Information gain: 7.8333 | Grad Norm: 30.9870 | Time: 20.8s
Step 0850 | Epoch 01 | Objective: -10.2979 | Coherence: 12.5891 | Separation: 12.9090 | Information gain: 7.8333 | Grad Norm: 32.3207 | Time: 21.1s
Step 0860 | Epoch 01 | Objective: -10.2278 | Coherence: 12.6228 | Separation: 12.8389 | Information gain: 7.8333 | Grad Norm: 29.5365 | Time: 21.4s
Step 0870 | Epoch 01 | Objective: -10.1626 | Coherence: 12.6433 | Separation: 12.7737 | Information gain: 7.8333 | Grad Norm: 30.1765 | Time: 21.6s
Step 0880 | Epoch 01 | Objective: -10.0887 | Coherence: 12.6682 | Separation: 12.6999 | Information gain: 7.8333 | Grad Norm: 30.1198 | Time: 21.8s
Step 0890 | Epoch 01 | Objective: -10.0202 | Coherence: 12.6864 | Separation: 12.6313 | Information gain: 7.8333 | Grad Norm: 31.1272 | Time: 22.1s
Step 0900 | Epoch 01 | Objective: -9.9472 | Coherence: 12.7035 | Separation: 12.5583 | Information gain: 7.8333 | Grad Norm: 31.0643 | Time: 22.3s
Step 0910 | Epoch 01 | Objective: -9.8754 | Coherence: 12.7322 | Separation: 12.4865 | Information gain: 7.8333 | Grad Norm: 31.4553 | Time: 22.6s
Step 0920 | Epoch 01 | Objective: -9.7932 | Coherence: 12.7520 | Separation: 12.4043 | Information gain: 7.8333 | Grad Norm: 32.1683 | Time: 22.8s
Step 0930 | Epoch 01 | Objective: -9.7588 | Coherence: 12.7857 | Separation: 12.3143 | Information gain: 7.6667 | Grad Norm: 30.0497 | Time: 23.0s
Step 0940 | Epoch 01 | Objective: -9.6769 | Coherence: 12.8073 | Separation: 12.2325 | Information gain: 7.6667 | Grad Norm: 31.6697 | Time: 23.3s
Step 0950 | Epoch 01 | Objective: -9.5937 | Coherence: 12.8313 | Separation: 12.1493 | Information gain: 7.6667 | Grad Norm: 30.6532 | Time: 23.5s
Step 0960 | Epoch 01 | Objective: -9.5082 | Coherence: 12.8562 | Separation: 12.0638 | Information gain: 7.6667 | Grad Norm: 31.8555 | Time: 23.7s
Step 0970 | Epoch 01 | Objective: -9.4278 | Coherence: 12.8805 | Separation: 11.9833 | Information gain: 7.6667 | Grad Norm: 29.3501 | Time: 23.9s
Step 0980 | Epoch 01 | Objective: -9.3816 | Coherence: 12.9225 | Separation: 11.9372 | Information gain: 7.6667 | Grad Norm: 31.0823 | Time: 24.2s
Step 0990 | Epoch 01 | Objective: -9.3289 | Coherence: 12.9564 | Separation: 11.8844 | Information gain: 7.6667 | Grad Norm: 31.6958 | Time: 24.4s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.635583  0.528517  0.546841  ...  0.528294  0.513938 -0.578810
1  0.489329  0.563340  0.444954  ...  0.563305  0.473259 -0.517146
2  0.515109  0.468156  0.586975  ...  0.468141  0.428534 -0.473893
3  0.493621  0.452910  0.429787  ...  0.452782  0.525746 -0.515362
4  0.584944  0.421064  0.561118  ...  0.420854  0.455372 -0.481800

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7956
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8982
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8818
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.9604, accuracy=0.1034
Testing SVM
  SVM Test Accuracy: 0.8541
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8286

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6575, Accuracy: 9547/12000 (80%)

Epoch 1 | Train Acc: 0.6780416666666667 | Test Acc: 0.7955833333333333 | Time: 1.1139421463012695 sec

Test set: Average loss: 0.5258, Accuracy: 9947/12000 (83%)

Epoch 2 | Train Acc: 0.829375 | Test Acc: 0.8289166666666666 | Time: 1.239858865737915 sec

Test set: Average loss: 0.4430, Accuracy: 10283/12000 (86%)

Epoch 3 | Train Acc: 0.8543958333333334 | Test Acc: 0.8569166666666667 | Time: 1.0198612213134766 sec

Test set: Average loss: 0.4000, Accuracy: 10435/12000 (87%)

Epoch 4 | Train Acc: 0.8683541666666666 | Test Acc: 0.8695833333333334 | Time: 1.0225324630737305 sec

Test set: Average loss: 0.3767, Accuracy: 10542/12000 (88%)

Epoch 5 | Train Acc: 0.8774166666666666 | Test Acc: 0.8785 | Time: 1.0292365550994873 sec

Test set: Average loss: 0.3636, Accuracy: 10596/12000 (88%)

Epoch 6 | Train Acc: 0.8833541666666667 | Test Acc: 0.883 | Time: 1.0396511554718018 sec

Test set: Average loss: 0.3532, Accuracy: 10631/12000 (89%)

Epoch 7 | Train Acc: 0.8876458333333334 | Test Acc: 0.8859166666666667 | Time: 1.1448678970336914 sec

Test set: Average loss: 0.3461, Accuracy: 10650/12000 (89%)

Epoch 8 | Train Acc: 0.8902708333333333 | Test Acc: 0.8875 | Time: 1.0402588844299316 sec

Test set: Average loss: 0.3415, Accuracy: 10663/12000 (89%)

Epoch 9 | Train Acc: 0.8922708333333333 | Test Acc: 0.8885833333333333 | Time: 1.0354301929473877 sec

Test set: Average loss: 0.3383, Accuracy: 10673/12000 (89%)

Epoch 10 | Train Acc: 0.8932708333333333 | Test Acc: 0.8894166666666666 | Time: 1.0300531387329102 sec

Test set: Average loss: 0.3360, Accuracy: 10688/12000 (89%)

Epoch 11 | Train Acc: 0.8938333333333334 | Test Acc: 0.8906666666666667 | Time: 1.0299692153930664 sec

Test set: Average loss: 0.3343, Accuracy: 10693/12000 (89%)

Epoch 12 | Train Acc: 0.8942291666666666 | Test Acc: 0.8910833333333333 | Time: 1.0338544845581055 sec

Test set: Average loss: 0.3332, Accuracy: 10698/12000 (89%)

Epoch 13 | Train Acc: 0.8948333333333334 | Test Acc: 0.8915 | Time: 1.0378332138061523 sec

Test set: Average loss: 0.3324, Accuracy: 10704/12000 (89%)

Epoch 14 | Train Acc: 0.895125 | Test Acc: 0.892 | Time: 1.0361170768737793 sec

Test set: Average loss: 0.3319, Accuracy: 10713/12000 (89%)

Epoch 15 | Train Acc: 0.8952083333333334 | Test Acc: 0.89275 | Time: 1.0523123741149902 sec

Test set: Average loss: 0.3315, Accuracy: 10717/12000 (89%)

Epoch 16 | Train Acc: 0.8954583333333334 | Test Acc: 0.8930833333333333 | Time: 1.121063232421875 sec

Test set: Average loss: 0.3312, Accuracy: 10719/12000 (89%)

Epoch 17 | Train Acc: 0.8956875 | Test Acc: 0.89325 | Time: 1.0305590629577637 sec

Test set: Average loss: 0.3311, Accuracy: 10718/12000 (89%)

Epoch 18 | Train Acc: 0.8958125 | Test Acc: 0.8931666666666667 | Time: 1.0320405960083008 sec

Test set: Average loss: 0.3310, Accuracy: 10720/12000 (89%)

Epoch 19 | Train Acc: 0.8959166666666667 | Test Acc: 0.8933333333333333 | Time: 1.0301644802093506 sec

Test set: Average loss: 0.3309, Accuracy: 10721/12000 (89%)

Epoch 20 | Train Acc: 0.8959583333333333 | Test Acc: 0.8934166666666666 | Time: 1.0324246883392334 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -46.8480 | Coherence: 6.6868 | Separation: 51.9591 | Information gain: 7.6667 | Grad Norm: 37.7161 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -45.0345 | Coherence: 6.6898 | Separation: 50.2567 | Information gain: 7.8333 | Grad Norm: 37.2317 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -43.3152 | Coherence: 6.6787 | Separation: 48.6486 | Information gain: 8.0000 | Grad Norm: 35.4378 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -42.2449 | Coherence: 6.5919 | Separation: 47.3561 | Information gain: 7.6667 | Grad Norm: 35.6115 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -40.9030 | Coherence: 6.4921 | Separation: 46.0141 | Information gain: 7.6667 | Grad Norm: 34.2071 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -39.5457 | Coherence: 6.3739 | Separation: 44.6568 | Information gain: 7.6667 | Grad Norm: 34.7950 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -38.4016 | Coherence: 6.2685 | Separation: 43.4016 | Information gain: 7.5000 | Grad Norm: 32.5497 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -37.2091 | Coherence: 6.1948 | Separation: 42.2091 | Information gain: 7.5000 | Grad Norm: 32.6709 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -36.0876 | Coherence: 6.1353 | Separation: 41.0876 | Information gain: 7.5000 | Grad Norm: 31.2068 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -35.0377 | Coherence: 6.1046 | Separation: 39.9266 | Information gain: 7.3333 | Grad Norm: 32.1323 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -33.8577 | Coherence: 6.0837 | Separation: 38.7466 | Information gain: 7.3333 | Grad Norm: 30.2136 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -32.7875 | Coherence: 6.0352 | Separation: 37.6764 | Information gain: 7.3333 | Grad Norm: 29.0198 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -31.8597 | Coherence: 5.9847 | Separation: 36.7486 | Information gain: 7.3333 | Grad Norm: 30.2737 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -30.9274 | Coherence: 6.0060 | Separation: 35.8163 | Information gain: 7.3333 | Grad Norm: 31.1888 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -29.9985 | Coherence: 6.0291 | Separation: 34.8874 | Information gain: 7.3333 | Grad Norm: 29.0458 | Time: 3.3s
Step 0150 | Epoch 01 | Objective: -28.9592 | Coherence: 6.0713 | Separation: 33.9592 | Information gain: 7.5000 | Grad Norm: 30.6570 | Time: 3.5s
Step 0160 | Epoch 01 | Objective: -28.0052 | Coherence: 6.0992 | Separation: 33.0052 | Information gain: 7.5000 | Grad Norm: 30.9346 | Time: 3.7s
Step 0170 | Epoch 01 | Objective: -26.9233 | Coherence: 6.1102 | Separation: 32.0344 | Information gain: 7.6667 | Grad Norm: 31.0542 | Time: 4.0s
Step 0180 | Epoch 01 | Objective: -25.9213 | Coherence: 6.1331 | Separation: 31.0324 | Information gain: 7.6667 | Grad Norm: 29.3067 | Time: 4.2s
Step 0190 | Epoch 01 | Objective: -25.0917 | Coherence: 6.1453 | Separation: 30.0917 | Information gain: 7.5000 | Grad Norm: 27.6517 | Time: 4.4s
Step 0200 | Epoch 01 | Objective: -24.3615 | Coherence: 6.1984 | Separation: 29.3615 | Information gain: 7.5000 | Grad Norm: 27.3118 | Time: 4.7s
Step 0210 | Epoch 01 | Objective: -23.6422 | Coherence: 6.2853 | Separation: 28.6422 | Information gain: 7.5000 | Grad Norm: 26.1551 | Time: 4.9s
Step 0220 | Epoch 01 | Objective: -22.9151 | Coherence: 6.4178 | Separation: 27.9151 | Information gain: 7.5000 | Grad Norm: 27.3285 | Time: 5.1s
Step 0230 | Epoch 01 | Objective: -22.1647 | Coherence: 6.5472 | Separation: 27.1647 | Information gain: 7.5000 | Grad Norm: 25.5684 | Time: 5.4s
Step 0240 | Epoch 01 | Objective: -21.4244 | Coherence: 6.6869 | Separation: 26.4244 | Information gain: 7.5000 | Grad Norm: 25.7186 | Time: 5.6s
Step 0250 | Epoch 01 | Objective: -20.6465 | Coherence: 6.8149 | Separation: 25.6465 | Information gain: 7.5000 | Grad Norm: 27.4798 | Time: 5.8s
Step 0260 | Epoch 01 | Objective: -19.9957 | Coherence: 6.9581 | Separation: 24.9957 | Information gain: 7.5000 | Grad Norm: 25.2858 | Time: 6.0s
Step 0270 | Epoch 01 | Objective: -19.5930 | Coherence: 7.1519 | Separation: 24.3707 | Information gain: 7.1667 | Grad Norm: 26.0658 | Time: 6.3s
Step 0280 | Epoch 01 | Objective: -18.9696 | Coherence: 7.3067 | Separation: 23.7474 | Information gain: 7.1667 | Grad Norm: 25.0585 | Time: 6.5s
Step 0290 | Epoch 01 | Objective: -18.3654 | Coherence: 7.4479 | Separation: 23.1431 | Information gain: 7.1667 | Grad Norm: 25.1629 | Time: 6.7s
Step 0300 | Epoch 01 | Objective: -17.8415 | Coherence: 7.6204 | Separation: 22.6193 | Information gain: 7.1667 | Grad Norm: 25.5421 | Time: 7.0s
Step 0310 | Epoch 01 | Objective: -17.3449 | Coherence: 7.8254 | Separation: 22.1227 | Information gain: 7.1667 | Grad Norm: 24.0356 | Time: 7.2s
Step 0320 | Epoch 01 | Objective: -16.8667 | Coherence: 8.0239 | Separation: 21.6445 | Information gain: 7.1667 | Grad Norm: 27.0711 | Time: 7.4s
Step 0330 | Epoch 01 | Objective: -16.2906 | Coherence: 8.2187 | Separation: 21.1795 | Information gain: 7.3333 | Grad Norm: 24.4943 | Time: 7.6s
Step 0340 | Epoch 01 | Objective: -15.8454 | Coherence: 8.4059 | Separation: 20.7343 | Information gain: 7.3333 | Grad Norm: 24.4582 | Time: 7.9s
Step 0350 | Epoch 01 | Objective: -15.3732 | Coherence: 8.5693 | Separation: 20.2621 | Information gain: 7.3333 | Grad Norm: 26.3014 | Time: 8.1s
Step 0360 | Epoch 01 | Objective: -14.9327 | Coherence: 8.7496 | Separation: 19.8216 | Information gain: 7.3333 | Grad Norm: 26.1034 | Time: 8.3s
Step 0370 | Epoch 01 | Objective: -14.5640 | Coherence: 8.9030 | Separation: 19.4529 | Information gain: 7.3333 | Grad Norm: 25.5151 | Time: 8.6s
Step 0380 | Epoch 01 | Objective: -14.1681 | Coherence: 9.0344 | Separation: 19.0570 | Information gain: 7.3333 | Grad Norm: 24.6932 | Time: 8.8s
Step 0390 | Epoch 01 | Objective: -13.7943 | Coherence: 9.1668 | Separation: 18.6832 | Information gain: 7.3333 | Grad Norm: 24.9857 | Time: 9.0s
Step 0400 | Epoch 01 | Objective: -13.4148 | Coherence: 9.3148 | Separation: 18.3037 | Information gain: 7.3333 | Grad Norm: 24.3597 | Time: 9.2s
Step 0410 | Epoch 01 | Objective: -13.0223 | Coherence: 9.4500 | Separation: 17.9112 | Information gain: 7.3333 | Grad Norm: 26.0637 | Time: 9.5s
Step 0420 | Epoch 01 | Objective: -12.6366 | Coherence: 9.5929 | Separation: 17.5255 | Information gain: 7.3333 | Grad Norm: 27.5271 | Time: 9.7s
Step 0430 | Epoch 01 | Objective: -12.1469 | Coherence: 9.7747 | Separation: 17.1469 | Information gain: 7.5000 | Grad Norm: 27.4533 | Time: 9.9s
Step 0440 | Epoch 01 | Objective: -11.8428 | Coherence: 9.9586 | Separation: 16.8428 | Information gain: 7.5000 | Grad Norm: 26.5212 | Time: 10.2s
Step 0450 | Epoch 01 | Objective: -11.5889 | Coherence: 10.1598 | Separation: 16.5889 | Information gain: 7.5000 | Grad Norm: 24.7505 | Time: 10.4s
Step 0460 | Epoch 01 | Objective: -11.3253 | Coherence: 10.2712 | Separation: 16.3253 | Information gain: 7.5000 | Grad Norm: 26.4481 | Time: 10.7s
Step 0470 | Epoch 01 | Objective: -10.9705 | Coherence: 10.4076 | Separation: 16.0816 | Information gain: 7.6667 | Grad Norm: 27.9491 | Time: 10.9s
Step 0480 | Epoch 01 | Objective: -10.7502 | Coherence: 10.5032 | Separation: 15.8614 | Information gain: 7.6667 | Grad Norm: 25.6419 | Time: 11.1s
Step 0490 | Epoch 01 | Objective: -10.5135 | Coherence: 10.6070 | Separation: 15.6246 | Information gain: 7.6667 | Grad Norm: 28.3037 | Time: 11.3s
Step 0500 | Epoch 01 | Objective: -10.2935 | Coherence: 10.6981 | Separation: 15.4046 | Information gain: 7.6667 | Grad Norm: 25.6654 | Time: 11.6s
Step 0510 | Epoch 01 | Objective: -10.0721 | Coherence: 10.7242 | Separation: 15.1832 | Information gain: 7.6667 | Grad Norm: 29.2616 | Time: 11.8s
Step 0520 | Epoch 01 | Objective: -9.8591 | Coherence: 10.7661 | Separation: 14.9702 | Information gain: 7.6667 | Grad Norm: 27.3829 | Time: 12.0s
Step 0530 | Epoch 01 | Objective: -9.6294 | Coherence: 10.8265 | Separation: 14.7405 | Information gain: 7.6667 | Grad Norm: 28.0927 | Time: 12.3s
Step 0540 | Epoch 01 | Objective: -9.4038 | Coherence: 10.8701 | Separation: 14.5149 | Information gain: 7.6667 | Grad Norm: 27.8326 | Time: 12.5s
Step 0550 | Epoch 01 | Objective: -9.2626 | Coherence: 10.9244 | Separation: 14.3737 | Information gain: 7.6667 | Grad Norm: 28.9593 | Time: 12.8s
Step 0560 | Epoch 01 | Objective: -9.1009 | Coherence: 10.9902 | Separation: 14.2120 | Information gain: 7.6667 | Grad Norm: 26.5984 | Time: 13.0s
Step 0570 | Epoch 01 | Objective: -8.9879 | Coherence: 11.0517 | Separation: 14.0990 | Information gain: 7.6667 | Grad Norm: 28.8829 | Time: 13.3s
Step 0580 | Epoch 01 | Objective: -8.8790 | Coherence: 11.1027 | Separation: 13.9901 | Information gain: 7.6667 | Grad Norm: 28.8574 | Time: 13.5s
Step 0590 | Epoch 01 | Objective: -8.7730 | Coherence: 11.1435 | Separation: 13.8841 | Information gain: 7.6667 | Grad Norm: 28.7073 | Time: 13.7s
Step 0600 | Epoch 01 | Objective: -8.5951 | Coherence: 11.1910 | Separation: 13.8174 | Information gain: 7.8333 | Grad Norm: 29.0650 | Time: 14.0s
Step 0610 | Epoch 01 | Objective: -8.5479 | Coherence: 11.2198 | Separation: 13.7702 | Information gain: 7.8333 | Grad Norm: 32.0291 | Time: 14.2s
Step 0620 | Epoch 01 | Objective: -8.4821 | Coherence: 11.2564 | Separation: 13.7043 | Information gain: 7.8333 | Grad Norm: 29.3867 | Time: 14.5s
Step 0630 | Epoch 01 | Objective: -8.4348 | Coherence: 11.2869 | Separation: 13.6570 | Information gain: 7.8333 | Grad Norm: 30.6069 | Time: 14.7s
Step 0640 | Epoch 01 | Objective: -8.3639 | Coherence: 11.3180 | Separation: 13.5861 | Information gain: 7.8333 | Grad Norm: 30.1615 | Time: 14.9s
Step 0650 | Epoch 01 | Objective: -8.3066 | Coherence: 11.3419 | Separation: 13.5289 | Information gain: 7.8333 | Grad Norm: 31.2296 | Time: 15.2s
Step 0660 | Epoch 01 | Objective: -8.3520 | Coherence: 11.3819 | Separation: 13.4631 | Information gain: 7.6667 | Grad Norm: 31.5115 | Time: 15.4s
Step 0670 | Epoch 01 | Objective: -8.2958 | Coherence: 11.4121 | Separation: 13.4069 | Information gain: 7.6667 | Grad Norm: 30.6836 | Time: 15.6s
Step 0680 | Epoch 01 | Objective: -8.2409 | Coherence: 11.4504 | Separation: 13.3520 | Information gain: 7.6667 | Grad Norm: 28.7336 | Time: 15.9s
Step 0690 | Epoch 01 | Objective: -8.1695 | Coherence: 11.4868 | Separation: 13.2806 | Information gain: 7.6667 | Grad Norm: 29.7915 | Time: 16.1s
Step 0700 | Epoch 01 | Objective: -8.1132 | Coherence: 11.5188 | Separation: 13.2243 | Information gain: 7.6667 | Grad Norm: 29.9134 | Time: 16.3s
Step 0710 | Epoch 01 | Objective: -8.0523 | Coherence: 11.5554 | Separation: 13.1635 | Information gain: 7.6667 | Grad Norm: 30.8593 | Time: 16.6s
Step 0720 | Epoch 01 | Objective: -7.8790 | Coherence: 11.5906 | Separation: 13.1012 | Information gain: 7.8333 | Grad Norm: 29.1062 | Time: 16.8s
Step 0730 | Epoch 01 | Objective: -7.8216 | Coherence: 11.6278 | Separation: 13.0438 | Information gain: 7.8333 | Grad Norm: 31.4562 | Time: 17.0s
Step 0740 | Epoch 01 | Objective: -7.7521 | Coherence: 11.6620 | Separation: 12.9743 | Information gain: 7.8333 | Grad Norm: 32.0426 | Time: 17.2s
Step 0750 | Epoch 01 | Objective: -7.5792 | Coherence: 11.7063 | Separation: 12.9125 | Information gain: 8.0000 | Grad Norm: 30.9461 | Time: 17.5s
Step 0760 | Epoch 01 | Objective: -7.5168 | Coherence: 11.7334 | Separation: 12.8502 | Information gain: 8.0000 | Grad Norm: 33.2538 | Time: 17.7s
Step 0770 | Epoch 01 | Objective: -7.4499 | Coherence: 11.7735 | Separation: 12.7832 | Information gain: 8.0000 | Grad Norm: 30.9435 | Time: 17.9s
Step 0780 | Epoch 01 | Objective: -7.3747 | Coherence: 11.8138 | Separation: 12.7081 | Information gain: 8.0000 | Grad Norm: 32.0373 | Time: 18.1s
Step 0790 | Epoch 01 | Objective: -7.3055 | Coherence: 11.8415 | Separation: 12.6389 | Information gain: 8.0000 | Grad Norm: 30.9469 | Time: 18.4s
Step 0800 | Epoch 01 | Objective: -7.2360 | Coherence: 11.8876 | Separation: 12.5693 | Information gain: 8.0000 | Grad Norm: 30.8795 | Time: 18.6s
Step 0810 | Epoch 01 | Objective: -7.1666 | Coherence: 11.9216 | Separation: 12.5000 | Information gain: 8.0000 | Grad Norm: 31.1673 | Time: 18.8s
Step 0820 | Epoch 01 | Objective: -7.0890 | Coherence: 11.9642 | Separation: 12.4224 | Information gain: 8.0000 | Grad Norm: 30.6623 | Time: 19.0s
Step 0830 | Epoch 01 | Objective: -7.0226 | Coherence: 12.0057 | Separation: 12.3559 | Information gain: 8.0000 | Grad Norm: 29.2096 | Time: 19.3s
Step 0840 | Epoch 01 | Objective: -6.9420 | Coherence: 12.0310 | Separation: 12.2753 | Information gain: 8.0000 | Grad Norm: 30.6090 | Time: 19.5s
Step 0850 | Epoch 01 | Objective: -6.8651 | Coherence: 12.0743 | Separation: 12.1984 | Information gain: 8.0000 | Grad Norm: 30.4151 | Time: 19.7s
Step 0860 | Epoch 01 | Objective: -6.7891 | Coherence: 12.1095 | Separation: 12.1224 | Information gain: 8.0000 | Grad Norm: 30.2828 | Time: 19.9s
Step 0870 | Epoch 01 | Objective: -6.7099 | Coherence: 12.1432 | Separation: 12.0432 | Information gain: 8.0000 | Grad Norm: 30.8114 | Time: 20.2s
Step 0880 | Epoch 01 | Objective: -6.6277 | Coherence: 12.1914 | Separation: 11.9610 | Information gain: 8.0000 | Grad Norm: 30.5594 | Time: 20.4s
Step 0890 | Epoch 01 | Objective: -6.5506 | Coherence: 12.2169 | Separation: 11.8839 | Information gain: 8.0000 | Grad Norm: 33.1572 | Time: 20.6s
Step 0900 | Epoch 01 | Objective: -6.4758 | Coherence: 12.2507 | Separation: 11.8091 | Information gain: 8.0000 | Grad Norm: 31.6737 | Time: 20.9s
Step 0910 | Epoch 01 | Objective: -6.4222 | Coherence: 12.2981 | Separation: 11.7555 | Information gain: 8.0000 | Grad Norm: 31.3010 | Time: 21.1s
Step 0920 | Epoch 01 | Objective: -6.3763 | Coherence: 12.3308 | Separation: 11.7097 | Information gain: 8.0000 | Grad Norm: 32.0362 | Time: 21.3s
Step 0930 | Epoch 01 | Objective: -6.3164 | Coherence: 12.3775 | Separation: 11.6497 | Information gain: 8.0000 | Grad Norm: 31.8618 | Time: 21.5s
Step 0940 | Epoch 01 | Objective: -6.3648 | Coherence: 12.4088 | Separation: 11.5871 | Information gain: 7.8333 | Grad Norm: 31.6906 | Time: 21.8s
Step 0950 | Epoch 01 | Objective: -6.3086 | Coherence: 12.4488 | Separation: 11.5309 | Information gain: 7.8333 | Grad Norm: 32.9237 | Time: 22.0s
Step 0960 | Epoch 01 | Objective: -6.2694 | Coherence: 12.4914 | Separation: 11.4917 | Information gain: 7.8333 | Grad Norm: 29.1672 | Time: 22.2s
Step 0970 | Epoch 01 | Objective: -6.2389 | Coherence: 12.5207 | Separation: 11.4611 | Information gain: 7.8333 | Grad Norm: 30.2924 | Time: 22.5s
Step 0980 | Epoch 01 | Objective: -6.2230 | Coherence: 12.5614 | Separation: 11.4452 | Information gain: 7.8333 | Grad Norm: 31.7998 | Time: 22.7s
Step 0990 | Epoch 01 | Objective: -6.2185 | Coherence: 12.5895 | Separation: 11.4408 | Information gain: 7.8333 | Grad Norm: 31.8293 | Time: 22.9s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.579958  0.393548  0.494393  ... -0.519375  0.504987  0.579959
1  0.433932  0.645692  0.427326  ... -0.494589  0.401037  0.433987
2  0.516592  0.405517  0.606982  ... -0.557127  0.498092  0.516592
3  0.401647  0.334232  0.440590  ... -0.414222  0.365618  0.401660
4  0.500269  0.391220  0.508343  ... -0.510468  0.472947  0.500274

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8021
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9018
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8815
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.9893, accuracy=0.0884
Testing SVM
  SVM Test Accuracy: 0.8582
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8337

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7441, Accuracy: 9287/12000 (77%)

Epoch 1 | Train Acc: 0.6631458333333333 | Test Acc: 0.7739166666666667 | Time: 1.051262617111206 sec

Test set: Average loss: 0.5238, Accuracy: 10057/12000 (84%)

Epoch 2 | Train Acc: 0.8274166666666667 | Test Acc: 0.8380833333333333 | Time: 1.138049602508545 sec

Test set: Average loss: 0.4298, Accuracy: 10392/12000 (87%)

Epoch 3 | Train Acc: 0.8585208333333333 | Test Acc: 0.866 | Time: 1.0320491790771484 sec

Test set: Average loss: 0.3801, Accuracy: 10562/12000 (88%)

Epoch 4 | Train Acc: 0.8751041666666667 | Test Acc: 0.8801666666666667 | Time: 1.0248935222625732 sec

Test set: Average loss: 0.3524, Accuracy: 10658/12000 (89%)

Epoch 5 | Train Acc: 0.8847708333333333 | Test Acc: 0.8881666666666667 | Time: 1.0269289016723633 sec

Test set: Average loss: 0.3372, Accuracy: 10698/12000 (89%)

Epoch 6 | Train Acc: 0.8909166666666667 | Test Acc: 0.8915 | Time: 1.0258703231811523 sec

Test set: Average loss: 0.3276, Accuracy: 10755/12000 (90%)

Epoch 7 | Train Acc: 0.8951041666666667 | Test Acc: 0.89625 | Time: 1.0248777866363525 sec

Test set: Average loss: 0.3214, Accuracy: 10770/12000 (90%)

Epoch 8 | Train Acc: 0.8987916666666667 | Test Acc: 0.8975 | Time: 1.0255753993988037 sec

Test set: Average loss: 0.3164, Accuracy: 10796/12000 (90%)

Epoch 9 | Train Acc: 0.9010833333333333 | Test Acc: 0.8996666666666666 | Time: 1.0220813751220703 sec

Test set: Average loss: 0.3131, Accuracy: 10810/12000 (90%)

Epoch 10 | Train Acc: 0.902875 | Test Acc: 0.9008333333333334 | Time: 1.031651258468628 sec

Test set: Average loss: 0.3110, Accuracy: 10816/12000 (90%)

Epoch 11 | Train Acc: 0.9037291666666667 | Test Acc: 0.9013333333333333 | Time: 1.1508235931396484 sec

Test set: Average loss: 0.3096, Accuracy: 10813/12000 (90%)

Epoch 12 | Train Acc: 0.9042708333333334 | Test Acc: 0.9010833333333333 | Time: 1.0734562873840332 sec

Test set: Average loss: 0.3086, Accuracy: 10817/12000 (90%)

Epoch 13 | Train Acc: 0.9046666666666666 | Test Acc: 0.9014166666666666 | Time: 1.0337042808532715 sec

Test set: Average loss: 0.3079, Accuracy: 10823/12000 (90%)

Epoch 14 | Train Acc: 0.9051458333333333 | Test Acc: 0.9019166666666667 | Time: 1.0328874588012695 sec

Test set: Average loss: 0.3075, Accuracy: 10821/12000 (90%)

Epoch 15 | Train Acc: 0.9053541666666667 | Test Acc: 0.90175 | Time: 1.0342762470245361 sec

Test set: Average loss: 0.3072, Accuracy: 10823/12000 (90%)

Epoch 16 | Train Acc: 0.9055833333333333 | Test Acc: 0.9019166666666667 | Time: 1.0367975234985352 sec

Test set: Average loss: 0.3070, Accuracy: 10821/12000 (90%)

Epoch 17 | Train Acc: 0.9056458333333334 | Test Acc: 0.90175 | Time: 1.030559778213501 sec

Test set: Average loss: 0.3069, Accuracy: 10821/12000 (90%)

Epoch 18 | Train Acc: 0.9057083333333333 | Test Acc: 0.90175 | Time: 1.0330266952514648 sec

Test set: Average loss: 0.3068, Accuracy: 10819/12000 (90%)

Epoch 19 | Train Acc: 0.9057291666666667 | Test Acc: 0.9015833333333333 | Time: 1.027940273284912 sec
Early stopping at epoch 19

Testing with M=15
Step 0000 | Epoch 01 | Objective: -47.2214 | Coherence: 0.4888 | Separation: 53.7214 | Information gain: 6.5000 | Grad Norm: 40.2351 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -45.2142 | Coherence: 0.6918 | Separation: 51.7142 | Information gain: 6.5000 | Grad Norm: 38.1676 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -43.3717 | Coherence: 0.7714 | Separation: 49.8717 | Information gain: 6.5000 | Grad Norm: 37.4672 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -41.7135 | Coherence: 0.7754 | Separation: 48.2135 | Information gain: 6.5000 | Grad Norm: 36.0604 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -40.2185 | Coherence: 0.7787 | Separation: 46.7185 | Information gain: 6.5000 | Grad Norm: 34.2795 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -38.9196 | Coherence: 0.7765 | Separation: 45.4196 | Information gain: 6.5000 | Grad Norm: 33.4239 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -37.9704 | Coherence: 0.7944 | Separation: 44.3037 | Information gain: 6.3333 | Grad Norm: 32.5307 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -36.7796 | Coherence: 0.7385 | Separation: 43.1129 | Information gain: 6.3333 | Grad Norm: 33.6438 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -35.6657 | Coherence: 0.6462 | Separation: 41.9990 | Information gain: 6.3333 | Grad Norm: 31.8665 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -34.5101 | Coherence: 0.5367 | Separation: 40.8434 | Information gain: 6.3333 | Grad Norm: 33.8810 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -33.2885 | Coherence: 0.4397 | Separation: 39.6219 | Information gain: 6.3333 | Grad Norm: 32.0946 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -32.1211 | Coherence: 0.3359 | Separation: 38.4544 | Information gain: 6.3333 | Grad Norm: 31.7212 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -30.9335 | Coherence: 0.2849 | Separation: 37.2668 | Information gain: 6.3333 | Grad Norm: 31.8556 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -29.8348 | Coherence: 0.2670 | Separation: 36.1682 | Information gain: 6.3333 | Grad Norm: 30.9066 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -28.9301 | Coherence: 0.2747 | Separation: 35.2634 | Information gain: 6.3333 | Grad Norm: 29.8741 | Time: 3.3s
Step 0150 | Epoch 01 | Objective: -28.0998 | Coherence: 0.2151 | Separation: 34.4331 | Information gain: 6.3333 | Grad Norm: 28.6911 | Time: 3.5s
Step 0160 | Epoch 01 | Objective: -27.3268 | Coherence: 0.1631 | Separation: 33.6601 | Information gain: 6.3333 | Grad Norm: 28.7940 | Time: 3.7s
Step 0170 | Epoch 01 | Objective: -26.5006 | Coherence: 0.1682 | Separation: 32.8339 | Information gain: 6.3333 | Grad Norm: 30.1521 | Time: 3.9s
Step 0180 | Epoch 01 | Objective: -25.8973 | Coherence: 0.1335 | Separation: 32.0639 | Information gain: 6.1667 | Grad Norm: 29.8394 | Time: 4.2s
Step 0190 | Epoch 01 | Objective: -25.1254 | Coherence: 0.1826 | Separation: 31.2920 | Information gain: 6.1667 | Grad Norm: 30.4983 | Time: 4.4s
Step 0200 | Epoch 01 | Objective: -24.3688 | Coherence: 0.2366 | Separation: 30.5355 | Information gain: 6.1667 | Grad Norm: 29.1263 | Time: 4.6s
Step 0210 | Epoch 01 | Objective: -23.9156 | Coherence: 0.2399 | Separation: 29.9156 | Information gain: 6.0000 | Grad Norm: 27.8533 | Time: 4.8s
Step 0220 | Epoch 01 | Objective: -23.3398 | Coherence: 0.1939 | Separation: 29.3398 | Information gain: 6.0000 | Grad Norm: 26.6110 | Time: 5.1s
Step 0230 | Epoch 01 | Objective: -22.6359 | Coherence: 0.1551 | Separation: 28.8026 | Information gain: 6.1667 | Grad Norm: 27.1227 | Time: 5.3s
Step 0240 | Epoch 01 | Objective: -21.7582 | Coherence: 0.1359 | Separation: 28.2582 | Information gain: 6.5000 | Grad Norm: 26.0028 | Time: 5.5s
Step 0250 | Epoch 01 | Objective: -21.3121 | Coherence: 0.0907 | Separation: 27.8121 | Information gain: 6.5000 | Grad Norm: 27.3052 | Time: 5.8s
Step 0260 | Epoch 01 | Objective: -21.0351 | Coherence: 0.0772 | Separation: 27.3684 | Information gain: 6.3333 | Grad Norm: 26.5134 | Time: 6.0s
Step 0270 | Epoch 01 | Objective: -20.7239 | Coherence: 0.1490 | Separation: 27.0572 | Information gain: 6.3333 | Grad Norm: 27.0396 | Time: 6.3s
Step 0280 | Epoch 01 | Objective: -20.4616 | Coherence: 0.2277 | Separation: 26.7950 | Information gain: 6.3333 | Grad Norm: 26.8024 | Time: 6.5s
Step 0290 | Epoch 01 | Objective: -20.1827 | Coherence: 0.3057 | Separation: 26.5160 | Information gain: 6.3333 | Grad Norm: 27.0999 | Time: 6.8s
Step 0300 | Epoch 01 | Objective: -19.9431 | Coherence: 0.3412 | Separation: 26.2765 | Information gain: 6.3333 | Grad Norm: 27.4113 | Time: 7.0s
Step 0310 | Epoch 01 | Objective: -19.5508 | Coherence: 0.3363 | Separation: 26.0508 | Information gain: 6.5000 | Grad Norm: 27.8708 | Time: 7.2s
Step 0320 | Epoch 01 | Objective: -19.2992 | Coherence: 0.3201 | Separation: 25.7992 | Information gain: 6.5000 | Grad Norm: 27.5611 | Time: 7.5s
Step 0330 | Epoch 01 | Objective: -19.0392 | Coherence: 0.3172 | Separation: 25.5392 | Information gain: 6.5000 | Grad Norm: 27.4875 | Time: 7.7s
Step 0340 | Epoch 01 | Objective: -18.7672 | Coherence: 0.3145 | Separation: 25.2672 | Information gain: 6.5000 | Grad Norm: 27.5037 | Time: 8.0s
Step 0350 | Epoch 01 | Objective: -18.5009 | Coherence: 0.3146 | Separation: 25.0009 | Information gain: 6.5000 | Grad Norm: 27.8143 | Time: 8.2s
Step 0360 | Epoch 01 | Objective: -18.2328 | Coherence: 0.3802 | Separation: 24.7328 | Information gain: 6.5000 | Grad Norm: 28.8410 | Time: 8.4s
Step 0370 | Epoch 01 | Objective: -18.0088 | Coherence: 0.4070 | Separation: 24.5088 | Information gain: 6.5000 | Grad Norm: 27.0839 | Time: 8.7s
Step 0380 | Epoch 01 | Objective: -17.7673 | Coherence: 0.4182 | Separation: 24.2673 | Information gain: 6.5000 | Grad Norm: 28.9776 | Time: 8.9s
Step 0390 | Epoch 01 | Objective: -17.5177 | Coherence: 0.4472 | Separation: 24.0177 | Information gain: 6.5000 | Grad Norm: 27.8250 | Time: 9.1s
Step 0400 | Epoch 01 | Objective: -17.2675 | Coherence: 0.4922 | Separation: 23.7675 | Information gain: 6.5000 | Grad Norm: 27.1433 | Time: 9.4s
Step 0410 | Epoch 01 | Objective: -17.0110 | Coherence: 0.5042 | Separation: 23.5110 | Information gain: 6.5000 | Grad Norm: 27.9913 | Time: 9.6s
Step 0420 | Epoch 01 | Objective: -16.7534 | Coherence: 0.5408 | Separation: 23.2534 | Information gain: 6.5000 | Grad Norm: 26.7214 | Time: 9.8s
Step 0430 | Epoch 01 | Objective: -16.4885 | Coherence: 0.5935 | Separation: 22.9885 | Information gain: 6.5000 | Grad Norm: 29.1992 | Time: 10.0s
Step 0440 | Epoch 01 | Objective: -16.2059 | Coherence: 0.6498 | Separation: 22.7059 | Information gain: 6.5000 | Grad Norm: 30.8351 | Time: 10.3s
Step 0450 | Epoch 01 | Objective: -15.9211 | Coherence: 0.7264 | Separation: 22.4211 | Information gain: 6.5000 | Grad Norm: 26.4715 | Time: 10.5s
Step 0460 | Epoch 01 | Objective: -15.6579 | Coherence: 0.8091 | Separation: 22.1579 | Information gain: 6.5000 | Grad Norm: 28.0350 | Time: 10.7s
Step 0470 | Epoch 01 | Objective: -15.4439 | Coherence: 0.8998 | Separation: 21.9439 | Information gain: 6.5000 | Grad Norm: 26.8829 | Time: 11.0s
Step 0480 | Epoch 01 | Objective: -15.0872 | Coherence: 0.9784 | Separation: 21.7539 | Information gain: 6.6667 | Grad Norm: 30.2356 | Time: 11.2s
Step 0490 | Epoch 01 | Objective: -14.8838 | Coherence: 1.0555 | Separation: 21.5505 | Information gain: 6.6667 | Grad Norm: 26.8149 | Time: 11.4s
Step 0500 | Epoch 01 | Objective: -14.8291 | Coherence: 1.1286 | Separation: 21.3291 | Information gain: 6.5000 | Grad Norm: 27.9539 | Time: 11.7s
Step 0510 | Epoch 01 | Objective: -14.4478 | Coherence: 1.2057 | Separation: 21.1145 | Information gain: 6.6667 | Grad Norm: 28.1294 | Time: 11.9s
Step 0520 | Epoch 01 | Objective: -14.3309 | Coherence: 1.2664 | Separation: 20.9975 | Information gain: 6.6667 | Grad Norm: 30.4608 | Time: 12.1s
Step 0530 | Epoch 01 | Objective: -14.2112 | Coherence: 1.2864 | Separation: 20.8779 | Information gain: 6.6667 | Grad Norm: 29.8187 | Time: 12.3s
Step 0540 | Epoch 01 | Objective: -14.0935 | Coherence: 1.3122 | Separation: 20.7602 | Information gain: 6.6667 | Grad Norm: 31.6466 | Time: 12.6s
Step 0550 | Epoch 01 | Objective: -13.9651 | Coherence: 1.3507 | Separation: 20.6317 | Information gain: 6.6667 | Grad Norm: 29.5099 | Time: 12.8s
Step 0560 | Epoch 01 | Objective: -14.0119 | Coherence: 1.3794 | Separation: 20.5119 | Information gain: 6.5000 | Grad Norm: 30.2157 | Time: 13.0s
Step 0570 | Epoch 01 | Objective: -13.8883 | Coherence: 1.4069 | Separation: 20.3883 | Information gain: 6.5000 | Grad Norm: 30.6129 | Time: 13.2s
Step 0580 | Epoch 01 | Objective: -13.5885 | Coherence: 1.4423 | Separation: 20.2552 | Information gain: 6.6667 | Grad Norm: 29.2765 | Time: 13.5s
Step 0590 | Epoch 01 | Objective: -13.4932 | Coherence: 1.4702 | Separation: 20.1598 | Information gain: 6.6667 | Grad Norm: 28.5047 | Time: 13.7s
Step 0600 | Epoch 01 | Objective: -13.4020 | Coherence: 1.4776 | Separation: 20.0686 | Information gain: 6.6667 | Grad Norm: 32.2341 | Time: 13.9s
Step 0610 | Epoch 01 | Objective: -13.1301 | Coherence: 1.5042 | Separation: 19.9634 | Information gain: 6.8333 | Grad Norm: 29.1426 | Time: 14.2s
Step 0620 | Epoch 01 | Objective: -13.0336 | Coherence: 1.5315 | Separation: 19.8669 | Information gain: 6.8333 | Grad Norm: 29.4035 | Time: 14.4s
Step 0630 | Epoch 01 | Objective: -12.9198 | Coherence: 1.5562 | Separation: 19.7531 | Information gain: 6.8333 | Grad Norm: 28.1394 | Time: 14.6s
Step 0640 | Epoch 01 | Objective: -12.8073 | Coherence: 1.5806 | Separation: 19.6407 | Information gain: 6.8333 | Grad Norm: 29.8623 | Time: 14.8s
Step 0650 | Epoch 01 | Objective: -12.6941 | Coherence: 1.6137 | Separation: 19.5274 | Information gain: 6.8333 | Grad Norm: 27.4213 | Time: 15.1s
Step 0660 | Epoch 01 | Objective: -12.5734 | Coherence: 1.6405 | Separation: 19.4067 | Information gain: 6.8333 | Grad Norm: 29.0036 | Time: 15.3s
Step 0670 | Epoch 01 | Objective: -12.4460 | Coherence: 1.6651 | Separation: 19.2794 | Information gain: 6.8333 | Grad Norm: 28.5372 | Time: 15.5s
Step 0680 | Epoch 01 | Objective: -12.3171 | Coherence: 1.6947 | Separation: 19.1505 | Information gain: 6.8333 | Grad Norm: 28.6163 | Time: 15.8s
Step 0690 | Epoch 01 | Objective: -12.1812 | Coherence: 1.7377 | Separation: 19.0145 | Information gain: 6.8333 | Grad Norm: 28.6694 | Time: 16.0s
Step 0700 | Epoch 01 | Objective: -12.0521 | Coherence: 1.7812 | Separation: 18.8855 | Information gain: 6.8333 | Grad Norm: 27.5204 | Time: 16.2s
Step 0710 | Epoch 01 | Objective: -11.9050 | Coherence: 1.8112 | Separation: 18.7383 | Information gain: 6.8333 | Grad Norm: 28.0714 | Time: 16.4s
Step 0720 | Epoch 01 | Objective: -11.7613 | Coherence: 1.8601 | Separation: 18.5946 | Information gain: 6.8333 | Grad Norm: 28.8809 | Time: 16.7s
Step 0730 | Epoch 01 | Objective: -11.4358 | Coherence: 1.9043 | Separation: 18.4358 | Information gain: 7.0000 | Grad Norm: 29.6834 | Time: 16.9s
Step 0740 | Epoch 01 | Objective: -11.2889 | Coherence: 1.9430 | Separation: 18.2889 | Information gain: 7.0000 | Grad Norm: 29.9084 | Time: 17.1s
Step 0750 | Epoch 01 | Objective: -11.3000 | Coherence: 1.9958 | Separation: 18.1333 | Information gain: 6.8333 | Grad Norm: 28.5356 | Time: 17.3s
Step 0760 | Epoch 01 | Objective: -10.9751 | Coherence: 2.0481 | Separation: 17.9751 | Information gain: 7.0000 | Grad Norm: 30.3040 | Time: 17.6s
Step 0770 | Epoch 01 | Objective: -10.8289 | Coherence: 2.1065 | Separation: 17.8289 | Information gain: 7.0000 | Grad Norm: 29.7808 | Time: 17.8s
Step 0780 | Epoch 01 | Objective: -10.7157 | Coherence: 2.1527 | Separation: 17.7157 | Information gain: 7.0000 | Grad Norm: 29.6286 | Time: 18.0s
Step 0790 | Epoch 01 | Objective: -10.7748 | Coherence: 2.1995 | Separation: 17.6082 | Information gain: 6.8333 | Grad Norm: 32.8318 | Time: 18.3s
Step 0800 | Epoch 01 | Objective: -10.4766 | Coherence: 2.2566 | Separation: 17.4766 | Information gain: 7.0000 | Grad Norm: 31.5955 | Time: 18.5s
Step 0810 | Epoch 01 | Objective: -10.3431 | Coherence: 2.3129 | Separation: 17.3431 | Information gain: 7.0000 | Grad Norm: 29.5072 | Time: 18.7s
Step 0820 | Epoch 01 | Objective: -10.0425 | Coherence: 2.3733 | Separation: 17.2092 | Information gain: 7.1667 | Grad Norm: 30.7958 | Time: 19.0s
Step 0830 | Epoch 01 | Objective: -9.9050 | Coherence: 2.4351 | Separation: 17.0716 | Information gain: 7.1667 | Grad Norm: 28.7270 | Time: 19.2s
Step 0840 | Epoch 01 | Objective: -9.5875 | Coherence: 2.5049 | Separation: 16.9208 | Information gain: 7.3333 | Grad Norm: 31.3043 | Time: 19.4s
Step 0850 | Epoch 01 | Objective: -9.2803 | Coherence: 2.5602 | Separation: 16.7803 | Information gain: 7.5000 | Grad Norm: 31.3788 | Time: 19.7s
Step 0860 | Epoch 01 | Objective: -9.1445 | Coherence: 2.5911 | Separation: 16.6445 | Information gain: 7.5000 | Grad Norm: 29.6841 | Time: 19.9s
Step 0870 | Epoch 01 | Objective: -9.0245 | Coherence: 2.6037 | Separation: 16.5245 | Information gain: 7.5000 | Grad Norm: 31.9389 | Time: 20.1s
Step 0880 | Epoch 01 | Objective: -8.8938 | Coherence: 2.6323 | Separation: 16.3938 | Information gain: 7.5000 | Grad Norm: 31.9623 | Time: 20.3s
Step 0890 | Epoch 01 | Objective: -8.7406 | Coherence: 2.6639 | Separation: 16.2406 | Information gain: 7.5000 | Grad Norm: 29.8152 | Time: 20.5s
Step 0900 | Epoch 01 | Objective: -8.5997 | Coherence: 2.6867 | Separation: 16.0997 | Information gain: 7.5000 | Grad Norm: 31.5164 | Time: 20.8s
Step 0910 | Epoch 01 | Objective: -8.4514 | Coherence: 2.7100 | Separation: 15.9514 | Information gain: 7.5000 | Grad Norm: 28.8003 | Time: 21.0s
Step 0920 | Epoch 01 | Objective: -8.3437 | Coherence: 2.7189 | Separation: 15.8437 | Information gain: 7.5000 | Grad Norm: 29.9666 | Time: 21.2s
Step 0930 | Epoch 01 | Objective: -8.2219 | Coherence: 2.7371 | Separation: 15.7219 | Information gain: 7.5000 | Grad Norm: 30.6174 | Time: 21.5s
Step 0940 | Epoch 01 | Objective: -8.1833 | Coherence: 2.7446 | Separation: 15.6833 | Information gain: 7.5000 | Grad Norm: 32.4746 | Time: 21.7s
Step 0950 | Epoch 01 | Objective: -8.1393 | Coherence: 2.7468 | Separation: 15.6393 | Information gain: 7.5000 | Grad Norm: 32.6287 | Time: 22.0s
Step 0960 | Epoch 01 | Objective: -8.0839 | Coherence: 2.7576 | Separation: 15.5839 | Information gain: 7.5000 | Grad Norm: 30.2931 | Time: 22.2s
Step 0970 | Epoch 01 | Objective: -8.0448 | Coherence: 2.7637 | Separation: 15.5448 | Information gain: 7.5000 | Grad Norm: 29.8242 | Time: 22.4s
Step 0980 | Epoch 01 | Objective: -8.0061 | Coherence: 2.7750 | Separation: 15.5061 | Information gain: 7.5000 | Grad Norm: 30.7554 | Time: 22.6s
Step 0990 | Epoch 01 | Objective: -7.9578 | Coherence: 2.7794 | Separation: 15.4578 | Information gain: 7.5000 | Grad Norm: 30.0264 | Time: 22.9s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.594614  0.523789 -0.497394  ...  0.536847 -0.469463 -0.540324
1 -0.524858  0.597183 -0.441896  ...  0.421670 -0.500588 -0.560820
2 -0.497197  0.427196 -0.619007  ...  0.449814 -0.352105 -0.487573
3 -0.454875  0.388922 -0.326346  ...  0.497243 -0.492752 -0.419231
4 -0.555861  0.554673 -0.449347  ...  0.503688 -0.532632 -0.573028

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7960
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8922
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8742
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.4003, accuracy=0.1002
Testing SVM
  SVM Test Accuracy: 0.8603
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8338

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6749, Accuracy: 9564/12000 (80%)

Epoch 1 | Train Acc: 0.6577083333333333 | Test Acc: 0.797 | Time: 1.0277092456817627 sec

Test set: Average loss: 0.5512, Accuracy: 9819/12000 (82%)

Epoch 2 | Train Acc: 0.8286458333333333 | Test Acc: 0.81825 | Time: 1.0284836292266846 sec

Test set: Average loss: 0.4624, Accuracy: 10208/12000 (85%)

Epoch 3 | Train Acc: 0.857375 | Test Acc: 0.8506666666666667 | Time: 1.031273603439331 sec

Test set: Average loss: 0.4112, Accuracy: 10413/12000 (87%)

Epoch 4 | Train Acc: 0.8710833333333333 | Test Acc: 0.86775 | Time: 1.1921672821044922 sec

Test set: Average loss: 0.3781, Accuracy: 10542/12000 (88%)

Epoch 5 | Train Acc: 0.8789791666666666 | Test Acc: 0.8785 | Time: 1.2297868728637695 sec

Test set: Average loss: 0.3593, Accuracy: 10615/12000 (88%)

Epoch 6 | Train Acc: 0.8851041666666667 | Test Acc: 0.8845833333333334 | Time: 1.1029682159423828 sec

Test set: Average loss: 0.3480, Accuracy: 10659/12000 (89%)

Epoch 7 | Train Acc: 0.8893333333333333 | Test Acc: 0.88825 | Time: 1.0256462097167969 sec

Test set: Average loss: 0.3414, Accuracy: 10679/12000 (89%)

Epoch 8 | Train Acc: 0.8919166666666667 | Test Acc: 0.8899166666666667 | Time: 1.030259132385254 sec

Test set: Average loss: 0.3370, Accuracy: 10707/12000 (89%)

Epoch 9 | Train Acc: 0.8934791666666667 | Test Acc: 0.89225 | Time: 1.029000997543335 sec

Test set: Average loss: 0.3340, Accuracy: 10717/12000 (89%)

Epoch 10 | Train Acc: 0.8946875 | Test Acc: 0.8930833333333333 | Time: 1.1466000080108643 sec

Test set: Average loss: 0.3319, Accuracy: 10736/12000 (89%)

Epoch 11 | Train Acc: 0.8959791666666667 | Test Acc: 0.8946666666666667 | Time: 1.0402402877807617 sec

Test set: Average loss: 0.3305, Accuracy: 10738/12000 (89%)

Epoch 12 | Train Acc: 0.8966875 | Test Acc: 0.8948333333333334 | Time: 1.02174973487854 sec

Test set: Average loss: 0.3294, Accuracy: 10742/12000 (90%)

Epoch 13 | Train Acc: 0.8969166666666667 | Test Acc: 0.8951666666666667 | Time: 1.0259106159210205 sec

Test set: Average loss: 0.3287, Accuracy: 10747/12000 (90%)

Epoch 14 | Train Acc: 0.8970208333333334 | Test Acc: 0.8955833333333333 | Time: 1.0375266075134277 sec

Test set: Average loss: 0.3283, Accuracy: 10745/12000 (90%)

Epoch 15 | Train Acc: 0.8969791666666667 | Test Acc: 0.8954166666666666 | Time: 1.0244190692901611 sec

Test set: Average loss: 0.3279, Accuracy: 10744/12000 (90%)

Epoch 16 | Train Acc: 0.8974375 | Test Acc: 0.8953333333333333 | Time: 1.0245461463928223 sec

Test set: Average loss: 0.3277, Accuracy: 10742/12000 (90%)

Epoch 17 | Train Acc: 0.8975208333333333 | Test Acc: 0.8951666666666667 | Time: 1.1105387210845947 sec

Test set: Average loss: 0.3276, Accuracy: 10743/12000 (90%)

Epoch 18 | Train Acc: 0.8977708333333333 | Test Acc: 0.89525 | Time: 1.1092641353607178 sec

Test set: Average loss: 0.3275, Accuracy: 10742/12000 (90%)

Epoch 19 | Train Acc: 0.8977916666666667 | Test Acc: 0.8951666666666667 | Time: 1.1909606456756592 sec
Early stopping at epoch 19

Testing with M=15
Step 0000 | Epoch 01 | Objective: 2.0329 | Coherence: 6.0986 | Separation: 57.1300 | Information gain: 7.0000 | Grad Norm: 7.3679 | Time: 0.0s
Step 0001 | Epoch 01 | Objective: 2.1134 | Coherence: 6.3402 | Separation: 57.1425 | Information gain: 7.0000 | Grad Norm: 7.3650 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.583802 -0.561838  0.427850  ...  0.542525  0.445200 -0.497393
1  0.567497 -0.573734  0.456992  ...  0.536618  0.453387 -0.497675
2  0.435492 -0.473517  0.607930  ...  0.418477  0.462398 -0.450545
3  0.548474 -0.515609  0.364071  ...  0.524495  0.409041 -0.441247
4  0.407439 -0.435542  0.498434  ...  0.449098  0.500930 -0.430875

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7953
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8937
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8716
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.5844, accuracy=0.0982
Testing SVM
  SVM Test Accuracy: 0.8596
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8352

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6980, Accuracy: 9537/12000 (79%)

Epoch 1 | Train Acc: 0.6475833333333333 | Test Acc: 0.79475 | Time: 1.0857911109924316 sec

Test set: Average loss: 0.5386, Accuracy: 9955/12000 (83%)

Epoch 2 | Train Acc: 0.8167916666666667 | Test Acc: 0.8295833333333333 | Time: 1.0266201496124268 sec

Test set: Average loss: 0.4693, Accuracy: 10188/12000 (85%)

Epoch 3 | Train Acc: 0.8465208333333333 | Test Acc: 0.849 | Time: 1.0284883975982666 sec

Test set: Average loss: 0.4220, Accuracy: 10409/12000 (87%)

Epoch 4 | Train Acc: 0.8627291666666667 | Test Acc: 0.8674166666666666 | Time: 1.0360667705535889 sec

Test set: Average loss: 0.3911, Accuracy: 10534/12000 (88%)

Epoch 5 | Train Acc: 0.8733125 | Test Acc: 0.8778333333333334 | Time: 1.0322561264038086 sec

Test set: Average loss: 0.3691, Accuracy: 10600/12000 (88%)

Epoch 6 | Train Acc: 0.880125 | Test Acc: 0.8833333333333333 | Time: 1.0425689220428467 sec

Test set: Average loss: 0.3559, Accuracy: 10650/12000 (89%)

Epoch 7 | Train Acc: 0.8851458333333333 | Test Acc: 0.8875 | Time: 1.0230813026428223 sec

Test set: Average loss: 0.3467, Accuracy: 10685/12000 (89%)

Epoch 8 | Train Acc: 0.8878125 | Test Acc: 0.8904166666666666 | Time: 1.1296789646148682 sec

Test set: Average loss: 0.3409, Accuracy: 10698/12000 (89%)

Epoch 9 | Train Acc: 0.8901458333333333 | Test Acc: 0.8915 | Time: 1.027787446975708 sec

Test set: Average loss: 0.3373, Accuracy: 10715/12000 (89%)

Epoch 10 | Train Acc: 0.8915416666666667 | Test Acc: 0.8929166666666667 | Time: 1.0271108150482178 sec

Test set: Average loss: 0.3350, Accuracy: 10720/12000 (89%)

Epoch 11 | Train Acc: 0.892625 | Test Acc: 0.8933333333333333 | Time: 1.024162769317627 sec

Test set: Average loss: 0.3334, Accuracy: 10733/12000 (89%)

Epoch 12 | Train Acc: 0.8935416666666667 | Test Acc: 0.8944166666666666 | Time: 1.0362775325775146 sec

Test set: Average loss: 0.3323, Accuracy: 10734/12000 (89%)

Epoch 13 | Train Acc: 0.8942708333333333 | Test Acc: 0.8945 | Time: 1.0272173881530762 sec

Test set: Average loss: 0.3315, Accuracy: 10740/12000 (90%)

Epoch 14 | Train Acc: 0.8945833333333333 | Test Acc: 0.895 | Time: 1.0289463996887207 sec

Test set: Average loss: 0.3310, Accuracy: 10746/12000 (90%)

Epoch 15 | Train Acc: 0.8945 | Test Acc: 0.8955 | Time: 1.091806411743164 sec

Test set: Average loss: 0.3307, Accuracy: 10743/12000 (90%)

Epoch 16 | Train Acc: 0.894625 | Test Acc: 0.89525 | Time: 1.0325613021850586 sec

Test set: Average loss: 0.3305, Accuracy: 10748/12000 (90%)

Epoch 17 | Train Acc: 0.8948958333333333 | Test Acc: 0.8956666666666667 | Time: 1.1680781841278076 sec

Test set: Average loss: 0.3303, Accuracy: 10748/12000 (90%)

Epoch 18 | Train Acc: 0.895125 | Test Acc: 0.8956666666666667 | Time: 1.0415656566619873 sec

Test set: Average loss: 0.3302, Accuracy: 10747/12000 (90%)

Epoch 19 | Train Acc: 0.8950625 | Test Acc: 0.8955833333333333 | Time: 1.0310089588165283 sec

Test set: Average loss: 0.3301, Accuracy: 10746/12000 (90%)

Epoch 20 | Train Acc: 0.8951666666666667 | Test Acc: 0.8955 | Time: 1.0283927917480469 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: 8.9208 | Coherence: 19.9292 | Separation: 55.2328 | Information gain: 6.8333 | Grad Norm: 7.3828 | Time: 0.1s
Step 0001 | Epoch 01 | Objective: 9.0014 | Coherence: 20.1708 | Separation: 55.2323 | Information gain: 6.8333 | Grad Norm: 7.3828 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.605092  0.557097  0.520605  ... -0.469607  0.536537  0.489747
1  0.581499  0.635623  0.518438  ... -0.487069  0.501187  0.498381
2  0.452144  0.433425  0.518931  ... -0.367077  0.455084  0.467792
3  0.447703  0.411119  0.437715  ... -0.290564  0.493245  0.504745
4  0.478891  0.540124  0.496824  ... -0.407649  0.488527  0.475138

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8044
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9023
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8831
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0727, accuracy=0.0882
Testing SVM
  SVM Test Accuracy: 0.8623
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8360

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6701, Accuracy: 9578/12000 (80%)

Epoch 1 | Train Acc: 0.6683958333333333 | Test Acc: 0.7981666666666667 | Time: 1.0303993225097656 sec

Test set: Average loss: 0.4873, Accuracy: 10192/12000 (85%)

Epoch 2 | Train Acc: 0.8299166666666666 | Test Acc: 0.8493333333333334 | Time: 1.0176122188568115 sec

Test set: Average loss: 0.4166, Accuracy: 10462/12000 (87%)

Epoch 3 | Train Acc: 0.8588958333333333 | Test Acc: 0.8718333333333333 | Time: 1.0223939418792725 sec

Test set: Average loss: 0.3798, Accuracy: 10599/12000 (88%)

Epoch 4 | Train Acc: 0.8739791666666666 | Test Acc: 0.88325 | Time: 1.2793300151824951 sec

Test set: Average loss: 0.3568, Accuracy: 10659/12000 (89%)

Epoch 5 | Train Acc: 0.8842083333333334 | Test Acc: 0.88825 | Time: 1.0701496601104736 sec

Test set: Average loss: 0.3406, Accuracy: 10717/12000 (89%)

Epoch 6 | Train Acc: 0.8909166666666667 | Test Acc: 0.8930833333333333 | Time: 1.0256555080413818 sec

Test set: Average loss: 0.3310, Accuracy: 10756/12000 (90%)

Epoch 7 | Train Acc: 0.896 | Test Acc: 0.8963333333333333 | Time: 1.019195318222046 sec

Test set: Average loss: 0.3256, Accuracy: 10773/12000 (90%)

Epoch 8 | Train Acc: 0.8988333333333334 | Test Acc: 0.89775 | Time: 1.0192298889160156 sec

Test set: Average loss: 0.3218, Accuracy: 10792/12000 (90%)

Epoch 9 | Train Acc: 0.901 | Test Acc: 0.8993333333333333 | Time: 1.0244903564453125 sec

Test set: Average loss: 0.3190, Accuracy: 10797/12000 (90%)

Epoch 10 | Train Acc: 0.9023958333333333 | Test Acc: 0.89975 | Time: 1.0230355262756348 sec

Test set: Average loss: 0.3168, Accuracy: 10814/12000 (90%)

Epoch 11 | Train Acc: 0.9033125 | Test Acc: 0.9011666666666667 | Time: 1.0229926109313965 sec

Test set: Average loss: 0.3152, Accuracy: 10820/12000 (90%)

Epoch 12 | Train Acc: 0.9041666666666667 | Test Acc: 0.9016666666666666 | Time: 1.027937889099121 sec

Test set: Average loss: 0.3141, Accuracy: 10821/12000 (90%)

Epoch 13 | Train Acc: 0.9045625 | Test Acc: 0.90175 | Time: 1.1196274757385254 sec

Test set: Average loss: 0.3133, Accuracy: 10834/12000 (90%)

Epoch 14 | Train Acc: 0.9050416666666666 | Test Acc: 0.9028333333333334 | Time: 1.0270063877105713 sec

Test set: Average loss: 0.3128, Accuracy: 10836/12000 (90%)

Epoch 15 | Train Acc: 0.9054791666666666 | Test Acc: 0.903 | Time: 1.037243127822876 sec

Test set: Average loss: 0.3125, Accuracy: 10841/12000 (90%)

Epoch 16 | Train Acc: 0.9056458333333334 | Test Acc: 0.9034166666666666 | Time: 1.019172191619873 sec

Test set: Average loss: 0.3122, Accuracy: 10839/12000 (90%)

Epoch 17 | Train Acc: 0.9056458333333334 | Test Acc: 0.90325 | Time: 1.0241949558258057 sec

Test set: Average loss: 0.3120, Accuracy: 10842/12000 (90%)

Epoch 18 | Train Acc: 0.9058541666666666 | Test Acc: 0.9035 | Time: 1.0387465953826904 sec

Test set: Average loss: 0.3119, Accuracy: 10844/12000 (90%)

Epoch 19 | Train Acc: 0.9058958333333333 | Test Acc: 0.9036666666666666 | Time: 1.0276663303375244 sec

Test set: Average loss: 0.3118, Accuracy: 10846/12000 (90%)

Epoch 20 | Train Acc: 0.905875 | Test Acc: 0.9038333333333334 | Time: 1.0200366973876953 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: 7.7820 | Coherence: 7.6794 | Separation: 50.9993 | Information gain: 7.8333 | Grad Norm: 7.4663 | Time: 0.0s
Step 0001 | Epoch 01 | Objective: 7.8566 | Coherence: 7.9030 | Separation: 50.9895 | Information gain: 7.8333 | Grad Norm: 7.4663 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.643141  0.485270  0.459670  ...  0.605570 -0.559628 -0.607020
1  0.427029  0.546005  0.413181  ...  0.463723 -0.498057 -0.451587
2  0.437212  0.439154  0.583618  ...  0.433550 -0.427218 -0.393338
3  0.458195  0.458033  0.318916  ...  0.474203 -0.472400 -0.519468
4  0.515915  0.448904  0.409675  ...  0.454372 -0.522967 -0.485848

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7938
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8941
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8796
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0555, accuracy=0.1002
Testing SVM
  SVM Test Accuracy: 0.8513
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8273

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6831, Accuracy: 9462/12000 (79%)

Epoch 1 | Train Acc: 0.6714166666666667 | Test Acc: 0.7885 | Time: 1.0900979042053223 sec

Test set: Average loss: 0.5511, Accuracy: 9862/12000 (82%)

Epoch 2 | Train Acc: 0.8207708333333333 | Test Acc: 0.8218333333333333 | Time: 1.0317919254302979 sec

Test set: Average loss: 0.4615, Accuracy: 10180/12000 (85%)

Epoch 3 | Train Acc: 0.845875 | Test Acc: 0.8483333333333334 | Time: 1.0306854248046875 sec

Test set: Average loss: 0.4213, Accuracy: 10329/12000 (86%)

Epoch 4 | Train Acc: 0.859625 | Test Acc: 0.86075 | Time: 1.0244908332824707 sec

Test set: Average loss: 0.3993, Accuracy: 10406/12000 (87%)

Epoch 5 | Train Acc: 0.869125 | Test Acc: 0.8671666666666666 | Time: 1.0202977657318115 sec

Test set: Average loss: 0.3847, Accuracy: 10464/12000 (87%)

Epoch 6 | Train Acc: 0.8744375 | Test Acc: 0.872 | Time: 1.0214431285858154 sec

Test set: Average loss: 0.3752, Accuracy: 10507/12000 (88%)

Epoch 7 | Train Acc: 0.8789791666666666 | Test Acc: 0.8755833333333334 | Time: 1.0275609493255615 sec

Test set: Average loss: 0.3687, Accuracy: 10545/12000 (88%)

Epoch 8 | Train Acc: 0.8823125 | Test Acc: 0.87875 | Time: 1.0270001888275146 sec

Test set: Average loss: 0.3643, Accuracy: 10572/12000 (88%)

Epoch 9 | Train Acc: 0.88475 | Test Acc: 0.881 | Time: 1.0196788311004639 sec

Test set: Average loss: 0.3613, Accuracy: 10597/12000 (88%)

Epoch 10 | Train Acc: 0.8861875 | Test Acc: 0.8830833333333333 | Time: 1.0167372226715088 sec

Test set: Average loss: 0.3593, Accuracy: 10604/12000 (88%)

Epoch 11 | Train Acc: 0.8872916666666667 | Test Acc: 0.8836666666666667 | Time: 1.2007639408111572 sec

Test set: Average loss: 0.3580, Accuracy: 10604/12000 (88%)

Epoch 12 | Train Acc: 0.8880208333333334 | Test Acc: 0.8836666666666667 | Time: 1.019284963607788 sec

Test set: Average loss: 0.3572, Accuracy: 10608/12000 (88%)

Epoch 13 | Train Acc: 0.8886666666666667 | Test Acc: 0.884 | Time: 1.0227105617523193 sec

Test set: Average loss: 0.3566, Accuracy: 10610/12000 (88%)

Epoch 14 | Train Acc: 0.8889166666666667 | Test Acc: 0.8841666666666667 | Time: 1.1302764415740967 sec

Test set: Average loss: 0.3562, Accuracy: 10617/12000 (88%)

Epoch 15 | Train Acc: 0.8893333333333333 | Test Acc: 0.88475 | Time: 1.042182445526123 sec

Test set: Average loss: 0.3559, Accuracy: 10620/12000 (88%)

Epoch 16 | Train Acc: 0.8897916666666666 | Test Acc: 0.885 | Time: 1.023707628250122 sec

Test set: Average loss: 0.3557, Accuracy: 10618/12000 (88%)

Epoch 17 | Train Acc: 0.8898541666666666 | Test Acc: 0.8848333333333334 | Time: 1.0252985954284668 sec

Test set: Average loss: 0.3555, Accuracy: 10618/12000 (88%)

Epoch 18 | Train Acc: 0.8899375 | Test Acc: 0.8848333333333334 | Time: 1.0583631992340088 sec

Test set: Average loss: 0.3554, Accuracy: 10621/12000 (89%)

Epoch 19 | Train Acc: 0.8898333333333334 | Test Acc: 0.8850833333333333 | Time: 1.0223257541656494 sec

Test set: Average loss: 0.3553, Accuracy: 10621/12000 (89%)

Epoch 20 | Train Acc: 0.889875 | Test Acc: 0.8850833333333333 | Time: 1.1275105476379395 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: 12.8317 | Coherence: 14.9950 | Separation: 56.8346 | Information gain: 7.8333 | Grad Norm: 7.4037 | Time: 0.1s
Step 0001 | Epoch 01 | Objective: 12.9111 | Coherence: 15.2332 | Separation: 56.7995 | Information gain: 7.8333 | Grad Norm: 7.4037 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.559936 -0.471464  0.476021  ...  0.437981  0.530637  0.519200
1 -0.499844 -0.597564  0.543925  ...  0.567937  0.497088  0.492633
2 -0.496747 -0.533409  0.586633  ...  0.522146  0.495788  0.448466
3 -0.467281 -0.524614  0.459979  ...  0.492155  0.447827  0.469897
4 -0.487561 -0.558480  0.534318  ...  0.497231  0.515933  0.484790

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7948
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8954
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8752
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.2433, accuracy=0.0779
Testing SVM
  SVM Test Accuracy: 0.8628
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8318

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6818, Accuracy: 9371/12000 (78%)

Epoch 1 | Train Acc: 0.6717083333333334 | Test Acc: 0.7809166666666667 | Time: 1.2924649715423584 sec

Test set: Average loss: 0.5298, Accuracy: 9871/12000 (82%)

Epoch 2 | Train Acc: 0.8216666666666667 | Test Acc: 0.8225833333333333 | Time: 1.2136225700378418 sec

Test set: Average loss: 0.4297, Accuracy: 10323/12000 (86%)

Epoch 3 | Train Acc: 0.8547291666666667 | Test Acc: 0.86025 | Time: 1.0310947895050049 sec

Test set: Average loss: 0.3883, Accuracy: 10482/12000 (87%)

Epoch 4 | Train Acc: 0.872 | Test Acc: 0.8735 | Time: 1.392469882965088 sec

Test set: Average loss: 0.3619, Accuracy: 10589/12000 (88%)

Epoch 5 | Train Acc: 0.8819791666666666 | Test Acc: 0.8824166666666666 | Time: 1.2054665088653564 sec

Test set: Average loss: 0.3461, Accuracy: 10666/12000 (89%)

Epoch 6 | Train Acc: 0.8895208333333333 | Test Acc: 0.8888333333333334 | Time: 1.0209541320800781 sec

Test set: Average loss: 0.3324, Accuracy: 10720/12000 (89%)

Epoch 7 | Train Acc: 0.8945 | Test Acc: 0.8933333333333333 | Time: 1.3355967998504639 sec

Test set: Average loss: 0.3249, Accuracy: 10746/12000 (90%)

Epoch 8 | Train Acc: 0.8975416666666667 | Test Acc: 0.8955 | Time: 1.2871298789978027 sec

Test set: Average loss: 0.3196, Accuracy: 10773/12000 (90%)

Epoch 9 | Train Acc: 0.8995208333333333 | Test Acc: 0.89775 | Time: 1.452866554260254 sec

Test set: Average loss: 0.3160, Accuracy: 10785/12000 (90%)

Epoch 10 | Train Acc: 0.9011041666666667 | Test Acc: 0.89875 | Time: 1.2928168773651123 sec

Test set: Average loss: 0.3137, Accuracy: 10790/12000 (90%)

Epoch 11 | Train Acc: 0.9025 | Test Acc: 0.8991666666666667 | Time: 1.0244300365447998 sec

Test set: Average loss: 0.3121, Accuracy: 10796/12000 (90%)

Epoch 12 | Train Acc: 0.903125 | Test Acc: 0.8996666666666666 | Time: 1.0183265209197998 sec

Test set: Average loss: 0.3111, Accuracy: 10797/12000 (90%)

Epoch 13 | Train Acc: 0.9038125 | Test Acc: 0.89975 | Time: 1.0227999687194824 sec

Test set: Average loss: 0.3103, Accuracy: 10804/12000 (90%)

Epoch 14 | Train Acc: 0.9041041666666667 | Test Acc: 0.9003333333333333 | Time: 1.0459346771240234 sec

Test set: Average loss: 0.3098, Accuracy: 10803/12000 (90%)

Epoch 15 | Train Acc: 0.9045625 | Test Acc: 0.90025 | Time: 1.3535809516906738 sec

Test set: Average loss: 0.3095, Accuracy: 10804/12000 (90%)

Epoch 16 | Train Acc: 0.9047708333333333 | Test Acc: 0.9003333333333333 | Time: 1.472320318222046 sec

Test set: Average loss: 0.3092, Accuracy: 10805/12000 (90%)

Epoch 17 | Train Acc: 0.9047708333333333 | Test Acc: 0.9004166666666666 | Time: 1.03594970703125 sec

Test set: Average loss: 0.3091, Accuracy: 10810/12000 (90%)

Epoch 18 | Train Acc: 0.9050208333333334 | Test Acc: 0.9008333333333334 | Time: 1.5231680870056152 sec

Test set: Average loss: 0.3089, Accuracy: 10811/12000 (90%)

Epoch 19 | Train Acc: 0.9050625 | Test Acc: 0.9009166666666667 | Time: 1.1726527214050293 sec

Test set: Average loss: 0.3089, Accuracy: 10812/12000 (90%)

Epoch 20 | Train Acc: 0.9050833333333334 | Test Acc: 0.901 | Time: 1.0427522659301758 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -9.5723 | Coherence: 23.7334 | Separation: 52.4503 | Information gain: 6.8333 | Grad Norm: 13.9207 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: -8.6513 | Coherence: 24.9063 | Separation: 50.8601 | Information gain: 6.8333 | Grad Norm: 13.2829 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -7.8220 | Coherence: 26.0776 | Separation: 49.5435 | Information gain: 6.6667 | Grad Norm: 12.3907 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: -7.0022 | Coherence: 27.2379 | Separation: 48.2444 | Information gain: 6.6667 | Grad Norm: 12.3312 | Time: 0.9s
Step 0040 | Epoch 01 | Objective: -6.2016 | Coherence: 28.4061 | Separation: 47.0109 | Information gain: 6.6667 | Grad Norm: 11.9410 | Time: 1.1s
Step 0050 | Epoch 01 | Objective: -5.4198 | Coherence: 29.5442 | Separation: 45.8037 | Information gain: 6.6667 | Grad Norm: 11.7298 | Time: 1.4s
Step 0060 | Epoch 01 | Objective: -4.6707 | Coherence: 30.6244 | Separation: 44.6363 | Information gain: 6.8333 | Grad Norm: 11.9665 | Time: 1.7s
Step 0070 | Epoch 01 | Objective: -3.9452 | Coherence: 31.6544 | Separation: 43.4900 | Information gain: 6.8333 | Grad Norm: 11.4395 | Time: 1.9s
Step 0080 | Epoch 01 | Objective: -3.2838 | Coherence: 32.7060 | Separation: 42.5574 | Information gain: 6.8333 | Grad Norm: 10.4043 | Time: 2.2s
Step 0090 | Epoch 01 | Objective: -2.6753 | Coherence: 33.6500 | Separation: 41.6758 | Information gain: 7.0000 | Grad Norm: 10.2106 | Time: 2.5s
Step 0100 | Epoch 01 | Objective: -2.0725 | Coherence: 34.5447 | Separation: 40.7623 | Information gain: 7.0000 | Grad Norm: 10.1893 | Time: 2.8s
Step 0110 | Epoch 01 | Objective: -1.5123 | Coherence: 35.4047 | Separation: 39.9415 | Information gain: 7.0000 | Grad Norm: 9.7332 | Time: 3.1s
Step 0120 | Epoch 01 | Objective: -0.9890 | Coherence: 36.2047 | Separation: 39.1718 | Information gain: 7.1667 | Grad Norm: 9.2440 | Time: 3.4s
Step 0130 | Epoch 01 | Objective: -0.4937 | Coherence: 36.9595 | Separation: 38.4407 | Information gain: 7.1667 | Grad Norm: 9.7407 | Time: 3.7s
Step 0140 | Epoch 01 | Objective: -0.0173 | Coherence: 37.6988 | Separation: 37.7507 | Information gain: 7.1667 | Grad Norm: 9.3000 | Time: 3.9s
Step 0150 | Epoch 01 | Objective: 0.4188 | Coherence: 38.3618 | Separation: 37.1053 | Information gain: 7.1667 | Grad Norm: 9.0104 | Time: 4.2s
Step 0160 | Epoch 01 | Objective: 0.8448 | Coherence: 38.9582 | Separation: 36.4237 | Information gain: 7.3333 | Grad Norm: 8.7407 | Time: 4.4s
Step 0162 | Epoch 01 | Objective: 0.9313 | Coherence: 39.0718 | Separation: 36.2778 | Information gain: 7.3333 | Grad Norm: 9.4532 | Time: 4.4s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.558028  0.469556  0.363035  ...  0.354139  0.436074 -0.522385
1  0.481435  0.590092  0.415213  ...  0.400519  0.400401 -0.512020
2  0.358907  0.401847  0.589638  ...  0.575565  0.423952 -0.451346
3  0.448265  0.456629  0.566479  ...  0.549777  0.517321 -0.552607
4  0.454874  0.470433  0.524319  ...  0.537102  0.561712 -0.537624

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8065
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9052
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8882
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.1967, accuracy=0.0894
Testing SVM
  SVM Test Accuracy: 0.8684
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8497

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7104, Accuracy: 9333/12000 (78%)

Epoch 1 | Train Acc: 0.6492083333333334 | Test Acc: 0.77775 | Time: 1.3350448608398438 sec

Test set: Average loss: 0.5142, Accuracy: 10037/12000 (84%)

Epoch 2 | Train Acc: 0.8303541666666666 | Test Acc: 0.8364166666666667 | Time: 1.316248893737793 sec

Test set: Average loss: 0.4396, Accuracy: 10311/12000 (86%)

Epoch 3 | Train Acc: 0.8573333333333333 | Test Acc: 0.85925 | Time: 1.024038314819336 sec

Test set: Average loss: 0.3952, Accuracy: 10491/12000 (87%)

Epoch 4 | Train Acc: 0.8718125 | Test Acc: 0.87425 | Time: 1.0262420177459717 sec

Test set: Average loss: 0.3712, Accuracy: 10581/12000 (88%)

Epoch 5 | Train Acc: 0.8809791666666666 | Test Acc: 0.88175 | Time: 1.0273542404174805 sec

Test set: Average loss: 0.3538, Accuracy: 10646/12000 (89%)

Epoch 6 | Train Acc: 0.8870208333333334 | Test Acc: 0.8871666666666667 | Time: 1.0741901397705078 sec

Test set: Average loss: 0.3404, Accuracy: 10714/12000 (89%)

Epoch 7 | Train Acc: 0.8917083333333333 | Test Acc: 0.8928333333333334 | Time: 1.1353142261505127 sec

Test set: Average loss: 0.3315, Accuracy: 10746/12000 (90%)

Epoch 8 | Train Acc: 0.8952291666666666 | Test Acc: 0.8955 | Time: 1.0252447128295898 sec

Test set: Average loss: 0.3268, Accuracy: 10762/12000 (90%)

Epoch 9 | Train Acc: 0.8976458333333334 | Test Acc: 0.8968333333333334 | Time: 1.029231309890747 sec

Test set: Average loss: 0.3240, Accuracy: 10775/12000 (90%)

Epoch 10 | Train Acc: 0.8992916666666667 | Test Acc: 0.8979166666666667 | Time: 1.0321438312530518 sec

Test set: Average loss: 0.3222, Accuracy: 10777/12000 (90%)

Epoch 11 | Train Acc: 0.9000416666666666 | Test Acc: 0.8980833333333333 | Time: 1.344433307647705 sec

Test set: Average loss: 0.3209, Accuracy: 10779/12000 (90%)

Epoch 12 | Train Acc: 0.9005416666666667 | Test Acc: 0.89825 | Time: 1.208064079284668 sec

Test set: Average loss: 0.3200, Accuracy: 10780/12000 (90%)

Epoch 13 | Train Acc: 0.9008333333333334 | Test Acc: 0.8983333333333333 | Time: 1.045860767364502 sec

Test set: Average loss: 0.3194, Accuracy: 10788/12000 (90%)

Epoch 14 | Train Acc: 0.9011666666666667 | Test Acc: 0.899 | Time: 1.2922344207763672 sec

Test set: Average loss: 0.3189, Accuracy: 10790/12000 (90%)

Epoch 15 | Train Acc: 0.9014583333333334 | Test Acc: 0.8991666666666667 | Time: 1.0255918502807617 sec

Test set: Average loss: 0.3186, Accuracy: 10789/12000 (90%)

Epoch 16 | Train Acc: 0.9016875 | Test Acc: 0.8990833333333333 | Time: 1.1686513423919678 sec

Test set: Average loss: 0.3184, Accuracy: 10790/12000 (90%)

Epoch 17 | Train Acc: 0.901875 | Test Acc: 0.8991666666666667 | Time: 1.2424256801605225 sec

Test set: Average loss: 0.3182, Accuracy: 10787/12000 (90%)

Epoch 18 | Train Acc: 0.9019791666666667 | Test Acc: 0.8989166666666667 | Time: 1.3966469764709473 sec

Test set: Average loss: 0.3181, Accuracy: 10787/12000 (90%)

Epoch 19 | Train Acc: 0.9021041666666667 | Test Acc: 0.8989166666666667 | Time: 1.1564383506774902 sec

Test set: Average loss: 0.3180, Accuracy: 10788/12000 (90%)

Epoch 20 | Train Acc: 0.9023125 | Test Acc: 0.899 | Time: 1.1271517276763916 sec
Early stopping at epoch 20

Testing with M=15
Step 0000 | Epoch 01 | Objective: -6.5646 | Coherence: 24.9390 | Separation: 52.1329 | Information gain: 7.5000 | Grad Norm: 14.5876 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -5.5245 | Coherence: 26.1203 | Separation: 50.1940 | Information gain: 7.5000 | Grad Norm: 13.5461 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -4.5516 | Coherence: 27.2999 | Separation: 48.4548 | Information gain: 7.5000 | Grad Norm: 13.3481 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -3.5859 | Coherence: 28.5027 | Separation: 46.7603 | Information gain: 7.5000 | Grad Norm: 12.9560 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -2.5339 | Coherence: 29.6463 | Separation: 45.0813 | Information gain: 7.8333 | Grad Norm: 12.3580 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -1.6485 | Coherence: 30.7590 | Separation: 43.5377 | Information gain: 7.8333 | Grad Norm: 12.1647 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -0.8622 | Coherence: 31.8374 | Separation: 42.2573 | Information gain: 7.8333 | Grad Norm: 10.9045 | Time: 1.5s
Step 0070 | Epoch 01 | Objective: -0.1444 | Coherence: 32.8624 | Separation: 41.1289 | Information gain: 7.8333 | Grad Norm: 10.3755 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: 0.5530 | Coherence: 33.8721 | Separation: 40.0463 | Information gain: 7.8333 | Grad Norm: 10.5460 | Time: 1.9s
Step 0085 | Epoch 01 | Objective: 0.9014 | Coherence: 34.3573 | Separation: 39.4865 | Information gain: 7.8333 | Grad Norm: 10.0886 | Time: 2.0s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.619560  0.465697  0.482015  ...  0.402020 -0.516765  0.476974
1  0.449458  0.608657  0.479252  ...  0.429147 -0.544882  0.485621
2  0.469358  0.507276  0.646223  ...  0.505714 -0.610008  0.638747
3  0.454908  0.524824  0.551047  ...  0.432476 -0.587761  0.539183
4  0.498276  0.539187  0.511841  ...  0.500841 -0.528203  0.511323

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7987
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8919
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8726
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.9526, accuracy=0.0929
Testing SVM
  SVM Test Accuracy: 0.8514
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8212

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6577, Accuracy: 9608/12000 (80%)

Epoch 1 | Train Acc: 0.67525 | Test Acc: 0.8006666666666666 | Time: 1.0347535610198975 sec

Test set: Average loss: 0.5241, Accuracy: 10005/12000 (83%)

Epoch 2 | Train Acc: 0.8175208333333334 | Test Acc: 0.83375 | Time: 1.0692479610443115 sec

Test set: Average loss: 0.4637, Accuracy: 10180/12000 (85%)

Epoch 3 | Train Acc: 0.8453958333333333 | Test Acc: 0.8483333333333334 | Time: 1.0189275741577148 sec

Test set: Average loss: 0.4284, Accuracy: 10309/12000 (86%)

Epoch 4 | Train Acc: 0.8605 | Test Acc: 0.8590833333333333 | Time: 1.0207312107086182 sec

Test set: Average loss: 0.4059, Accuracy: 10383/12000 (87%)

Epoch 5 | Train Acc: 0.8700416666666667 | Test Acc: 0.86525 | Time: 1.0275421142578125 sec

Test set: Average loss: 0.3917, Accuracy: 10447/12000 (87%)

Epoch 6 | Train Acc: 0.8762916666666667 | Test Acc: 0.8705833333333334 | Time: 1.0314679145812988 sec

Test set: Average loss: 0.3806, Accuracy: 10473/12000 (87%)

Epoch 7 | Train Acc: 0.8806875 | Test Acc: 0.87275 | Time: 1.0504229068756104 sec

Test set: Average loss: 0.3722, Accuracy: 10527/12000 (88%)

Epoch 8 | Train Acc: 0.8838125 | Test Acc: 0.87725 | Time: 1.232069969177246 sec

Test set: Average loss: 0.3670, Accuracy: 10551/12000 (88%)

Epoch 9 | Train Acc: 0.88625 | Test Acc: 0.87925 | Time: 1.0218007564544678 sec

Test set: Average loss: 0.3633, Accuracy: 10575/12000 (88%)

Epoch 10 | Train Acc: 0.8878333333333334 | Test Acc: 0.88125 | Time: 1.0292260646820068 sec

Test set: Average loss: 0.3608, Accuracy: 10589/12000 (88%)

Epoch 11 | Train Acc: 0.8887916666666666 | Test Acc: 0.8824166666666666 | Time: 1.0284583568572998 sec

Test set: Average loss: 0.3589, Accuracy: 10597/12000 (88%)

Epoch 12 | Train Acc: 0.8896875 | Test Acc: 0.8830833333333333 | Time: 1.0305874347686768 sec

Test set: Average loss: 0.3576, Accuracy: 10606/12000 (88%)

Epoch 13 | Train Acc: 0.89025 | Test Acc: 0.8838333333333334 | Time: 1.238865852355957 sec

Test set: Average loss: 0.3567, Accuracy: 10606/12000 (88%)

Epoch 14 | Train Acc: 0.8905416666666667 | Test Acc: 0.8838333333333334 | Time: 1.1099190711975098 sec

Test set: Average loss: 0.3561, Accuracy: 10605/12000 (88%)

Epoch 15 | Train Acc: 0.8910416666666666 | Test Acc: 0.88375 | Time: 1.0263714790344238 sec

Test set: Average loss: 0.3556, Accuracy: 10607/12000 (88%)

Epoch 16 | Train Acc: 0.8912291666666666 | Test Acc: 0.8839166666666667 | Time: 1.0272703170776367 sec

Test set: Average loss: 0.3553, Accuracy: 10608/12000 (88%)

Epoch 17 | Train Acc: 0.8914375 | Test Acc: 0.884 | Time: 1.129819393157959 sec

Test set: Average loss: 0.3550, Accuracy: 10611/12000 (88%)

Epoch 18 | Train Acc: 0.8916666666666667 | Test Acc: 0.88425 | Time: 1.0685522556304932 sec

Test set: Average loss: 0.3548, Accuracy: 10614/12000 (88%)

Epoch 19 | Train Acc: 0.8916458333333334 | Test Acc: 0.8845 | Time: 1.2399818897247314 sec

Test set: Average loss: 0.3547, Accuracy: 10613/12000 (88%)

Epoch 20 | Train Acc: 0.891625 | Test Acc: 0.8844166666666666 | Time: 1.030418872833252 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -6.7093 | Coherence: 17.8981 | Separation: 54.3592 | Information gain: 8.1667 | Grad Norm: 13.8793 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -5.7499 | Coherence: 18.8238 | Separation: 52.7400 | Information gain: 8.3333 | Grad Norm: 13.8462 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -4.8837 | Coherence: 19.7877 | Separation: 51.1056 | Information gain: 8.3333 | Grad Norm: 13.8536 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -3.9936 | Coherence: 20.7819 | Separation: 49.4294 | Information gain: 8.3333 | Grad Norm: 13.8989 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -3.2252 | Coherence: 21.7983 | Separation: 47.8073 | Information gain: 8.1667 | Grad Norm: 13.2127 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -2.3844 | Coherence: 22.7090 | Separation: 46.1956 | Information gain: 8.1667 | Grad Norm: 12.9578 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -1.6695 | Coherence: 23.5566 | Separation: 44.5652 | Information gain: 8.0000 | Grad Norm: 12.6446 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -0.9086 | Coherence: 24.3491 | Separation: 43.0750 | Information gain: 8.0000 | Grad Norm: 11.5368 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -0.2062 | Coherence: 25.1163 | Separation: 41.7349 | Information gain: 8.0000 | Grad Norm: 11.8265 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: 0.4869 | Coherence: 25.9239 | Separation: 40.4631 | Information gain: 8.0000 | Grad Norm: 11.0414 | Time: 2.1s
Step 0097 | Epoch 01 | Objective: 0.9462 | Coherence: 26.5112 | Separation: 39.6727 | Information gain: 8.0000 | Grad Norm: 11.0623 | Time: 2.3s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.559099  0.512585  0.449605  ... -0.423437  0.423287  0.392778
1  0.572616  0.641827  0.531523  ... -0.417715  0.452255  0.386863
2  0.435852  0.457142  0.557127  ... -0.433524  0.487655  0.418859
3  0.494661  0.426805  0.443332  ... -0.495971  0.525016  0.520466
4  0.408151  0.394025  0.432871  ... -0.468292  0.435980  0.461257

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8051
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8979
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8792
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.3522, accuracy=0.0861
Testing SVM
  SVM Test Accuracy: 0.8621
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8399

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7320, Accuracy: 9362/12000 (78%)

Epoch 1 | Train Acc: 0.6626458333333334 | Test Acc: 0.7801666666666667 | Time: 1.0337872505187988 sec

Test set: Average loss: 0.5083, Accuracy: 10116/12000 (84%)

Epoch 2 | Train Acc: 0.822125 | Test Acc: 0.843 | Time: 1.0245521068572998 sec

Test set: Average loss: 0.4445, Accuracy: 10331/12000 (86%)

Epoch 3 | Train Acc: 0.8510625 | Test Acc: 0.8609166666666667 | Time: 1.0282535552978516 sec

Test set: Average loss: 0.4095, Accuracy: 10444/12000 (87%)

Epoch 4 | Train Acc: 0.8664583333333333 | Test Acc: 0.8703333333333333 | Time: 1.150388240814209 sec

Test set: Average loss: 0.3842, Accuracy: 10557/12000 (88%)

Epoch 5 | Train Acc: 0.8757083333333333 | Test Acc: 0.87975 | Time: 1.311640977859497 sec

Test set: Average loss: 0.3697, Accuracy: 10604/12000 (88%)

Epoch 6 | Train Acc: 0.8821458333333333 | Test Acc: 0.8836666666666667 | Time: 1.0931272506713867 sec

Test set: Average loss: 0.3602, Accuracy: 10633/12000 (89%)

Epoch 7 | Train Acc: 0.8861875 | Test Acc: 0.8860833333333333 | Time: 1.0259196758270264 sec

Test set: Average loss: 0.3542, Accuracy: 10641/12000 (89%)

Epoch 8 | Train Acc: 0.8893541666666667 | Test Acc: 0.88675 | Time: 1.0241496562957764 sec

Test set: Average loss: 0.3505, Accuracy: 10648/12000 (89%)

Epoch 9 | Train Acc: 0.8918125 | Test Acc: 0.8873333333333333 | Time: 1.024761438369751 sec

Test set: Average loss: 0.3478, Accuracy: 10658/12000 (89%)

Epoch 10 | Train Acc: 0.8929791666666667 | Test Acc: 0.8881666666666667 | Time: 1.0226988792419434 sec

Test set: Average loss: 0.3458, Accuracy: 10673/12000 (89%)

Epoch 11 | Train Acc: 0.8940208333333334 | Test Acc: 0.8894166666666666 | Time: 1.0267665386199951 sec

Test set: Average loss: 0.3444, Accuracy: 10677/12000 (89%)

Epoch 12 | Train Acc: 0.8950416666666666 | Test Acc: 0.88975 | Time: 1.195324182510376 sec

Test set: Average loss: 0.3434, Accuracy: 10677/12000 (89%)

Epoch 13 | Train Acc: 0.8955 | Test Acc: 0.88975 | Time: 1.3033292293548584 sec

Test set: Average loss: 0.3427, Accuracy: 10684/12000 (89%)

Epoch 14 | Train Acc: 0.89625 | Test Acc: 0.8903333333333333 | Time: 1.0525190830230713 sec

Test set: Average loss: 0.3423, Accuracy: 10684/12000 (89%)

Epoch 15 | Train Acc: 0.8966458333333334 | Test Acc: 0.8903333333333333 | Time: 1.0288903713226318 sec

Test set: Average loss: 0.3421, Accuracy: 10685/12000 (89%)

Epoch 16 | Train Acc: 0.8966458333333334 | Test Acc: 0.8904166666666666 | Time: 1.0288503170013428 sec

Test set: Average loss: 0.3419, Accuracy: 10683/12000 (89%)

Epoch 17 | Train Acc: 0.8967708333333333 | Test Acc: 0.89025 | Time: 1.0229778289794922 sec

Test set: Average loss: 0.3417, Accuracy: 10685/12000 (89%)

Epoch 18 | Train Acc: 0.8968125 | Test Acc: 0.8904166666666666 | Time: 1.028191328048706 sec

Test set: Average loss: 0.3416, Accuracy: 10685/12000 (89%)

Epoch 19 | Train Acc: 0.8969166666666667 | Test Acc: 0.8904166666666666 | Time: 1.1661417484283447 sec

Test set: Average loss: 0.3415, Accuracy: 10689/12000 (89%)

Epoch 20 | Train Acc: 0.8970208333333334 | Test Acc: 0.89075 | Time: 1.35736083984375 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -9.6963 | Coherence: 6.9709 | Separation: 58.0598 | Information gain: 7.3333 | Grad Norm: 14.2827 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: -8.9919 | Coherence: 7.8845 | Separation: 56.8602 | Information gain: 7.3333 | Grad Norm: 13.7133 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -8.2580 | Coherence: 8.8809 | Separation: 55.6548 | Information gain: 7.3333 | Grad Norm: 13.5698 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: -7.5027 | Coherence: 9.9014 | Separation: 54.4093 | Information gain: 7.3333 | Grad Norm: 13.5484 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: -6.8861 | Coherence: 10.9535 | Separation: 53.1117 | Information gain: 7.1667 | Grad Norm: 13.3106 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -6.1060 | Coherence: 12.0359 | Separation: 51.8540 | Information gain: 7.1667 | Grad Norm: 13.0045 | Time: 1.3s
Step 0060 | Epoch 01 | Objective: -5.1495 | Coherence: 13.1799 | Separation: 50.6285 | Information gain: 7.3333 | Grad Norm: 12.9158 | Time: 1.5s
Step 0070 | Epoch 01 | Objective: -4.2124 | Coherence: 14.4227 | Separation: 49.5599 | Information gain: 7.5000 | Grad Norm: 12.7608 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -3.4416 | Coherence: 15.6768 | Separation: 48.5015 | Information gain: 7.5000 | Grad Norm: 12.9068 | Time: 2.0s
Step 0090 | Epoch 01 | Objective: -2.6664 | Coherence: 16.9005 | Separation: 47.3997 | Information gain: 7.5000 | Grad Norm: 12.5503 | Time: 2.2s
Step 0100 | Epoch 01 | Objective: -1.7518 | Coherence: 18.0522 | Separation: 46.3074 | Information gain: 7.6667 | Grad Norm: 12.3154 | Time: 2.4s
Step 0110 | Epoch 01 | Objective: -1.0071 | Coherence: 19.2198 | Separation: 45.2412 | Information gain: 7.6667 | Grad Norm: 12.3228 | Time: 2.7s
Step 0120 | Epoch 01 | Objective: -0.2431 | Coherence: 20.4046 | Separation: 44.1340 | Information gain: 7.6667 | Grad Norm: 12.2853 | Time: 2.9s
Step 0130 | Epoch 01 | Objective: 0.4955 | Coherence: 21.6060 | Separation: 43.1196 | Information gain: 7.6667 | Grad Norm: 11.8938 | Time: 3.1s
Step 0136 | Epoch 01 | Objective: 0.9333 | Coherence: 22.3189 | Separation: 42.5189 | Information gain: 7.6667 | Grad Norm: 11.7415 | Time: 3.3s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.530139  0.468976  0.415096  ...  0.370286 -0.516577  0.384121
1  0.524286  0.601547  0.453091  ...  0.444765 -0.561417  0.452431
2  0.529017  0.500940  0.649432  ...  0.569519 -0.491593  0.588437
3  0.448543  0.515649  0.384731  ...  0.424927 -0.452743  0.421773
4  0.463800  0.503555  0.468412  ...  0.538226 -0.437597  0.538599

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7991
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9053
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8844
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.9445, accuracy=0.0985
Testing SVM
  SVM Test Accuracy: 0.8628
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8356

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6489, Accuracy: 9831/12000 (82%)

Epoch 1 | Train Acc: 0.6701458333333333 | Test Acc: 0.81925 | Time: 1.0351181030273438 sec

Test set: Average loss: 0.4893, Accuracy: 10218/12000 (85%)

Epoch 2 | Train Acc: 0.8338125 | Test Acc: 0.8515 | Time: 1.0250816345214844 sec

Test set: Average loss: 0.4281, Accuracy: 10382/12000 (87%)

Epoch 3 | Train Acc: 0.8601458333333334 | Test Acc: 0.8651666666666666 | Time: 1.028862476348877 sec

Test set: Average loss: 0.3968, Accuracy: 10524/12000 (88%)

Epoch 4 | Train Acc: 0.8745 | Test Acc: 0.877 | Time: 1.2511241436004639 sec

Test set: Average loss: 0.3754, Accuracy: 10596/12000 (88%)

Epoch 5 | Train Acc: 0.8837291666666667 | Test Acc: 0.883 | Time: 1.2918200492858887 sec

Test set: Average loss: 0.3626, Accuracy: 10631/12000 (89%)

Epoch 6 | Train Acc: 0.8899166666666667 | Test Acc: 0.8859166666666667 | Time: 1.0313708782196045 sec

Test set: Average loss: 0.3526, Accuracy: 10679/12000 (89%)

Epoch 7 | Train Acc: 0.8944166666666666 | Test Acc: 0.8899166666666667 | Time: 1.0275609493255615 sec

Test set: Average loss: 0.3453, Accuracy: 10712/12000 (89%)

Epoch 8 | Train Acc: 0.8967083333333333 | Test Acc: 0.8926666666666667 | Time: 1.0286533832550049 sec

Test set: Average loss: 0.3409, Accuracy: 10733/12000 (89%)

Epoch 9 | Train Acc: 0.898625 | Test Acc: 0.8944166666666666 | Time: 1.1330440044403076 sec

Test set: Average loss: 0.3380, Accuracy: 10742/12000 (90%)

Epoch 10 | Train Acc: 0.9001041666666667 | Test Acc: 0.8951666666666667 | Time: 1.0266389846801758 sec

Test set: Average loss: 0.3361, Accuracy: 10749/12000 (90%)

Epoch 11 | Train Acc: 0.9010833333333333 | Test Acc: 0.89575 | Time: 1.0278878211975098 sec

Test set: Average loss: 0.3348, Accuracy: 10752/12000 (90%)

Epoch 12 | Train Acc: 0.9013541666666667 | Test Acc: 0.896 | Time: 1.0238208770751953 sec

Test set: Average loss: 0.3340, Accuracy: 10750/12000 (90%)

Epoch 13 | Train Acc: 0.9019166666666667 | Test Acc: 0.8958333333333334 | Time: 1.0241293907165527 sec

Test set: Average loss: 0.3334, Accuracy: 10753/12000 (90%)

Epoch 14 | Train Acc: 0.9024583333333334 | Test Acc: 0.8960833333333333 | Time: 1.0309109687805176 sec

Test set: Average loss: 0.3330, Accuracy: 10756/12000 (90%)

Epoch 15 | Train Acc: 0.902875 | Test Acc: 0.8963333333333333 | Time: 1.0228829383850098 sec

Test set: Average loss: 0.3326, Accuracy: 10757/12000 (90%)

Epoch 16 | Train Acc: 0.9029583333333333 | Test Acc: 0.8964166666666666 | Time: 1.0304512977600098 sec

Test set: Average loss: 0.3324, Accuracy: 10760/12000 (90%)

Epoch 17 | Train Acc: 0.90325 | Test Acc: 0.8966666666666666 | Time: 1.221329927444458 sec

Test set: Average loss: 0.3323, Accuracy: 10759/12000 (90%)

Epoch 18 | Train Acc: 0.9033125 | Test Acc: 0.8965833333333333 | Time: 1.3525569438934326 sec

Test set: Average loss: 0.3322, Accuracy: 10758/12000 (90%)

Epoch 19 | Train Acc: 0.9033125 | Test Acc: 0.8965 | Time: 1.029815673828125 sec

Test set: Average loss: 0.3321, Accuracy: 10759/12000 (90%)

Epoch 20 | Train Acc: 0.9032916666666667 | Test Acc: 0.8965833333333333 | Time: 1.0265843868255615 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -36.1095 | Coherence: 8.2271 | Separation: 58.2779 | Information gain: 8.1667 | Grad Norm: 27.1691 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -34.7747 | Coherence: 8.7102 | Separation: 56.5172 | Information gain: 8.1667 | Grad Norm: 26.7990 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -33.5517 | Coherence: 9.2207 | Separation: 54.9380 | Information gain: 8.1667 | Grad Norm: 26.0436 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -32.2947 | Coherence: 9.7502 | Separation: 53.3172 | Information gain: 8.1667 | Grad Norm: 25.4427 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -31.0987 | Coherence: 10.2971 | Separation: 51.7967 | Information gain: 8.1667 | Grad Norm: 24.9795 | Time: 0.9s
Step 0050 | Epoch 01 | Objective: -29.9432 | Coherence: 10.8164 | Separation: 50.3231 | Information gain: 8.1667 | Grad Norm: 24.0103 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -28.8347 | Coherence: 11.2844 | Separation: 48.8942 | Information gain: 8.3333 | Grad Norm: 24.0049 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -27.6558 | Coherence: 11.7957 | Separation: 47.3816 | Information gain: 8.1667 | Grad Norm: 23.4509 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -26.6528 | Coherence: 12.2881 | Separation: 46.1232 | Information gain: 8.1667 | Grad Norm: 22.1909 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -25.7723 | Coherence: 12.7996 | Separation: 45.0582 | Information gain: 8.1667 | Grad Norm: 23.1610 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -24.9179 | Coherence: 13.3718 | Separation: 44.0628 | Information gain: 8.1667 | Grad Norm: 21.8187 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -24.0833 | Coherence: 14.0016 | Separation: 43.1257 | Information gain: 8.1667 | Grad Norm: 22.3927 | Time: 2.5s
Step 0120 | Epoch 01 | Objective: -23.2283 | Coherence: 14.6286 | Separation: 42.1567 | Information gain: 8.1667 | Grad Norm: 22.0135 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -22.3735 | Coherence: 15.2358 | Separation: 41.1781 | Information gain: 8.1667 | Grad Norm: 21.8970 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -21.5051 | Coherence: 15.8301 | Separation: 40.1727 | Information gain: 8.1667 | Grad Norm: 22.2014 | Time: 3.2s
Step 0150 | Epoch 01 | Objective: -20.6552 | Coherence: 16.3997 | Separation: 39.1827 | Information gain: 8.1667 | Grad Norm: 21.5936 | Time: 3.5s
Step 0160 | Epoch 01 | Objective: -19.9033 | Coherence: 16.9500 | Separation: 38.3299 | Information gain: 8.1667 | Grad Norm: 20.6848 | Time: 3.7s
Step 0170 | Epoch 01 | Objective: -19.1504 | Coherence: 17.5074 | Separation: 37.4792 | Information gain: 8.3333 | Grad Norm: 19.4014 | Time: 3.9s
Step 0180 | Epoch 01 | Objective: -18.3981 | Coherence: 18.0453 | Separation: 36.6198 | Information gain: 8.3333 | Grad Norm: 19.0518 | Time: 4.1s
Step 0190 | Epoch 01 | Objective: -17.6273 | Coherence: 18.5989 | Separation: 35.7403 | Information gain: 8.1667 | Grad Norm: 20.0772 | Time: 4.4s
Step 0200 | Epoch 01 | Objective: -16.8675 | Coherence: 19.1323 | Separation: 34.8674 | Information gain: 8.1667 | Grad Norm: 20.7194 | Time: 4.6s
Step 0210 | Epoch 01 | Objective: -16.0943 | Coherence: 19.6544 | Separation: 33.9686 | Information gain: 8.1667 | Grad Norm: 19.0552 | Time: 4.8s
Step 0220 | Epoch 01 | Objective: -15.3852 | Coherence: 20.1400 | Separation: 33.1478 | Information gain: 8.1667 | Grad Norm: 19.1475 | Time: 5.1s
Step 0230 | Epoch 01 | Objective: -14.7404 | Coherence: 20.6380 | Separation: 32.4296 | Information gain: 8.1667 | Grad Norm: 18.3379 | Time: 5.3s
Step 0240 | Epoch 01 | Objective: -14.1108 | Coherence: 21.1793 | Separation: 31.7559 | Information gain: 8.3333 | Grad Norm: 20.2998 | Time: 5.5s
Step 0250 | Epoch 01 | Objective: -13.4652 | Coherence: 21.7021 | Separation: 31.0488 | Information gain: 8.3333 | Grad Norm: 18.3854 | Time: 5.7s
Step 0260 | Epoch 01 | Objective: -12.8824 | Coherence: 22.2386 | Separation: 30.4429 | Information gain: 8.3333 | Grad Norm: 17.9576 | Time: 6.0s
Step 0270 | Epoch 01 | Objective: -12.3145 | Coherence: 22.7477 | Separation: 29.8455 | Information gain: 8.5000 | Grad Norm: 17.2999 | Time: 6.2s
Step 0280 | Epoch 01 | Objective: -11.7372 | Coherence: 23.2302 | Separation: 29.2210 | Information gain: 8.5000 | Grad Norm: 16.7205 | Time: 6.4s
Step 0290 | Epoch 01 | Objective: -11.1903 | Coherence: 23.7229 | Separation: 28.6469 | Information gain: 8.5000 | Grad Norm: 16.9824 | Time: 6.7s
Step 0300 | Epoch 01 | Objective: -10.6667 | Coherence: 24.1791 | Separation: 28.0896 | Information gain: 8.5000 | Grad Norm: 18.0426 | Time: 7.0s
Step 0310 | Epoch 01 | Objective: -10.1252 | Coherence: 24.6334 | Separation: 27.5045 | Information gain: 8.5000 | Grad Norm: 16.8634 | Time: 7.3s
Step 0320 | Epoch 01 | Objective: -9.5936 | Coherence: 25.0878 | Separation: 26.9343 | Information gain: 8.6667 | Grad Norm: 18.8354 | Time: 7.5s
Step 0330 | Epoch 01 | Objective: -9.0693 | Coherence: 25.5298 | Separation: 26.3688 | Information gain: 8.6667 | Grad Norm: 17.3752 | Time: 7.8s
Step 0340 | Epoch 01 | Objective: -8.5280 | Coherence: 25.9989 | Separation: 25.7914 | Information gain: 9.0000 | Grad Norm: 18.7786 | Time: 8.1s
Step 0350 | Epoch 01 | Objective: -7.9776 | Coherence: 26.4915 | Separation: 25.2121 | Information gain: 9.0000 | Grad Norm: 18.1087 | Time: 8.3s
Step 0360 | Epoch 01 | Objective: -7.4381 | Coherence: 26.9532 | Separation: 24.6338 | Information gain: 9.0000 | Grad Norm: 16.3632 | Time: 8.5s
Step 0370 | Epoch 01 | Objective: -6.9036 | Coherence: 27.4161 | Separation: 24.0635 | Information gain: 9.0000 | Grad Norm: 18.5944 | Time: 8.8s
Step 0380 | Epoch 01 | Objective: -6.3577 | Coherence: 27.8915 | Separation: 23.4823 | Information gain: 8.8333 | Grad Norm: 17.3913 | Time: 9.0s
Step 0390 | Epoch 01 | Objective: -5.8497 | Coherence: 28.3003 | Separation: 22.9247 | Information gain: 8.8333 | Grad Norm: 16.7215 | Time: 9.2s
Step 0400 | Epoch 01 | Objective: -5.4084 | Coherence: 28.6606 | Separation: 22.4428 | Information gain: 9.0000 | Grad Norm: 16.3633 | Time: 9.5s
Step 0410 | Epoch 01 | Objective: -5.0499 | Coherence: 28.9303 | Separation: 22.0400 | Information gain: 9.0000 | Grad Norm: 16.6267 | Time: 9.7s
Step 0420 | Epoch 01 | Objective: -4.6796 | Coherence: 29.1639 | Separation: 21.6014 | Information gain: 9.0000 | Grad Norm: 16.3532 | Time: 9.9s
Step 0430 | Epoch 01 | Objective: -4.3391 | Coherence: 29.4021 | Separation: 21.2097 | Information gain: 9.0000 | Grad Norm: 16.9058 | Time: 10.2s
Step 0440 | Epoch 01 | Objective: -4.0128 | Coherence: 29.6643 | Separation: 20.8513 | Information gain: 8.8333 | Grad Norm: 16.6106 | Time: 10.4s
Step 0450 | Epoch 01 | Objective: -3.6872 | Coherence: 29.9156 | Separation: 20.4887 | Information gain: 8.8333 | Grad Norm: 16.1080 | Time: 10.6s
Step 0460 | Epoch 01 | Objective: -3.3770 | Coherence: 30.1600 | Separation: 20.1455 | Information gain: 8.8333 | Grad Norm: 16.9425 | Time: 10.8s
Step 0470 | Epoch 01 | Objective: -3.0804 | Coherence: 30.4251 | Separation: 19.8331 | Information gain: 8.8333 | Grad Norm: 17.9785 | Time: 11.1s
Step 0480 | Epoch 01 | Objective: -2.7829 | Coherence: 30.7199 | Separation: 19.5343 | Information gain: 8.8333 | Grad Norm: 17.0137 | Time: 11.3s
Step 0490 | Epoch 01 | Objective: -2.4818 | Coherence: 31.0057 | Separation: 19.2255 | Information gain: 8.8333 | Grad Norm: 17.5642 | Time: 11.5s
Step 0500 | Epoch 01 | Objective: -2.1789 | Coherence: 31.2854 | Separation: 18.9110 | Information gain: 8.8333 | Grad Norm: 15.5815 | Time: 11.7s
Step 0510 | Epoch 01 | Objective: -1.8786 | Coherence: 31.5653 | Separation: 18.6005 | Information gain: 8.8333 | Grad Norm: 17.8855 | Time: 11.9s
Step 0520 | Epoch 01 | Objective: -1.5922 | Coherence: 31.8552 | Separation: 18.3159 | Information gain: 8.8333 | Grad Norm: 17.2386 | Time: 12.2s
Step 0530 | Epoch 01 | Objective: -1.3223 | Coherence: 32.1189 | Separation: 18.0428 | Information gain: 8.8333 | Grad Norm: 15.8750 | Time: 12.4s
Step 0540 | Epoch 01 | Objective: -1.0453 | Coherence: 32.3729 | Separation: 17.7544 | Information gain: 8.8333 | Grad Norm: 15.8142 | Time: 12.6s
Step 0550 | Epoch 01 | Objective: -0.8350 | Coherence: 32.5954 | Separation: 17.5501 | Information gain: 9.0000 | Grad Norm: 17.2257 | Time: 12.8s
Step 0560 | Epoch 01 | Objective: -0.6087 | Coherence: 32.8072 | Separation: 17.3167 | Information gain: 9.1667 | Grad Norm: 17.4303 | Time: 13.1s
Step 0570 | Epoch 01 | Objective: -0.3866 | Coherence: 33.0074 | Separation: 17.0836 | Information gain: 9.1667 | Grad Norm: 16.4185 | Time: 13.3s
Step 0580 | Epoch 01 | Objective: -0.1741 | Coherence: 33.1879 | Separation: 16.8551 | Information gain: 9.1667 | Grad Norm: 18.3688 | Time: 13.5s
Step 0590 | Epoch 01 | Objective: 0.0414 | Coherence: 33.3865 | Separation: 16.6311 | Information gain: 9.1667 | Grad Norm: 18.0476 | Time: 13.7s
Step 0600 | Epoch 01 | Objective: 0.2566 | Coherence: 33.5587 | Separation: 16.3945 | Information gain: 9.1667 | Grad Norm: 17.7097 | Time: 14.0s
Step 0610 | Epoch 01 | Objective: 0.4801 | Coherence: 33.7208 | Separation: 16.1403 | Information gain: 9.1667 | Grad Norm: 16.3471 | Time: 14.2s
Step 0620 | Epoch 01 | Objective: 0.6973 | Coherence: 33.8712 | Separation: 15.8897 | Information gain: 9.1667 | Grad Norm: 17.5984 | Time: 14.4s
Step 0630 | Epoch 01 | Objective: 0.9018 | Coherence: 34.0592 | Separation: 15.6769 | Information gain: 9.1667 | Grad Norm: 17.4159 | Time: 14.6s
Step 0630 | Epoch 01 | Objective: 0.9018 | Coherence: 34.0592 | Separation: 15.6769 | Information gain: 9.1667 | Grad Norm: 17.4159 | Time: 14.6s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.590069  0.564277  0.417092  ...  0.441122  0.320944  0.521061
1 -0.545205  0.576611  0.439579  ...  0.431788  0.390813  0.464180
2 -0.434481  0.452574  0.603941  ...  0.454234  0.453618  0.461549
3 -0.414213  0.464498  0.452641  ...  0.315058  0.339699  0.384073
4 -0.435169  0.466187  0.524694  ...  0.497220  0.480190  0.474844

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8081
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9019
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8875
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.9059, accuracy=0.1083
Testing SVM
  SVM Test Accuracy: 0.8652
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8401

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6483, Accuracy: 9724/12000 (81%)

Epoch 1 | Train Acc: 0.6862708333333334 | Test Acc: 0.8103333333333333 | Time: 1.0260558128356934 sec

Test set: Average loss: 0.4677, Accuracy: 10274/12000 (86%)

Epoch 2 | Train Acc: 0.8410416666666667 | Test Acc: 0.8561666666666666 | Time: 1.0260186195373535 sec

Test set: Average loss: 0.3978, Accuracy: 10534/12000 (88%)

Epoch 3 | Train Acc: 0.86625 | Test Acc: 0.8778333333333334 | Time: 1.019439697265625 sec

Test set: Average loss: 0.3709, Accuracy: 10606/12000 (88%)

Epoch 4 | Train Acc: 0.8793333333333333 | Test Acc: 0.8838333333333334 | Time: 1.0247547626495361 sec

Test set: Average loss: 0.3526, Accuracy: 10672/12000 (89%)

Epoch 5 | Train Acc: 0.8865 | Test Acc: 0.8893333333333333 | Time: 1.12650728225708 sec

Test set: Average loss: 0.3407, Accuracy: 10717/12000 (89%)

Epoch 6 | Train Acc: 0.8922916666666667 | Test Acc: 0.8930833333333333 | Time: 1.0266218185424805 sec

Test set: Average loss: 0.3327, Accuracy: 10735/12000 (89%)

Epoch 7 | Train Acc: 0.8955416666666667 | Test Acc: 0.8945833333333333 | Time: 1.0201945304870605 sec

Test set: Average loss: 0.3277, Accuracy: 10761/12000 (90%)

Epoch 8 | Train Acc: 0.8976666666666666 | Test Acc: 0.89675 | Time: 1.0296776294708252 sec

Test set: Average loss: 0.3243, Accuracy: 10769/12000 (90%)

Epoch 9 | Train Acc: 0.8995 | Test Acc: 0.8974166666666666 | Time: 1.02549409866333 sec

Test set: Average loss: 0.3219, Accuracy: 10780/12000 (90%)

Epoch 10 | Train Acc: 0.9008541666666666 | Test Acc: 0.8983333333333333 | Time: 1.2332568168640137 sec

Test set: Average loss: 0.3200, Accuracy: 10782/12000 (90%)

Epoch 11 | Train Acc: 0.9016875 | Test Acc: 0.8985 | Time: 1.1721301078796387 sec

Test set: Average loss: 0.3188, Accuracy: 10787/12000 (90%)

Epoch 12 | Train Acc: 0.9024375 | Test Acc: 0.8989166666666667 | Time: 1.0643930435180664 sec

Test set: Average loss: 0.3178, Accuracy: 10784/12000 (90%)

Epoch 13 | Train Acc: 0.902875 | Test Acc: 0.8986666666666666 | Time: 1.0331921577453613 sec

Test set: Average loss: 0.3171, Accuracy: 10788/12000 (90%)

Epoch 14 | Train Acc: 0.9030208333333334 | Test Acc: 0.899 | Time: 1.1189424991607666 sec

Test set: Average loss: 0.3166, Accuracy: 10794/12000 (90%)

Epoch 15 | Train Acc: 0.9032916666666667 | Test Acc: 0.8995 | Time: 1.0254545211791992 sec

Test set: Average loss: 0.3162, Accuracy: 10797/12000 (90%)

Epoch 16 | Train Acc: 0.9034791666666667 | Test Acc: 0.89975 | Time: 1.0283045768737793 sec

Test set: Average loss: 0.3160, Accuracy: 10796/12000 (90%)

Epoch 17 | Train Acc: 0.9035416666666667 | Test Acc: 0.8996666666666666 | Time: 1.0269765853881836 sec

Test set: Average loss: 0.3158, Accuracy: 10792/12000 (90%)

Epoch 18 | Train Acc: 0.9036041666666667 | Test Acc: 0.8993333333333333 | Time: 1.0212945938110352 sec

Test set: Average loss: 0.3157, Accuracy: 10791/12000 (90%)

Epoch 19 | Train Acc: 0.9035833333333333 | Test Acc: 0.89925 | Time: 1.025308609008789 sec

Test set: Average loss: 0.3156, Accuracy: 10790/12000 (90%)

Epoch 20 | Train Acc: 0.9036458333333334 | Test Acc: 0.8991666666666667 | Time: 1.0343563556671143 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -33.3485 | Coherence: 4.0282 | Separation: 56.4535 | Information gain: 8.8333 | Grad Norm: 26.6298 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -32.0641 | Coherence: 4.8307 | Separation: 54.9282 | Information gain: 8.8333 | Grad Norm: 26.5505 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -30.9364 | Coherence: 5.6541 | Separation: 53.6483 | Information gain: 8.8333 | Grad Norm: 25.2407 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -29.9281 | Coherence: 6.4391 | Separation: 52.5284 | Information gain: 8.8333 | Grad Norm: 24.4715 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: -28.9579 | Coherence: 7.0748 | Separation: 51.4742 | Information gain: 9.0000 | Grad Norm: 23.8292 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -28.1493 | Coherence: 7.7055 | Separation: 50.5768 | Information gain: 9.0000 | Grad Norm: 23.3753 | Time: 1.3s
Step 0060 | Epoch 01 | Objective: -27.3187 | Coherence: 8.3308 | Separation: 49.6434 | Information gain: 9.0000 | Grad Norm: 23.8029 | Time: 1.6s
Step 0070 | Epoch 01 | Objective: -26.5281 | Coherence: 8.9750 | Separation: 48.6963 | Information gain: 8.8333 | Grad Norm: 24.0403 | Time: 1.8s
Step 0080 | Epoch 01 | Objective: -25.6725 | Coherence: 9.5889 | Separation: 47.7199 | Information gain: 8.8333 | Grad Norm: 23.2099 | Time: 2.1s
Step 0090 | Epoch 01 | Objective: -24.9031 | Coherence: 10.1538 | Separation: 46.7649 | Information gain: 8.6667 | Grad Norm: 23.1032 | Time: 2.4s
Step 0100 | Epoch 01 | Objective: -24.0936 | Coherence: 10.6347 | Separation: 45.7911 | Information gain: 8.6667 | Grad Norm: 23.0273 | Time: 2.6s
Step 0110 | Epoch 01 | Objective: -23.3126 | Coherence: 11.0386 | Separation: 44.8216 | Information gain: 8.6667 | Grad Norm: 21.9114 | Time: 2.9s
Step 0120 | Epoch 01 | Objective: -22.6060 | Coherence: 11.4180 | Separation: 43.8680 | Information gain: 8.5000 | Grad Norm: 21.7036 | Time: 3.2s
Step 0130 | Epoch 01 | Objective: -21.8489 | Coherence: 11.8130 | Separation: 42.9299 | Information gain: 8.5000 | Grad Norm: 20.8407 | Time: 3.4s
Step 0140 | Epoch 01 | Objective: -21.0715 | Coherence: 12.2838 | Separation: 41.9991 | Information gain: 8.5000 | Grad Norm: 21.8315 | Time: 3.7s
Step 0150 | Epoch 01 | Objective: -20.2706 | Coherence: 12.7632 | Separation: 41.0375 | Information gain: 8.5000 | Grad Norm: 20.9997 | Time: 3.9s
Step 0160 | Epoch 01 | Objective: -19.4367 | Coherence: 13.2656 | Separation: 40.0379 | Information gain: 8.5000 | Grad Norm: 21.8038 | Time: 4.2s
Step 0170 | Epoch 01 | Objective: -18.5235 | Coherence: 13.8082 | Separation: 39.0226 | Information gain: 8.6667 | Grad Norm: 20.7049 | Time: 4.4s
Step 0180 | Epoch 01 | Objective: -17.7634 | Coherence: 14.3394 | Separation: 38.1481 | Information gain: 8.6667 | Grad Norm: 20.1661 | Time: 4.6s
Step 0190 | Epoch 01 | Objective: -17.0008 | Coherence: 14.8385 | Separation: 37.2538 | Information gain: 8.6667 | Grad Norm: 20.7652 | Time: 4.9s
Step 0200 | Epoch 01 | Objective: -16.2216 | Coherence: 15.3110 | Separation: 36.3212 | Information gain: 8.6667 | Grad Norm: 18.7582 | Time: 5.1s
Step 0210 | Epoch 01 | Objective: -15.4259 | Coherence: 15.7215 | Separation: 35.3330 | Information gain: 8.6667 | Grad Norm: 20.3168 | Time: 5.3s
Step 0220 | Epoch 01 | Objective: -14.5829 | Coherence: 16.1281 | Separation: 34.2717 | Information gain: 8.6667 | Grad Norm: 20.5239 | Time: 5.5s
Step 0230 | Epoch 01 | Objective: -13.7446 | Coherence: 16.5733 | Separation: 33.2369 | Information gain: 8.6667 | Grad Norm: 19.7131 | Time: 5.8s
Step 0240 | Epoch 01 | Objective: -12.9420 | Coherence: 17.0847 | Separation: 32.2886 | Information gain: 8.6667 | Grad Norm: 18.9451 | Time: 6.0s
Step 0250 | Epoch 01 | Objective: -12.1889 | Coherence: 17.6346 | Separation: 31.3507 | Information gain: 8.5000 | Grad Norm: 20.3356 | Time: 6.2s
Step 0260 | Epoch 01 | Objective: -11.3713 | Coherence: 18.1862 | Separation: 30.4000 | Information gain: 8.5000 | Grad Norm: 18.8155 | Time: 6.4s
Step 0270 | Epoch 01 | Objective: -10.7161 | Coherence: 18.7340 | Separation: 29.6911 | Information gain: 8.5000 | Grad Norm: 17.7778 | Time: 6.6s
Step 0280 | Epoch 01 | Objective: -10.1458 | Coherence: 19.2552 | Separation: 29.0129 | Information gain: 8.3333 | Grad Norm: 17.9329 | Time: 6.9s
Step 0290 | Epoch 01 | Objective: -9.4919 | Coherence: 19.7799 | Separation: 28.2944 | Information gain: 8.3333 | Grad Norm: 17.3427 | Time: 7.1s
Step 0300 | Epoch 01 | Objective: -8.8820 | Coherence: 20.2990 | Separation: 27.6392 | Information gain: 8.3333 | Grad Norm: 18.3686 | Time: 7.3s
Step 0310 | Epoch 01 | Objective: -8.3266 | Coherence: 20.7688 | Separation: 27.0409 | Information gain: 8.3333 | Grad Norm: 16.8787 | Time: 7.5s
Step 0320 | Epoch 01 | Objective: -7.8367 | Coherence: 21.2220 | Separation: 26.4493 | Information gain: 8.1667 | Grad Norm: 16.4088 | Time: 7.8s
Step 0330 | Epoch 01 | Objective: -7.3226 | Coherence: 21.6713 | Separation: 25.9030 | Information gain: 8.1667 | Grad Norm: 17.0965 | Time: 8.0s
Step 0340 | Epoch 01 | Objective: -6.8327 | Coherence: 22.1000 | Separation: 25.3823 | Information gain: 8.1667 | Grad Norm: 17.1900 | Time: 8.2s
Step 0350 | Epoch 01 | Objective: -6.3372 | Coherence: 22.5286 | Separation: 24.8534 | Information gain: 8.1667 | Grad Norm: 17.1496 | Time: 8.4s
Step 0360 | Epoch 01 | Objective: -5.8751 | Coherence: 22.9833 | Separation: 24.3876 | Information gain: 8.1667 | Grad Norm: 16.8349 | Time: 8.7s
Step 0370 | Epoch 01 | Objective: -5.4750 | Coherence: 23.4220 | Separation: 24.0068 | Information gain: 8.1667 | Grad Norm: 16.7733 | Time: 8.9s
Step 0380 | Epoch 01 | Objective: -5.0720 | Coherence: 23.8602 | Separation: 23.6214 | Information gain: 8.1667 | Grad Norm: 17.8052 | Time: 9.1s
Step 0390 | Epoch 01 | Objective: -4.6824 | Coherence: 24.2794 | Separation: 23.2466 | Information gain: 8.1667 | Grad Norm: 16.9858 | Time: 9.3s
Step 0400 | Epoch 01 | Objective: -4.3213 | Coherence: 24.6827 | Separation: 22.9066 | Information gain: 8.1667 | Grad Norm: 16.4522 | Time: 9.6s
Step 0410 | Epoch 01 | Objective: -3.9417 | Coherence: 25.0962 | Separation: 22.5440 | Information gain: 8.1667 | Grad Norm: 16.9174 | Time: 9.8s
Step 0420 | Epoch 01 | Objective: -3.5927 | Coherence: 25.5051 | Separation: 22.2250 | Information gain: 8.1667 | Grad Norm: 16.4809 | Time: 10.0s
Step 0430 | Epoch 01 | Objective: -3.3403 | Coherence: 25.8607 | Separation: 22.0242 | Information gain: 8.1667 | Grad Norm: 17.1363 | Time: 10.3s
Step 0440 | Epoch 01 | Objective: -3.0934 | Coherence: 26.2033 | Separation: 21.8251 | Information gain: 8.1667 | Grad Norm: 17.0753 | Time: 10.5s
Step 0450 | Epoch 01 | Objective: -2.8777 | Coherence: 26.5397 | Separation: 21.6698 | Information gain: 8.1667 | Grad Norm: 16.3271 | Time: 10.7s
Step 0460 | Epoch 01 | Objective: -2.6726 | Coherence: 26.8597 | Separation: 21.5221 | Information gain: 8.1667 | Grad Norm: 16.6821 | Time: 10.9s
Step 0470 | Epoch 01 | Objective: -2.4544 | Coherence: 27.1861 | Separation: 21.3579 | Information gain: 8.1667 | Grad Norm: 15.3851 | Time: 11.1s
Step 0480 | Epoch 01 | Objective: -2.2969 | Coherence: 27.4888 | Separation: 21.2731 | Information gain: 8.1667 | Grad Norm: 15.6103 | Time: 11.4s
Step 0490 | Epoch 01 | Objective: -2.1358 | Coherence: 27.7878 | Separation: 21.1809 | Information gain: 8.1667 | Grad Norm: 15.7624 | Time: 11.6s
Step 0500 | Epoch 01 | Objective: -1.9757 | Coherence: 28.0755 | Separation: 21.0846 | Information gain: 8.1667 | Grad Norm: 17.7534 | Time: 11.8s
Step 0510 | Epoch 01 | Objective: -1.8129 | Coherence: 28.3594 | Separation: 20.9824 | Information gain: 8.1667 | Grad Norm: 17.6385 | Time: 12.1s
Step 0520 | Epoch 01 | Objective: -1.6440 | Coherence: 28.6466 | Separation: 20.8725 | Information gain: 8.1667 | Grad Norm: 17.7694 | Time: 12.3s
Step 0530 | Epoch 01 | Objective: -1.4747 | Coherence: 28.9368 | Separation: 20.7638 | Information gain: 8.1667 | Grad Norm: 16.7937 | Time: 12.5s
Step 0540 | Epoch 01 | Objective: -1.3043 | Coherence: 29.2201 | Separation: 20.6499 | Information gain: 8.1667 | Grad Norm: 15.9111 | Time: 12.7s
Step 0550 | Epoch 01 | Objective: -1.1324 | Coherence: 29.5122 | Separation: 20.5380 | Information gain: 8.1667 | Grad Norm: 15.6472 | Time: 13.0s
Step 0560 | Epoch 01 | Objective: -0.9599 | Coherence: 29.7919 | Separation: 20.4192 | Information gain: 8.1667 | Grad Norm: 16.4431 | Time: 13.2s
Step 0570 | Epoch 01 | Objective: -0.7777 | Coherence: 30.0667 | Separation: 20.2832 | Information gain: 8.1667 | Grad Norm: 17.8517 | Time: 13.5s
Step 0580 | Epoch 01 | Objective: -0.5968 | Coherence: 30.3425 | Separation: 20.1498 | Information gain: 8.1667 | Grad Norm: 17.2426 | Time: 13.8s
Step 0590 | Epoch 01 | Objective: -0.4119 | Coherence: 30.6200 | Separation: 20.0111 | Information gain: 8.1667 | Grad Norm: 16.8706 | Time: 14.0s
Step 0600 | Epoch 01 | Objective: -0.2316 | Coherence: 30.8775 | Separation: 19.8695 | Information gain: 8.1667 | Grad Norm: 15.7910 | Time: 14.3s
Step 0610 | Epoch 01 | Objective: -0.0573 | Coherence: 31.1528 | Separation: 19.7457 | Information gain: 8.1667 | Grad Norm: 16.5018 | Time: 14.5s
Step 0620 | Epoch 01 | Objective: 0.1192 | Coherence: 31.4417 | Separation: 19.6254 | Information gain: 8.1667 | Grad Norm: 15.1595 | Time: 14.8s
Step 0630 | Epoch 01 | Objective: 0.2875 | Coherence: 31.7125 | Separation: 19.5083 | Information gain: 8.1667 | Grad Norm: 15.9996 | Time: 15.1s
Step 0640 | Epoch 01 | Objective: 0.4515 | Coherence: 31.9722 | Separation: 19.3922 | Information gain: 8.1667 | Grad Norm: 17.1571 | Time: 15.3s
Step 0650 | Epoch 01 | Objective: 0.6039 | Coherence: 32.2573 | Separation: 19.3061 | Information gain: 8.1667 | Grad Norm: 16.0723 | Time: 15.6s
Step 0660 | Epoch 01 | Objective: 0.7644 | Coherence: 32.5339 | Separation: 19.2036 | Information gain: 8.1667 | Grad Norm: 15.9105 | Time: 15.8s
Step 0669 | Epoch 01 | Objective: 0.9065 | Coherence: 32.7910 | Separation: 19.1190 | Information gain: 8.1667 | Grad Norm: 16.7328 | Time: 16.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.571008  0.463961  0.431657  ... -0.018913  0.433566  0.356793
1  0.488308  0.597659  0.515794  ... -0.038473  0.465176  0.406950
2  0.448231  0.518975  0.614821  ... -0.016045  0.528063  0.513661
3  0.476627  0.603335  0.544057  ...  0.001648  0.442777  0.428844
4  0.537564  0.536778  0.488457  ...  0.027962  0.459853  0.391334

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8001
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9066
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8874
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.8547, accuracy=0.1032
Testing SVM
  SVM Test Accuracy: 0.8641
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8298

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6257, Accuracy: 9831/12000 (82%)

Epoch 1 | Train Acc: 0.6791666666666667 | Test Acc: 0.81925 | Time: 1.0328137874603271 sec

Test set: Average loss: 0.4434, Accuracy: 10401/12000 (87%)

Epoch 2 | Train Acc: 0.8423125 | Test Acc: 0.86675 | Time: 1.0222454071044922 sec

Test set: Average loss: 0.3888, Accuracy: 10550/12000 (88%)

Epoch 3 | Train Acc: 0.8677916666666666 | Test Acc: 0.8791666666666667 | Time: 1.0355205535888672 sec

Test set: Average loss: 0.3569, Accuracy: 10631/12000 (89%)

Epoch 4 | Train Acc: 0.8809583333333333 | Test Acc: 0.8859166666666667 | Time: 1.0406291484832764 sec

Test set: Average loss: 0.3372, Accuracy: 10699/12000 (89%)

Epoch 5 | Train Acc: 0.8898333333333334 | Test Acc: 0.8915833333333333 | Time: 1.0187246799468994 sec

Test set: Average loss: 0.3241, Accuracy: 10759/12000 (90%)

Epoch 6 | Train Acc: 0.8960833333333333 | Test Acc: 0.8965833333333333 | Time: 1.0200343132019043 sec

Test set: Average loss: 0.3148, Accuracy: 10767/12000 (90%)

Epoch 7 | Train Acc: 0.9000625 | Test Acc: 0.89725 | Time: 1.0288991928100586 sec

Test set: Average loss: 0.3088, Accuracy: 10797/12000 (90%)

Epoch 8 | Train Acc: 0.90275 | Test Acc: 0.89975 | Time: 1.040393352508545 sec

Test set: Average loss: 0.3042, Accuracy: 10820/12000 (90%)

Epoch 9 | Train Acc: 0.9047708333333333 | Test Acc: 0.9016666666666666 | Time: 1.039048194885254 sec

Test set: Average loss: 0.3008, Accuracy: 10832/12000 (90%)

Epoch 10 | Train Acc: 0.9063333333333333 | Test Acc: 0.9026666666666666 | Time: 1.136667013168335 sec

Test set: Average loss: 0.2985, Accuracy: 10836/12000 (90%)

Epoch 11 | Train Acc: 0.907 | Test Acc: 0.903 | Time: 1.030630350112915 sec

Test set: Average loss: 0.2967, Accuracy: 10839/12000 (90%)

Epoch 12 | Train Acc: 0.90775 | Test Acc: 0.90325 | Time: 1.0328700542449951 sec

Test set: Average loss: 0.2953, Accuracy: 10848/12000 (90%)

Epoch 13 | Train Acc: 0.9077916666666667 | Test Acc: 0.904 | Time: 1.028857707977295 sec

Test set: Average loss: 0.2944, Accuracy: 10853/12000 (90%)

Epoch 14 | Train Acc: 0.9082291666666666 | Test Acc: 0.9044166666666666 | Time: 1.0647988319396973 sec

Test set: Average loss: 0.2939, Accuracy: 10854/12000 (90%)

Epoch 15 | Train Acc: 0.9086875 | Test Acc: 0.9045 | Time: 1.0345468521118164 sec

Test set: Average loss: 0.2935, Accuracy: 10857/12000 (90%)

Epoch 16 | Train Acc: 0.9087083333333333 | Test Acc: 0.90475 | Time: 1.0335173606872559 sec

Test set: Average loss: 0.2932, Accuracy: 10858/12000 (90%)

Epoch 17 | Train Acc: 0.9087916666666667 | Test Acc: 0.9048333333333334 | Time: 1.0316498279571533 sec

Test set: Average loss: 0.2931, Accuracy: 10857/12000 (90%)

Epoch 18 | Train Acc: 0.9090625 | Test Acc: 0.90475 | Time: 1.0277330875396729 sec

Test set: Average loss: 0.2929, Accuracy: 10858/12000 (90%)

Epoch 19 | Train Acc: 0.9091458333333333 | Test Acc: 0.9048333333333334 | Time: 1.129692554473877 sec

Test set: Average loss: 0.2929, Accuracy: 10857/12000 (90%)

Epoch 20 | Train Acc: 0.9091666666666667 | Test Acc: 0.90475 | Time: 1.0286226272583008 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -23.8526 | Coherence: 17.4217 | Separation: 51.4897 | Information gain: 7.0000 | Grad Norm: 23.7026 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -22.7240 | Coherence: 18.0952 | Separation: 49.9669 | Information gain: 6.8333 | Grad Norm: 23.1997 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -21.4929 | Coherence: 18.7948 | Separation: 48.4700 | Information gain: 6.8333 | Grad Norm: 22.9958 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -20.1456 | Coherence: 19.4641 | Separation: 46.9504 | Information gain: 7.0000 | Grad Norm: 22.2822 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -19.0633 | Coherence: 20.1928 | Separation: 45.5246 | Information gain: 6.8333 | Grad Norm: 22.1190 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -17.9287 | Coherence: 20.9355 | Separation: 44.1942 | Information gain: 6.8333 | Grad Norm: 21.6273 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -16.8327 | Coherence: 21.6246 | Separation: 42.8947 | Information gain: 6.8333 | Grad Norm: 21.3942 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -15.6854 | Coherence: 22.3609 | Separation: 41.5419 | Information gain: 6.8333 | Grad Norm: 22.5093 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -14.6899 | Coherence: 23.0887 | Separation: 40.4125 | Information gain: 6.8333 | Grad Norm: 20.7295 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -13.7864 | Coherence: 23.7002 | Separation: 39.3630 | Information gain: 6.8333 | Grad Norm: 20.7413 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -12.9334 | Coherence: 24.3187 | Separation: 38.3928 | Information gain: 6.8333 | Grad Norm: 19.9605 | Time: 2.4s
Step 0110 | Epoch 01 | Objective: -12.1287 | Coherence: 24.8670 | Separation: 37.4598 | Information gain: 6.8333 | Grad Norm: 19.3536 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -11.2082 | Coherence: 25.3695 | Separation: 36.4971 | Information gain: 7.0000 | Grad Norm: 20.5708 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -10.3286 | Coherence: 25.9277 | Separation: 35.6234 | Information gain: 7.1667 | Grad Norm: 19.2427 | Time: 3.1s
Step 0140 | Epoch 01 | Objective: -9.5875 | Coherence: 26.4676 | Separation: 34.7817 | Information gain: 7.1667 | Grad Norm: 18.9521 | Time: 3.3s
Step 0150 | Epoch 01 | Objective: -9.0422 | Coherence: 26.9885 | Separation: 34.0575 | Information gain: 7.0000 | Grad Norm: 18.6659 | Time: 3.5s
Step 0160 | Epoch 01 | Objective: -8.3360 | Coherence: 27.4566 | Separation: 33.3989 | Information gain: 7.1667 | Grad Norm: 17.1181 | Time: 3.8s
Step 0170 | Epoch 01 | Objective: -7.8003 | Coherence: 27.8761 | Separation: 32.8052 | Information gain: 7.1667 | Grad Norm: 17.7245 | Time: 4.0s
Step 0180 | Epoch 01 | Objective: -7.3041 | Coherence: 28.2491 | Separation: 32.2474 | Information gain: 7.1667 | Grad Norm: 16.8224 | Time: 4.2s
Step 0190 | Epoch 01 | Objective: -6.8189 | Coherence: 28.6116 | Separation: 31.7009 | Information gain: 7.1667 | Grad Norm: 16.4850 | Time: 4.5s
Step 0200 | Epoch 01 | Objective: -6.2468 | Coherence: 28.9749 | Separation: 31.1910 | Information gain: 7.3333 | Grad Norm: 16.6045 | Time: 4.7s
Step 0210 | Epoch 01 | Objective: -5.8135 | Coherence: 29.3323 | Separation: 30.7197 | Information gain: 7.3333 | Grad Norm: 15.5086 | Time: 4.9s
Step 0220 | Epoch 01 | Objective: -5.3925 | Coherence: 29.7035 | Separation: 30.2739 | Information gain: 7.3333 | Grad Norm: 15.9537 | Time: 5.2s
Step 0230 | Epoch 01 | Objective: -5.0089 | Coherence: 30.0449 | Separation: 29.8691 | Information gain: 7.3333 | Grad Norm: 16.6457 | Time: 5.4s
Step 0240 | Epoch 01 | Objective: -4.5386 | Coherence: 30.4278 | Separation: 29.5218 | Information gain: 7.5000 | Grad Norm: 16.3141 | Time: 5.6s
Step 0250 | Epoch 01 | Objective: -4.1657 | Coherence: 30.8144 | Separation: 29.1558 | Information gain: 7.5000 | Grad Norm: 15.4928 | Time: 5.9s
Step 0260 | Epoch 01 | Objective: -3.9376 | Coherence: 31.2267 | Separation: 28.8531 | Information gain: 7.3333 | Grad Norm: 16.1587 | Time: 6.1s
Step 0270 | Epoch 01 | Objective: -3.4653 | Coherence: 31.6533 | Separation: 28.5246 | Information gain: 7.5000 | Grad Norm: 15.8803 | Time: 6.3s
Step 0280 | Epoch 01 | Objective: -3.1008 | Coherence: 32.0634 | Separation: 28.1829 | Information gain: 7.5000 | Grad Norm: 15.9409 | Time: 6.6s
Step 0290 | Epoch 01 | Objective: -2.7388 | Coherence: 32.4327 | Separation: 27.8246 | Information gain: 7.5000 | Grad Norm: 16.5086 | Time: 6.8s
Step 0300 | Epoch 01 | Objective: -2.3858 | Coherence: 32.7896 | Separation: 27.4735 | Information gain: 7.5000 | Grad Norm: 15.7784 | Time: 7.0s
Step 0310 | Epoch 01 | Objective: -2.1741 | Coherence: 33.1639 | Separation: 27.1764 | Information gain: 7.3333 | Grad Norm: 15.0819 | Time: 7.3s
Step 0320 | Epoch 01 | Objective: -1.8568 | Coherence: 33.5156 | Separation: 26.8763 | Information gain: 7.3333 | Grad Norm: 16.7504 | Time: 7.5s
Step 0330 | Epoch 01 | Objective: -1.5357 | Coherence: 33.8819 | Separation: 26.5778 | Information gain: 7.3333 | Grad Norm: 16.4126 | Time: 7.7s
Step 0340 | Epoch 01 | Objective: -1.2239 | Coherence: 34.2271 | Separation: 26.2827 | Information gain: 7.3333 | Grad Norm: 15.7318 | Time: 8.0s
Step 0350 | Epoch 01 | Objective: -0.9143 | Coherence: 34.5456 | Separation: 25.9777 | Information gain: 7.3333 | Grad Norm: 16.7622 | Time: 8.2s
Step 0360 | Epoch 01 | Objective: -0.7119 | Coherence: 34.8823 | Separation: 25.6757 | Information gain: 7.1667 | Grad Norm: 15.9122 | Time: 8.5s
Step 0370 | Epoch 01 | Objective: -0.4499 | Coherence: 35.1837 | Separation: 25.4333 | Information gain: 7.1667 | Grad Norm: 16.9198 | Time: 8.7s
Step 0380 | Epoch 01 | Objective: -0.0444 | Coherence: 35.4891 | Separation: 25.1444 | Information gain: 7.3333 | Grad Norm: 15.0024 | Time: 9.0s
Step 0390 | Epoch 01 | Objective: 0.2256 | Coherence: 35.7791 | Separation: 24.8844 | Information gain: 7.3333 | Grad Norm: 15.5283 | Time: 9.2s
Step 0400 | Epoch 01 | Objective: 0.4783 | Coherence: 36.0359 | Separation: 24.6338 | Information gain: 7.3333 | Grad Norm: 14.7624 | Time: 9.4s
Step 0410 | Epoch 01 | Objective: 0.7210 | Coherence: 36.2748 | Separation: 24.3893 | Information gain: 7.3333 | Grad Norm: 17.3586 | Time: 9.6s
Step 0413 | Epoch 01 | Objective: 0.9093 | Coherence: 36.3352 | Separation: 24.3037 | Information gain: 7.5000 | Grad Norm: 17.3009 | Time: 9.7s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.627519  0.564987  0.492791  ...  0.598266  0.580666  0.511219
1  0.568051  0.627340  0.575485  ...  0.555390  0.552562  0.497570
2  0.456479  0.519533  0.572387  ...  0.443070  0.464129  0.472381
3  0.457700  0.526898  0.508369  ...  0.487259  0.438502  0.352988
4  0.464114  0.571857  0.562930  ...  0.482372  0.471629  0.399430

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8020
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9057
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8897
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0836, accuracy=0.0984
Testing SVM
  SVM Test Accuracy: 0.8612
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8426

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6047, Accuracy: 9893/12000 (82%)

Epoch 1 | Train Acc: 0.6912916666666666 | Test Acc: 0.8244166666666667 | Time: 1.029266595840454 sec

Test set: Average loss: 0.4667, Accuracy: 10219/12000 (85%)

Epoch 2 | Train Acc: 0.8375833333333333 | Test Acc: 0.8515833333333334 | Time: 1.0249919891357422 sec

Test set: Average loss: 0.4095, Accuracy: 10430/12000 (87%)

Epoch 3 | Train Acc: 0.8601041666666667 | Test Acc: 0.8691666666666666 | Time: 1.3159348964691162 sec

Test set: Average loss: 0.3797, Accuracy: 10546/12000 (88%)

Epoch 4 | Train Acc: 0.8739583333333333 | Test Acc: 0.8788333333333334 | Time: 1.0278332233428955 sec

Test set: Average loss: 0.3611, Accuracy: 10620/12000 (88%)

Epoch 5 | Train Acc: 0.882125 | Test Acc: 0.885 | Time: 1.0607457160949707 sec

Test set: Average loss: 0.3488, Accuracy: 10662/12000 (89%)

Epoch 6 | Train Acc: 0.8869791666666667 | Test Acc: 0.8885 | Time: 1.6299023628234863 sec

Test set: Average loss: 0.3404, Accuracy: 10692/12000 (89%)

Epoch 7 | Train Acc: 0.8917291666666667 | Test Acc: 0.891 | Time: 1.0321128368377686 sec

Test set: Average loss: 0.3348, Accuracy: 10700/12000 (89%)

Epoch 8 | Train Acc: 0.8942916666666667 | Test Acc: 0.8916666666666667 | Time: 1.0261867046356201 sec

Test set: Average loss: 0.3307, Accuracy: 10713/12000 (89%)

Epoch 9 | Train Acc: 0.896375 | Test Acc: 0.89275 | Time: 1.2540287971496582 sec

Test set: Average loss: 0.3276, Accuracy: 10728/12000 (89%)

Epoch 10 | Train Acc: 0.8974166666666666 | Test Acc: 0.894 | Time: 1.5279760360717773 sec

Test set: Average loss: 0.3255, Accuracy: 10733/12000 (89%)

Epoch 11 | Train Acc: 0.8990416666666666 | Test Acc: 0.8944166666666666 | Time: 1.3248860836029053 sec

Test set: Average loss: 0.3240, Accuracy: 10747/12000 (90%)

Epoch 12 | Train Acc: 0.8995 | Test Acc: 0.8955833333333333 | Time: 1.0311315059661865 sec

Test set: Average loss: 0.3229, Accuracy: 10745/12000 (90%)

Epoch 13 | Train Acc: 0.899625 | Test Acc: 0.8954166666666666 | Time: 1.028505563735962 sec

Test set: Average loss: 0.3222, Accuracy: 10748/12000 (90%)

Epoch 14 | Train Acc: 0.8999583333333333 | Test Acc: 0.8956666666666667 | Time: 1.083871603012085 sec

Test set: Average loss: 0.3217, Accuracy: 10752/12000 (90%)

Epoch 15 | Train Acc: 0.9001458333333333 | Test Acc: 0.896 | Time: 1.1584053039550781 sec

Test set: Average loss: 0.3213, Accuracy: 10758/12000 (90%)

Epoch 16 | Train Acc: 0.9003333333333333 | Test Acc: 0.8965 | Time: 1.0300788879394531 sec

Test set: Average loss: 0.3211, Accuracy: 10758/12000 (90%)

Epoch 17 | Train Acc: 0.9004583333333334 | Test Acc: 0.8965 | Time: 1.3205914497375488 sec

Test set: Average loss: 0.3210, Accuracy: 10762/12000 (90%)

Epoch 18 | Train Acc: 0.900625 | Test Acc: 0.8968333333333334 | Time: 1.1581878662109375 sec

Test set: Average loss: 0.3209, Accuracy: 10761/12000 (90%)

Epoch 19 | Train Acc: 0.9008125 | Test Acc: 0.89675 | Time: 1.0288093090057373 sec

Test set: Average loss: 0.3208, Accuracy: 10765/12000 (90%)

Epoch 20 | Train Acc: 0.900875 | Test Acc: 0.8970833333333333 | Time: 1.3926613330841064 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -21.8221 | Coherence: 26.9488 | Separation: 58.4575 | Information gain: 8.1667 | Grad Norm: 27.4669 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -20.3368 | Coherence: 27.2059 | Separation: 56.3581 | Information gain: 8.1667 | Grad Norm: 25.7261 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -19.1699 | Coherence: 27.4299 | Separation: 54.4698 | Information gain: 8.0000 | Grad Norm: 25.1365 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -17.7920 | Coherence: 27.6483 | Separation: 52.5121 | Information gain: 8.0000 | Grad Norm: 24.8877 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -16.4230 | Coherence: 27.8543 | Separation: 50.5616 | Information gain: 8.0000 | Grad Norm: 24.2122 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -15.0642 | Coherence: 27.9948 | Separation: 48.5938 | Information gain: 8.0000 | Grad Norm: 23.5097 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -13.4166 | Coherence: 28.0910 | Separation: 46.6705 | Information gain: 8.3333 | Grad Norm: 22.7454 | Time: 1.5s
Step 0070 | Epoch 01 | Objective: -12.1760 | Coherence: 28.2683 | Separation: 44.8982 | Information gain: 8.3333 | Grad Norm: 22.7485 | Time: 1.8s
Step 0080 | Epoch 01 | Objective: -10.9718 | Coherence: 28.5409 | Separation: 43.2281 | Information gain: 8.3333 | Grad Norm: 22.2253 | Time: 2.1s
Step 0090 | Epoch 01 | Objective: -9.6386 | Coherence: 28.7885 | Separation: 41.6021 | Information gain: 8.5000 | Grad Norm: 21.0580 | Time: 2.4s
Step 0100 | Epoch 01 | Objective: -8.8467 | Coherence: 28.9973 | Separation: 40.2687 | Information gain: 8.3333 | Grad Norm: 20.0248 | Time: 2.6s
Step 0110 | Epoch 01 | Objective: -7.7726 | Coherence: 29.0763 | Separation: 38.9471 | Information gain: 8.5000 | Grad Norm: 19.5497 | Time: 2.9s
Step 0120 | Epoch 01 | Objective: -7.4739 | Coherence: 29.2134 | Separation: 37.8176 | Information gain: 8.0000 | Grad Norm: 18.6842 | Time: 3.2s
Step 0130 | Epoch 01 | Objective: -6.5504 | Coherence: 29.4434 | Separation: 36.7973 | Information gain: 8.1667 | Grad Norm: 18.6319 | Time: 3.5s
Step 0140 | Epoch 01 | Objective: -5.9418 | Coherence: 29.6964 | Separation: 35.7610 | Information gain: 8.0000 | Grad Norm: 19.1440 | Time: 3.7s
Step 0150 | Epoch 01 | Objective: -5.1784 | Coherence: 29.9127 | Separation: 34.7239 | Information gain: 8.0000 | Grad Norm: 18.2622 | Time: 4.0s
Step 0160 | Epoch 01 | Objective: -4.6173 | Coherence: 30.0840 | Separation: 33.7179 | Information gain: 7.8333 | Grad Norm: 19.2321 | Time: 4.2s
Step 0170 | Epoch 01 | Objective: -3.8800 | Coherence: 30.2898 | Separation: 32.7149 | Information gain: 7.8333 | Grad Norm: 17.9793 | Time: 4.5s
Step 0180 | Epoch 01 | Objective: -3.1491 | Coherence: 30.5124 | Separation: 31.7298 | Information gain: 7.8333 | Grad Norm: 18.4845 | Time: 4.7s
Step 0190 | Epoch 01 | Objective: -2.4282 | Coherence: 30.7681 | Separation: 30.7764 | Information gain: 7.8333 | Grad Norm: 17.9194 | Time: 4.9s
Step 0200 | Epoch 01 | Objective: -1.8374 | Coherence: 31.0601 | Separation: 30.0361 | Information gain: 7.8333 | Grad Norm: 17.4170 | Time: 5.2s
Step 0210 | Epoch 01 | Objective: -1.1432 | Coherence: 31.3569 | Separation: 29.3932 | Information gain: 8.0000 | Grad Norm: 17.5642 | Time: 5.4s
Step 0220 | Epoch 01 | Objective: -0.7092 | Coherence: 31.6146 | Separation: 28.8711 | Information gain: 8.0000 | Grad Norm: 16.6760 | Time: 5.6s
Step 0230 | Epoch 01 | Objective: -0.2869 | Coherence: 31.9052 | Separation: 28.3829 | Information gain: 8.0000 | Grad Norm: 16.8855 | Time: 5.8s
Step 0240 | Epoch 01 | Objective: 0.0947 | Coherence: 32.1617 | Separation: 27.9387 | Information gain: 8.0000 | Grad Norm: 17.1874 | Time: 6.1s
Step 0250 | Epoch 01 | Objective: 0.4723 | Coherence: 32.4016 | Separation: 27.4923 | Information gain: 8.0000 | Grad Norm: 15.6938 | Time: 6.3s
Step 0260 | Epoch 01 | Objective: 0.8613 | Coherence: 32.6066 | Separation: 27.0114 | Information gain: 8.0000 | Grad Norm: 15.9500 | Time: 6.5s
Step 0262 | Epoch 01 | Objective: 0.9356 | Coherence: 32.6418 | Separation: 26.9175 | Information gain: 8.0000 | Grad Norm: 17.2624 | Time: 6.6s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.612545  0.586500  0.462787  ...  0.458556  0.501595  0.473869
1  0.550947  0.580150  0.433930  ...  0.444349  0.477429  0.441989
2  0.440291  0.433392  0.570741  ...  0.273225  0.448221  0.471803
3  0.509643  0.526268  0.360621  ...  0.595805  0.396823  0.452567
4  0.451914  0.493437  0.339915  ...  0.565835  0.338250  0.453393

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8061
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9022
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8841
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.2139, accuracy=0.0945
Testing SVM
  SVM Test Accuracy: 0.8633
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8369

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6473, Accuracy: 9873/12000 (82%)

Epoch 1 | Train Acc: 0.6485208333333333 | Test Acc: 0.82275 | Time: 1.2019448280334473 sec

Test set: Average loss: 0.4940, Accuracy: 10205/12000 (85%)

Epoch 2 | Train Acc: 0.8353125 | Test Acc: 0.8504166666666667 | Time: 1.3029475212097168 sec

Test set: Average loss: 0.4115, Accuracy: 10492/12000 (87%)

Epoch 3 | Train Acc: 0.8659166666666667 | Test Acc: 0.8743333333333333 | Time: 1.1818816661834717 sec

Test set: Average loss: 0.3723, Accuracy: 10639/12000 (89%)

Epoch 4 | Train Acc: 0.8801458333333333 | Test Acc: 0.8865833333333333 | Time: 1.0382471084594727 sec

Test set: Average loss: 0.3521, Accuracy: 10709/12000 (89%)

Epoch 5 | Train Acc: 0.8889583333333333 | Test Acc: 0.8924166666666666 | Time: 1.5485882759094238 sec

Test set: Average loss: 0.3428, Accuracy: 10749/12000 (90%)

Epoch 6 | Train Acc: 0.8943125 | Test Acc: 0.89575 | Time: 1.1264283657073975 sec

Test set: Average loss: 0.3362, Accuracy: 10761/12000 (90%)

Epoch 7 | Train Acc: 0.8982916666666667 | Test Acc: 0.89675 | Time: 1.0334856510162354 sec

Test set: Average loss: 0.3311, Accuracy: 10772/12000 (90%)

Epoch 8 | Train Acc: 0.9001666666666667 | Test Acc: 0.8976666666666666 | Time: 1.3024570941925049 sec

Test set: Average loss: 0.3275, Accuracy: 10786/12000 (90%)

Epoch 9 | Train Acc: 0.9017708333333333 | Test Acc: 0.8988333333333334 | Time: 1.4415359497070312 sec

Test set: Average loss: 0.3244, Accuracy: 10793/12000 (90%)

Epoch 10 | Train Acc: 0.9027083333333333 | Test Acc: 0.8994166666666666 | Time: 1.696101427078247 sec

Test set: Average loss: 0.3223, Accuracy: 10800/12000 (90%)

Epoch 11 | Train Acc: 0.9036458333333334 | Test Acc: 0.9 | Time: 1.1623296737670898 sec

Test set: Average loss: 0.3207, Accuracy: 10800/12000 (90%)

Epoch 12 | Train Acc: 0.9041666666666667 | Test Acc: 0.9 | Time: 1.0235576629638672 sec

Test set: Average loss: 0.3195, Accuracy: 10800/12000 (90%)

Epoch 13 | Train Acc: 0.9046041666666667 | Test Acc: 0.9 | Time: 1.0184712409973145 sec

Test set: Average loss: 0.3188, Accuracy: 10805/12000 (90%)

Epoch 14 | Train Acc: 0.9051041666666667 | Test Acc: 0.9004166666666666 | Time: 1.0250062942504883 sec

Test set: Average loss: 0.3182, Accuracy: 10809/12000 (90%)

Epoch 15 | Train Acc: 0.9056875 | Test Acc: 0.90075 | Time: 1.0307645797729492 sec

Test set: Average loss: 0.3179, Accuracy: 10814/12000 (90%)

Epoch 16 | Train Acc: 0.9057708333333333 | Test Acc: 0.9011666666666667 | Time: 1.3465490341186523 sec

Test set: Average loss: 0.3176, Accuracy: 10820/12000 (90%)

Epoch 17 | Train Acc: 0.9056666666666666 | Test Acc: 0.9016666666666666 | Time: 1.2440409660339355 sec

Test set: Average loss: 0.3174, Accuracy: 10819/12000 (90%)

Epoch 18 | Train Acc: 0.90575 | Test Acc: 0.9015833333333333 | Time: 1.0279765129089355 sec

Test set: Average loss: 0.3173, Accuracy: 10819/12000 (90%)

Epoch 19 | Train Acc: 0.9057916666666667 | Test Acc: 0.9015833333333333 | Time: 1.7153375148773193 sec

Test set: Average loss: 0.3173, Accuracy: 10818/12000 (90%)

Epoch 20 | Train Acc: 0.905875 | Test Acc: 0.9015 | Time: 1.2899327278137207 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -51.9947 | Coherence: 16.1054 | Separation: 57.3631 | Information gain: 8.6667 | Grad Norm: 42.9711 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -49.9303 | Coherence: 16.4276 | Separation: 55.4062 | Information gain: 8.6667 | Grad Norm: 40.8205 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -47.8793 | Coherence: 16.8069 | Separation: 53.4816 | Information gain: 8.6667 | Grad Norm: 39.5114 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -45.7803 | Coherence: 17.1777 | Separation: 51.5062 | Information gain: 8.6667 | Grad Norm: 38.3597 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -43.6813 | Coherence: 17.5551 | Separation: 49.5330 | Information gain: 8.3333 | Grad Norm: 36.8607 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -41.8231 | Coherence: 17.9431 | Separation: 47.8042 | Information gain: 8.3333 | Grad Norm: 36.7784 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -39.9754 | Coherence: 18.2654 | Separation: 46.0639 | Information gain: 8.3333 | Grad Norm: 35.6508 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -38.1075 | Coherence: 18.5850 | Separation: 44.3025 | Information gain: 8.3333 | Grad Norm: 35.6739 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -36.3127 | Coherence: 18.9419 | Separation: 42.6267 | Information gain: 8.3333 | Grad Norm: 34.4946 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -34.6547 | Coherence: 19.3588 | Separation: 41.1077 | Information gain: 8.1667 | Grad Norm: 32.4314 | Time: 2.2s
Step 0100 | Epoch 01 | Objective: -33.1795 | Coherence: 19.8272 | Separation: 39.7886 | Information gain: 8.1667 | Grad Norm: 30.7695 | Time: 2.4s
Step 0110 | Epoch 01 | Objective: -31.9336 | Coherence: 20.2310 | Separation: 38.6773 | Information gain: 8.1667 | Grad Norm: 30.7234 | Time: 2.7s
Step 0120 | Epoch 01 | Objective: -30.9004 | Coherence: 20.5601 | Separation: 37.7537 | Information gain: 8.1667 | Grad Norm: 29.1533 | Time: 3.0s
Step 0130 | Epoch 01 | Objective: -30.0119 | Coherence: 20.9062 | Separation: 36.9806 | Information gain: 8.1667 | Grad Norm: 28.6639 | Time: 3.3s
Step 0140 | Epoch 01 | Objective: -29.1762 | Coherence: 21.2430 | Separation: 36.2572 | Information gain: 8.1667 | Grad Norm: 29.8693 | Time: 3.6s
Step 0150 | Epoch 01 | Objective: -28.3457 | Coherence: 21.5279 | Separation: 35.5216 | Information gain: 8.1667 | Grad Norm: 27.6693 | Time: 3.8s
Step 0160 | Epoch 01 | Objective: -27.4764 | Coherence: 21.8015 | Separation: 34.7435 | Information gain: 8.0000 | Grad Norm: 28.6287 | Time: 4.1s
Step 0170 | Epoch 01 | Objective: -26.6356 | Coherence: 22.0972 | Separation: 34.0013 | Information gain: 8.0000 | Grad Norm: 27.4821 | Time: 4.4s
Step 0180 | Epoch 01 | Objective: -25.7489 | Coherence: 22.4313 | Separation: 33.2260 | Information gain: 7.8333 | Grad Norm: 27.7151 | Time: 4.7s
Step 0190 | Epoch 01 | Objective: -24.8911 | Coherence: 22.7412 | Separation: 32.4715 | Information gain: 7.8333 | Grad Norm: 28.2305 | Time: 5.0s
Step 0200 | Epoch 01 | Objective: -24.0090 | Coherence: 23.0725 | Separation: 31.6999 | Information gain: 7.8333 | Grad Norm: 27.7990 | Time: 5.3s
Step 0210 | Epoch 01 | Objective: -23.1105 | Coherence: 23.3841 | Separation: 30.9052 | Information gain: 7.8333 | Grad Norm: 29.9325 | Time: 5.6s
Step 0220 | Epoch 01 | Objective: -22.2319 | Coherence: 23.7182 | Separation: 30.1380 | Information gain: 7.8333 | Grad Norm: 27.4327 | Time: 5.9s
Step 0230 | Epoch 01 | Objective: -21.3272 | Coherence: 24.0666 | Separation: 29.3494 | Information gain: 8.1667 | Grad Norm: 28.3392 | Time: 6.2s
Step 0240 | Epoch 01 | Objective: -20.4089 | Coherence: 24.4348 | Separation: 28.5539 | Information gain: 8.0000 | Grad Norm: 27.4765 | Time: 6.4s
Step 0250 | Epoch 01 | Objective: -19.5292 | Coherence: 24.8136 | Separation: 27.8004 | Information gain: 8.0000 | Grad Norm: 27.9878 | Time: 6.7s
Step 0260 | Epoch 01 | Objective: -18.7504 | Coherence: 25.2185 | Separation: 27.1566 | Information gain: 8.0000 | Grad Norm: 27.0177 | Time: 6.9s
Step 0270 | Epoch 01 | Objective: -18.0018 | Coherence: 25.6142 | Separation: 26.5399 | Information gain: 8.0000 | Grad Norm: 26.0843 | Time: 7.1s
Step 0280 | Epoch 01 | Objective: -17.3462 | Coherence: 25.9680 | Separation: 26.0022 | Information gain: 8.1667 | Grad Norm: 24.8076 | Time: 7.3s
Step 0290 | Epoch 01 | Objective: -16.6978 | Coherence: 26.2863 | Separation: 25.4599 | Information gain: 8.1667 | Grad Norm: 26.4453 | Time: 7.6s
Step 0300 | Epoch 01 | Objective: -16.0814 | Coherence: 26.5968 | Separation: 24.9470 | Information gain: 8.3333 | Grad Norm: 26.4962 | Time: 7.8s
Step 0310 | Epoch 01 | Objective: -15.5367 | Coherence: 26.9044 | Separation: 24.5049 | Information gain: 8.5000 | Grad Norm: 24.5977 | Time: 8.0s
Step 0320 | Epoch 01 | Objective: -15.0303 | Coherence: 27.1434 | Separation: 24.0781 | Information gain: 8.5000 | Grad Norm: 25.3728 | Time: 8.3s
Step 0330 | Epoch 01 | Objective: -14.4956 | Coherence: 27.3769 | Separation: 23.6213 | Information gain: 8.5000 | Grad Norm: 26.5087 | Time: 8.5s
Step 0340 | Epoch 01 | Objective: -14.0652 | Coherence: 27.5821 | Separation: 23.2593 | Information gain: 8.6667 | Grad Norm: 26.6093 | Time: 8.7s
Step 0350 | Epoch 01 | Objective: -13.6872 | Coherence: 27.7849 | Separation: 22.9488 | Information gain: 8.6667 | Grad Norm: 23.8428 | Time: 9.0s
Step 0360 | Epoch 01 | Objective: -13.3214 | Coherence: 28.0559 | Separation: 22.6733 | Information gain: 8.6667 | Grad Norm: 24.8794 | Time: 9.2s
Step 0370 | Epoch 01 | Objective: -12.9468 | Coherence: 28.3504 | Separation: 22.3969 | Information gain: 8.6667 | Grad Norm: 23.0097 | Time: 9.4s
Step 0380 | Epoch 01 | Objective: -12.6496 | Coherence: 28.6263 | Separation: 22.1917 | Information gain: 8.6667 | Grad Norm: 24.4093 | Time: 9.7s
Step 0390 | Epoch 01 | Objective: -12.3895 | Coherence: 28.8161 | Separation: 21.9949 | Information gain: 8.5000 | Grad Norm: 24.3573 | Time: 9.9s
Step 0400 | Epoch 01 | Objective: -12.1196 | Coherence: 28.9759 | Separation: 21.7782 | Information gain: 8.5000 | Grad Norm: 24.4650 | Time: 10.2s
Step 0410 | Epoch 01 | Objective: -11.8537 | Coherence: 29.1536 | Separation: 21.5716 | Information gain: 8.5000 | Grad Norm: 24.1768 | Time: 10.5s
Step 0420 | Epoch 01 | Objective: -11.5848 | Coherence: 29.3249 | Separation: 21.3598 | Information gain: 8.5000 | Grad Norm: 24.1576 | Time: 10.8s
Step 0430 | Epoch 01 | Objective: -11.2944 | Coherence: 29.5197 | Separation: 21.1343 | Information gain: 8.5000 | Grad Norm: 22.7554 | Time: 11.1s
Step 0440 | Epoch 01 | Objective: -10.9975 | Coherence: 29.6985 | Separation: 20.8971 | Information gain: 8.5000 | Grad Norm: 24.5769 | Time: 11.4s
Step 0450 | Epoch 01 | Objective: -10.6883 | Coherence: 29.8748 | Separation: 20.6466 | Information gain: 8.5000 | Grad Norm: 24.3935 | Time: 11.7s
Step 0460 | Epoch 01 | Objective: -10.3633 | Coherence: 30.0523 | Separation: 20.3807 | Information gain: 8.5000 | Grad Norm: 25.3444 | Time: 12.0s
Step 0470 | Epoch 01 | Objective: -10.0254 | Coherence: 30.2264 | Separation: 20.1008 | Information gain: 8.5000 | Grad Norm: 24.9881 | Time: 12.2s
Step 0480 | Epoch 01 | Objective: -9.6767 | Coherence: 30.4021 | Separation: 19.8107 | Information gain: 8.5000 | Grad Norm: 25.2819 | Time: 12.5s
Step 0490 | Epoch 01 | Objective: -9.3385 | Coherence: 30.5714 | Separation: 19.5289 | Information gain: 8.5000 | Grad Norm: 22.5550 | Time: 12.7s
Step 0500 | Epoch 01 | Objective: -9.0300 | Coherence: 30.7283 | Separation: 19.2728 | Information gain: 8.5000 | Grad Norm: 28.5108 | Time: 12.9s
Step 0510 | Epoch 01 | Objective: -8.8273 | Coherence: 30.9046 | Separation: 19.1289 | Information gain: 8.5000 | Grad Norm: 26.1021 | Time: 13.2s
Step 0520 | Epoch 01 | Objective: -8.6587 | Coherence: 31.0781 | Separation: 19.0180 | Information gain: 8.5000 | Grad Norm: 24.9937 | Time: 13.5s
Step 0530 | Epoch 01 | Objective: -8.4790 | Coherence: 31.2581 | Separation: 18.8984 | Information gain: 8.5000 | Grad Norm: 24.5133 | Time: 13.7s
Step 0540 | Epoch 01 | Objective: -8.3150 | Coherence: 31.4317 | Separation: 18.7922 | Information gain: 8.5000 | Grad Norm: 25.3149 | Time: 14.0s
Step 0550 | Epoch 01 | Objective: -8.1288 | Coherence: 31.6171 | Separation: 18.6678 | Information gain: 8.5000 | Grad Norm: 25.7994 | Time: 14.2s
Step 0560 | Epoch 01 | Objective: -7.9482 | Coherence: 31.7882 | Separation: 18.5442 | Information gain: 8.3333 | Grad Norm: 25.8882 | Time: 14.4s
Step 0570 | Epoch 01 | Objective: -7.7523 | Coherence: 31.9657 | Separation: 18.4076 | Information gain: 8.3333 | Grad Norm: 27.0257 | Time: 14.7s
Step 0580 | Epoch 01 | Objective: -7.5563 | Coherence: 32.1447 | Separation: 18.2712 | Information gain: 8.3333 | Grad Norm: 26.1215 | Time: 14.9s
Step 0590 | Epoch 01 | Objective: -7.3558 | Coherence: 32.3302 | Separation: 18.1325 | Information gain: 8.3333 | Grad Norm: 26.9786 | Time: 15.1s
Step 0600 | Epoch 01 | Objective: -7.1400 | Coherence: 32.4903 | Separation: 17.9701 | Information gain: 8.3333 | Grad Norm: 29.2051 | Time: 15.4s
Step 0610 | Epoch 01 | Objective: -6.9265 | Coherence: 32.6790 | Separation: 17.8195 | Information gain: 8.3333 | Grad Norm: 27.4727 | Time: 15.6s
Step 0620 | Epoch 01 | Objective: -6.6971 | Coherence: 32.8497 | Separation: 17.6470 | Information gain: 8.3333 | Grad Norm: 27.6591 | Time: 15.8s
Step 0630 | Epoch 01 | Objective: -6.4634 | Coherence: 33.0336 | Separation: 17.4746 | Information gain: 8.3333 | Grad Norm: 25.2773 | Time: 16.1s
Step 0640 | Epoch 01 | Objective: -6.2677 | Coherence: 33.2061 | Separation: 17.3364 | Information gain: 8.3333 | Grad Norm: 28.3786 | Time: 16.4s
Step 0650 | Epoch 01 | Objective: -6.0979 | Coherence: 33.3490 | Separation: 17.2142 | Information gain: 8.3333 | Grad Norm: 26.2468 | Time: 16.7s
Step 0660 | Epoch 01 | Objective: -5.9360 | Coherence: 33.4948 | Separation: 17.1009 | Information gain: 8.3333 | Grad Norm: 27.3369 | Time: 16.9s
Step 0670 | Epoch 01 | Objective: -5.7849 | Coherence: 33.6449 | Separation: 16.9999 | Information gain: 8.3333 | Grad Norm: 27.2654 | Time: 17.2s
Step 0680 | Epoch 01 | Objective: -5.6171 | Coherence: 33.7757 | Separation: 16.8756 | Information gain: 8.3333 | Grad Norm: 25.3659 | Time: 17.4s
Step 0690 | Epoch 01 | Objective: -5.4452 | Coherence: 33.9074 | Separation: 16.7477 | Information gain: 8.3333 | Grad Norm: 24.1851 | Time: 17.6s
Step 0700 | Epoch 01 | Objective: -5.2800 | Coherence: 34.0300 | Separation: 16.6234 | Information gain: 8.3333 | Grad Norm: 28.1202 | Time: 17.8s
Step 0710 | Epoch 01 | Objective: -5.0984 | Coherence: 34.1684 | Separation: 16.4878 | Information gain: 8.3333 | Grad Norm: 27.1329 | Time: 18.1s
Step 0720 | Epoch 01 | Objective: -4.9120 | Coherence: 34.3031 | Separation: 16.3464 | Information gain: 8.3333 | Grad Norm: 28.1796 | Time: 18.3s
Step 0730 | Epoch 01 | Objective: -4.7202 | Coherence: 34.4288 | Separation: 16.1964 | Information gain: 8.3333 | Grad Norm: 25.5643 | Time: 18.6s
Step 0740 | Epoch 01 | Objective: -4.5281 | Coherence: 34.5556 | Separation: 16.0466 | Information gain: 8.1667 | Grad Norm: 27.0592 | Time: 18.9s
Step 0750 | Epoch 01 | Objective: -4.3705 | Coherence: 34.6735 | Separation: 15.9283 | Information gain: 8.1667 | Grad Norm: 26.1809 | Time: 19.2s
Step 0760 | Epoch 01 | Objective: -4.1895 | Coherence: 34.7665 | Separation: 15.7784 | Information gain: 8.3333 | Grad Norm: 25.4346 | Time: 19.4s
Step 0770 | Epoch 01 | Objective: -4.0178 | Coherence: 34.8733 | Separation: 15.6422 | Information gain: 8.3333 | Grad Norm: 27.4388 | Time: 19.7s
Step 0780 | Epoch 01 | Objective: -3.8452 | Coherence: 34.9840 | Separation: 15.5065 | Information gain: 8.3333 | Grad Norm: 26.0427 | Time: 19.9s
Step 0790 | Epoch 01 | Objective: -3.6600 | Coherence: 35.0831 | Separation: 15.3544 | Information gain: 8.3333 | Grad Norm: 26.2944 | Time: 20.2s
Step 0800 | Epoch 01 | Objective: -3.4863 | Coherence: 35.1806 | Separation: 15.2132 | Information gain: 8.3333 | Grad Norm: 27.6967 | Time: 20.5s
Step 0810 | Epoch 01 | Objective: -3.2908 | Coherence: 35.2885 | Separation: 15.0537 | Information gain: 8.3333 | Grad Norm: 27.5002 | Time: 20.8s
Step 0820 | Epoch 01 | Objective: -3.0990 | Coherence: 35.3713 | Separation: 14.8894 | Information gain: 8.3333 | Grad Norm: 27.0061 | Time: 21.1s
Step 0830 | Epoch 01 | Objective: -2.9011 | Coherence: 35.4720 | Separation: 14.7251 | Information gain: 8.3333 | Grad Norm: 28.3447 | Time: 21.4s
Step 0840 | Epoch 01 | Objective: -2.7003 | Coherence: 35.5693 | Separation: 14.5567 | Information gain: 8.3333 | Grad Norm: 25.1215 | Time: 21.7s
Step 0850 | Epoch 01 | Objective: -2.4899 | Coherence: 35.6574 | Separation: 14.3756 | Information gain: 8.5000 | Grad Norm: 28.1800 | Time: 21.9s
Step 0860 | Epoch 01 | Objective: -2.2750 | Coherence: 35.7481 | Separation: 14.1911 | Information gain: 8.5000 | Grad Norm: 27.1317 | Time: 22.2s
Step 0870 | Epoch 01 | Objective: -2.0550 | Coherence: 35.8372 | Separation: 14.0007 | Information gain: 8.3333 | Grad Norm: 29.3494 | Time: 22.5s
Step 0880 | Epoch 01 | Objective: -1.8229 | Coherence: 35.9309 | Separation: 13.7999 | Information gain: 8.3333 | Grad Norm: 28.2431 | Time: 22.7s
Step 0890 | Epoch 01 | Objective: -1.6213 | Coherence: 35.9943 | Separation: 13.6194 | Information gain: 8.3333 | Grad Norm: 29.7600 | Time: 23.0s
Step 0900 | Epoch 01 | Objective: -1.4432 | Coherence: 36.0691 | Separation: 13.4662 | Information gain: 8.3333 | Grad Norm: 29.4496 | Time: 23.2s
Step 0910 | Epoch 01 | Objective: -1.2887 | Coherence: 36.1266 | Separation: 13.3309 | Information gain: 8.3333 | Grad Norm: 25.5939 | Time: 23.4s
Step 0920 | Epoch 01 | Objective: -1.1239 | Coherence: 36.1833 | Separation: 13.1850 | Information gain: 8.3333 | Grad Norm: 26.4997 | Time: 23.6s
Step 0930 | Epoch 01 | Objective: -0.9691 | Coherence: 36.2429 | Separation: 13.0501 | Information gain: 8.3333 | Grad Norm: 26.4261 | Time: 23.9s
Step 0940 | Epoch 01 | Objective: -0.8065 | Coherence: 36.2971 | Separation: 12.9055 | Information gain: 8.3333 | Grad Norm: 29.7863 | Time: 24.1s
Step 0950 | Epoch 01 | Objective: -0.6496 | Coherence: 36.3574 | Separation: 12.7688 | Information gain: 8.3333 | Grad Norm: 26.4908 | Time: 24.3s
Step 0960 | Epoch 01 | Objective: -0.4889 | Coherence: 36.4120 | Separation: 12.6262 | Information gain: 8.3333 | Grad Norm: 29.4161 | Time: 24.5s
Step 0970 | Epoch 01 | Objective: -0.3250 | Coherence: 36.4529 | Separation: 12.4759 | Information gain: 8.3333 | Grad Norm: 28.2218 | Time: 24.8s
Step 0980 | Epoch 01 | Objective: -0.1603 | Coherence: 36.5034 | Separation: 12.3281 | Information gain: 8.3333 | Grad Norm: 28.8553 | Time: 25.0s
Step 0990 | Epoch 01 | Objective: 0.0011 | Coherence: 36.5518 | Separation: 12.1828 | Information gain: 8.3333 | Grad Norm: 26.5726 | Time: 25.2s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.563492  0.392364 -0.459718  ...  0.519164  0.285373  0.295899
1  0.392230  0.630857 -0.577750  ...  0.504082  0.474252  0.473955
2  0.461913  0.565846 -0.612368  ...  0.482967  0.428946  0.425823
3  0.358583  0.485738 -0.407704  ...  0.501060  0.357162  0.368157
4  0.377334  0.528042 -0.503822  ...  0.473941  0.438322  0.436066

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7921
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8953
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8776
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.9637, accuracy=0.0860
Testing SVM
  SVM Test Accuracy: 0.8533
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8292

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7038, Accuracy: 9522/12000 (79%)

Epoch 1 | Train Acc: 0.6755833333333333 | Test Acc: 0.7935 | Time: 1.0292704105377197 sec

Test set: Average loss: 0.4850, Accuracy: 10173/12000 (85%)

Epoch 2 | Train Acc: 0.8253541666666667 | Test Acc: 0.84775 | Time: 1.0318052768707275 sec

Test set: Average loss: 0.4207, Accuracy: 10398/12000 (87%)

Epoch 3 | Train Acc: 0.8518958333333333 | Test Acc: 0.8665 | Time: 1.021162748336792 sec

Test set: Average loss: 0.3876, Accuracy: 10541/12000 (88%)

Epoch 4 | Train Acc: 0.8681666666666666 | Test Acc: 0.8784166666666666 | Time: 1.0217795372009277 sec

Test set: Average loss: 0.3659, Accuracy: 10618/12000 (88%)

Epoch 5 | Train Acc: 0.8778541666666667 | Test Acc: 0.8848333333333334 | Time: 1.024693250656128 sec

Test set: Average loss: 0.3504, Accuracy: 10687/12000 (89%)

Epoch 6 | Train Acc: 0.8843125 | Test Acc: 0.8905833333333333 | Time: 1.1303918361663818 sec

Test set: Average loss: 0.3405, Accuracy: 10717/12000 (89%)

Epoch 7 | Train Acc: 0.8897083333333333 | Test Acc: 0.8930833333333333 | Time: 1.0353190898895264 sec

Test set: Average loss: 0.3332, Accuracy: 10761/12000 (90%)

Epoch 8 | Train Acc: 0.8927291666666667 | Test Acc: 0.89675 | Time: 1.026137113571167 sec

Test set: Average loss: 0.3285, Accuracy: 10783/12000 (90%)

Epoch 9 | Train Acc: 0.8949791666666667 | Test Acc: 0.8985833333333333 | Time: 1.0208730697631836 sec

Test set: Average loss: 0.3253, Accuracy: 10791/12000 (90%)

Epoch 10 | Train Acc: 0.8966458333333334 | Test Acc: 0.89925 | Time: 1.033355712890625 sec

Test set: Average loss: 0.3231, Accuracy: 10799/12000 (90%)

Epoch 11 | Train Acc: 0.8973958333333333 | Test Acc: 0.8999166666666667 | Time: 1.03057861328125 sec

Test set: Average loss: 0.3214, Accuracy: 10798/12000 (90%)

Epoch 12 | Train Acc: 0.8983125 | Test Acc: 0.8998333333333334 | Time: 1.028817892074585 sec

Test set: Average loss: 0.3202, Accuracy: 10809/12000 (90%)

Epoch 13 | Train Acc: 0.8988541666666666 | Test Acc: 0.90075 | Time: 1.0697541236877441 sec

Test set: Average loss: 0.3194, Accuracy: 10805/12000 (90%)

Epoch 14 | Train Acc: 0.8995 | Test Acc: 0.9004166666666666 | Time: 1.1461231708526611 sec

Test set: Average loss: 0.3188, Accuracy: 10809/12000 (90%)

Epoch 15 | Train Acc: 0.89975 | Test Acc: 0.90075 | Time: 1.0385468006134033 sec

Test set: Average loss: 0.3185, Accuracy: 10812/12000 (90%)

Epoch 16 | Train Acc: 0.8999583333333333 | Test Acc: 0.901 | Time: 1.0378262996673584 sec

Test set: Average loss: 0.3183, Accuracy: 10813/12000 (90%)

Epoch 17 | Train Acc: 0.9001041666666667 | Test Acc: 0.9010833333333333 | Time: 1.0292737483978271 sec

Test set: Average loss: 0.3181, Accuracy: 10811/12000 (90%)

Epoch 18 | Train Acc: 0.9001041666666667 | Test Acc: 0.9009166666666667 | Time: 1.0326120853424072 sec

Test set: Average loss: 0.3180, Accuracy: 10812/12000 (90%)

Epoch 19 | Train Acc: 0.900125 | Test Acc: 0.901 | Time: 1.030876636505127 sec

Test set: Average loss: 0.3179, Accuracy: 10812/12000 (90%)

Epoch 20 | Train Acc: 0.9001458333333333 | Test Acc: 0.901 | Time: 1.0261502265930176 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -45.0752 | Coherence: 14.2013 | Separation: 52.0868 | Information gain: 6.8333 | Grad Norm: 36.6678 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -43.2655 | Coherence: 14.5532 | Separation: 50.3388 | Information gain: 6.6667 | Grad Norm: 36.1651 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -41.5186 | Coherence: 14.9578 | Separation: 48.6712 | Information gain: 6.5000 | Grad Norm: 35.2446 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -39.8722 | Coherence: 15.3528 | Separation: 47.1564 | Information gain: 6.5000 | Grad Norm: 32.6197 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: -38.4208 | Coherence: 15.7249 | Separation: 45.8291 | Information gain: 6.5000 | Grad Norm: 32.4646 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -36.8477 | Coherence: 16.1107 | Separation: 44.4401 | Information gain: 6.6667 | Grad Norm: 33.5284 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -35.3743 | Coherence: 16.5145 | Separation: 43.1013 | Information gain: 6.6667 | Grad Norm: 31.2658 | Time: 1.5s
Step 0070 | Epoch 01 | Objective: -34.1510 | Coherence: 16.9093 | Separation: 41.9541 | Information gain: 6.5000 | Grad Norm: 30.3476 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -32.8737 | Coherence: 17.2991 | Separation: 40.8067 | Information gain: 6.5000 | Grad Norm: 29.2916 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -31.6600 | Coherence: 17.7013 | Separation: 39.7827 | Information gain: 6.6667 | Grad Norm: 29.9669 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -30.5516 | Coherence: 18.1184 | Separation: 38.8132 | Information gain: 6.6667 | Grad Norm: 29.1869 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -29.5707 | Coherence: 18.4625 | Separation: 37.9471 | Information gain: 6.6667 | Grad Norm: 29.8000 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -28.5237 | Coherence: 18.7694 | Separation: 37.0579 | Information gain: 6.8333 | Grad Norm: 29.0507 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -27.5488 | Coherence: 19.0950 | Separation: 36.1916 | Information gain: 6.8333 | Grad Norm: 29.7426 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -26.6005 | Coherence: 19.4240 | Separation: 35.3529 | Information gain: 6.8333 | Grad Norm: 28.4719 | Time: 3.3s
Step 0150 | Epoch 01 | Objective: -25.7475 | Coherence: 19.7493 | Separation: 34.6084 | Information gain: 6.8333 | Grad Norm: 25.7518 | Time: 3.5s
Step 0160 | Epoch 01 | Objective: -24.9892 | Coherence: 20.0790 | Separation: 33.9044 | Information gain: 6.6667 | Grad Norm: 26.1871 | Time: 3.7s
Step 0170 | Epoch 01 | Objective: -24.2060 | Coherence: 20.4048 | Separation: 33.2298 | Information gain: 6.6667 | Grad Norm: 27.9489 | Time: 4.0s
Step 0180 | Epoch 01 | Objective: -23.3943 | Coherence: 20.7148 | Separation: 32.5215 | Information gain: 6.6667 | Grad Norm: 26.2035 | Time: 4.2s
Step 0190 | Epoch 01 | Objective: -22.5794 | Coherence: 21.0582 | Separation: 31.8210 | Information gain: 6.6667 | Grad Norm: 25.8155 | Time: 4.4s
Step 0200 | Epoch 01 | Objective: -21.7614 | Coherence: 21.3890 | Separation: 31.1133 | Information gain: 6.6667 | Grad Norm: 28.2034 | Time: 4.7s
Step 0210 | Epoch 01 | Objective: -20.8961 | Coherence: 21.6949 | Separation: 30.3500 | Information gain: 6.6667 | Grad Norm: 27.1940 | Time: 4.9s
Step 0220 | Epoch 01 | Objective: -20.0235 | Coherence: 22.0123 | Separation: 29.5831 | Information gain: 6.6667 | Grad Norm: 28.6719 | Time: 5.1s
Step 0230 | Epoch 01 | Objective: -19.1421 | Coherence: 22.3726 | Separation: 28.8219 | Information gain: 6.6667 | Grad Norm: 27.8933 | Time: 5.4s
Step 0240 | Epoch 01 | Objective: -18.2647 | Coherence: 22.7371 | Separation: 28.1215 | Information gain: 6.8333 | Grad Norm: 28.5084 | Time: 5.6s
Step 0250 | Epoch 01 | Objective: -17.4696 | Coherence: 23.1018 | Separation: 27.5035 | Information gain: 7.0000 | Grad Norm: 25.9148 | Time: 5.8s
Step 0260 | Epoch 01 | Objective: -16.6836 | Coherence: 23.4580 | Separation: 26.8363 | Information gain: 7.0000 | Grad Norm: 24.7632 | Time: 6.0s
Step 0270 | Epoch 01 | Objective: -15.9026 | Coherence: 23.8107 | Separation: 26.1729 | Information gain: 7.0000 | Grad Norm: 26.0002 | Time: 6.3s
Step 0280 | Epoch 01 | Objective: -15.2715 | Coherence: 24.1220 | Separation: 25.6455 | Information gain: 7.0000 | Grad Norm: 23.9391 | Time: 6.5s
Step 0290 | Epoch 01 | Objective: -14.6515 | Coherence: 24.4178 | Separation: 25.1796 | Information gain: 7.1667 | Grad Norm: 25.0500 | Time: 6.7s
Step 0300 | Epoch 01 | Objective: -14.1107 | Coherence: 24.7198 | Separation: 24.6840 | Information gain: 7.0000 | Grad Norm: 26.3219 | Time: 7.0s
Step 0310 | Epoch 01 | Objective: -13.5085 | Coherence: 25.0281 | Separation: 24.1846 | Information gain: 7.0000 | Grad Norm: 27.0509 | Time: 7.2s
Step 0320 | Epoch 01 | Objective: -12.8839 | Coherence: 25.3460 | Separation: 23.6659 | Information gain: 7.0000 | Grad Norm: 27.7748 | Time: 7.4s
Step 0330 | Epoch 01 | Objective: -12.2079 | Coherence: 25.6410 | Separation: 23.1438 | Information gain: 7.1667 | Grad Norm: 29.9186 | Time: 7.6s
Step 0340 | Epoch 01 | Objective: -11.6371 | Coherence: 25.9549 | Separation: 22.7332 | Information gain: 7.3333 | Grad Norm: 27.8120 | Time: 7.9s
Step 0350 | Epoch 01 | Objective: -11.0975 | Coherence: 26.2576 | Separation: 22.2945 | Information gain: 7.3333 | Grad Norm: 26.5749 | Time: 8.1s
Step 0360 | Epoch 01 | Objective: -10.5484 | Coherence: 26.5675 | Separation: 21.8487 | Information gain: 7.3333 | Grad Norm: 26.6536 | Time: 8.3s
Step 0370 | Epoch 01 | Objective: -10.0287 | Coherence: 26.8633 | Separation: 21.4276 | Information gain: 7.3333 | Grad Norm: 29.0764 | Time: 8.5s
Step 0380 | Epoch 01 | Objective: -9.5621 | Coherence: 27.2185 | Separation: 21.0794 | Information gain: 7.3333 | Grad Norm: 25.1922 | Time: 8.8s
Step 0390 | Epoch 01 | Objective: -9.0785 | Coherence: 27.5540 | Separation: 20.7076 | Information gain: 7.3333 | Grad Norm: 26.1985 | Time: 9.0s
Step 0400 | Epoch 01 | Objective: -8.5937 | Coherence: 27.8958 | Separation: 20.3367 | Information gain: 7.3333 | Grad Norm: 26.2364 | Time: 9.2s
Step 0410 | Epoch 01 | Objective: -8.1223 | Coherence: 28.2473 | Separation: 19.9825 | Information gain: 7.3333 | Grad Norm: 26.9199 | Time: 9.5s
Step 0420 | Epoch 01 | Objective: -7.6328 | Coherence: 28.5961 | Separation: 19.6093 | Information gain: 7.3333 | Grad Norm: 23.5402 | Time: 9.7s
Step 0430 | Epoch 01 | Objective: -7.1431 | Coherence: 28.9307 | Separation: 19.2311 | Information gain: 7.3333 | Grad Norm: 26.1076 | Time: 9.9s
Step 0440 | Epoch 01 | Objective: -6.7409 | Coherence: 29.2681 | Separation: 18.9414 | Information gain: 7.3333 | Grad Norm: 23.9537 | Time: 10.1s
Step 0450 | Epoch 01 | Objective: -6.3989 | Coherence: 29.5615 | Separation: 18.6972 | Information gain: 7.3333 | Grad Norm: 26.2666 | Time: 10.4s
Step 0460 | Epoch 01 | Objective: -6.0600 | Coherence: 29.8521 | Separation: 18.4551 | Information gain: 7.3333 | Grad Norm: 24.1042 | Time: 10.6s
Step 0470 | Epoch 01 | Objective: -5.7496 | Coherence: 30.1348 | Separation: 18.2390 | Information gain: 7.3333 | Grad Norm: 25.6486 | Time: 10.8s
Step 0480 | Epoch 01 | Objective: -5.4300 | Coherence: 30.4067 | Separation: 18.0100 | Information gain: 7.3333 | Grad Norm: 27.0087 | Time: 11.1s
Step 0490 | Epoch 01 | Objective: -5.1116 | Coherence: 30.6630 | Separation: 17.7771 | Information gain: 7.3333 | Grad Norm: 27.7584 | Time: 11.3s
Step 0500 | Epoch 01 | Objective: -4.7921 | Coherence: 30.9178 | Separation: 17.5425 | Information gain: 7.3333 | Grad Norm: 27.0268 | Time: 11.5s
Step 0510 | Epoch 01 | Objective: -4.4630 | Coherence: 31.1691 | Separation: 17.2972 | Information gain: 7.3333 | Grad Norm: 28.4503 | Time: 11.8s
Step 0520 | Epoch 01 | Objective: -4.1293 | Coherence: 31.4109 | Separation: 17.0440 | Information gain: 7.3333 | Grad Norm: 25.8432 | Time: 12.0s
Step 0530 | Epoch 01 | Objective: -3.8005 | Coherence: 31.6327 | Separation: 16.7892 | Information gain: 7.3333 | Grad Norm: 27.7076 | Time: 12.2s
Step 0540 | Epoch 01 | Objective: -3.4743 | Coherence: 31.8133 | Separation: 16.5232 | Information gain: 7.3333 | Grad Norm: 27.3539 | Time: 12.4s
Step 0550 | Epoch 01 | Objective: -3.1529 | Coherence: 31.9783 | Separation: 16.2568 | Information gain: 7.3333 | Grad Norm: 28.0863 | Time: 12.7s
Step 0560 | Epoch 01 | Objective: -2.9417 | Coherence: 32.0891 | Separation: 16.0825 | Information gain: 7.3333 | Grad Norm: 27.7405 | Time: 12.9s
Step 0570 | Epoch 01 | Objective: -2.7219 | Coherence: 32.1530 | Separation: 15.8841 | Information gain: 7.3333 | Grad Norm: 28.9389 | Time: 13.1s
Step 0580 | Epoch 01 | Objective: -2.4472 | Coherence: 32.2374 | Separation: 15.6930 | Information gain: 7.5000 | Grad Norm: 27.6590 | Time: 13.3s
Step 0590 | Epoch 01 | Objective: -2.2796 | Coherence: 32.2785 | Separation: 15.5391 | Information gain: 7.5000 | Grad Norm: 28.9419 | Time: 13.6s
Step 0600 | Epoch 01 | Objective: -2.0982 | Coherence: 32.3058 | Separation: 15.3668 | Information gain: 7.5000 | Grad Norm: 29.3085 | Time: 13.8s
Step 0610 | Epoch 01 | Objective: -1.8501 | Coherence: 32.3363 | Separation: 15.1845 | Information gain: 7.6667 | Grad Norm: 28.6167 | Time: 14.0s
Step 0620 | Epoch 01 | Objective: -1.6569 | Coherence: 32.3530 | Separation: 14.9967 | Information gain: 7.6667 | Grad Norm: 26.0703 | Time: 14.3s
Step 0630 | Epoch 01 | Objective: -1.4622 | Coherence: 32.3784 | Separation: 14.8105 | Information gain: 7.6667 | Grad Norm: 25.9813 | Time: 14.5s
Step 0640 | Epoch 01 | Objective: -1.2753 | Coherence: 32.3963 | Separation: 14.6297 | Information gain: 7.6667 | Grad Norm: 25.0097 | Time: 14.7s
Step 0650 | Epoch 01 | Objective: -1.0480 | Coherence: 32.4192 | Separation: 14.4655 | Information gain: 7.8333 | Grad Norm: 26.8695 | Time: 14.9s
Step 0660 | Epoch 01 | Objective: -0.8679 | Coherence: 32.4622 | Separation: 14.2997 | Information gain: 7.8333 | Grad Norm: 29.4785 | Time: 15.1s
Step 0670 | Epoch 01 | Objective: -0.6908 | Coherence: 32.4912 | Separation: 14.1324 | Information gain: 7.8333 | Grad Norm: 26.1551 | Time: 15.4s
Step 0680 | Epoch 01 | Objective: -0.5019 | Coherence: 32.5109 | Separation: 13.9500 | Information gain: 7.8333 | Grad Norm: 28.3318 | Time: 15.6s
Step 0690 | Epoch 01 | Objective: -0.2664 | Coherence: 32.5353 | Separation: 13.7782 | Information gain: 8.0000 | Grad Norm: 30.1938 | Time: 15.8s
Step 0700 | Epoch 01 | Objective: -0.0926 | Coherence: 32.5621 | Separation: 13.6133 | Information gain: 8.0000 | Grad Norm: 29.5302 | Time: 16.1s
Step 0710 | Epoch 01 | Objective: 0.0402 | Coherence: 32.6010 | Separation: 13.4935 | Information gain: 8.0000 | Grad Norm: 27.8120 | Time: 16.3s
Step 0720 | Epoch 01 | Objective: 0.1731 | Coherence: 32.6317 | Separation: 13.3708 | Information gain: 8.0000 | Grad Norm: 28.8432 | Time: 16.6s
Step 0730 | Epoch 01 | Objective: 0.2482 | Coherence: 32.6643 | Separation: 13.2510 | Information gain: 7.8333 | Grad Norm: 28.7815 | Time: 16.8s
Step 0740 | Epoch 01 | Objective: 0.3639 | Coherence: 32.6934 | Separation: 13.1450 | Information gain: 7.8333 | Grad Norm: 30.7688 | Time: 17.0s
Step 0750 | Epoch 01 | Objective: 0.4904 | Coherence: 32.7383 | Separation: 13.0334 | Information gain: 7.8333 | Grad Norm: 28.2177 | Time: 17.3s
Step 0760 | Epoch 01 | Objective: 0.5960 | Coherence: 32.7701 | Separation: 12.9385 | Information gain: 7.8333 | Grad Norm: 27.8052 | Time: 17.5s
Step 0770 | Epoch 01 | Objective: 0.6986 | Coherence: 32.8154 | Separation: 12.8509 | Information gain: 7.8333 | Grad Norm: 29.5107 | Time: 17.7s
Step 0780 | Epoch 01 | Objective: 0.8017 | Coherence: 32.8615 | Separation: 12.7632 | Information gain: 7.8333 | Grad Norm: 31.4510 | Time: 18.0s
Step 0790 | Epoch 01 | Objective: 0.9016 | Coherence: 32.9207 | Separation: 12.6831 | Information gain: 7.8333 | Grad Norm: 30.9865 | Time: 18.2s
Step 0790 | Epoch 01 | Objective: 0.9016 | Coherence: 32.9207 | Separation: 12.6831 | Information gain: 7.8333 | Grad Norm: 30.9865 | Time: 18.2s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.630796  0.507564  0.480944  ...  0.463176  0.501886  0.483437
1  0.455883  0.579874  0.342488  ...  0.355637  0.412985  0.519463
2  0.466970  0.367400  0.601303  ...  0.532278  0.413361  0.483779
3  0.443255  0.379765  0.530285  ...  0.459023  0.511307  0.428884
4  0.494570  0.448939  0.432004  ...  0.428191  0.470753  0.376331

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8203
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9055
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8917
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0096, accuracy=0.0997
Testing SVM
  SVM Test Accuracy: 0.8632
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8404

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6271, Accuracy: 9757/12000 (81%)

Epoch 1 | Train Acc: 0.6937916666666667 | Test Acc: 0.8130833333333334 | Time: 1.1414837837219238 sec

Test set: Average loss: 0.4925, Accuracy: 10114/12000 (84%)

Epoch 2 | Train Acc: 0.8330833333333333 | Test Acc: 0.8428333333333333 | Time: 1.022437334060669 sec

Test set: Average loss: 0.4302, Accuracy: 10321/12000 (86%)

Epoch 3 | Train Acc: 0.8567291666666667 | Test Acc: 0.8600833333333333 | Time: 1.0498158931732178 sec

Test set: Average loss: 0.3929, Accuracy: 10479/12000 (87%)

Epoch 4 | Train Acc: 0.871125 | Test Acc: 0.87325 | Time: 1.0254302024841309 sec

Test set: Average loss: 0.3627, Accuracy: 10611/12000 (88%)

Epoch 5 | Train Acc: 0.880375 | Test Acc: 0.88425 | Time: 1.0296623706817627 sec

Test set: Average loss: 0.3434, Accuracy: 10693/12000 (89%)

Epoch 6 | Train Acc: 0.88725 | Test Acc: 0.8910833333333333 | Time: 1.024170160293579 sec

Test set: Average loss: 0.3296, Accuracy: 10741/12000 (90%)

Epoch 7 | Train Acc: 0.8904375 | Test Acc: 0.8950833333333333 | Time: 1.024425745010376 sec

Test set: Average loss: 0.3211, Accuracy: 10783/12000 (90%)

Epoch 8 | Train Acc: 0.8931666666666667 | Test Acc: 0.8985833333333333 | Time: 1.0247321128845215 sec

Test set: Average loss: 0.3156, Accuracy: 10795/12000 (90%)

Epoch 9 | Train Acc: 0.8955833333333333 | Test Acc: 0.8995833333333333 | Time: 1.0197257995605469 sec

Test set: Average loss: 0.3124, Accuracy: 10807/12000 (90%)

Epoch 10 | Train Acc: 0.8970833333333333 | Test Acc: 0.9005833333333333 | Time: 1.1174256801605225 sec

Test set: Average loss: 0.3104, Accuracy: 10824/12000 (90%)

Epoch 11 | Train Acc: 0.8980416666666666 | Test Acc: 0.902 | Time: 1.0215601921081543 sec

Test set: Average loss: 0.3090, Accuracy: 10831/12000 (90%)

Epoch 12 | Train Acc: 0.8991041666666667 | Test Acc: 0.9025833333333333 | Time: 1.0320842266082764 sec

Test set: Average loss: 0.3080, Accuracy: 10837/12000 (90%)

Epoch 13 | Train Acc: 0.899125 | Test Acc: 0.9030833333333333 | Time: 1.0662548542022705 sec

Test set: Average loss: 0.3073, Accuracy: 10838/12000 (90%)

Epoch 14 | Train Acc: 0.8996875 | Test Acc: 0.9031666666666667 | Time: 1.036180019378662 sec

Test set: Average loss: 0.3068, Accuracy: 10840/12000 (90%)

Epoch 15 | Train Acc: 0.8999166666666667 | Test Acc: 0.9033333333333333 | Time: 1.0291998386383057 sec

Test set: Average loss: 0.3064, Accuracy: 10843/12000 (90%)

Epoch 16 | Train Acc: 0.9 | Test Acc: 0.9035833333333333 | Time: 1.0311760902404785 sec

Test set: Average loss: 0.3062, Accuracy: 10839/12000 (90%)

Epoch 17 | Train Acc: 0.8999166666666667 | Test Acc: 0.90325 | Time: 1.0385520458221436 sec

Test set: Average loss: 0.3061, Accuracy: 10840/12000 (90%)

Epoch 18 | Train Acc: 0.9000416666666666 | Test Acc: 0.9033333333333333 | Time: 1.3089303970336914 sec

Test set: Average loss: 0.3060, Accuracy: 10840/12000 (90%)

Epoch 19 | Train Acc: 0.9001875 | Test Acc: 0.9033333333333333 | Time: 1.357062816619873 sec

Test set: Average loss: 0.3059, Accuracy: 10841/12000 (90%)

Epoch 20 | Train Acc: 0.9003333333333333 | Test Acc: 0.9034166666666666 | Time: 1.0280907154083252 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -42.3572 | Coherence: 15.2995 | Separation: 52.5681 | Information gain: 7.6667 | Grad Norm: 38.6319 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -40.4612 | Coherence: 15.7656 | Separation: 50.8276 | Information gain: 7.6667 | Grad Norm: 37.3663 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -38.8314 | Coherence: 16.2925 | Separation: 49.2622 | Information gain: 7.5000 | Grad Norm: 36.3894 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -37.1977 | Coherence: 16.8241 | Separation: 47.8057 | Information gain: 7.5000 | Grad Norm: 34.6299 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: -35.5291 | Coherence: 17.3376 | Separation: 46.3083 | Information gain: 7.5000 | Grad Norm: 34.9239 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -33.8815 | Coherence: 17.9045 | Separation: 44.8497 | Information gain: 7.5000 | Grad Norm: 33.0996 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -32.4515 | Coherence: 18.5042 | Separation: 43.5084 | Information gain: 7.3333 | Grad Norm: 34.1038 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -30.9869 | Coherence: 19.1666 | Separation: 42.2647 | Information gain: 7.3333 | Grad Norm: 31.0248 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -29.7381 | Coherence: 19.7185 | Separation: 41.1998 | Information gain: 7.3333 | Grad Norm: 30.6231 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -28.4300 | Coherence: 20.2904 | Separation: 40.3046 | Information gain: 7.6667 | Grad Norm: 28.8305 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -27.2646 | Coherence: 20.7699 | Separation: 39.4101 | Information gain: 7.8333 | Grad Norm: 28.9365 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -26.2026 | Coherence: 21.2910 | Separation: 38.5218 | Information gain: 7.8333 | Grad Norm: 29.5199 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -25.0147 | Coherence: 21.8114 | Separation: 37.6186 | Information gain: 8.0000 | Grad Norm: 30.1637 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -24.0126 | Coherence: 22.2656 | Separation: 36.7678 | Information gain: 8.0000 | Grad Norm: 27.4720 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -23.0278 | Coherence: 22.7006 | Separation: 35.9280 | Information gain: 8.0000 | Grad Norm: 28.6326 | Time: 3.3s
Step 0150 | Epoch 01 | Objective: -21.9021 | Coherence: 23.1132 | Separation: 35.0510 | Information gain: 8.1667 | Grad Norm: 27.6206 | Time: 3.5s
Step 0160 | Epoch 01 | Objective: -20.8880 | Coherence: 23.5187 | Separation: 34.1720 | Information gain: 8.1667 | Grad Norm: 27.8346 | Time: 3.7s
Step 0170 | Epoch 01 | Objective: -20.1139 | Coherence: 23.9164 | Separation: 33.4194 | Information gain: 8.0000 | Grad Norm: 26.6960 | Time: 4.0s
Step 0180 | Epoch 01 | Objective: -19.3537 | Coherence: 24.3145 | Separation: 32.6808 | Information gain: 7.8333 | Grad Norm: 29.3265 | Time: 4.2s
Step 0190 | Epoch 01 | Objective: -18.2962 | Coherence: 24.6973 | Separation: 31.9731 | Information gain: 8.1667 | Grad Norm: 26.8480 | Time: 4.4s
Step 0200 | Epoch 01 | Objective: -17.5227 | Coherence: 25.0409 | Separation: 31.3142 | Information gain: 8.1667 | Grad Norm: 27.1597 | Time: 4.6s
Step 0210 | Epoch 01 | Objective: -16.7459 | Coherence: 25.3735 | Separation: 30.6481 | Information gain: 8.1667 | Grad Norm: 27.4443 | Time: 4.8s
Step 0220 | Epoch 01 | Objective: -15.9951 | Coherence: 25.7165 | Separation: 30.0117 | Information gain: 8.1667 | Grad Norm: 27.2643 | Time: 5.1s
Step 0230 | Epoch 01 | Objective: -15.3656 | Coherence: 26.0439 | Separation: 29.3803 | Information gain: 8.0000 | Grad Norm: 27.1366 | Time: 5.3s
Step 0240 | Epoch 01 | Objective: -14.6464 | Coherence: 26.3877 | Separation: 28.7757 | Information gain: 8.0000 | Grad Norm: 28.9104 | Time: 5.5s
Step 0250 | Epoch 01 | Objective: -14.2143 | Coherence: 26.6745 | Separation: 28.2169 | Information gain: 7.6667 | Grad Norm: 28.9822 | Time: 5.7s
Step 0260 | Epoch 01 | Objective: -13.5596 | Coherence: 26.9025 | Separation: 27.6382 | Information gain: 7.6667 | Grad Norm: 27.2635 | Time: 6.0s
Step 0270 | Epoch 01 | Objective: -12.9542 | Coherence: 27.0755 | Separation: 27.0904 | Information gain: 7.6667 | Grad Norm: 27.5779 | Time: 6.2s
Step 0280 | Epoch 01 | Objective: -12.2040 | Coherence: 27.2777 | Separation: 26.5188 | Information gain: 7.8333 | Grad Norm: 28.5687 | Time: 6.4s
Step 0290 | Epoch 01 | Objective: -11.7482 | Coherence: 27.4690 | Separation: 26.0157 | Information gain: 7.6667 | Grad Norm: 26.7106 | Time: 6.6s
Step 0300 | Epoch 01 | Objective: -11.2352 | Coherence: 27.6271 | Separation: 25.5554 | Information gain: 7.6667 | Grad Norm: 24.1877 | Time: 6.9s
Step 0310 | Epoch 01 | Objective: -10.8141 | Coherence: 27.7871 | Separation: 25.1876 | Information gain: 7.6667 | Grad Norm: 26.5368 | Time: 7.1s
Step 0320 | Epoch 01 | Objective: -10.2635 | Coherence: 27.9201 | Separation: 24.7924 | Information gain: 7.8333 | Grad Norm: 26.9544 | Time: 7.3s
Step 0330 | Epoch 01 | Objective: -9.8187 | Coherence: 28.0535 | Separation: 24.3920 | Information gain: 7.8333 | Grad Norm: 26.1706 | Time: 7.6s
Step 0340 | Epoch 01 | Objective: -9.3469 | Coherence: 28.1856 | Separation: 23.9643 | Information gain: 7.8333 | Grad Norm: 26.8576 | Time: 7.8s
Step 0350 | Epoch 01 | Objective: -8.8691 | Coherence: 28.3272 | Separation: 23.5337 | Information gain: 7.8333 | Grad Norm: 24.8518 | Time: 8.0s
Step 0360 | Epoch 01 | Objective: -8.4220 | Coherence: 28.4864 | Separation: 23.1397 | Information gain: 7.8333 | Grad Norm: 24.7351 | Time: 8.2s
Step 0370 | Epoch 01 | Objective: -8.0148 | Coherence: 28.6384 | Separation: 22.7832 | Information gain: 7.8333 | Grad Norm: 27.4740 | Time: 8.5s
Step 0380 | Epoch 01 | Objective: -7.6525 | Coherence: 28.8046 | Separation: 22.4762 | Information gain: 7.8333 | Grad Norm: 23.9202 | Time: 8.7s
Step 0390 | Epoch 01 | Objective: -7.3893 | Coherence: 28.9535 | Separation: 22.1516 | Information gain: 7.6667 | Grad Norm: 26.1328 | Time: 8.9s
Step 0400 | Epoch 01 | Objective: -7.0011 | Coherence: 29.0961 | Separation: 21.8110 | Information gain: 7.6667 | Grad Norm: 26.4639 | Time: 9.1s
Step 0410 | Epoch 01 | Objective: -6.6328 | Coherence: 29.2332 | Separation: 21.4884 | Information gain: 7.6667 | Grad Norm: 23.7110 | Time: 9.4s
Step 0420 | Epoch 01 | Objective: -6.2574 | Coherence: 29.3600 | Separation: 21.1552 | Information gain: 7.6667 | Grad Norm: 26.0869 | Time: 9.6s
Step 0430 | Epoch 01 | Objective: -5.9426 | Coherence: 29.4825 | Separation: 20.8812 | Information gain: 7.6667 | Grad Norm: 25.9213 | Time: 9.9s
Step 0440 | Epoch 01 | Objective: -5.6266 | Coherence: 29.6195 | Separation: 20.6109 | Information gain: 7.6667 | Grad Norm: 27.8608 | Time: 10.1s
Step 0450 | Epoch 01 | Objective: -5.3181 | Coherence: 29.7806 | Separation: 20.3561 | Information gain: 7.6667 | Grad Norm: 23.9014 | Time: 10.4s
Step 0460 | Epoch 01 | Objective: -5.0452 | Coherence: 29.9387 | Separation: 20.1359 | Information gain: 7.6667 | Grad Norm: 25.4670 | Time: 10.6s
Step 0470 | Epoch 01 | Objective: -4.8090 | Coherence: 30.1093 | Separation: 19.9565 | Information gain: 7.6667 | Grad Norm: 24.9549 | Time: 10.8s
Step 0480 | Epoch 01 | Objective: -4.5543 | Coherence: 30.2985 | Separation: 19.7649 | Information gain: 7.6667 | Grad Norm: 26.3043 | Time: 11.1s
Step 0490 | Epoch 01 | Objective: -4.2950 | Coherence: 30.5049 | Separation: 19.5744 | Information gain: 7.6667 | Grad Norm: 24.6135 | Time: 11.3s
Step 0500 | Epoch 01 | Objective: -4.0327 | Coherence: 30.6973 | Separation: 19.3763 | Information gain: 7.6667 | Grad Norm: 25.9855 | Time: 11.5s
Step 0510 | Epoch 01 | Objective: -3.7611 | Coherence: 30.9067 | Separation: 19.1745 | Information gain: 7.6667 | Grad Norm: 25.1511 | Time: 11.8s
Step 0520 | Epoch 01 | Objective: -3.5025 | Coherence: 31.0858 | Separation: 18.9755 | Information gain: 7.6667 | Grad Norm: 27.6055 | Time: 12.0s
Step 0530 | Epoch 01 | Objective: -3.1445 | Coherence: 31.2520 | Separation: 18.7841 | Information gain: 7.8333 | Grad Norm: 26.8391 | Time: 12.2s
Step 0540 | Epoch 01 | Objective: -3.0729 | Coherence: 31.4266 | Separation: 18.6595 | Information gain: 7.6667 | Grad Norm: 27.1839 | Time: 12.5s
Step 0550 | Epoch 01 | Objective: -2.8942 | Coherence: 31.6122 | Separation: 18.5427 | Information gain: 7.6667 | Grad Norm: 26.4750 | Time: 12.7s
Step 0560 | Epoch 01 | Objective: -2.7117 | Coherence: 31.7941 | Separation: 18.4209 | Information gain: 7.6667 | Grad Norm: 27.1300 | Time: 13.0s
Step 0570 | Epoch 01 | Objective: -2.5302 | Coherence: 31.9714 | Separation: 18.2984 | Information gain: 7.6667 | Grad Norm: 28.7937 | Time: 13.2s
Step 0580 | Epoch 01 | Objective: -2.3509 | Coherence: 32.1530 | Separation: 18.1797 | Information gain: 7.6667 | Grad Norm: 29.5416 | Time: 13.4s
Step 0590 | Epoch 01 | Objective: -2.1634 | Coherence: 32.3300 | Separation: 18.0512 | Information gain: 7.6667 | Grad Norm: 30.6367 | Time: 13.7s
Step 0600 | Epoch 01 | Objective: -1.8547 | Coherence: 32.5207 | Separation: 17.9171 | Information gain: 7.8333 | Grad Norm: 28.7287 | Time: 13.9s
Step 0610 | Epoch 01 | Objective: -1.6619 | Coherence: 32.7103 | Separation: 17.7875 | Information gain: 7.8333 | Grad Norm: 30.2165 | Time: 14.1s
Step 0620 | Epoch 01 | Objective: -1.4621 | Coherence: 32.9015 | Separation: 17.6515 | Information gain: 7.8333 | Grad Norm: 28.8531 | Time: 14.4s
Step 0630 | Epoch 01 | Objective: -1.2429 | Coherence: 33.0927 | Separation: 17.4961 | Information gain: 7.8333 | Grad Norm: 28.0568 | Time: 14.6s
Step 0640 | Epoch 01 | Objective: -1.0380 | Coherence: 33.2901 | Separation: 17.3569 | Information gain: 7.8333 | Grad Norm: 29.7266 | Time: 14.8s
Step 0650 | Epoch 01 | Objective: -0.8168 | Coherence: 33.4702 | Separation: 17.1957 | Information gain: 7.8333 | Grad Norm: 28.0026 | Time: 15.0s
Step 0660 | Epoch 01 | Objective: -0.5893 | Coherence: 33.6485 | Separation: 17.0277 | Information gain: 7.8333 | Grad Norm: 28.3511 | Time: 15.3s
Step 0670 | Epoch 01 | Objective: -0.3658 | Coherence: 33.8507 | Separation: 16.8716 | Information gain: 7.8333 | Grad Norm: 29.1223 | Time: 15.5s
Step 0680 | Epoch 01 | Objective: -0.1245 | Coherence: 34.0132 | Separation: 16.6844 | Information gain: 7.8333 | Grad Norm: 29.2872 | Time: 15.7s
Step 0690 | Epoch 01 | Objective: 0.1186 | Coherence: 34.1993 | Separation: 16.5034 | Information gain: 7.8333 | Grad Norm: 28.1528 | Time: 15.9s
Step 0700 | Epoch 01 | Objective: 0.3692 | Coherence: 34.3777 | Separation: 16.3123 | Information gain: 7.8333 | Grad Norm: 28.5263 | Time: 16.2s
Step 0710 | Epoch 01 | Objective: 0.5098 | Coherence: 34.5657 | Separation: 16.1232 | Information gain: 7.6667 | Grad Norm: 27.2753 | Time: 16.4s
Step 0720 | Epoch 01 | Objective: 0.7718 | Coherence: 34.7433 | Separation: 15.9204 | Information gain: 7.6667 | Grad Norm: 28.0639 | Time: 16.6s
Step 0726 | Epoch 01 | Objective: 0.9182 | Coherence: 34.8614 | Separation: 15.8133 | Information gain: 7.6667 | Grad Norm: 29.2036 | Time: 16.8s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.602406  0.452533  0.529519  ...  0.451347  0.559159  0.501058
1  0.453258  0.590398  0.505713  ...  0.574498  0.458495  0.481880
2  0.496769  0.468306  0.563956  ...  0.428928  0.452930  0.421855
3  0.501746  0.504093  0.523852  ...  0.483401  0.488159  0.463342
4  0.551204  0.463862  0.552072  ...  0.440354  0.510723  0.495143

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7994
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8923
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8764
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0081, accuracy=0.0984
Testing SVM
  SVM Test Accuracy: 0.8576
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8283

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7152, Accuracy: 9182/12000 (77%)

Epoch 1 | Train Acc: 0.6594791666666666 | Test Acc: 0.7651666666666667 | Time: 1.1722204685211182 sec

Test set: Average loss: 0.5248, Accuracy: 9923/12000 (83%)

Epoch 2 | Train Acc: 0.823125 | Test Acc: 0.8269166666666666 | Time: 1.02659273147583 sec

Test set: Average loss: 0.4488, Accuracy: 10225/12000 (85%)

Epoch 3 | Train Acc: 0.8521875 | Test Acc: 0.8520833333333333 | Time: 1.0292539596557617 sec

Test set: Average loss: 0.4036, Accuracy: 10399/12000 (87%)

Epoch 4 | Train Acc: 0.8668125 | Test Acc: 0.8665833333333334 | Time: 1.0230250358581543 sec

Test set: Average loss: 0.3796, Accuracy: 10511/12000 (88%)

Epoch 5 | Train Acc: 0.8763333333333333 | Test Acc: 0.8759166666666667 | Time: 1.021831750869751 sec

Test set: Average loss: 0.3641, Accuracy: 10574/12000 (88%)

Epoch 6 | Train Acc: 0.8827916666666666 | Test Acc: 0.8811666666666667 | Time: 1.0206248760223389 sec

Test set: Average loss: 0.3554, Accuracy: 10622/12000 (89%)

Epoch 7 | Train Acc: 0.8867291666666667 | Test Acc: 0.8851666666666667 | Time: 1.2279298305511475 sec

Test set: Average loss: 0.3490, Accuracy: 10639/12000 (89%)

Epoch 8 | Train Acc: 0.8888958333333333 | Test Acc: 0.8865833333333333 | Time: 1.0214424133300781 sec

Test set: Average loss: 0.3446, Accuracy: 10660/12000 (89%)

Epoch 9 | Train Acc: 0.8912708333333333 | Test Acc: 0.8883333333333333 | Time: 1.0191352367401123 sec

Test set: Average loss: 0.3412, Accuracy: 10674/12000 (89%)

Epoch 10 | Train Acc: 0.8924791666666667 | Test Acc: 0.8895 | Time: 1.0235204696655273 sec

Test set: Average loss: 0.3391, Accuracy: 10685/12000 (89%)

Epoch 11 | Train Acc: 0.8933541666666667 | Test Acc: 0.8904166666666666 | Time: 1.0243525505065918 sec

Test set: Average loss: 0.3375, Accuracy: 10691/12000 (89%)

Epoch 12 | Train Acc: 0.8941875 | Test Acc: 0.8909166666666667 | Time: 1.0385797023773193 sec

Test set: Average loss: 0.3364, Accuracy: 10695/12000 (89%)

Epoch 13 | Train Acc: 0.8946458333333334 | Test Acc: 0.89125 | Time: 1.0214159488677979 sec

Test set: Average loss: 0.3357, Accuracy: 10698/12000 (89%)

Epoch 14 | Train Acc: 0.894875 | Test Acc: 0.8915 | Time: 1.036177158355713 sec

Test set: Average loss: 0.3353, Accuracy: 10703/12000 (89%)

Epoch 15 | Train Acc: 0.8949375 | Test Acc: 0.8919166666666667 | Time: 1.027505874633789 sec

Test set: Average loss: 0.3349, Accuracy: 10711/12000 (89%)

Epoch 16 | Train Acc: 0.8950833333333333 | Test Acc: 0.8925833333333333 | Time: 1.1163406372070312 sec

Test set: Average loss: 0.3347, Accuracy: 10718/12000 (89%)

Epoch 17 | Train Acc: 0.8951666666666667 | Test Acc: 0.8931666666666667 | Time: 1.0221219062805176 sec

Test set: Average loss: 0.3345, Accuracy: 10717/12000 (89%)

Epoch 18 | Train Acc: 0.8951875 | Test Acc: 0.8930833333333333 | Time: 1.0231804847717285 sec

Test set: Average loss: 0.3345, Accuracy: 10717/12000 (89%)

Epoch 19 | Train Acc: 0.8953125 | Test Acc: 0.8930833333333333 | Time: 1.0172779560089111 sec

Test set: Average loss: 0.3344, Accuracy: 10720/12000 (89%)

Epoch 20 | Train Acc: 0.8954583333333334 | Test Acc: 0.8933333333333333 | Time: 1.0220959186553955 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -42.4125 | Coherence: 16.6642 | Separation: 55.4673 | Information gain: 7.5000 | Grad Norm: 39.6280 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: -40.4869 | Coherence: 16.8416 | Separation: 53.6007 | Information gain: 7.5000 | Grad Norm: 37.7967 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -38.8459 | Coherence: 17.0439 | Separation: 52.0272 | Information gain: 7.5000 | Grad Norm: 35.9676 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: -37.2671 | Coherence: 17.2408 | Separation: 50.5140 | Information gain: 7.5000 | Grad Norm: 36.3760 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: -35.6767 | Coherence: 17.4223 | Separation: 48.9842 | Information gain: 7.5000 | Grad Norm: 34.8585 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -34.1613 | Coherence: 17.5246 | Separation: 47.5028 | Information gain: 7.5000 | Grad Norm: 34.6117 | Time: 1.3s
Step 0060 | Epoch 01 | Objective: -32.6160 | Coherence: 17.6026 | Separation: 45.9835 | Information gain: 7.5000 | Grad Norm: 34.5723 | Time: 1.5s
Step 0070 | Epoch 01 | Objective: -31.0294 | Coherence: 17.6944 | Separation: 44.4275 | Information gain: 7.5000 | Grad Norm: 34.0769 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -29.2794 | Coherence: 17.8936 | Separation: 42.9106 | Information gain: 7.6667 | Grad Norm: 32.9653 | Time: 2.0s
Step 0090 | Epoch 01 | Objective: -27.9748 | Coherence: 18.0783 | Separation: 41.5009 | Information gain: 7.5000 | Grad Norm: 32.1124 | Time: 2.2s
Step 0100 | Epoch 01 | Objective: -26.5674 | Coherence: 18.2139 | Separation: 40.1387 | Information gain: 7.5000 | Grad Norm: 32.3177 | Time: 2.4s
Step 0110 | Epoch 01 | Objective: -25.2005 | Coherence: 18.3685 | Separation: 38.8233 | Information gain: 7.5000 | Grad Norm: 29.7579 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -23.8927 | Coherence: 18.5968 | Separation: 37.5917 | Information gain: 7.5000 | Grad Norm: 29.7212 | Time: 2.9s
Step 0130 | Epoch 01 | Objective: -22.6448 | Coherence: 18.8709 | Separation: 36.4351 | Information gain: 7.5000 | Grad Norm: 29.3607 | Time: 3.1s
Step 0140 | Epoch 01 | Objective: -21.4933 | Coherence: 19.1107 | Separation: 35.3635 | Information gain: 7.5000 | Grad Norm: 30.4119 | Time: 3.3s
Step 0150 | Epoch 01 | Objective: -20.3994 | Coherence: 19.2648 | Separation: 34.3210 | Information gain: 7.5000 | Grad Norm: 29.4086 | Time: 3.6s
Step 0160 | Epoch 01 | Objective: -19.3727 | Coherence: 19.4624 | Separation: 33.3601 | Information gain: 7.5000 | Grad Norm: 27.9105 | Time: 3.8s
Step 0170 | Epoch 01 | Objective: -18.5429 | Coherence: 19.7045 | Separation: 32.6111 | Information gain: 7.5000 | Grad Norm: 28.0122 | Time: 4.0s
Step 0180 | Epoch 01 | Objective: -17.9258 | Coherence: 19.9176 | Separation: 32.0650 | Information gain: 7.5000 | Grad Norm: 26.2286 | Time: 4.3s
Step 0190 | Epoch 01 | Objective: -17.3356 | Coherence: 20.1317 | Separation: 31.5461 | Information gain: 7.5000 | Grad Norm: 27.3100 | Time: 4.5s
Step 0200 | Epoch 01 | Objective: -16.8845 | Coherence: 20.3305 | Separation: 30.9946 | Information gain: 7.3333 | Grad Norm: 27.9934 | Time: 4.7s
Step 0210 | Epoch 01 | Objective: -16.2474 | Coherence: 20.5475 | Separation: 30.4299 | Information gain: 7.3333 | Grad Norm: 27.9002 | Time: 4.9s
Step 0220 | Epoch 01 | Objective: -15.5748 | Coherence: 20.7750 | Separation: 29.8331 | Information gain: 7.3333 | Grad Norm: 27.1888 | Time: 5.1s
Step 0230 | Epoch 01 | Objective: -14.8703 | Coherence: 21.0209 | Separation: 29.2105 | Information gain: 7.3333 | Grad Norm: 27.2970 | Time: 5.4s
Step 0240 | Epoch 01 | Objective: -14.1651 | Coherence: 21.2442 | Separation: 28.5798 | Information gain: 7.3333 | Grad Norm: 27.1229 | Time: 5.6s
Step 0250 | Epoch 01 | Objective: -13.6347 | Coherence: 21.4309 | Separation: 27.9450 | Information gain: 7.1667 | Grad Norm: 26.7364 | Time: 5.8s
Step 0260 | Epoch 01 | Objective: -13.0162 | Coherence: 21.6364 | Separation: 27.3950 | Information gain: 7.1667 | Grad Norm: 25.4140 | Time: 6.0s
Step 0270 | Epoch 01 | Objective: -12.4232 | Coherence: 21.8599 | Separation: 26.8765 | Information gain: 7.1667 | Grad Norm: 26.1078 | Time: 6.3s
Step 0280 | Epoch 01 | Objective: -11.9557 | Coherence: 22.0618 | Separation: 26.4763 | Information gain: 7.1667 | Grad Norm: 27.3788 | Time: 6.5s
Step 0290 | Epoch 01 | Objective: -11.5078 | Coherence: 22.2536 | Separation: 26.0923 | Information gain: 7.1667 | Grad Norm: 25.8453 | Time: 6.7s
Step 0300 | Epoch 01 | Objective: -10.8938 | Coherence: 22.4137 | Separation: 25.6984 | Information gain: 7.3333 | Grad Norm: 26.0384 | Time: 6.9s
Step 0310 | Epoch 01 | Objective: -10.4709 | Coherence: 22.5918 | Separation: 25.3348 | Information gain: 7.3333 | Grad Norm: 27.3044 | Time: 7.2s
Step 0320 | Epoch 01 | Objective: -10.0260 | Coherence: 22.7775 | Separation: 24.9518 | Information gain: 7.3333 | Grad Norm: 25.8366 | Time: 7.4s
Step 0330 | Epoch 01 | Objective: -9.6004 | Coherence: 22.9421 | Separation: 24.5811 | Information gain: 7.3333 | Grad Norm: 26.1390 | Time: 7.6s
Step 0340 | Epoch 01 | Objective: -9.1652 | Coherence: 23.1095 | Separation: 24.2017 | Information gain: 7.3333 | Grad Norm: 28.6383 | Time: 7.8s
Step 0350 | Epoch 01 | Objective: -8.7378 | Coherence: 23.2793 | Separation: 23.8309 | Information gain: 7.3333 | Grad Norm: 25.9410 | Time: 8.1s
Step 0360 | Epoch 01 | Objective: -8.3129 | Coherence: 23.4713 | Separation: 23.4699 | Information gain: 7.3333 | Grad Norm: 24.4903 | Time: 8.3s
Step 0370 | Epoch 01 | Objective: -7.8910 | Coherence: 23.6472 | Separation: 23.1067 | Information gain: 7.3333 | Grad Norm: 25.7627 | Time: 8.5s
Step 0380 | Epoch 01 | Objective: -7.5194 | Coherence: 23.8350 | Separation: 22.7977 | Information gain: 7.3333 | Grad Norm: 25.8136 | Time: 8.7s
Step 0390 | Epoch 01 | Objective: -7.1338 | Coherence: 24.0002 | Separation: 22.4672 | Information gain: 7.3333 | Grad Norm: 26.5217 | Time: 9.0s
Step 0400 | Epoch 01 | Objective: -6.7325 | Coherence: 24.1671 | Separation: 22.1215 | Information gain: 7.3333 | Grad Norm: 25.2461 | Time: 9.2s
Step 0410 | Epoch 01 | Objective: -6.3274 | Coherence: 24.3377 | Separation: 21.7733 | Information gain: 7.3333 | Grad Norm: 25.8224 | Time: 9.4s
Step 0420 | Epoch 01 | Objective: -5.9187 | Coherence: 24.5134 | Separation: 21.4232 | Information gain: 7.3333 | Grad Norm: 26.2239 | Time: 9.7s
Step 0430 | Epoch 01 | Objective: -5.5739 | Coherence: 24.6853 | Separation: 21.1356 | Information gain: 7.3333 | Grad Norm: 23.9234 | Time: 9.9s
Step 0440 | Epoch 01 | Objective: -5.3466 | Coherence: 24.8676 | Separation: 20.9691 | Information gain: 7.3333 | Grad Norm: 26.7775 | Time: 10.2s
Step 0450 | Epoch 01 | Objective: -5.1056 | Coherence: 25.0631 | Separation: 20.7933 | Information gain: 7.3333 | Grad Norm: 25.6102 | Time: 10.4s
Step 0460 | Epoch 01 | Objective: -5.0139 | Coherence: 25.2652 | Separation: 20.6023 | Information gain: 7.1667 | Grad Norm: 25.6355 | Time: 10.6s
Step 0470 | Epoch 01 | Objective: -4.7591 | Coherence: 25.4556 | Separation: 20.4109 | Information gain: 7.1667 | Grad Norm: 25.8576 | Time: 10.9s
Step 0480 | Epoch 01 | Objective: -4.3140 | Coherence: 25.6413 | Separation: 20.1944 | Information gain: 7.3333 | Grad Norm: 23.7100 | Time: 11.1s
Step 0490 | Epoch 01 | Objective: -4.0531 | Coherence: 25.8549 | Separation: 20.0047 | Information gain: 7.3333 | Grad Norm: 26.0665 | Time: 11.3s
Step 0500 | Epoch 01 | Objective: -3.8053 | Coherence: 26.0565 | Separation: 19.8241 | Information gain: 7.3333 | Grad Norm: 24.3922 | Time: 11.6s
Step 0510 | Epoch 01 | Objective: -3.5621 | Coherence: 26.2307 | Separation: 19.6390 | Information gain: 7.3333 | Grad Norm: 26.4130 | Time: 11.8s
Step 0520 | Epoch 01 | Objective: -3.3325 | Coherence: 26.4028 | Separation: 19.4668 | Information gain: 7.3333 | Grad Norm: 26.4023 | Time: 12.0s
Step 0530 | Epoch 01 | Objective: -3.1028 | Coherence: 26.5535 | Separation: 19.2873 | Information gain: 7.3333 | Grad Norm: 24.2250 | Time: 12.3s
Step 0540 | Epoch 01 | Objective: -2.6973 | Coherence: 26.6958 | Separation: 19.0959 | Information gain: 7.5000 | Grad Norm: 24.7990 | Time: 12.5s
Step 0550 | Epoch 01 | Objective: -2.4488 | Coherence: 26.8537 | Separation: 18.9000 | Information gain: 7.5000 | Grad Norm: 25.6927 | Time: 12.7s
Step 0560 | Epoch 01 | Objective: -2.1841 | Coherence: 26.9948 | Separation: 18.6824 | Information gain: 7.5000 | Grad Norm: 24.5224 | Time: 13.0s
Step 0570 | Epoch 01 | Objective: -1.9190 | Coherence: 27.1505 | Separation: 18.4692 | Information gain: 7.5000 | Grad Norm: 26.0697 | Time: 13.2s
Step 0580 | Epoch 01 | Objective: -1.4711 | Coherence: 27.3039 | Separation: 18.2391 | Information gain: 7.6667 | Grad Norm: 25.9763 | Time: 13.4s
Step 0590 | Epoch 01 | Objective: -1.1715 | Coherence: 27.4714 | Separation: 17.9953 | Information gain: 7.6667 | Grad Norm: 25.4937 | Time: 13.6s
Step 0600 | Epoch 01 | Objective: -0.8713 | Coherence: 27.6214 | Separation: 17.7451 | Information gain: 7.6667 | Grad Norm: 26.1777 | Time: 13.9s
Step 0610 | Epoch 01 | Objective: -0.5637 | Coherence: 27.7672 | Separation: 17.4861 | Information gain: 7.6667 | Grad Norm: 26.7343 | Time: 14.1s
Step 0620 | Epoch 01 | Objective: -0.0798 | Coherence: 27.9243 | Separation: 17.2212 | Information gain: 7.8333 | Grad Norm: 26.3413 | Time: 14.3s
Step 0630 | Epoch 01 | Objective: 0.2479 | Coherence: 28.0831 | Separation: 16.9465 | Information gain: 7.8333 | Grad Norm: 28.2816 | Time: 14.5s
Step 0640 | Epoch 01 | Objective: 0.5927 | Coherence: 28.2226 | Separation: 16.6482 | Information gain: 7.8333 | Grad Norm: 27.3567 | Time: 14.8s
Step 0649 | Epoch 01 | Objective: 0.9093 | Coherence: 28.3554 | Separation: 16.3758 | Information gain: 7.8333 | Grad Norm: 26.0157 | Time: 15.0s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.573697  0.477412  0.407451  ...  0.354239  0.487742  0.490876
1  0.502472  0.557539  0.357151  ...  0.460388  0.494346  0.421334
2  0.446318  0.368797  0.608816  ...  0.217565  0.480917  0.558921
3  0.303506  0.256786  0.463175  ...  0.065195  0.450842  0.443889
4  0.514129  0.473539  0.433043  ...  0.312586  0.556792  0.534434

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8071
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8963
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8807
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.8610, accuracy=0.1018
Testing SVM
  SVM Test Accuracy: 0.8611
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8326

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6496, Accuracy: 9676/12000 (81%)

Epoch 1 | Train Acc: 0.6863958333333333 | Test Acc: 0.8063333333333333 | Time: 1.0258512496948242 sec

Test set: Average loss: 0.5036, Accuracy: 10101/12000 (84%)

Epoch 2 | Train Acc: 0.8274791666666667 | Test Acc: 0.84175 | Time: 1.0254473686218262 sec

Test set: Average loss: 0.4534, Accuracy: 10274/12000 (86%)

Epoch 3 | Train Acc: 0.8538125 | Test Acc: 0.8561666666666666 | Time: 1.1431808471679688 sec

Test set: Average loss: 0.4190, Accuracy: 10417/12000 (87%)

Epoch 4 | Train Acc: 0.8673541666666666 | Test Acc: 0.8680833333333333 | Time: 1.0242059230804443 sec

Test set: Average loss: 0.3888, Accuracy: 10527/12000 (88%)

Epoch 5 | Train Acc: 0.8769375 | Test Acc: 0.87725 | Time: 1.0238440036773682 sec

Test set: Average loss: 0.3666, Accuracy: 10608/12000 (88%)

Epoch 6 | Train Acc: 0.8833125 | Test Acc: 0.884 | Time: 1.0214900970458984 sec

Test set: Average loss: 0.3523, Accuracy: 10668/12000 (89%)

Epoch 7 | Train Acc: 0.88725 | Test Acc: 0.889 | Time: 1.0227751731872559 sec

Test set: Average loss: 0.3423, Accuracy: 10702/12000 (89%)

Epoch 8 | Train Acc: 0.890375 | Test Acc: 0.8918333333333334 | Time: 1.025618314743042 sec

Test set: Average loss: 0.3363, Accuracy: 10730/12000 (89%)

Epoch 9 | Train Acc: 0.8923541666666667 | Test Acc: 0.8941666666666667 | Time: 1.029860019683838 sec

Test set: Average loss: 0.3323, Accuracy: 10744/12000 (90%)

Epoch 10 | Train Acc: 0.8940208333333334 | Test Acc: 0.8953333333333333 | Time: 1.026750087738037 sec

Test set: Average loss: 0.3298, Accuracy: 10754/12000 (90%)

Epoch 11 | Train Acc: 0.8948125 | Test Acc: 0.8961666666666667 | Time: 1.0233464241027832 sec

Test set: Average loss: 0.3282, Accuracy: 10763/12000 (90%)

Epoch 12 | Train Acc: 0.8958333333333334 | Test Acc: 0.8969166666666667 | Time: 1.111976146697998 sec

Test set: Average loss: 0.3272, Accuracy: 10762/12000 (90%)

Epoch 13 | Train Acc: 0.8965833333333333 | Test Acc: 0.8968333333333334 | Time: 1.114758014678955 sec

Test set: Average loss: 0.3265, Accuracy: 10763/12000 (90%)

Epoch 14 | Train Acc: 0.8967916666666667 | Test Acc: 0.8969166666666667 | Time: 1.11537504196167 sec

Test set: Average loss: 0.3260, Accuracy: 10764/12000 (90%)

Epoch 15 | Train Acc: 0.8970833333333333 | Test Acc: 0.897 | Time: 1.0224864482879639 sec

Test set: Average loss: 0.3257, Accuracy: 10763/12000 (90%)

Epoch 16 | Train Acc: 0.8972916666666667 | Test Acc: 0.8969166666666667 | Time: 1.0240089893341064 sec

Test set: Average loss: 0.3255, Accuracy: 10767/12000 (90%)

Epoch 17 | Train Acc: 0.8973541666666667 | Test Acc: 0.89725 | Time: 1.0247259140014648 sec

Test set: Average loss: 0.3253, Accuracy: 10769/12000 (90%)

Epoch 18 | Train Acc: 0.8975 | Test Acc: 0.8974166666666666 | Time: 1.0215063095092773 sec

Test set: Average loss: 0.3253, Accuracy: 10773/12000 (90%)

Epoch 19 | Train Acc: 0.8974375 | Test Acc: 0.89775 | Time: 1.0230436325073242 sec

Test set: Average loss: 0.3252, Accuracy: 10775/12000 (90%)

Epoch 20 | Train Acc: 0.8974791666666667 | Test Acc: 0.8979166666666667 | Time: 1.0215163230895996 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: 22.7411 | Coherence: 34.1117 | Separation: 51.1751 | Information gain: 7.0000 | Grad Norm: 14.7680 | Time: 0.0s
Step 0001 | Epoch 01 | Objective: 22.8746 | Coherence: 34.3119 | Separation: 51.2207 | Information gain: 7.0000 | Grad Norm: 14.7680 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.634584  0.585517  0.304157  ... -0.338980  0.501222  0.335166
1  0.594062  0.629987  0.354552  ... -0.388874  0.563163  0.374544
2  0.297610  0.341759  0.578392  ... -0.561072  0.437663  0.537945
3  0.455576  0.490985  0.527974  ... -0.527507  0.570840  0.535383
4  0.355906  0.396927  0.536532  ... -0.585814  0.457850  0.442032

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7828
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8999
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8800
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0755, accuracy=0.0826
Testing SVM
  SVM Test Accuracy: 0.8575
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8321

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7353, Accuracy: 9307/12000 (78%)

Epoch 1 | Train Acc: 0.6409791666666667 | Test Acc: 0.7755833333333333 | Time: 1.0278599262237549 sec

Test set: Average loss: 0.5517, Accuracy: 9910/12000 (83%)

Epoch 2 | Train Acc: 0.8173125 | Test Acc: 0.8258333333333333 | Time: 1.0298247337341309 sec

Test set: Average loss: 0.4759, Accuracy: 10164/12000 (85%)

Epoch 3 | Train Acc: 0.8500208333333333 | Test Acc: 0.847 | Time: 1.023223876953125 sec

Test set: Average loss: 0.4306, Accuracy: 10358/12000 (86%)

Epoch 4 | Train Acc: 0.8673958333333334 | Test Acc: 0.8631666666666666 | Time: 1.023172378540039 sec

Test set: Average loss: 0.3987, Accuracy: 10485/12000 (87%)

Epoch 5 | Train Acc: 0.8786875 | Test Acc: 0.87375 | Time: 1.0331294536590576 sec

Test set: Average loss: 0.3795, Accuracy: 10549/12000 (88%)

Epoch 6 | Train Acc: 0.8863125 | Test Acc: 0.8790833333333333 | Time: 1.1717636585235596 sec

Test set: Average loss: 0.3667, Accuracy: 10615/12000 (88%)

Epoch 7 | Train Acc: 0.8909166666666667 | Test Acc: 0.8845833333333334 | Time: 1.2102603912353516 sec

Test set: Average loss: 0.3576, Accuracy: 10643/12000 (89%)

Epoch 8 | Train Acc: 0.8938541666666666 | Test Acc: 0.8869166666666667 | Time: 1.105461597442627 sec

Test set: Average loss: 0.3524, Accuracy: 10653/12000 (89%)

Epoch 9 | Train Acc: 0.8960833333333333 | Test Acc: 0.88775 | Time: 1.1522912979125977 sec

Test set: Average loss: 0.3489, Accuracy: 10657/12000 (89%)

Epoch 10 | Train Acc: 0.8978333333333334 | Test Acc: 0.8880833333333333 | Time: 1.0266695022583008 sec

Test set: Average loss: 0.3467, Accuracy: 10668/12000 (89%)

Epoch 11 | Train Acc: 0.8990833333333333 | Test Acc: 0.889 | Time: 1.0215513706207275 sec

Test set: Average loss: 0.3452, Accuracy: 10672/12000 (89%)

Epoch 12 | Train Acc: 0.8997916666666667 | Test Acc: 0.8893333333333333 | Time: 1.0278713703155518 sec

Test set: Average loss: 0.3441, Accuracy: 10679/12000 (89%)

Epoch 13 | Train Acc: 0.9002708333333334 | Test Acc: 0.8899166666666667 | Time: 1.0251269340515137 sec

Test set: Average loss: 0.3433, Accuracy: 10679/12000 (89%)

Epoch 14 | Train Acc: 0.9002708333333334 | Test Acc: 0.8899166666666667 | Time: 1.0215237140655518 sec

Test set: Average loss: 0.3427, Accuracy: 10679/12000 (89%)

Epoch 15 | Train Acc: 0.9005 | Test Acc: 0.8899166666666667 | Time: 1.0308313369750977 sec

Test set: Average loss: 0.3423, Accuracy: 10681/12000 (89%)

Epoch 16 | Train Acc: 0.9006041666666667 | Test Acc: 0.8900833333333333 | Time: 1.0366580486297607 sec

Test set: Average loss: 0.3420, Accuracy: 10682/12000 (89%)

Epoch 17 | Train Acc: 0.9008125 | Test Acc: 0.8901666666666667 | Time: 1.0222880840301514 sec

Test set: Average loss: 0.3418, Accuracy: 10679/12000 (89%)

Epoch 18 | Train Acc: 0.9009166666666667 | Test Acc: 0.8899166666666667 | Time: 1.1225464344024658 sec

Test set: Average loss: 0.3417, Accuracy: 10677/12000 (89%)

Epoch 19 | Train Acc: 0.9008958333333333 | Test Acc: 0.88975 | Time: 1.0291190147399902 sec

Test set: Average loss: 0.3416, Accuracy: 10677/12000 (89%)

Epoch 20 | Train Acc: 0.9010416666666666 | Test Acc: 0.88975 | Time: 1.0300486087799072 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: 14.5137 | Coherence: 18.3539 | Separation: 52.3299 | Information gain: 6.8333 | Grad Norm: 14.8149 | Time: 0.0s
Step 0001 | Epoch 01 | Objective: 14.6622 | Coherence: 18.5767 | Separation: 52.3670 | Information gain: 6.8333 | Grad Norm: 14.8149 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.584604  0.439076  0.497977  ...  0.506746 -0.477663 -0.456660
1  0.438787  0.613930  0.498510  ...  0.415247 -0.496873 -0.463509
2  0.473942  0.477615  0.600797  ...  0.544798 -0.516947 -0.583045
3  0.447041  0.470315  0.596986  ...  0.577306 -0.543141 -0.613513
4  0.561212  0.485645  0.592410  ...  0.568854 -0.512392 -0.557678

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7908
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8924
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8761
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.1916, accuracy=0.0948
Testing SVM
  SVM Test Accuracy: 0.8481
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8265

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7751, Accuracy: 9236/12000 (77%)

Epoch 1 | Train Acc: 0.6398541666666666 | Test Acc: 0.7696666666666667 | Time: 1.0487589836120605 sec

Test set: Average loss: 0.5750, Accuracy: 9895/12000 (82%)

Epoch 2 | Train Acc: 0.81075 | Test Acc: 0.8245833333333333 | Time: 1.02247953414917 sec

Test set: Average loss: 0.4984, Accuracy: 10126/12000 (84%)

Epoch 3 | Train Acc: 0.8425833333333334 | Test Acc: 0.8438333333333333 | Time: 1.0245208740234375 sec

Test set: Average loss: 0.4402, Accuracy: 10328/12000 (86%)

Epoch 4 | Train Acc: 0.856875 | Test Acc: 0.8606666666666667 | Time: 1.0226585865020752 sec

Test set: Average loss: 0.4123, Accuracy: 10434/12000 (87%)

Epoch 5 | Train Acc: 0.8662083333333334 | Test Acc: 0.8695 | Time: 1.1932857036590576 sec

Test set: Average loss: 0.3943, Accuracy: 10490/12000 (87%)

Epoch 6 | Train Acc: 0.8734791666666667 | Test Acc: 0.8741666666666666 | Time: 1.0293684005737305 sec

Test set: Average loss: 0.3823, Accuracy: 10523/12000 (88%)

Epoch 7 | Train Acc: 0.8782083333333334 | Test Acc: 0.8769166666666667 | Time: 1.029836893081665 sec

Test set: Average loss: 0.3738, Accuracy: 10551/12000 (88%)

Epoch 8 | Train Acc: 0.8819583333333333 | Test Acc: 0.87925 | Time: 1.022301197052002 sec

Test set: Average loss: 0.3673, Accuracy: 10586/12000 (88%)

Epoch 9 | Train Acc: 0.884375 | Test Acc: 0.8821666666666667 | Time: 1.0229036808013916 sec

Test set: Average loss: 0.3626, Accuracy: 10611/12000 (88%)

Epoch 10 | Train Acc: 0.8863541666666667 | Test Acc: 0.88425 | Time: 1.0836498737335205 sec

Test set: Average loss: 0.3594, Accuracy: 10626/12000 (89%)

Epoch 11 | Train Acc: 0.8871041666666667 | Test Acc: 0.8855 | Time: 1.1980369091033936 sec

Test set: Average loss: 0.3570, Accuracy: 10635/12000 (89%)

Epoch 12 | Train Acc: 0.8879166666666667 | Test Acc: 0.88625 | Time: 1.0902838706970215 sec

Test set: Average loss: 0.3555, Accuracy: 10645/12000 (89%)

Epoch 13 | Train Acc: 0.8888958333333333 | Test Acc: 0.8870833333333333 | Time: 1.0274038314819336 sec

Test set: Average loss: 0.3545, Accuracy: 10654/12000 (89%)

Epoch 14 | Train Acc: 0.8892291666666666 | Test Acc: 0.8878333333333334 | Time: 1.1185989379882812 sec

Test set: Average loss: 0.3540, Accuracy: 10649/12000 (89%)

Epoch 15 | Train Acc: 0.8896666666666667 | Test Acc: 0.8874166666666666 | Time: 1.0213842391967773 sec

Test set: Average loss: 0.3536, Accuracy: 10651/12000 (89%)

Epoch 16 | Train Acc: 0.8900625 | Test Acc: 0.8875833333333333 | Time: 1.0235090255737305 sec

Test set: Average loss: 0.3533, Accuracy: 10648/12000 (89%)

Epoch 17 | Train Acc: 0.890125 | Test Acc: 0.8873333333333333 | Time: 1.0242114067077637 sec

Test set: Average loss: 0.3532, Accuracy: 10649/12000 (89%)

Epoch 18 | Train Acc: 0.8901041666666667 | Test Acc: 0.8874166666666666 | Time: 1.0292458534240723 sec

Test set: Average loss: 0.3531, Accuracy: 10648/12000 (89%)

Epoch 19 | Train Acc: 0.8900208333333334 | Test Acc: 0.8873333333333333 | Time: 1.0297844409942627 sec
Early stopping at epoch 19

Testing with M=15
Step 0000 | Epoch 01 | Objective: 12.4050 | Coherence: 10.6075 | Separation: 50.4647 | Information gain: 8.0000 | Grad Norm: 14.7900 | Time: 0.1s
Step 0001 | Epoch 01 | Objective: 12.5624 | Coherence: 10.8436 | Separation: 50.4766 | Information gain: 8.0000 | Grad Norm: 14.7845 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.597894  0.488420 -0.508610  ... -0.493815 -0.451139 -0.486368
1  0.442809  0.569599 -0.443908  ... -0.535244 -0.513380 -0.527795
2  0.481423  0.452193 -0.592904  ... -0.478965 -0.461900 -0.399859
3  0.527743  0.529361 -0.579334  ... -0.571778 -0.528044 -0.486721
4  0.455348  0.428686 -0.548447  ... -0.412951 -0.396442 -0.355916

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8027
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9009
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8857
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0226, accuracy=0.0877
Testing SVM
  SVM Test Accuracy: 0.8644
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8320

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6864, Accuracy: 9563/12000 (80%)

Epoch 1 | Train Acc: 0.6506458333333334 | Test Acc: 0.7969166666666667 | Time: 1.1417758464813232 sec

Test set: Average loss: 0.4936, Accuracy: 10145/12000 (85%)

Epoch 2 | Train Acc: 0.8259583333333333 | Test Acc: 0.8454166666666667 | Time: 1.023634672164917 sec

Test set: Average loss: 0.4268, Accuracy: 10416/12000 (87%)

Epoch 3 | Train Acc: 0.8581666666666666 | Test Acc: 0.868 | Time: 1.0315613746643066 sec

Test set: Average loss: 0.3868, Accuracy: 10557/12000 (88%)

Epoch 4 | Train Acc: 0.8729166666666667 | Test Acc: 0.87975 | Time: 1.0245862007141113 sec

Test set: Average loss: 0.3648, Accuracy: 10650/12000 (89%)

Epoch 5 | Train Acc: 0.8822916666666667 | Test Acc: 0.8875 | Time: 1.0237467288970947 sec

Test set: Average loss: 0.3528, Accuracy: 10689/12000 (89%)

Epoch 6 | Train Acc: 0.8886666666666667 | Test Acc: 0.89075 | Time: 1.1786952018737793 sec

Test set: Average loss: 0.3437, Accuracy: 10724/12000 (89%)

Epoch 7 | Train Acc: 0.8927708333333333 | Test Acc: 0.8936666666666667 | Time: 1.255873441696167 sec

Test set: Average loss: 0.3376, Accuracy: 10746/12000 (90%)

Epoch 8 | Train Acc: 0.896 | Test Acc: 0.8955 | Time: 1.440938949584961 sec

Test set: Average loss: 0.3332, Accuracy: 10764/12000 (90%)

Epoch 9 | Train Acc: 0.8983333333333333 | Test Acc: 0.897 | Time: 1.2195346355438232 sec

Test set: Average loss: 0.3299, Accuracy: 10774/12000 (90%)

Epoch 10 | Train Acc: 0.8992916666666667 | Test Acc: 0.8978333333333334 | Time: 1.3154330253601074 sec

Test set: Average loss: 0.3276, Accuracy: 10780/12000 (90%)

Epoch 11 | Train Acc: 0.9002291666666666 | Test Acc: 0.8983333333333333 | Time: 1.3548171520233154 sec

Test set: Average loss: 0.3258, Accuracy: 10784/12000 (90%)

Epoch 12 | Train Acc: 0.901 | Test Acc: 0.8986666666666666 | Time: 1.5414676666259766 sec

Test set: Average loss: 0.3244, Accuracy: 10790/12000 (90%)

Epoch 13 | Train Acc: 0.9014791666666667 | Test Acc: 0.8991666666666667 | Time: 1.2888977527618408 sec

Test set: Average loss: 0.3233, Accuracy: 10788/12000 (90%)

Epoch 14 | Train Acc: 0.9017291666666667 | Test Acc: 0.899 | Time: 1.0254435539245605 sec

Test set: Average loss: 0.3225, Accuracy: 10786/12000 (90%)

Epoch 15 | Train Acc: 0.9018958333333333 | Test Acc: 0.8988333333333334 | Time: 1.0193595886230469 sec

Test set: Average loss: 0.3219, Accuracy: 10794/12000 (90%)

Epoch 16 | Train Acc: 0.9021666666666667 | Test Acc: 0.8995 | Time: 1.0255467891693115 sec

Test set: Average loss: 0.3215, Accuracy: 10795/12000 (90%)

Epoch 17 | Train Acc: 0.9022083333333333 | Test Acc: 0.8995833333333333 | Time: 1.1485991477966309 sec

Test set: Average loss: 0.3212, Accuracy: 10791/12000 (90%)

Epoch 18 | Train Acc: 0.9023958333333333 | Test Acc: 0.89925 | Time: 1.1175553798675537 sec

Test set: Average loss: 0.3210, Accuracy: 10793/12000 (90%)

Epoch 19 | Train Acc: 0.902375 | Test Acc: 0.8994166666666666 | Time: 1.1831681728363037 sec

Test set: Average loss: 0.3209, Accuracy: 10792/12000 (90%)

Epoch 20 | Train Acc: 0.9024583333333334 | Test Acc: 0.8993333333333333 | Time: 1.1756949424743652 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: 15.5908 | Coherence: 12.3861 | Separation: 50.9332 | Information gain: 7.3333 | Grad Norm: 14.7607 | Time: 0.1s
Step 0001 | Epoch 01 | Objective: 15.7507 | Coherence: 12.6261 | Separation: 50.9558 | Information gain: 7.3333 | Grad Norm: 14.7607 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.467894 -0.492538  0.529074  ...  0.403528  0.402078  0.380028
1 -0.478533 -0.602076  0.540025  ...  0.526982  0.441862  0.427868
2 -0.460079 -0.507112  0.567747  ...  0.487663  0.421301  0.417703
3 -0.410234 -0.484829  0.551584  ...  0.483301  0.480514  0.501940
4 -0.385085 -0.476613  0.455930  ...  0.431824  0.495308  0.462254

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8048
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8953
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8792
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.2775, accuracy=0.0986
Testing SVM
  SVM Test Accuracy: 0.8512
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8259

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6623, Accuracy: 9623/12000 (80%)

Epoch 1 | Train Acc: 0.6674166666666667 | Test Acc: 0.8019166666666667 | Time: 1.1000096797943115 sec

Test set: Average loss: 0.5087, Accuracy: 10090/12000 (84%)

Epoch 2 | Train Acc: 0.8221875 | Test Acc: 0.8408333333333333 | Time: 1.343766450881958 sec

Test set: Average loss: 0.4594, Accuracy: 10276/12000 (86%)

Epoch 3 | Train Acc: 0.8480416666666667 | Test Acc: 0.8563333333333333 | Time: 1.1805241107940674 sec

Test set: Average loss: 0.4343, Accuracy: 10366/12000 (86%)

Epoch 4 | Train Acc: 0.8628125 | Test Acc: 0.8638333333333333 | Time: 1.3499150276184082 sec

Test set: Average loss: 0.4091, Accuracy: 10439/12000 (87%)

Epoch 5 | Train Acc: 0.8719791666666666 | Test Acc: 0.8699166666666667 | Time: 1.4860143661499023 sec

Test set: Average loss: 0.3876, Accuracy: 10519/12000 (88%)

Epoch 6 | Train Acc: 0.8779791666666666 | Test Acc: 0.8765833333333334 | Time: 1.1560142040252686 sec

Test set: Average loss: 0.3741, Accuracy: 10570/12000 (88%)

Epoch 7 | Train Acc: 0.8827291666666667 | Test Acc: 0.8808333333333334 | Time: 1.1317176818847656 sec

Test set: Average loss: 0.3649, Accuracy: 10596/12000 (88%)

Epoch 8 | Train Acc: 0.88525 | Test Acc: 0.883 | Time: 1.0231785774230957 sec

Test set: Average loss: 0.3596, Accuracy: 10618/12000 (88%)

Epoch 9 | Train Acc: 0.887375 | Test Acc: 0.8848333333333334 | Time: 1.0268440246582031 sec

Test set: Average loss: 0.3562, Accuracy: 10616/12000 (88%)

Epoch 10 | Train Acc: 0.8887916666666666 | Test Acc: 0.8846666666666667 | Time: 1.3882973194122314 sec

Test set: Average loss: 0.3542, Accuracy: 10622/12000 (89%)

Epoch 11 | Train Acc: 0.8897708333333333 | Test Acc: 0.8851666666666667 | Time: 1.2560887336730957 sec

Test set: Average loss: 0.3528, Accuracy: 10623/12000 (89%)

Epoch 12 | Train Acc: 0.8899166666666667 | Test Acc: 0.88525 | Time: 1.265040636062622 sec

Test set: Average loss: 0.3518, Accuracy: 10621/12000 (89%)

Epoch 13 | Train Acc: 0.8906666666666667 | Test Acc: 0.8850833333333333 | Time: 1.0270164012908936 sec

Test set: Average loss: 0.3513, Accuracy: 10625/12000 (89%)

Epoch 14 | Train Acc: 0.8909583333333333 | Test Acc: 0.8854166666666666 | Time: 1.028794288635254 sec

Test set: Average loss: 0.3508, Accuracy: 10628/12000 (89%)

Epoch 15 | Train Acc: 0.8912708333333333 | Test Acc: 0.8856666666666667 | Time: 1.20875883102417 sec

Test set: Average loss: 0.3506, Accuracy: 10623/12000 (89%)

Epoch 16 | Train Acc: 0.8915416666666667 | Test Acc: 0.88525 | Time: 1.4686472415924072 sec

Test set: Average loss: 0.3504, Accuracy: 10620/12000 (88%)

Epoch 17 | Train Acc: 0.8915833333333333 | Test Acc: 0.885 | Time: 1.4617528915405273 sec

Test set: Average loss: 0.3503, Accuracy: 10618/12000 (88%)

Epoch 18 | Train Acc: 0.8918333333333334 | Test Acc: 0.8848333333333334 | Time: 1.1084394454956055 sec

Test set: Average loss: 0.3502, Accuracy: 10619/12000 (88%)

Epoch 19 | Train Acc: 0.891875 | Test Acc: 0.8849166666666667 | Time: 1.0298175811767578 sec

Test set: Average loss: 0.3502, Accuracy: 10620/12000 (88%)

Epoch 20 | Train Acc: 0.8918333333333334 | Test Acc: 0.885 | Time: 1.0274672508239746 sec
Early stopping at epoch 20

Testing with M=15
Step 0000 | Epoch 01 | Objective: -15.6168 | Coherence: 5.0514 | Separation: 56.9530 | Information gain: 7.3333 | Grad Norm: 21.2169 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: -13.8576 | Coherence: 6.8951 | Separation: 55.3630 | Information gain: 7.3333 | Grad Norm: 20.9116 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -12.1945 | Coherence: 8.8380 | Separation: 54.2596 | Information gain: 7.3333 | Grad Norm: 19.7830 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: -10.5750 | Coherence: 10.7687 | Separation: 53.2624 | Information gain: 7.3333 | Grad Norm: 19.7749 | Time: 0.9s
Step 0040 | Epoch 01 | Objective: -8.9574 | Coherence: 12.6981 | Separation: 52.2683 | Information gain: 7.3333 | Grad Norm: 19.3117 | Time: 1.1s
Step 0050 | Epoch 01 | Objective: -7.3659 | Coherence: 14.6343 | Separation: 51.3662 | Information gain: 7.3333 | Grad Norm: 18.7813 | Time: 1.4s
Step 0060 | Epoch 01 | Objective: -5.9034 | Coherence: 16.5141 | Separation: 50.7383 | Information gain: 7.3333 | Grad Norm: 18.1057 | Time: 1.7s
Step 0070 | Epoch 01 | Objective: -4.4795 | Coherence: 18.2581 | Separation: 49.9548 | Information gain: 7.3333 | Grad Norm: 17.8088 | Time: 1.9s
Step 0080 | Epoch 01 | Objective: -3.0410 | Coherence: 19.9213 | Separation: 48.9656 | Information gain: 7.3333 | Grad Norm: 17.8170 | Time: 2.2s
Step 0090 | Epoch 01 | Objective: -1.6121 | Coherence: 21.5519 | Separation: 47.9400 | Information gain: 7.3333 | Grad Norm: 17.4796 | Time: 2.4s
Step 0100 | Epoch 01 | Objective: -0.2162 | Coherence: 23.1461 | Separation: 46.9409 | Information gain: 7.3333 | Grad Norm: 16.8537 | Time: 2.7s
Step 0109 | Epoch 01 | Objective: 0.9139 | Coherence: 24.5795 | Separation: 46.4175 | Information gain: 7.3333 | Grad Norm: 16.2757 | Time: 2.9s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.617271  0.568913  0.484510  ...  0.569289  0.570445  0.516616
1  0.541242  0.584582  0.495690  ...  0.446278  0.460093  0.548011
2  0.476308  0.506221  0.593545  ...  0.394579  0.454803  0.518819
3  0.554123  0.503921  0.493210  ...  0.553739  0.533932  0.455877
4  0.531999  0.550058  0.521603  ...  0.493854  0.489801  0.529043

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7998
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9000
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8889
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.8138, accuracy=0.1209
Testing SVM
  SVM Test Accuracy: 0.8654
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8351

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6652, Accuracy: 9659/12000 (80%)

Epoch 1 | Train Acc: 0.6746666666666666 | Test Acc: 0.8049166666666666 | Time: 1.0323073863983154 sec

Test set: Average loss: 0.4826, Accuracy: 10266/12000 (86%)

Epoch 2 | Train Acc: 0.8366458333333333 | Test Acc: 0.8555 | Time: 1.0255281925201416 sec

Test set: Average loss: 0.4138, Accuracy: 10481/12000 (87%)

Epoch 3 | Train Acc: 0.8649375 | Test Acc: 0.8734166666666666 | Time: 1.138671875 sec

Test set: Average loss: 0.3799, Accuracy: 10594/12000 (88%)

Epoch 4 | Train Acc: 0.8783958333333334 | Test Acc: 0.8828333333333334 | Time: 1.035144329071045 sec

Test set: Average loss: 0.3582, Accuracy: 10665/12000 (89%)

Epoch 5 | Train Acc: 0.8875 | Test Acc: 0.88875 | Time: 1.1849186420440674 sec

Test set: Average loss: 0.3438, Accuracy: 10726/12000 (89%)

Epoch 6 | Train Acc: 0.8931458333333333 | Test Acc: 0.8938333333333334 | Time: 1.0270569324493408 sec

Test set: Average loss: 0.3326, Accuracy: 10769/12000 (90%)

Epoch 7 | Train Acc: 0.8971666666666667 | Test Acc: 0.8974166666666666 | Time: 1.0229551792144775 sec

Test set: Average loss: 0.3244, Accuracy: 10792/12000 (90%)

Epoch 8 | Train Acc: 0.8999583333333333 | Test Acc: 0.8993333333333333 | Time: 1.02134370803833 sec

Test set: Average loss: 0.3191, Accuracy: 10812/12000 (90%)

Epoch 9 | Train Acc: 0.9021666666666667 | Test Acc: 0.901 | Time: 1.0227622985839844 sec

Test set: Average loss: 0.3156, Accuracy: 10820/12000 (90%)

Epoch 10 | Train Acc: 0.9032708333333334 | Test Acc: 0.9016666666666666 | Time: 1.0259838104248047 sec

Test set: Average loss: 0.3133, Accuracy: 10823/12000 (90%)

Epoch 11 | Train Acc: 0.9043125 | Test Acc: 0.9019166666666667 | Time: 1.022376298904419 sec

Test set: Average loss: 0.3119, Accuracy: 10829/12000 (90%)

Epoch 12 | Train Acc: 0.9055 | Test Acc: 0.9024166666666666 | Time: 1.123105525970459 sec

Test set: Average loss: 0.3109, Accuracy: 10837/12000 (90%)

Epoch 13 | Train Acc: 0.9055 | Test Acc: 0.9030833333333333 | Time: 1.0263755321502686 sec

Test set: Average loss: 0.3103, Accuracy: 10842/12000 (90%)

Epoch 14 | Train Acc: 0.9055208333333333 | Test Acc: 0.9035 | Time: 1.158531904220581 sec

Test set: Average loss: 0.3099, Accuracy: 10846/12000 (90%)

Epoch 15 | Train Acc: 0.9058541666666666 | Test Acc: 0.9038333333333334 | Time: 1.069277048110962 sec

Test set: Average loss: 0.3096, Accuracy: 10847/12000 (90%)

Epoch 16 | Train Acc: 0.9059791666666667 | Test Acc: 0.9039166666666667 | Time: 1.0231499671936035 sec

Test set: Average loss: 0.3093, Accuracy: 10849/12000 (90%)

Epoch 17 | Train Acc: 0.9062291666666666 | Test Acc: 0.9040833333333333 | Time: 1.0234720706939697 sec

Test set: Average loss: 0.3092, Accuracy: 10849/12000 (90%)

Epoch 18 | Train Acc: 0.9062916666666667 | Test Acc: 0.9040833333333333 | Time: 1.0207054615020752 sec

Test set: Average loss: 0.3090, Accuracy: 10848/12000 (90%)

Epoch 19 | Train Acc: 0.906375 | Test Acc: 0.904 | Time: 1.0250177383422852 sec

Test set: Average loss: 0.3090, Accuracy: 10850/12000 (90%)

Epoch 20 | Train Acc: 0.9065208333333333 | Test Acc: 0.9041666666666667 | Time: 1.0365595817565918 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -3.1995 | Coherence: 17.9051 | Separation: 52.4088 | Information gain: 7.0000 | Grad Norm: 17.5901 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -1.6685 | Coherence: 19.8659 | Separation: 51.5709 | Information gain: 6.8333 | Grad Norm: 17.6862 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -0.0644 | Coherence: 21.8224 | Separation: 50.6713 | Information gain: 6.8333 | Grad Norm: 17.6591 | Time: 0.5s
Step 0026 | Epoch 01 | Objective: 0.9075 | Coherence: 22.9844 | Separation: 50.0796 | Information gain: 6.8333 | Grad Norm: 17.6366 | Time: 0.6s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.603574  0.443953  0.516183  ...  0.518442  0.295048  0.504173
1  0.465057  0.622175  0.508139  ...  0.531022  0.170924  0.442329
2  0.490431  0.471144  0.567144  ...  0.493026  0.318194  0.382748
3  0.468967  0.546690  0.487885  ...  0.440193  0.287454  0.451657
4  0.543548  0.527240  0.525002  ...  0.625536  0.115371  0.495793

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7966
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8972
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8810
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.9055, accuracy=0.1136
Testing SVM
  SVM Test Accuracy: 0.8579
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8327

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7096, Accuracy: 9213/12000 (77%)

Epoch 1 | Train Acc: 0.6796666666666666 | Test Acc: 0.76775 | Time: 1.0248043537139893 sec

Test set: Average loss: 0.5390, Accuracy: 9844/12000 (82%)

Epoch 2 | Train Acc: 0.8227291666666666 | Test Acc: 0.8203333333333334 | Time: 1.0235321521759033 sec

Test set: Average loss: 0.4525, Accuracy: 10200/12000 (85%)

Epoch 3 | Train Acc: 0.8495416666666666 | Test Acc: 0.85 | Time: 1.0246291160583496 sec

Test set: Average loss: 0.4171, Accuracy: 10338/12000 (86%)

Epoch 4 | Train Acc: 0.8639791666666666 | Test Acc: 0.8615 | Time: 1.0219523906707764 sec

Test set: Average loss: 0.3971, Accuracy: 10433/12000 (87%)

Epoch 5 | Train Acc: 0.8737916666666666 | Test Acc: 0.8694166666666666 | Time: 1.0371217727661133 sec

Test set: Average loss: 0.3813, Accuracy: 10512/12000 (88%)

Epoch 6 | Train Acc: 0.8791458333333333 | Test Acc: 0.876 | Time: 1.0191636085510254 sec

Test set: Average loss: 0.3716, Accuracy: 10569/12000 (88%)

Epoch 7 | Train Acc: 0.8829583333333333 | Test Acc: 0.88075 | Time: 1.0241422653198242 sec

Test set: Average loss: 0.3649, Accuracy: 10589/12000 (88%)

Epoch 8 | Train Acc: 0.8857083333333333 | Test Acc: 0.8824166666666666 | Time: 1.0247435569763184 sec

Test set: Average loss: 0.3598, Accuracy: 10611/12000 (88%)

Epoch 9 | Train Acc: 0.887625 | Test Acc: 0.88425 | Time: 1.0260577201843262 sec

Test set: Average loss: 0.3566, Accuracy: 10626/12000 (89%)

Epoch 10 | Train Acc: 0.8896041666666666 | Test Acc: 0.8855 | Time: 1.1376807689666748 sec

Test set: Average loss: 0.3545, Accuracy: 10638/12000 (89%)

Epoch 11 | Train Acc: 0.8906458333333334 | Test Acc: 0.8865 | Time: 1.1195287704467773 sec

Test set: Average loss: 0.3529, Accuracy: 10641/12000 (89%)

Epoch 12 | Train Acc: 0.891125 | Test Acc: 0.88675 | Time: 1.0416812896728516 sec

Test set: Average loss: 0.3519, Accuracy: 10647/12000 (89%)

Epoch 13 | Train Acc: 0.8920625 | Test Acc: 0.88725 | Time: 1.0314202308654785 sec

Test set: Average loss: 0.3512, Accuracy: 10650/12000 (89%)

Epoch 14 | Train Acc: 0.8925208333333333 | Test Acc: 0.8875 | Time: 1.0254616737365723 sec

Test set: Average loss: 0.3508, Accuracy: 10646/12000 (89%)

Epoch 15 | Train Acc: 0.8927708333333333 | Test Acc: 0.8871666666666667 | Time: 1.0260684490203857 sec

Test set: Average loss: 0.3505, Accuracy: 10644/12000 (89%)

Epoch 16 | Train Acc: 0.8930625 | Test Acc: 0.887 | Time: 1.0287108421325684 sec

Test set: Average loss: 0.3503, Accuracy: 10644/12000 (89%)

Epoch 17 | Train Acc: 0.8929166666666667 | Test Acc: 0.887 | Time: 1.0237877368927002 sec

Test set: Average loss: 0.3501, Accuracy: 10647/12000 (89%)

Epoch 18 | Train Acc: 0.893125 | Test Acc: 0.88725 | Time: 1.026620864868164 sec

Test set: Average loss: 0.3500, Accuracy: 10647/12000 (89%)

Epoch 19 | Train Acc: 0.8932708333333333 | Test Acc: 0.88725 | Time: 1.119830846786499 sec
Early stopping at epoch 19

Testing with M=15
Step 0000 | Epoch 01 | Objective: 5.7951 | Coherence: 27.2754 | Separation: 54.4989 | Information gain: 8.6667 | Grad Norm: 17.4922 | Time: 0.0s
Step 0001 | Epoch 01 | Objective: 5.9493 | Coherence: 27.4416 | Separation: 54.3688 | Information gain: 8.6667 | Grad Norm: 17.4799 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.611988 -0.414121  0.389649  ...  0.549944  0.521246  0.595907
1 -0.423602 -0.620087  0.418566  ...  0.544633  0.490138  0.396614
2 -0.383912 -0.407523  0.585904  ...  0.344226  0.418082  0.321962
3 -0.398227 -0.400008  0.574358  ...  0.357578  0.413128  0.340842
4 -0.366494 -0.475284  0.529403  ...  0.394660  0.446294  0.332275

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7688
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8764
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8530
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.3909, accuracy=0.0823
Testing SVM
  SVM Test Accuracy: 0.8338
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8108

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.8013, Accuracy: 9065/12000 (76%)

Epoch 1 | Train Acc: 0.6245 | Test Acc: 0.7554166666666666 | Time: 1.0265026092529297 sec

Test set: Average loss: 0.5719, Accuracy: 9800/12000 (82%)

Epoch 2 | Train Acc: 0.79725 | Test Acc: 0.8166666666666667 | Time: 1.0198478698730469 sec

Test set: Average loss: 0.4999, Accuracy: 10052/12000 (84%)

Epoch 3 | Train Acc: 0.8319166666666666 | Test Acc: 0.8376666666666667 | Time: 1.023956298828125 sec

Test set: Average loss: 0.4496, Accuracy: 10230/12000 (85%)

Epoch 4 | Train Acc: 0.8495833333333334 | Test Acc: 0.8525 | Time: 1.0186469554901123 sec

Test set: Average loss: 0.4223, Accuracy: 10340/12000 (86%)

Epoch 5 | Train Acc: 0.860625 | Test Acc: 0.8616666666666667 | Time: 1.0223181247711182 sec

Test set: Average loss: 0.4028, Accuracy: 10421/12000 (87%)

Epoch 6 | Train Acc: 0.8668958333333333 | Test Acc: 0.8684166666666666 | Time: 1.0193307399749756 sec

Test set: Average loss: 0.3887, Accuracy: 10475/12000 (87%)

Epoch 7 | Train Acc: 0.871375 | Test Acc: 0.8729166666666667 | Time: 1.026547908782959 sec

Test set: Average loss: 0.3795, Accuracy: 10507/12000 (88%)

Epoch 8 | Train Acc: 0.8753541666666667 | Test Acc: 0.8755833333333334 | Time: 1.1990697383880615 sec

Test set: Average loss: 0.3737, Accuracy: 10539/12000 (88%)

Epoch 9 | Train Acc: 0.878125 | Test Acc: 0.87825 | Time: 1.0234005451202393 sec

Test set: Average loss: 0.3697, Accuracy: 10568/12000 (88%)

Epoch 10 | Train Acc: 0.8795208333333333 | Test Acc: 0.8806666666666667 | Time: 1.032017707824707 sec

Test set: Average loss: 0.3672, Accuracy: 10581/12000 (88%)

Epoch 11 | Train Acc: 0.88075 | Test Acc: 0.88175 | Time: 1.0686211585998535 sec

Test set: Average loss: 0.3655, Accuracy: 10586/12000 (88%)

Epoch 12 | Train Acc: 0.8814583333333333 | Test Acc: 0.8821666666666667 | Time: 1.0273571014404297 sec

Test set: Average loss: 0.3645, Accuracy: 10593/12000 (88%)

Epoch 13 | Train Acc: 0.8819791666666666 | Test Acc: 0.88275 | Time: 1.0340971946716309 sec

Test set: Average loss: 0.3638, Accuracy: 10597/12000 (88%)

Epoch 14 | Train Acc: 0.8822708333333333 | Test Acc: 0.8830833333333333 | Time: 1.0354149341583252 sec

Test set: Average loss: 0.3632, Accuracy: 10596/12000 (88%)

Epoch 15 | Train Acc: 0.8826875 | Test Acc: 0.883 | Time: 1.0357415676116943 sec

Test set: Average loss: 0.3628, Accuracy: 10600/12000 (88%)

Epoch 16 | Train Acc: 0.882875 | Test Acc: 0.8833333333333333 | Time: 1.025385856628418 sec

Test set: Average loss: 0.3626, Accuracy: 10601/12000 (88%)

Epoch 17 | Train Acc: 0.8830625 | Test Acc: 0.8834166666666666 | Time: 1.1152327060699463 sec

Test set: Average loss: 0.3624, Accuracy: 10603/12000 (88%)

Epoch 18 | Train Acc: 0.8831875 | Test Acc: 0.8835833333333334 | Time: 1.035412311553955 sec

Test set: Average loss: 0.3623, Accuracy: 10602/12000 (88%)

Epoch 19 | Train Acc: 0.88325 | Test Acc: 0.8835 | Time: 1.0684876441955566 sec

Test set: Average loss: 0.3622, Accuracy: 10601/12000 (88%)

Epoch 20 | Train Acc: 0.8834583333333333 | Test Acc: 0.8834166666666666 | Time: 1.027364730834961 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: 1.8120 | Coherence: 16.9443 | Separation: 52.4526 | Information gain: 8.0000 | Grad Norm: 17.7900 | Time: 0.0s
Step 0001 | Epoch 01 | Objective: 1.9678 | Coherence: 17.1408 | Separation: 52.3782 | Information gain: 8.0000 | Grad Norm: 17.6675 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.537006  0.371489  0.439338  ...  0.322150 -0.490923  0.430610
1  0.408187  0.561429  0.400050  ...  0.505377 -0.421639  0.374915
2  0.535124  0.449216  0.635139  ...  0.449241 -0.595065  0.535044
3  0.457412  0.417868  0.499034  ...  0.437645 -0.498790  0.403018
4  0.537946  0.486714  0.426918  ...  0.377617 -0.515330  0.379821

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7935
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9006
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8834
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.7813, accuracy=0.0863
Testing SVM
  SVM Test Accuracy: 0.8539
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8231

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6575, Accuracy: 9543/12000 (80%)

Epoch 1 | Train Acc: 0.6601041666666667 | Test Acc: 0.79525 | Time: 1.0249667167663574 sec

Test set: Average loss: 0.4739, Accuracy: 10211/12000 (85%)

Epoch 2 | Train Acc: 0.8335625 | Test Acc: 0.8509166666666667 | Time: 1.0231688022613525 sec

Test set: Average loss: 0.4124, Accuracy: 10449/12000 (87%)

Epoch 3 | Train Acc: 0.862875 | Test Acc: 0.87075 | Time: 1.02372145652771 sec

Test set: Average loss: 0.3792, Accuracy: 10543/12000 (88%)

Epoch 4 | Train Acc: 0.877 | Test Acc: 0.8785833333333334 | Time: 1.1293816566467285 sec

Test set: Average loss: 0.3582, Accuracy: 10621/12000 (89%)

Epoch 5 | Train Acc: 0.8856041666666666 | Test Acc: 0.8850833333333333 | Time: 1.020766258239746 sec

Test set: Average loss: 0.3451, Accuracy: 10659/12000 (89%)

Epoch 6 | Train Acc: 0.8911875 | Test Acc: 0.88825 | Time: 1.0234804153442383 sec

Test set: Average loss: 0.3352, Accuracy: 10711/12000 (89%)

Epoch 7 | Train Acc: 0.8948958333333333 | Test Acc: 0.8925833333333333 | Time: 1.0257842540740967 sec

Test set: Average loss: 0.3278, Accuracy: 10740/12000 (90%)

Epoch 8 | Train Acc: 0.8974375 | Test Acc: 0.895 | Time: 1.0349419116973877 sec

Test set: Average loss: 0.3229, Accuracy: 10746/12000 (90%)

Epoch 9 | Train Acc: 0.8992291666666666 | Test Acc: 0.8955 | Time: 1.033578634262085 sec

Test set: Average loss: 0.3194, Accuracy: 10764/12000 (90%)

Epoch 10 | Train Acc: 0.9005625 | Test Acc: 0.897 | Time: 1.0398290157318115 sec

Test set: Average loss: 0.3169, Accuracy: 10775/12000 (90%)

Epoch 11 | Train Acc: 0.9015416666666667 | Test Acc: 0.8979166666666667 | Time: 1.0290486812591553 sec

Test set: Average loss: 0.3153, Accuracy: 10786/12000 (90%)

Epoch 12 | Train Acc: 0.9022708333333334 | Test Acc: 0.8988333333333334 | Time: 1.0676593780517578 sec

Test set: Average loss: 0.3142, Accuracy: 10795/12000 (90%)

Epoch 13 | Train Acc: 0.9026458333333334 | Test Acc: 0.8995833333333333 | Time: 1.1212372779846191 sec

Test set: Average loss: 0.3135, Accuracy: 10797/12000 (90%)

Epoch 14 | Train Acc: 0.9031666666666667 | Test Acc: 0.89975 | Time: 1.031386137008667 sec

Test set: Average loss: 0.3130, Accuracy: 10797/12000 (90%)

Epoch 15 | Train Acc: 0.9034791666666667 | Test Acc: 0.89975 | Time: 1.1324570178985596 sec

Test set: Average loss: 0.3126, Accuracy: 10800/12000 (90%)

Epoch 16 | Train Acc: 0.9037708333333333 | Test Acc: 0.9 | Time: 1.0321776866912842 sec

Test set: Average loss: 0.3124, Accuracy: 10805/12000 (90%)

Epoch 17 | Train Acc: 0.9039166666666667 | Test Acc: 0.9004166666666666 | Time: 1.0358836650848389 sec

Test set: Average loss: 0.3122, Accuracy: 10806/12000 (90%)

Epoch 18 | Train Acc: 0.9040208333333334 | Test Acc: 0.9005 | Time: 1.0320179462432861 sec

Test set: Average loss: 0.3121, Accuracy: 10806/12000 (90%)

Epoch 19 | Train Acc: 0.9041875 | Test Acc: 0.9005 | Time: 1.027101755142212 sec

Test set: Average loss: 0.3120, Accuracy: 10807/12000 (90%)

Epoch 20 | Train Acc: 0.9042291666666666 | Test Acc: 0.9005833333333333 | Time: 1.0335099697113037 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -28.4371 | Coherence: 15.1390 | Separation: 57.7947 | Information gain: 6.8333 | Grad Norm: 30.1418 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -26.6335 | Coherence: 15.7316 | Separation: 55.6819 | Information gain: 6.8333 | Grad Norm: 29.1834 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -24.9417 | Coherence: 16.3434 | Separation: 53.7559 | Information gain: 6.8333 | Grad Norm: 28.1543 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -23.4247 | Coherence: 17.0196 | Separation: 52.1566 | Information gain: 6.8333 | Grad Norm: 26.4853 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -22.0260 | Coherence: 17.8464 | Separation: 50.8854 | Information gain: 6.6667 | Grad Norm: 25.4010 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -20.6701 | Coherence: 18.6955 | Separation: 49.7006 | Information gain: 6.6667 | Grad Norm: 25.0306 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -19.3769 | Coherence: 19.5243 | Separation: 48.5896 | Information gain: 6.6667 | Grad Norm: 24.3990 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -18.1676 | Coherence: 20.3989 | Separation: 47.6504 | Information gain: 6.6667 | Grad Norm: 23.5682 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -16.9657 | Coherence: 21.2815 | Separation: 46.7300 | Information gain: 6.5000 | Grad Norm: 23.6207 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -15.7132 | Coherence: 22.1855 | Separation: 45.7553 | Information gain: 6.5000 | Grad Norm: 23.1477 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -14.4144 | Coherence: 23.0954 | Separation: 44.7170 | Information gain: 6.5000 | Grad Norm: 22.7460 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -13.1593 | Coherence: 24.0389 | Separation: 43.7779 | Information gain: 6.5000 | Grad Norm: 21.8566 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -11.9464 | Coherence: 24.9799 | Separation: 42.8996 | Information gain: 6.5000 | Grad Norm: 21.6239 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -10.7441 | Coherence: 25.9016 | Separation: 42.0176 | Information gain: 6.5000 | Grad Norm: 21.5156 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -9.5455 | Coherence: 26.7745 | Separation: 41.0927 | Information gain: 6.5000 | Grad Norm: 20.6373 | Time: 3.2s
Step 0150 | Epoch 01 | Objective: -8.2986 | Coherence: 27.5869 | Separation: 40.0348 | Information gain: 6.3333 | Grad Norm: 21.0587 | Time: 3.5s
Step 0160 | Epoch 01 | Objective: -7.0514 | Coherence: 28.3893 | Separation: 38.9664 | Information gain: 6.3333 | Grad Norm: 20.7812 | Time: 3.7s
Step 0170 | Epoch 01 | Objective: -5.7677 | Coherence: 29.1660 | Separation: 37.8175 | Information gain: 6.5000 | Grad Norm: 22.4235 | Time: 3.9s
Step 0180 | Epoch 01 | Objective: -4.4868 | Coherence: 29.8913 | Separation: 36.6214 | Information gain: 6.5000 | Grad Norm: 19.8672 | Time: 4.2s
Step 0190 | Epoch 01 | Objective: -3.2928 | Coherence: 30.5558 | Separation: 35.4950 | Information gain: 6.5000 | Grad Norm: 19.2879 | Time: 4.4s
Step 0200 | Epoch 01 | Objective: -2.1288 | Coherence: 31.1910 | Separation: 34.3842 | Information gain: 6.6667 | Grad Norm: 19.9856 | Time: 4.6s
Step 0210 | Epoch 01 | Objective: -0.9984 | Coherence: 31.8982 | Separation: 33.3958 | Information gain: 6.8333 | Grad Norm: 19.0107 | Time: 4.8s
Step 0220 | Epoch 01 | Objective: 0.0426 | Coherence: 32.6094 | Separation: 32.5454 | Information gain: 6.8333 | Grad Norm: 18.7806 | Time: 5.1s
Step 0229 | Epoch 01 | Objective: 0.9708 | Coherence: 33.1815 | Separation: 31.7253 | Information gain: 6.8333 | Grad Norm: 18.6566 | Time: 5.3s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.614804 -0.528378  0.555228  ...  0.523324  0.481030  0.466615
1  0.493614 -0.574344  0.523377  ...  0.438624  0.506146  0.320563
2  0.524580 -0.522668  0.578225  ...  0.449305  0.417204  0.369401
3  0.512297 -0.544667  0.479162  ...  0.557101  0.582587  0.401102
4  0.475485 -0.444255  0.410438  ...  0.453351  0.454102  0.473469

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8080
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9005
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8850
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.2804, accuracy=0.0838
Testing SVM
  SVM Test Accuracy: 0.8592
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8330

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6547, Accuracy: 9676/12000 (81%)

Epoch 1 | Train Acc: 0.6720625 | Test Acc: 0.8063333333333333 | Time: 1.0313937664031982 sec

Test set: Average loss: 0.4755, Accuracy: 10200/12000 (85%)

Epoch 2 | Train Acc: 0.8371458333333334 | Test Acc: 0.85 | Time: 1.022430658340454 sec

Test set: Average loss: 0.4256, Accuracy: 10330/12000 (86%)

Epoch 3 | Train Acc: 0.8610208333333333 | Test Acc: 0.8608333333333333 | Time: 1.0316781997680664 sec

Test set: Average loss: 0.3870, Accuracy: 10479/12000 (87%)

Epoch 4 | Train Acc: 0.873875 | Test Acc: 0.87325 | Time: 1.0288007259368896 sec

Test set: Average loss: 0.3653, Accuracy: 10572/12000 (88%)

Epoch 5 | Train Acc: 0.88225 | Test Acc: 0.881 | Time: 1.0202512741088867 sec

Test set: Average loss: 0.3523, Accuracy: 10629/12000 (89%)

Epoch 6 | Train Acc: 0.8873125 | Test Acc: 0.88575 | Time: 1.0175249576568604 sec

Test set: Average loss: 0.3445, Accuracy: 10648/12000 (89%)

Epoch 7 | Train Acc: 0.8906458333333334 | Test Acc: 0.8873333333333333 | Time: 1.034351110458374 sec

Test set: Average loss: 0.3398, Accuracy: 10669/12000 (89%)

Epoch 8 | Train Acc: 0.8933125 | Test Acc: 0.8890833333333333 | Time: 1.0256032943725586 sec

Test set: Average loss: 0.3366, Accuracy: 10670/12000 (89%)

Epoch 9 | Train Acc: 0.8953541666666667 | Test Acc: 0.8891666666666667 | Time: 1.0187759399414062 sec

Test set: Average loss: 0.3343, Accuracy: 10678/12000 (89%)

Epoch 10 | Train Acc: 0.8965833333333333 | Test Acc: 0.8898333333333334 | Time: 1.1057076454162598 sec

Test set: Average loss: 0.3326, Accuracy: 10684/12000 (89%)

Epoch 11 | Train Acc: 0.8975 | Test Acc: 0.8903333333333333 | Time: 1.2071871757507324 sec

Test set: Average loss: 0.3314, Accuracy: 10682/12000 (89%)

Epoch 12 | Train Acc: 0.8983541666666667 | Test Acc: 0.8901666666666667 | Time: 1.059828281402588 sec

Test set: Average loss: 0.3305, Accuracy: 10690/12000 (89%)

Epoch 13 | Train Acc: 0.89875 | Test Acc: 0.8908333333333334 | Time: 1.033562421798706 sec

Test set: Average loss: 0.3298, Accuracy: 10692/12000 (89%)

Epoch 14 | Train Acc: 0.8989375 | Test Acc: 0.891 | Time: 1.0208745002746582 sec

Test set: Average loss: 0.3294, Accuracy: 10692/12000 (89%)

Epoch 15 | Train Acc: 0.8991041666666667 | Test Acc: 0.891 | Time: 1.029078722000122 sec

Test set: Average loss: 0.3291, Accuracy: 10692/12000 (89%)

Epoch 16 | Train Acc: 0.8993541666666667 | Test Acc: 0.891 | Time: 1.0195636749267578 sec

Test set: Average loss: 0.3289, Accuracy: 10696/12000 (89%)

Epoch 17 | Train Acc: 0.8993958333333333 | Test Acc: 0.8913333333333333 | Time: 1.0233547687530518 sec

Test set: Average loss: 0.3288, Accuracy: 10694/12000 (89%)

Epoch 18 | Train Acc: 0.8993333333333333 | Test Acc: 0.8911666666666667 | Time: 1.0231962203979492 sec

Test set: Average loss: 0.3287, Accuracy: 10695/12000 (89%)

Epoch 19 | Train Acc: 0.8993333333333333 | Test Acc: 0.89125 | Time: 1.0181820392608643 sec

Test set: Average loss: 0.3286, Accuracy: 10696/12000 (89%)

Epoch 20 | Train Acc: 0.89925 | Test Acc: 0.8913333333333333 | Time: 1.1163713932037354 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -24.1495 | Coherence: 23.8183 | Separation: 63.4592 | Information gain: 6.8333 | Grad Norm: 29.3582 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -22.2725 | Coherence: 24.4325 | Separation: 61.5079 | Information gain: 7.3333 | Grad Norm: 29.1083 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -20.5391 | Coherence: 25.0537 | Separation: 59.5290 | Information gain: 7.3333 | Grad Norm: 28.4823 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -18.7008 | Coherence: 25.7612 | Separation: 57.7290 | Information gain: 7.8333 | Grad Norm: 27.2795 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -17.1769 | Coherence: 26.5297 | Separation: 56.2117 | Information gain: 7.8333 | Grad Norm: 25.9823 | Time: 0.9s
Step 0050 | Epoch 01 | Objective: -15.6374 | Coherence: 27.2684 | Separation: 54.7245 | Information gain: 8.0000 | Grad Norm: 25.3305 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -14.2071 | Coherence: 28.0826 | Separation: 53.3933 | Information gain: 8.0000 | Grad Norm: 25.5003 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -12.8023 | Coherence: 28.8993 | Separation: 52.1027 | Information gain: 8.0000 | Grad Norm: 24.2736 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -11.4019 | Coherence: 29.7344 | Separation: 50.8372 | Information gain: 8.0000 | Grad Norm: 24.0503 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -10.1811 | Coherence: 30.5029 | Separation: 49.6079 | Information gain: 7.6667 | Grad Norm: 24.9848 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -8.8228 | Coherence: 31.2923 | Separation: 48.3598 | Information gain: 7.6667 | Grad Norm: 22.6246 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -7.5535 | Coherence: 32.0414 | Separation: 47.2049 | Information gain: 7.6667 | Grad Norm: 22.0230 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -6.2385 | Coherence: 32.7686 | Separation: 45.9597 | Information gain: 7.6667 | Grad Norm: 22.6447 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -4.7715 | Coherence: 33.4834 | Separation: 44.6408 | Information gain: 8.0000 | Grad Norm: 22.5931 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -3.3814 | Coherence: 34.1688 | Separation: 43.3242 | Information gain: 8.1667 | Grad Norm: 21.2504 | Time: 3.3s
Step 0150 | Epoch 01 | Objective: -2.0724 | Coherence: 34.8115 | Separation: 42.0035 | Information gain: 8.1667 | Grad Norm: 19.5605 | Time: 3.5s
Step 0160 | Epoch 01 | Objective: -0.8979 | Coherence: 35.4954 | Separation: 41.0088 | Information gain: 8.3333 | Grad Norm: 20.4053 | Time: 3.7s
Step 0170 | Epoch 01 | Objective: 0.1821 | Coherence: 36.2511 | Separation: 40.1445 | Information gain: 8.3333 | Grad Norm: 19.2583 | Time: 3.9s
Step 0177 | Epoch 01 | Objective: 0.9458 | Coherence: 36.7653 | Separation: 39.5132 | Information gain: 8.3333 | Grad Norm: 19.8258 | Time: 4.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.597579  0.371405  0.512662  ...  0.476361  0.541354  0.573380
1  0.397376  0.665695  0.487351  ...  0.451509  0.442102  0.364568
2  0.506370  0.455707  0.600994  ...  0.481402  0.562840  0.440566
3  0.474703  0.467127  0.548763  ...  0.455078  0.530325  0.436712
4  0.447762  0.542613  0.436818  ...  0.407619  0.440363  0.439998

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7991
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9005
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8816
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0339, accuracy=0.0920
Testing SVM
  SVM Test Accuracy: 0.8596
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8371

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6495, Accuracy: 9685/12000 (81%)

Epoch 1 | Train Acc: 0.6745208333333333 | Test Acc: 0.8070833333333334 | Time: 1.0332493782043457 sec

Test set: Average loss: 0.4816, Accuracy: 10218/12000 (85%)

Epoch 2 | Train Acc: 0.8260833333333333 | Test Acc: 0.8515 | Time: 1.0724942684173584 sec

Test set: Average loss: 0.4180, Accuracy: 10442/12000 (87%)

Epoch 3 | Train Acc: 0.8536041666666667 | Test Acc: 0.8701666666666666 | Time: 1.0220015048980713 sec

Test set: Average loss: 0.3822, Accuracy: 10553/12000 (88%)

Epoch 4 | Train Acc: 0.870625 | Test Acc: 0.8794166666666666 | Time: 1.0247223377227783 sec

Test set: Average loss: 0.3597, Accuracy: 10620/12000 (88%)

Epoch 5 | Train Acc: 0.8819375 | Test Acc: 0.885 | Time: 1.023348331451416 sec

Test set: Average loss: 0.3469, Accuracy: 10666/12000 (89%)

Epoch 6 | Train Acc: 0.8883333333333333 | Test Acc: 0.8888333333333334 | Time: 1.0293242931365967 sec

Test set: Average loss: 0.3358, Accuracy: 10701/12000 (89%)

Epoch 7 | Train Acc: 0.8928125 | Test Acc: 0.89175 | Time: 1.029949426651001 sec

Test set: Average loss: 0.3269, Accuracy: 10746/12000 (90%)

Epoch 8 | Train Acc: 0.8957083333333333 | Test Acc: 0.8955 | Time: 1.1418018341064453 sec

Test set: Average loss: 0.3200, Accuracy: 10766/12000 (90%)

Epoch 9 | Train Acc: 0.8979791666666667 | Test Acc: 0.8971666666666667 | Time: 1.0223991870880127 sec

Test set: Average loss: 0.3148, Accuracy: 10783/12000 (90%)

Epoch 10 | Train Acc: 0.8996041666666666 | Test Acc: 0.8985833333333333 | Time: 1.0228440761566162 sec

Test set: Average loss: 0.3117, Accuracy: 10804/12000 (90%)

Epoch 11 | Train Acc: 0.9009583333333333 | Test Acc: 0.9003333333333333 | Time: 1.0503098964691162 sec

Test set: Average loss: 0.3099, Accuracy: 10815/12000 (90%)

Epoch 12 | Train Acc: 0.9015 | Test Acc: 0.90125 | Time: 1.0406053066253662 sec

Test set: Average loss: 0.3089, Accuracy: 10815/12000 (90%)

Epoch 13 | Train Acc: 0.9021666666666667 | Test Acc: 0.90125 | Time: 1.0255630016326904 sec

Test set: Average loss: 0.3082, Accuracy: 10818/12000 (90%)

Epoch 14 | Train Acc: 0.9025416666666667 | Test Acc: 0.9015 | Time: 1.0296483039855957 sec

Test set: Average loss: 0.3077, Accuracy: 10825/12000 (90%)

Epoch 15 | Train Acc: 0.9027708333333333 | Test Acc: 0.9020833333333333 | Time: 1.0316662788391113 sec

Test set: Average loss: 0.3074, Accuracy: 10829/12000 (90%)

Epoch 16 | Train Acc: 0.90275 | Test Acc: 0.9024166666666666 | Time: 1.0298008918762207 sec

Test set: Average loss: 0.3072, Accuracy: 10830/12000 (90%)

Epoch 17 | Train Acc: 0.9027291666666667 | Test Acc: 0.9025 | Time: 1.1257436275482178 sec

Test set: Average loss: 0.3070, Accuracy: 10830/12000 (90%)

Epoch 18 | Train Acc: 0.9029166666666667 | Test Acc: 0.9025 | Time: 1.0228581428527832 sec

Test set: Average loss: 0.3069, Accuracy: 10828/12000 (90%)

Epoch 19 | Train Acc: 0.9029791666666667 | Test Acc: 0.9023333333333333 | Time: 1.0234568119049072 sec

Test set: Average loss: 0.3069, Accuracy: 10827/12000 (90%)

Epoch 20 | Train Acc: 0.9030833333333333 | Test Acc: 0.90225 | Time: 1.0252020359039307 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -19.2691 | Coherence: 17.0613 | Separation: 53.6316 | Information gain: 7.6667 | Grad Norm: 28.0815 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -17.5032 | Coherence: 18.2535 | Separation: 52.1750 | Information gain: 7.6667 | Grad Norm: 27.4627 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -15.7588 | Coherence: 19.4950 | Separation: 50.7998 | Information gain: 7.6667 | Grad Norm: 27.0833 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -14.0139 | Coherence: 20.7500 | Separation: 49.4376 | Information gain: 7.6667 | Grad Norm: 26.7629 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -12.2432 | Coherence: 22.0008 | Separation: 48.0322 | Information gain: 7.6667 | Grad Norm: 26.6248 | Time: 0.9s
Step 0050 | Epoch 01 | Objective: -10.4613 | Coherence: 23.2572 | Separation: 46.6158 | Information gain: 7.6667 | Grad Norm: 26.2733 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -8.5890 | Coherence: 24.5156 | Separation: 45.2325 | Information gain: 7.8333 | Grad Norm: 25.3226 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -6.8932 | Coherence: 25.7581 | Separation: 43.9312 | Information gain: 7.8333 | Grad Norm: 25.7447 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -5.2870 | Coherence: 26.9937 | Separation: 42.7576 | Information gain: 7.8333 | Grad Norm: 24.3564 | Time: 1.8s
Step 0090 | Epoch 01 | Objective: -3.8937 | Coherence: 28.1396 | Separation: 41.6469 | Information gain: 7.6667 | Grad Norm: 22.7132 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -2.5103 | Coherence: 29.2244 | Separation: 40.6565 | Information gain: 7.6667 | Grad Norm: 21.6689 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -1.0754 | Coherence: 30.3048 | Separation: 39.7511 | Information gain: 7.8333 | Grad Norm: 21.2800 | Time: 2.5s
Step 0120 | Epoch 01 | Objective: 0.2201 | Coherence: 31.3677 | Separation: 38.8709 | Information gain: 7.8333 | Grad Norm: 21.0501 | Time: 2.7s
Step 0126 | Epoch 01 | Objective: 0.9932 | Coherence: 31.9625 | Separation: 38.4726 | Information gain: 8.0000 | Grad Norm: 19.7456 | Time: 2.9s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.649603  0.610742  0.463271  ...  0.395445  0.581749  0.453534
1  0.594686  0.633741  0.466698  ...  0.450125  0.609465  0.462523
2  0.458124  0.470320  0.642834  ...  0.577947  0.532521  0.461885
3  0.413427  0.361195  0.460960  ...  0.392008  0.391277  0.406033
4  0.408309  0.368150  0.471703  ...  0.403165  0.392277  0.391219

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7768
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8865
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8620
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0440, accuracy=0.1065
Testing SVM
  SVM Test Accuracy: 0.8532
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8274

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7892, Accuracy: 8983/12000 (75%)

Epoch 1 | Train Acc: 0.6219375 | Test Acc: 0.7485833333333334 | Time: 1.0231282711029053 sec

Test set: Average loss: 0.5397, Accuracy: 9948/12000 (83%)

Epoch 2 | Train Acc: 0.8013333333333333 | Test Acc: 0.829 | Time: 1.0223958492279053 sec

Test set: Average loss: 0.4664, Accuracy: 10197/12000 (85%)

Epoch 3 | Train Acc: 0.8383333333333334 | Test Acc: 0.84975 | Time: 1.2776587009429932 sec

Test set: Average loss: 0.4209, Accuracy: 10412/12000 (87%)

Epoch 4 | Train Acc: 0.8573541666666666 | Test Acc: 0.8676666666666667 | Time: 1.5275890827178955 sec

Test set: Average loss: 0.3919, Accuracy: 10534/12000 (88%)

Epoch 5 | Train Acc: 0.8684375 | Test Acc: 0.8778333333333334 | Time: 1.5526175498962402 sec

Test set: Average loss: 0.3746, Accuracy: 10609/12000 (88%)

Epoch 6 | Train Acc: 0.8753958333333334 | Test Acc: 0.8840833333333333 | Time: 1.2658965587615967 sec

Test set: Average loss: 0.3646, Accuracy: 10639/12000 (89%)

Epoch 7 | Train Acc: 0.879375 | Test Acc: 0.8865833333333333 | Time: 1.3345797061920166 sec

Test set: Average loss: 0.3580, Accuracy: 10666/12000 (89%)

Epoch 8 | Train Acc: 0.8827291666666667 | Test Acc: 0.8888333333333334 | Time: 1.4323160648345947 sec

Test set: Average loss: 0.3537, Accuracy: 10694/12000 (89%)

Epoch 9 | Train Acc: 0.8844583333333333 | Test Acc: 0.8911666666666667 | Time: 1.4206182956695557 sec

Test set: Average loss: 0.3509, Accuracy: 10702/12000 (89%)

Epoch 10 | Train Acc: 0.8855833333333333 | Test Acc: 0.8918333333333334 | Time: 1.06412935256958 sec

Test set: Average loss: 0.3489, Accuracy: 10706/12000 (89%)

Epoch 11 | Train Acc: 0.8868958333333333 | Test Acc: 0.8921666666666667 | Time: 1.0257089138031006 sec

Test set: Average loss: 0.3475, Accuracy: 10709/12000 (89%)

Epoch 12 | Train Acc: 0.8877916666666666 | Test Acc: 0.8924166666666666 | Time: 1.02392578125 sec

Test set: Average loss: 0.3465, Accuracy: 10714/12000 (89%)

Epoch 13 | Train Acc: 0.8883541666666667 | Test Acc: 0.8928333333333334 | Time: 1.1456775665283203 sec

Test set: Average loss: 0.3458, Accuracy: 10712/12000 (89%)

Epoch 14 | Train Acc: 0.8884583333333333 | Test Acc: 0.8926666666666667 | Time: 1.2701399326324463 sec

Test set: Average loss: 0.3454, Accuracy: 10710/12000 (89%)

Epoch 15 | Train Acc: 0.888875 | Test Acc: 0.8925 | Time: 1.2941789627075195 sec

Test set: Average loss: 0.3451, Accuracy: 10710/12000 (89%)

Epoch 16 | Train Acc: 0.889 | Test Acc: 0.8925 | Time: 1.0716443061828613 sec

Test set: Average loss: 0.3449, Accuracy: 10712/12000 (89%)

Epoch 17 | Train Acc: 0.8889583333333333 | Test Acc: 0.8926666666666667 | Time: 1.285360336303711 sec

Test set: Average loss: 0.3448, Accuracy: 10712/12000 (89%)

Epoch 18 | Train Acc: 0.8891458333333333 | Test Acc: 0.8926666666666667 | Time: 1.4357481002807617 sec
Early stopping at epoch 18

Testing with M=15
Step 0000 | Epoch 01 | Objective: -17.4753 | Coherence: 17.6263 | Separation: 53.8392 | Information gain: 6.6667 | Grad Norm: 29.6270 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -15.4612 | Coherence: 18.9630 | Separation: 52.1548 | Information gain: 6.6667 | Grad Norm: 28.1066 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -13.3428 | Coherence: 20.2778 | Separation: 50.5421 | Information gain: 6.8333 | Grad Norm: 27.6126 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -11.5147 | Coherence: 21.4994 | Separation: 49.0215 | Information gain: 6.8333 | Grad Norm: 26.0751 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -9.7876 | Coherence: 22.6963 | Separation: 47.6276 | Information gain: 6.8333 | Grad Norm: 24.9603 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -8.1654 | Coherence: 23.8173 | Separation: 46.3154 | Information gain: 6.8333 | Grad Norm: 24.5771 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -6.5965 | Coherence: 24.8797 | Separation: 45.0244 | Information gain: 6.8333 | Grad Norm: 25.0588 | Time: 1.5s
Step 0070 | Epoch 01 | Objective: -5.0317 | Coherence: 25.9689 | Separation: 43.7665 | Information gain: 6.8333 | Grad Norm: 23.9255 | Time: 1.8s
Step 0080 | Epoch 01 | Objective: -3.4488 | Coherence: 27.0498 | Separation: 42.4731 | Information gain: 6.8333 | Grad Norm: 24.0730 | Time: 2.0s
Step 0090 | Epoch 01 | Objective: -1.8497 | Coherence: 28.1157 | Separation: 41.1403 | Information gain: 6.8333 | Grad Norm: 23.5435 | Time: 2.3s
Step 0100 | Epoch 01 | Objective: -0.1011 | Coherence: 29.1473 | Separation: 39.7990 | Information gain: 7.0000 | Grad Norm: 23.0017 | Time: 2.6s
Step 0107 | Epoch 01 | Objective: 1.0095 | Coherence: 29.8334 | Separation: 38.8192 | Information gain: 7.0000 | Grad Norm: 23.2640 | Time: 2.7s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.582263  0.456078  0.462270  ...  0.503531  0.337901  0.425471
1  0.409382  0.535953  0.455205  ...  0.420101  0.340688  0.447487
2  0.448481  0.482537  0.565817  ...  0.469432  0.370872  0.557674
3  0.386415  0.490396  0.540985  ...  0.465351  0.419804  0.567785
4  0.491386  0.535495  0.561295  ...  0.557272  0.332602  0.557903

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7985
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8974
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8770
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.2497, accuracy=0.1120
Testing SVM
  SVM Test Accuracy: 0.8605
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8292

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.8056, Accuracy: 8805/12000 (73%)

Epoch 1 | Train Acc: 0.647 | Test Acc: 0.73375 | Time: 1.1216883659362793 sec

Test set: Average loss: 0.5726, Accuracy: 9720/12000 (81%)

Epoch 2 | Train Acc: 0.821375 | Test Acc: 0.81 | Time: 1.5081067085266113 sec

Test set: Average loss: 0.4469, Accuracy: 10256/12000 (85%)

Epoch 3 | Train Acc: 0.8528333333333333 | Test Acc: 0.8546666666666667 | Time: 1.0721497535705566 sec

Test set: Average loss: 0.4022, Accuracy: 10455/12000 (87%)

Epoch 4 | Train Acc: 0.8678541666666667 | Test Acc: 0.87125 | Time: 1.026418685913086 sec

Test set: Average loss: 0.3782, Accuracy: 10549/12000 (88%)

Epoch 5 | Train Acc: 0.8783333333333333 | Test Acc: 0.8790833333333333 | Time: 1.4409589767456055 sec

Test set: Average loss: 0.3612, Accuracy: 10630/12000 (89%)

Epoch 6 | Train Acc: 0.8843958333333334 | Test Acc: 0.8858333333333334 | Time: 1.1951944828033447 sec

Test set: Average loss: 0.3508, Accuracy: 10659/12000 (89%)

Epoch 7 | Train Acc: 0.8886458333333334 | Test Acc: 0.88825 | Time: 1.132633924484253 sec

Test set: Average loss: 0.3441, Accuracy: 10682/12000 (89%)

Epoch 8 | Train Acc: 0.8912916666666667 | Test Acc: 0.8901666666666667 | Time: 1.022688388824463 sec

Test set: Average loss: 0.3392, Accuracy: 10696/12000 (89%)

Epoch 9 | Train Acc: 0.8934791666666667 | Test Acc: 0.8913333333333333 | Time: 1.018739938735962 sec

Test set: Average loss: 0.3361, Accuracy: 10715/12000 (89%)

Epoch 10 | Train Acc: 0.8948333333333334 | Test Acc: 0.8929166666666667 | Time: 1.023547649383545 sec

Test set: Average loss: 0.3340, Accuracy: 10719/12000 (89%)

Epoch 11 | Train Acc: 0.8957916666666667 | Test Acc: 0.89325 | Time: 1.169764757156372 sec

Test set: Average loss: 0.3326, Accuracy: 10727/12000 (89%)

Epoch 12 | Train Acc: 0.8965625 | Test Acc: 0.8939166666666667 | Time: 1.469710111618042 sec

Test set: Average loss: 0.3317, Accuracy: 10725/12000 (89%)

Epoch 13 | Train Acc: 0.8972708333333334 | Test Acc: 0.89375 | Time: 1.3159053325653076 sec

Test set: Average loss: 0.3311, Accuracy: 10724/12000 (89%)

Epoch 14 | Train Acc: 0.8976666666666666 | Test Acc: 0.8936666666666667 | Time: 1.2595477104187012 sec

Test set: Average loss: 0.3306, Accuracy: 10727/12000 (89%)

Epoch 15 | Train Acc: 0.898125 | Test Acc: 0.8939166666666667 | Time: 1.2124783992767334 sec

Test set: Average loss: 0.3303, Accuracy: 10730/12000 (89%)

Epoch 16 | Train Acc: 0.8983125 | Test Acc: 0.8941666666666667 | Time: 1.023017406463623 sec

Test set: Average loss: 0.3301, Accuracy: 10732/12000 (89%)

Epoch 17 | Train Acc: 0.89875 | Test Acc: 0.8943333333333333 | Time: 1.2059643268585205 sec

Test set: Average loss: 0.3299, Accuracy: 10736/12000 (89%)

Epoch 18 | Train Acc: 0.8988333333333334 | Test Acc: 0.8946666666666667 | Time: 1.153458833694458 sec

Test set: Average loss: 0.3298, Accuracy: 10738/12000 (89%)

Epoch 19 | Train Acc: 0.8989791666666667 | Test Acc: 0.8948333333333334 | Time: 1.4202282428741455 sec

Test set: Average loss: 0.3297, Accuracy: 10737/12000 (89%)

Epoch 20 | Train Acc: 0.8989583333333333 | Test Acc: 0.89475 | Time: 1.1601097583770752 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -48.0601 | Coherence: 17.5590 | Separation: 59.7661 | Information gain: 8.0000 | Grad Norm: 49.1797 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -44.8977 | Coherence: 18.2164 | Separation: 57.0419 | Information gain: 8.0000 | Grad Norm: 47.8155 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -41.7475 | Coherence: 18.8741 | Separation: 54.3302 | Information gain: 8.0000 | Grad Norm: 47.0595 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -38.7242 | Coherence: 19.5127 | Separation: 51.7327 | Information gain: 8.0000 | Grad Norm: 44.1664 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -36.0600 | Coherence: 20.0892 | Separation: 49.4527 | Information gain: 7.8333 | Grad Norm: 42.4337 | Time: 0.9s
Step 0050 | Epoch 01 | Objective: -33.5370 | Coherence: 20.5848 | Separation: 47.2602 | Information gain: 7.8333 | Grad Norm: 40.2380 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -31.3516 | Coherence: 21.1170 | Separation: 45.4296 | Information gain: 7.8333 | Grad Norm: 37.6505 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -29.3165 | Coherence: 21.5833 | Separation: 43.7054 | Information gain: 7.8333 | Grad Norm: 36.5722 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -27.3682 | Coherence: 21.9734 | Separation: 42.0171 | Information gain: 8.0000 | Grad Norm: 34.8102 | Time: 1.8s
Step 0090 | Epoch 01 | Objective: -25.5062 | Coherence: 22.3484 | Separation: 40.4051 | Information gain: 7.8333 | Grad Norm: 37.3085 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -23.7751 | Coherence: 22.8445 | Separation: 39.0047 | Information gain: 7.8333 | Grad Norm: 32.8474 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -22.0209 | Coherence: 23.3476 | Separation: 37.5860 | Information gain: 7.8333 | Grad Norm: 34.7157 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -20.3187 | Coherence: 23.8149 | Separation: 36.1953 | Information gain: 7.8333 | Grad Norm: 33.4139 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -18.6586 | Coherence: 24.3342 | Separation: 34.8814 | Information gain: 7.8333 | Grad Norm: 32.7253 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -17.1172 | Coherence: 24.9072 | Separation: 33.7220 | Information gain: 8.0000 | Grad Norm: 29.9875 | Time: 3.3s
Step 0150 | Epoch 01 | Objective: -15.7916 | Coherence: 25.4827 | Separation: 32.7801 | Information gain: 8.0000 | Grad Norm: 31.2723 | Time: 3.5s
Step 0160 | Epoch 01 | Objective: -14.5308 | Coherence: 26.0502 | Separation: 31.8976 | Information gain: 8.0000 | Grad Norm: 29.5509 | Time: 3.8s
Step 0170 | Epoch 01 | Objective: -13.3242 | Coherence: 26.6445 | Separation: 31.0872 | Information gain: 8.0000 | Grad Norm: 27.1004 | Time: 4.1s
Step 0180 | Epoch 01 | Objective: -12.2431 | Coherence: 27.2361 | Separation: 30.4005 | Information gain: 7.8333 | Grad Norm: 28.0973 | Time: 4.4s
Step 0190 | Epoch 01 | Objective: -11.1965 | Coherence: 27.7757 | Separation: 29.7136 | Information gain: 7.8333 | Grad Norm: 27.3106 | Time: 4.6s
Step 0200 | Epoch 01 | Objective: -10.1262 | Coherence: 28.3139 | Separation: 29.0021 | Information gain: 8.0000 | Grad Norm: 25.7862 | Time: 4.9s
Step 0210 | Epoch 01 | Objective: -9.1909 | Coherence: 28.8326 | Separation: 28.4127 | Information gain: 8.0000 | Grad Norm: 23.4223 | Time: 5.2s
Step 0220 | Epoch 01 | Objective: -8.3279 | Coherence: 29.3045 | Separation: 27.8643 | Information gain: 8.1667 | Grad Norm: 24.5581 | Time: 5.4s
Step 0230 | Epoch 01 | Objective: -7.4652 | Coherence: 29.7278 | Separation: 27.2838 | Information gain: 8.1667 | Grad Norm: 24.0469 | Time: 5.7s
Step 0240 | Epoch 01 | Objective: -6.5935 | Coherence: 30.1242 | Separation: 26.6763 | Information gain: 8.0000 | Grad Norm: 24.2599 | Time: 5.9s
Step 0250 | Epoch 01 | Objective: -5.7460 | Coherence: 30.4988 | Separation: 26.0785 | Information gain: 8.0000 | Grad Norm: 25.3782 | Time: 6.2s
Step 0260 | Epoch 01 | Objective: -5.0030 | Coherence: 30.8853 | Separation: 25.5933 | Information gain: 8.0000 | Grad Norm: 21.3325 | Time: 6.4s
Step 0270 | Epoch 01 | Objective: -4.3162 | Coherence: 31.2413 | Separation: 25.1437 | Information gain: 8.0000 | Grad Norm: 22.0898 | Time: 6.6s
Step 0280 | Epoch 01 | Objective: -3.6497 | Coherence: 31.5329 | Separation: 24.6717 | Information gain: 8.0000 | Grad Norm: 22.6598 | Time: 6.9s
Step 0290 | Epoch 01 | Objective: -3.0289 | Coherence: 31.8369 | Separation: 24.2534 | Information gain: 8.1667 | Grad Norm: 22.7295 | Time: 7.2s
Step 0300 | Epoch 01 | Objective: -2.5328 | Coherence: 32.1900 | Separation: 23.9928 | Information gain: 8.3333 | Grad Norm: 22.7051 | Time: 7.5s
Step 0310 | Epoch 01 | Objective: -2.0229 | Coherence: 32.5242 | Separation: 23.7057 | Information gain: 8.5000 | Grad Norm: 23.0676 | Time: 7.7s
Step 0320 | Epoch 01 | Objective: -1.5207 | Coherence: 32.8688 | Separation: 23.4332 | Information gain: 8.5000 | Grad Norm: 23.3418 | Time: 8.0s
Step 0330 | Epoch 01 | Objective: -1.0054 | Coherence: 33.2290 | Separation: 23.1581 | Information gain: 8.6667 | Grad Norm: 27.9656 | Time: 8.2s
Step 0340 | Epoch 01 | Objective: -0.5328 | Coherence: 33.5863 | Separation: 22.9236 | Information gain: 8.6667 | Grad Norm: 23.6071 | Time: 8.5s
Step 0350 | Epoch 01 | Objective: -0.1580 | Coherence: 33.8672 | Separation: 22.7361 | Information gain: 8.8333 | Grad Norm: 21.2957 | Time: 8.7s
Step 0360 | Epoch 01 | Objective: 0.2191 | Coherence: 34.0763 | Separation: 22.4985 | Information gain: 8.6667 | Grad Norm: 23.9638 | Time: 9.0s
Step 0370 | Epoch 01 | Objective: 0.5760 | Coherence: 34.2964 | Separation: 22.2883 | Information gain: 8.6667 | Grad Norm: 22.6449 | Time: 9.3s
Step 0380 | Epoch 01 | Objective: 0.9180 | Coherence: 34.5310 | Separation: 22.1026 | Information gain: 8.6667 | Grad Norm: 22.3037 | Time: 9.6s
Step 0380 | Epoch 01 | Objective: 0.9180 | Coherence: 34.5310 | Separation: 22.1026 | Information gain: 8.6667 | Grad Norm: 22.3037 | Time: 9.6s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.591150  0.502533  0.452791  ...  0.451393  0.511124  0.522475
1  0.501218  0.596712  0.476946  ...  0.495140  0.468594  0.428920
2  0.487868  0.507324  0.612806  ...  0.559301  0.523083  0.484519
3  0.394758  0.446503  0.438349  ...  0.407587  0.348611  0.319317
4  0.457814  0.629143  0.480333  ...  0.514863  0.447339  0.372331

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8018
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8979
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8832
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0408, accuracy=0.0812
Testing SVM
  SVM Test Accuracy: 0.8629
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8388

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7049, Accuracy: 9439/12000 (79%)

Epoch 1 | Train Acc: 0.6541458333333333 | Test Acc: 0.7865833333333333 | Time: 1.0281739234924316 sec

Test set: Average loss: 0.5156, Accuracy: 10021/12000 (84%)

Epoch 2 | Train Acc: 0.8201458333333334 | Test Acc: 0.8350833333333333 | Time: 1.0245933532714844 sec

Test set: Average loss: 0.4377, Accuracy: 10325/12000 (86%)

Epoch 3 | Train Acc: 0.8532916666666667 | Test Acc: 0.8604166666666667 | Time: 1.025167465209961 sec

Test set: Average loss: 0.3969, Accuracy: 10488/12000 (87%)

Epoch 4 | Train Acc: 0.8701666666666666 | Test Acc: 0.874 | Time: 1.0356414318084717 sec

Test set: Average loss: 0.3688, Accuracy: 10598/12000 (88%)

Epoch 5 | Train Acc: 0.8811458333333333 | Test Acc: 0.8831666666666667 | Time: 1.2963135242462158 sec

Test set: Average loss: 0.3513, Accuracy: 10680/12000 (89%)

Epoch 6 | Train Acc: 0.888 | Test Acc: 0.89 | Time: 1.0292706489562988 sec

Test set: Average loss: 0.3399, Accuracy: 10715/12000 (89%)

Epoch 7 | Train Acc: 0.8929375 | Test Acc: 0.8929166666666667 | Time: 1.0254180431365967 sec

Test set: Average loss: 0.3321, Accuracy: 10747/12000 (90%)

Epoch 8 | Train Acc: 0.8968958333333333 | Test Acc: 0.8955833333333333 | Time: 1.1409060955047607 sec

Test set: Average loss: 0.3277, Accuracy: 10762/12000 (90%)

Epoch 9 | Train Acc: 0.8988125 | Test Acc: 0.8968333333333334 | Time: 1.0326945781707764 sec

Test set: Average loss: 0.3247, Accuracy: 10771/12000 (90%)

Epoch 10 | Train Acc: 0.9003958333333333 | Test Acc: 0.8975833333333333 | Time: 1.0456020832061768 sec

Test set: Average loss: 0.3225, Accuracy: 10785/12000 (90%)

Epoch 11 | Train Acc: 0.9015 | Test Acc: 0.89875 | Time: 1.2722933292388916 sec

Test set: Average loss: 0.3210, Accuracy: 10795/12000 (90%)

Epoch 12 | Train Acc: 0.9025208333333333 | Test Acc: 0.8995833333333333 | Time: 1.040693759918213 sec

Test set: Average loss: 0.3199, Accuracy: 10797/12000 (90%)

Epoch 13 | Train Acc: 0.9028958333333333 | Test Acc: 0.89975 | Time: 1.0385565757751465 sec

Test set: Average loss: 0.3191, Accuracy: 10797/12000 (90%)

Epoch 14 | Train Acc: 0.90325 | Test Acc: 0.89975 | Time: 1.037947177886963 sec

Test set: Average loss: 0.3185, Accuracy: 10794/12000 (90%)

Epoch 15 | Train Acc: 0.9034375 | Test Acc: 0.8995 | Time: 1.0448808670043945 sec

Test set: Average loss: 0.3181, Accuracy: 10797/12000 (90%)

Epoch 16 | Train Acc: 0.9036458333333334 | Test Acc: 0.89975 | Time: 1.0685434341430664 sec

Test set: Average loss: 0.3178, Accuracy: 10796/12000 (90%)

Epoch 17 | Train Acc: 0.90375 | Test Acc: 0.8996666666666666 | Time: 1.3899295330047607 sec

Test set: Average loss: 0.3176, Accuracy: 10798/12000 (90%)

Epoch 18 | Train Acc: 0.9039583333333333 | Test Acc: 0.8998333333333334 | Time: 1.0458412170410156 sec

Test set: Average loss: 0.3174, Accuracy: 10797/12000 (90%)

Epoch 19 | Train Acc: 0.9038958333333333 | Test Acc: 0.89975 | Time: 1.0383179187774658 sec

Test set: Average loss: 0.3173, Accuracy: 10797/12000 (90%)

Epoch 20 | Train Acc: 0.9038958333333333 | Test Acc: 0.89975 | Time: 1.0402727127075195 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -55.9065 | Coherence: -1.3964 | Separation: 57.3645 | Information gain: 7.1667 | Grad Norm: 42.6567 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -53.7554 | Coherence: -0.7832 | Separation: 55.6777 | Information gain: 7.3333 | Grad Norm: 42.3055 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -51.6994 | Coherence: -0.1115 | Separation: 53.9584 | Information gain: 7.0000 | Grad Norm: 41.3503 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -49.5399 | Coherence: 0.6170 | Separation: 52.2846 | Information gain: 7.0000 | Grad Norm: 40.1771 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -47.3749 | Coherence: 1.3837 | Separation: 50.7418 | Information gain: 7.3333 | Grad Norm: 39.1174 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -45.3488 | Coherence: 2.2045 | Separation: 49.2629 | Information gain: 7.3333 | Grad Norm: 38.8929 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -43.2719 | Coherence: 3.0397 | Separation: 47.7984 | Information gain: 7.5000 | Grad Norm: 37.9784 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -41.2906 | Coherence: 3.8599 | Separation: 46.3639 | Information gain: 7.5000 | Grad Norm: 37.7304 | Time: 1.7s
Step 0080 | Epoch 01 | Objective: -39.4773 | Coherence: 4.6643 | Separation: 45.0868 | Information gain: 7.5000 | Grad Norm: 36.2899 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -37.7922 | Coherence: 5.4196 | Separation: 43.9053 | Information gain: 7.5000 | Grad Norm: 34.6319 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -36.1493 | Coherence: 6.1535 | Separation: 42.8628 | Information gain: 7.8333 | Grad Norm: 33.6482 | Time: 2.4s
Step 0110 | Epoch 01 | Objective: -34.5427 | Coherence: 6.8815 | Separation: 41.7415 | Information gain: 7.8333 | Grad Norm: 33.3396 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -32.9370 | Coherence: 7.6551 | Separation: 40.5960 | Information gain: 7.6667 | Grad Norm: 33.6905 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -31.1312 | Coherence: 8.5316 | Separation: 39.4856 | Information gain: 8.0000 | Grad Norm: 34.0836 | Time: 3.1s
Step 0140 | Epoch 01 | Objective: -29.3769 | Coherence: 9.4011 | Separation: 38.3110 | Information gain: 8.0000 | Grad Norm: 33.3205 | Time: 3.3s
Step 0150 | Epoch 01 | Objective: -27.5940 | Coherence: 10.2770 | Separation: 37.1120 | Information gain: 8.0000 | Grad Norm: 33.1488 | Time: 3.5s
Step 0160 | Epoch 01 | Objective: -25.9658 | Coherence: 11.1561 | Separation: 36.0698 | Information gain: 8.0000 | Grad Norm: 31.4320 | Time: 3.7s
Step 0170 | Epoch 01 | Objective: -24.3177 | Coherence: 12.0812 | Separation: 35.0940 | Information gain: 8.1667 | Grad Norm: 32.1286 | Time: 4.0s
Step 0180 | Epoch 01 | Objective: -22.6518 | Coherence: 13.0146 | Separation: 34.1060 | Information gain: 8.3333 | Grad Norm: 30.9063 | Time: 4.2s
Step 0190 | Epoch 01 | Objective: -21.1208 | Coherence: 14.0109 | Separation: 33.2392 | Information gain: 8.3333 | Grad Norm: 32.2504 | Time: 4.5s
Step 0200 | Epoch 01 | Objective: -19.7149 | Coherence: 14.9898 | Separation: 32.5414 | Information gain: 8.5000 | Grad Norm: 30.8911 | Time: 4.8s
Step 0210 | Epoch 01 | Objective: -18.3714 | Coherence: 15.8999 | Separation: 31.8047 | Information gain: 8.5000 | Grad Norm: 29.2086 | Time: 5.0s
Step 0220 | Epoch 01 | Objective: -16.9729 | Coherence: 16.7777 | Separation: 31.0469 | Information gain: 8.6667 | Grad Norm: 28.2082 | Time: 5.3s
Step 0230 | Epoch 01 | Objective: -15.6296 | Coherence: 17.6194 | Separation: 30.2648 | Information gain: 8.6667 | Grad Norm: 31.6910 | Time: 5.5s
Step 0240 | Epoch 01 | Objective: -14.3506 | Coherence: 18.4506 | Separation: 29.5399 | Information gain: 8.6667 | Grad Norm: 29.4649 | Time: 5.7s
Step 0250 | Epoch 01 | Objective: -13.1497 | Coherence: 19.2861 | Separation: 28.8959 | Information gain: 8.6667 | Grad Norm: 30.1808 | Time: 6.0s
Step 0260 | Epoch 01 | Objective: -12.0126 | Coherence: 20.1080 | Separation: 28.3068 | Information gain: 8.6667 | Grad Norm: 27.4409 | Time: 6.2s
Step 0270 | Epoch 01 | Objective: -10.9759 | Coherence: 20.8932 | Separation: 27.7936 | Information gain: 8.6667 | Grad Norm: 28.2707 | Time: 6.4s
Step 0280 | Epoch 01 | Objective: -10.0185 | Coherence: 21.6812 | Separation: 27.3615 | Information gain: 8.6667 | Grad Norm: 27.1058 | Time: 6.7s
Step 0290 | Epoch 01 | Objective: -9.0477 | Coherence: 22.4757 | Separation: 26.9204 | Information gain: 8.6667 | Grad Norm: 25.9154 | Time: 6.9s
Step 0300 | Epoch 01 | Objective: -8.1293 | Coherence: 23.2815 | Separation: 26.4836 | Information gain: 8.5000 | Grad Norm: 30.7111 | Time: 7.1s
Step 0310 | Epoch 01 | Objective: -7.1219 | Coherence: 24.0736 | Separation: 26.0043 | Information gain: 8.5000 | Grad Norm: 27.3660 | Time: 7.4s
Step 0320 | Epoch 01 | Objective: -6.1412 | Coherence: 24.8548 | Separation: 25.5444 | Information gain: 8.5000 | Grad Norm: 28.6759 | Time: 7.6s
Step 0330 | Epoch 01 | Objective: -5.1803 | Coherence: 25.6408 | Separation: 25.1075 | Information gain: 8.5000 | Grad Norm: 25.6801 | Time: 7.8s
Step 0340 | Epoch 01 | Objective: -4.2818 | Coherence: 26.3751 | Separation: 24.6986 | Information gain: 8.5000 | Grad Norm: 26.6052 | Time: 8.0s
Step 0350 | Epoch 01 | Objective: -3.3319 | Coherence: 27.0827 | Separation: 24.2759 | Information gain: 8.6667 | Grad Norm: 25.9943 | Time: 8.3s
Step 0360 | Epoch 01 | Objective: -2.4361 | Coherence: 27.7846 | Separation: 23.8480 | Information gain: 8.6667 | Grad Norm: 26.3873 | Time: 8.5s
Step 0370 | Epoch 01 | Objective: -1.5673 | Coherence: 28.4402 | Separation: 23.4163 | Information gain: 8.6667 | Grad Norm: 27.0860 | Time: 8.7s
Step 0380 | Epoch 01 | Objective: -0.7375 | Coherence: 29.0878 | Separation: 23.0183 | Information gain: 8.6667 | Grad Norm: 27.4912 | Time: 9.0s
Step 0390 | Epoch 01 | Objective: 0.0958 | Coherence: 29.7374 | Separation: 22.6180 | Information gain: 8.6667 | Grad Norm: 27.2317 | Time: 9.2s
Step 0400 | Epoch 01 | Objective: 0.9499 | Coherence: 30.3823 | Separation: 22.1939 | Information gain: 8.6667 | Grad Norm: 28.2827 | Time: 9.4s
Step 0400 | Epoch 01 | Objective: 0.9499 | Coherence: 30.3823 | Separation: 22.1939 | Information gain: 8.6667 | Grad Norm: 28.2827 | Time: 9.4s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.574270  0.456320 -0.492060  ...  0.318910  0.419779  0.324087
1  0.466396  0.598698 -0.557247  ...  0.370296  0.430268  0.370513
2  0.489553  0.545684 -0.584058  ...  0.430981  0.494489  0.427358
3  0.539504  0.488381 -0.528291  ...  0.343780  0.447214  0.339677
4  0.483422  0.513258 -0.565950  ...  0.484575  0.530110  0.486227

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8023
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8967
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8774
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.2473, accuracy=0.0918
Testing SVM
  SVM Test Accuracy: 0.8549
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8332

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7521, Accuracy: 9051/12000 (75%)

Epoch 1 | Train Acc: 0.648625 | Test Acc: 0.75425 | Time: 1.0898659229278564 sec

Test set: Average loss: 0.5266, Accuracy: 10002/12000 (83%)

Epoch 2 | Train Acc: 0.8118333333333333 | Test Acc: 0.8335 | Time: 1.0216622352600098 sec

Test set: Average loss: 0.4577, Accuracy: 10193/12000 (85%)

Epoch 3 | Train Acc: 0.8430833333333333 | Test Acc: 0.8494166666666667 | Time: 1.1243302822113037 sec

Test set: Average loss: 0.4195, Accuracy: 10345/12000 (86%)

Epoch 4 | Train Acc: 0.8585625 | Test Acc: 0.8620833333333333 | Time: 1.0275051593780518 sec

Test set: Average loss: 0.3976, Accuracy: 10443/12000 (87%)

Epoch 5 | Train Acc: 0.8684583333333333 | Test Acc: 0.87025 | Time: 1.0267503261566162 sec

Test set: Average loss: 0.3807, Accuracy: 10499/12000 (87%)

Epoch 6 | Train Acc: 0.8750833333333333 | Test Acc: 0.8749166666666667 | Time: 1.1565349102020264 sec

Test set: Average loss: 0.3701, Accuracy: 10548/12000 (88%)

Epoch 7 | Train Acc: 0.8791458333333333 | Test Acc: 0.879 | Time: 1.2900068759918213 sec

Test set: Average loss: 0.3622, Accuracy: 10586/12000 (88%)

Epoch 8 | Train Acc: 0.8825416666666667 | Test Acc: 0.8821666666666667 | Time: 1.0846977233886719 sec

Test set: Average loss: 0.3562, Accuracy: 10607/12000 (88%)

Epoch 9 | Train Acc: 0.8848125 | Test Acc: 0.8839166666666667 | Time: 1.0231199264526367 sec

Test set: Average loss: 0.3520, Accuracy: 10641/12000 (89%)

Epoch 10 | Train Acc: 0.8863125 | Test Acc: 0.88675 | Time: 1.0207836627960205 sec

Test set: Average loss: 0.3492, Accuracy: 10653/12000 (89%)

Epoch 11 | Train Acc: 0.8875208333333333 | Test Acc: 0.88775 | Time: 1.0173711776733398 sec

Test set: Average loss: 0.3474, Accuracy: 10655/12000 (89%)

Epoch 12 | Train Acc: 0.8885208333333333 | Test Acc: 0.8879166666666667 | Time: 1.1235780715942383 sec

Test set: Average loss: 0.3461, Accuracy: 10660/12000 (89%)

Epoch 13 | Train Acc: 0.8889583333333333 | Test Acc: 0.8883333333333333 | Time: 1.0228021144866943 sec

Test set: Average loss: 0.3454, Accuracy: 10662/12000 (89%)

Epoch 14 | Train Acc: 0.889375 | Test Acc: 0.8885 | Time: 1.0288722515106201 sec

Test set: Average loss: 0.3448, Accuracy: 10670/12000 (89%)

Epoch 15 | Train Acc: 0.8896041666666666 | Test Acc: 0.8891666666666667 | Time: 1.191673755645752 sec

Test set: Average loss: 0.3445, Accuracy: 10671/12000 (89%)

Epoch 16 | Train Acc: 0.8895833333333333 | Test Acc: 0.88925 | Time: 1.1329352855682373 sec

Test set: Average loss: 0.3442, Accuracy: 10670/12000 (89%)

Epoch 17 | Train Acc: 0.8896875 | Test Acc: 0.8891666666666667 | Time: 1.0557148456573486 sec

Test set: Average loss: 0.3440, Accuracy: 10677/12000 (89%)

Epoch 18 | Train Acc: 0.8899166666666667 | Test Acc: 0.88975 | Time: 1.0235624313354492 sec

Test set: Average loss: 0.3439, Accuracy: 10678/12000 (89%)

Epoch 19 | Train Acc: 0.8898958333333333 | Test Acc: 0.8898333333333334 | Time: 1.0217013359069824 sec

Test set: Average loss: 0.3438, Accuracy: 10676/12000 (89%)

Epoch 20 | Train Acc: 0.8900208333333334 | Test Acc: 0.8896666666666667 | Time: 1.016683578491211 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -35.9125 | Coherence: 14.9819 | Separation: 50.9004 | Information gain: 7.5000 | Grad Norm: 39.4481 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: -33.3508 | Coherence: 15.8174 | Separation: 49.0068 | Information gain: 7.6667 | Grad Norm: 37.6427 | Time: 0.4s
Step 0020 | Epoch 01 | Objective: -31.1033 | Coherence: 16.6622 | Separation: 47.3226 | Information gain: 7.6667 | Grad Norm: 37.0909 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: -28.9748 | Coherence: 17.4976 | Separation: 45.6399 | Information gain: 7.5000 | Grad Norm: 35.5868 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: -26.9003 | Coherence: 18.2730 | Separation: 44.0823 | Information gain: 7.5000 | Grad Norm: 34.5752 | Time: 1.1s
Step 0050 | Epoch 01 | Objective: -24.7530 | Coherence: 18.9951 | Separation: 42.5275 | Information gain: 7.6667 | Grad Norm: 32.8946 | Time: 1.3s
Step 0060 | Epoch 01 | Objective: -22.9153 | Coherence: 19.6443 | Separation: 41.0114 | Information gain: 7.5000 | Grad Norm: 33.0098 | Time: 1.5s
Step 0070 | Epoch 01 | Objective: -20.8163 | Coherence: 20.3435 | Separation: 39.6009 | Information gain: 7.8333 | Grad Norm: 32.1671 | Time: 1.8s
Step 0080 | Epoch 01 | Objective: -19.1090 | Coherence: 21.0744 | Separation: 38.3809 | Information gain: 7.8333 | Grad Norm: 31.5726 | Time: 2.0s
Step 0090 | Epoch 01 | Objective: -17.5410 | Coherence: 21.8310 | Separation: 37.3171 | Information gain: 7.8333 | Grad Norm: 29.5616 | Time: 2.2s
Step 0100 | Epoch 01 | Objective: -16.2480 | Coherence: 22.5130 | Separation: 36.3678 | Information gain: 7.6667 | Grad Norm: 28.7755 | Time: 2.5s
Step 0110 | Epoch 01 | Objective: -14.9762 | Coherence: 23.1879 | Separation: 35.4347 | Information gain: 7.5000 | Grad Norm: 28.4939 | Time: 2.7s
Step 0120 | Epoch 01 | Objective: -13.6408 | Coherence: 23.8614 | Separation: 34.6595 | Information gain: 7.6667 | Grad Norm: 27.2171 | Time: 2.9s
Step 0130 | Epoch 01 | Objective: -12.5314 | Coherence: 24.5179 | Separation: 33.8767 | Information gain: 7.5000 | Grad Norm: 27.8787 | Time: 3.2s
Step 0140 | Epoch 01 | Objective: -11.2677 | Coherence: 25.1598 | Separation: 33.0409 | Information gain: 7.5000 | Grad Norm: 28.3327 | Time: 3.4s
Step 0150 | Epoch 01 | Objective: -10.0090 | Coherence: 25.8412 | Separation: 32.2364 | Information gain: 7.5000 | Grad Norm: 29.0004 | Time: 3.7s
Step 0160 | Epoch 01 | Objective: -8.8793 | Coherence: 26.5033 | Separation: 31.5482 | Information gain: 7.5000 | Grad Norm: 26.7599 | Time: 3.9s
Step 0170 | Epoch 01 | Objective: -7.7911 | Coherence: 27.2062 | Separation: 30.9286 | Information gain: 7.5000 | Grad Norm: 26.9239 | Time: 4.2s
Step 0180 | Epoch 01 | Objective: -6.7344 | Coherence: 27.9356 | Separation: 30.3581 | Information gain: 7.5000 | Grad Norm: 25.1251 | Time: 4.4s
Step 0190 | Epoch 01 | Objective: -5.6813 | Coherence: 28.6118 | Separation: 29.7558 | Information gain: 7.5000 | Grad Norm: 25.3029 | Time: 4.7s
Step 0200 | Epoch 01 | Objective: -4.7006 | Coherence: 29.2580 | Separation: 29.2059 | Information gain: 7.5000 | Grad Norm: 25.8343 | Time: 4.9s
Step 0210 | Epoch 01 | Objective: -3.8645 | Coherence: 29.8894 | Separation: 28.6797 | Information gain: 7.3333 | Grad Norm: 24.6093 | Time: 5.2s
Step 0220 | Epoch 01 | Objective: -2.9972 | Coherence: 30.4825 | Separation: 28.2077 | Information gain: 7.3333 | Grad Norm: 25.4780 | Time: 5.4s
Step 0230 | Epoch 01 | Objective: -2.1252 | Coherence: 31.0103 | Separation: 27.6876 | Information gain: 7.3333 | Grad Norm: 25.3868 | Time: 5.7s
Step 0240 | Epoch 01 | Objective: -1.2322 | Coherence: 31.5438 | Separation: 27.1503 | Information gain: 7.3333 | Grad Norm: 24.2507 | Time: 5.9s
Step 0250 | Epoch 01 | Objective: -0.4391 | Coherence: 32.0480 | Separation: 26.6933 | Information gain: 7.3333 | Grad Norm: 24.1018 | Time: 6.2s
Step 0260 | Epoch 01 | Objective: 0.3837 | Coherence: 32.4664 | Separation: 26.1495 | Information gain: 7.3333 | Grad Norm: 24.9140 | Time: 6.4s
Step 0267 | Epoch 01 | Objective: 0.9645 | Coherence: 32.7809 | Separation: 25.7784 | Information gain: 7.3333 | Grad Norm: 26.8111 | Time: 6.6s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.598760  0.546875  0.471584  ...  0.481283  0.493821 -0.472406
1  0.559421  0.616709  0.468881  ...  0.473597  0.471774 -0.525241
2  0.499660  0.484219  0.657475  ...  0.654339  0.568375 -0.603152
3  0.479112  0.485103  0.389372  ...  0.387489  0.481105 -0.445205
4  0.491583  0.524513  0.389890  ...  0.409451  0.359690 -0.432908

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7948
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8931
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8763
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.1167, accuracy=0.0854
Testing SVM
  SVM Test Accuracy: 0.8587
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8307

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7098, Accuracy: 9318/12000 (78%)

Epoch 1 | Train Acc: 0.6444791666666667 | Test Acc: 0.7765 | Time: 1.0217704772949219 sec

Test set: Average loss: 0.5239, Accuracy: 9981/12000 (83%)

Epoch 2 | Train Acc: 0.8172291666666667 | Test Acc: 0.83175 | Time: 1.019118309020996 sec

Test set: Average loss: 0.4456, Accuracy: 10303/12000 (86%)

Epoch 3 | Train Acc: 0.8491875 | Test Acc: 0.8585833333333334 | Time: 1.023252248764038 sec

Test set: Average loss: 0.3994, Accuracy: 10473/12000 (87%)

Epoch 4 | Train Acc: 0.866875 | Test Acc: 0.87275 | Time: 1.023881435394287 sec

Test set: Average loss: 0.3720, Accuracy: 10600/12000 (88%)

Epoch 5 | Train Acc: 0.87825 | Test Acc: 0.8833333333333333 | Time: 1.1741554737091064 sec

Test set: Average loss: 0.3569, Accuracy: 10666/12000 (89%)

Epoch 6 | Train Acc: 0.8853541666666667 | Test Acc: 0.8888333333333334 | Time: 1.0978307723999023 sec

Test set: Average loss: 0.3460, Accuracy: 10707/12000 (89%)

Epoch 7 | Train Acc: 0.8889583333333333 | Test Acc: 0.89225 | Time: 1.0267231464385986 sec

Test set: Average loss: 0.3397, Accuracy: 10728/12000 (89%)

Epoch 8 | Train Acc: 0.892125 | Test Acc: 0.894 | Time: 1.0210368633270264 sec

Test set: Average loss: 0.3352, Accuracy: 10740/12000 (90%)

Epoch 9 | Train Acc: 0.8942083333333334 | Test Acc: 0.895 | Time: 1.025188684463501 sec

Test set: Average loss: 0.3323, Accuracy: 10754/12000 (90%)

Epoch 10 | Train Acc: 0.89575 | Test Acc: 0.8961666666666667 | Time: 1.1721491813659668 sec

Test set: Average loss: 0.3302, Accuracy: 10758/12000 (90%)

Epoch 11 | Train Acc: 0.8964791666666667 | Test Acc: 0.8965 | Time: 1.0300116539001465 sec

Test set: Average loss: 0.3284, Accuracy: 10769/12000 (90%)

Epoch 12 | Train Acc: 0.897125 | Test Acc: 0.8974166666666666 | Time: 1.0213634967803955 sec

Test set: Average loss: 0.3270, Accuracy: 10771/12000 (90%)

Epoch 13 | Train Acc: 0.8976875 | Test Acc: 0.8975833333333333 | Time: 1.0213849544525146 sec

Test set: Average loss: 0.3260, Accuracy: 10778/12000 (90%)

Epoch 14 | Train Acc: 0.898 | Test Acc: 0.8981666666666667 | Time: 1.0306799411773682 sec

Test set: Average loss: 0.3253, Accuracy: 10778/12000 (90%)

Epoch 15 | Train Acc: 0.8981041666666667 | Test Acc: 0.8981666666666667 | Time: 1.0198173522949219 sec

Test set: Average loss: 0.3249, Accuracy: 10781/12000 (90%)

Epoch 16 | Train Acc: 0.898375 | Test Acc: 0.8984166666666666 | Time: 1.0227398872375488 sec

Test set: Average loss: 0.3246, Accuracy: 10788/12000 (90%)

Epoch 17 | Train Acc: 0.8985208333333333 | Test Acc: 0.899 | Time: 1.027627944946289 sec

Test set: Average loss: 0.3245, Accuracy: 10790/12000 (90%)

Epoch 18 | Train Acc: 0.8987291666666667 | Test Acc: 0.8991666666666667 | Time: 1.0203537940979004 sec

Test set: Average loss: 0.3243, Accuracy: 10792/12000 (90%)

Epoch 19 | Train Acc: 0.8988333333333334 | Test Acc: 0.8993333333333333 | Time: 1.1260712146759033 sec

Test set: Average loss: 0.3243, Accuracy: 10792/12000 (90%)

Epoch 20 | Train Acc: 0.8990416666666666 | Test Acc: 0.8993333333333333 | Time: 1.0224130153656006 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -32.2282 | Coherence: 15.3229 | Separation: 50.9435 | Information gain: 8.5000 | Grad Norm: 37.9257 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -30.1427 | Coherence: 16.2813 | Separation: 49.4969 | Information gain: 8.5000 | Grad Norm: 36.1726 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -28.2074 | Coherence: 17.2319 | Separation: 48.1953 | Information gain: 8.5000 | Grad Norm: 34.4876 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -26.0923 | Coherence: 18.1754 | Separation: 46.8759 | Information gain: 8.6667 | Grad Norm: 34.7613 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -24.1404 | Coherence: 19.1195 | Separation: 45.5535 | Information gain: 8.6667 | Grad Norm: 33.4074 | Time: 0.9s
Step 0050 | Epoch 01 | Objective: -22.1738 | Coherence: 20.0910 | Separation: 44.4011 | Information gain: 8.8333 | Grad Norm: 31.9643 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -20.5794 | Coherence: 20.9920 | Separation: 43.4074 | Information gain: 8.8333 | Grad Norm: 31.2597 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -19.1199 | Coherence: 21.7876 | Separation: 42.4783 | Information gain: 8.8333 | Grad Norm: 29.9910 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -17.6513 | Coherence: 22.5306 | Separation: 41.5050 | Information gain: 8.8333 | Grad Norm: 29.7122 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -16.2546 | Coherence: 23.2822 | Separation: 40.6095 | Information gain: 8.8333 | Grad Norm: 29.2046 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -14.5466 | Coherence: 24.0218 | Separation: 39.7278 | Information gain: 9.1667 | Grad Norm: 29.2640 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -13.1598 | Coherence: 24.7485 | Separation: 38.8255 | Information gain: 9.1667 | Grad Norm: 28.6677 | Time: 2.5s
Step 0120 | Epoch 01 | Objective: -11.9186 | Coherence: 25.4302 | Separation: 38.0387 | Information gain: 9.1667 | Grad Norm: 27.3383 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -10.6634 | Coherence: 26.0941 | Separation: 37.2261 | Information gain: 9.1667 | Grad Norm: 29.0596 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: -9.5228 | Coherence: 26.7990 | Separation: 36.3887 | Information gain: 9.0000 | Grad Norm: 28.1729 | Time: 3.2s
Step 0150 | Epoch 01 | Objective: -8.1876 | Coherence: 27.5267 | Separation: 35.5387 | Information gain: 9.0000 | Grad Norm: 27.4967 | Time: 3.4s
Step 0160 | Epoch 01 | Objective: -6.8467 | Coherence: 28.2316 | Separation: 34.8345 | Information gain: 9.1667 | Grad Norm: 28.1051 | Time: 3.7s
Step 0170 | Epoch 01 | Objective: -5.6512 | Coherence: 28.9297 | Separation: 34.1043 | Information gain: 9.1667 | Grad Norm: 29.0675 | Time: 3.9s
Step 0180 | Epoch 01 | Objective: -4.4705 | Coherence: 29.6301 | Separation: 33.3906 | Information gain: 9.1667 | Grad Norm: 29.3869 | Time: 4.1s
Step 0190 | Epoch 01 | Objective: -3.3893 | Coherence: 30.3155 | Separation: 32.7663 | Information gain: 9.1667 | Grad Norm: 28.1069 | Time: 4.4s
Step 0200 | Epoch 01 | Objective: -2.3983 | Coherence: 30.9209 | Separation: 32.1789 | Information gain: 9.1667 | Grad Norm: 25.3135 | Time: 4.7s
Step 0210 | Epoch 01 | Objective: -1.4809 | Coherence: 31.5184 | Separation: 31.6598 | Information gain: 9.1667 | Grad Norm: 27.2200 | Time: 4.9s
Step 0220 | Epoch 01 | Objective: -0.7218 | Coherence: 32.0772 | Separation: 31.1066 | Information gain: 9.0000 | Grad Norm: 27.8673 | Time: 5.1s
Step 0230 | Epoch 01 | Objective: 0.1713 | Coherence: 32.6273 | Separation: 30.5802 | Information gain: 9.0000 | Grad Norm: 26.7648 | Time: 5.4s
Step 0240 | Epoch 01 | Objective: 0.8493 | Coherence: 33.1382 | Separation: 30.0761 | Information gain: 8.8333 | Grad Norm: 24.7037 | Time: 5.6s
Step 0241 | Epoch 01 | Objective: 0.9371 | Coherence: 33.1923 | Separation: 30.0244 | Information gain: 8.8333 | Grad Norm: 23.9896 | Time: 5.7s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.544834  0.476573  0.489736  ...  0.454049  0.481881  0.475639
1 -0.515196  0.600372  0.556493  ...  0.462395  0.574396  0.505859
2 -0.558269  0.584034  0.626268  ...  0.546078  0.583556  0.563128
3 -0.446719  0.512914  0.514487  ...  0.430841  0.482978  0.485948
4 -0.416271  0.458472  0.462635  ...  0.425999  0.430589  0.437563

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7849
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8834
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8725
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0473, accuracy=0.0993
Testing SVM
  SVM Test Accuracy: 0.8457
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8111

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7162, Accuracy: 9337/12000 (78%)

Epoch 1 | Train Acc: 0.6628125 | Test Acc: 0.7780833333333333 | Time: 1.053797960281372 sec

Test set: Average loss: 0.5472, Accuracy: 9856/12000 (82%)

Epoch 2 | Train Acc: 0.8158125 | Test Acc: 0.8213333333333334 | Time: 1.0233466625213623 sec

Test set: Average loss: 0.4760, Accuracy: 10108/12000 (84%)

Epoch 3 | Train Acc: 0.8415416666666666 | Test Acc: 0.8423333333333334 | Time: 1.033132791519165 sec

Test set: Average loss: 0.4396, Accuracy: 10241/12000 (85%)

Epoch 4 | Train Acc: 0.8549166666666667 | Test Acc: 0.8534166666666667 | Time: 1.0285630226135254 sec

Test set: Average loss: 0.4179, Accuracy: 10308/12000 (86%)

Epoch 5 | Train Acc: 0.8632291666666667 | Test Acc: 0.859 | Time: 1.1592414379119873 sec

Test set: Average loss: 0.4049, Accuracy: 10360/12000 (86%)

Epoch 6 | Train Acc: 0.8693125 | Test Acc: 0.8633333333333333 | Time: 1.1875526905059814 sec

Test set: Average loss: 0.3962, Accuracy: 10405/12000 (87%)

Epoch 7 | Train Acc: 0.8732916666666667 | Test Acc: 0.8670833333333333 | Time: 1.2484476566314697 sec

Test set: Average loss: 0.3894, Accuracy: 10435/12000 (87%)

Epoch 8 | Train Acc: 0.8759375 | Test Acc: 0.8695833333333334 | Time: 1.0353550910949707 sec

Test set: Average loss: 0.3844, Accuracy: 10458/12000 (87%)

Epoch 9 | Train Acc: 0.8781041666666667 | Test Acc: 0.8715 | Time: 1.034543514251709 sec

Test set: Average loss: 0.3807, Accuracy: 10468/12000 (87%)

Epoch 10 | Train Acc: 0.8794583333333333 | Test Acc: 0.8723333333333333 | Time: 1.0311675071716309 sec

Test set: Average loss: 0.3783, Accuracy: 10489/12000 (87%)

Epoch 11 | Train Acc: 0.88075 | Test Acc: 0.8740833333333333 | Time: 1.0308563709259033 sec

Test set: Average loss: 0.3766, Accuracy: 10495/12000 (87%)

Epoch 12 | Train Acc: 0.8816041666666666 | Test Acc: 0.8745833333333334 | Time: 1.0252017974853516 sec

Test set: Average loss: 0.3754, Accuracy: 10499/12000 (87%)

Epoch 13 | Train Acc: 0.8822083333333334 | Test Acc: 0.8749166666666667 | Time: 1.0383381843566895 sec

Test set: Average loss: 0.3746, Accuracy: 10506/12000 (88%)

Epoch 14 | Train Acc: 0.882625 | Test Acc: 0.8755 | Time: 1.0323643684387207 sec

Test set: Average loss: 0.3740, Accuracy: 10508/12000 (88%)

Epoch 15 | Train Acc: 0.8829375 | Test Acc: 0.8756666666666667 | Time: 1.1230928897857666 sec

Test set: Average loss: 0.3736, Accuracy: 10506/12000 (88%)

Epoch 16 | Train Acc: 0.8830833333333333 | Test Acc: 0.8755 | Time: 1.0443410873413086 sec

Test set: Average loss: 0.3733, Accuracy: 10508/12000 (88%)

Epoch 17 | Train Acc: 0.8834166666666666 | Test Acc: 0.8756666666666667 | Time: 1.191929578781128 sec

Test set: Average loss: 0.3731, Accuracy: 10510/12000 (88%)

Epoch 18 | Train Acc: 0.8833125 | Test Acc: 0.8758333333333334 | Time: 1.104628324508667 sec

Test set: Average loss: 0.3729, Accuracy: 10510/12000 (88%)

Epoch 19 | Train Acc: 0.8833958333333334 | Test Acc: 0.8758333333333334 | Time: 1.0578062534332275 sec

Test set: Average loss: 0.3728, Accuracy: 10511/12000 (88%)

Epoch 20 | Train Acc: 0.8834583333333333 | Test Acc: 0.8759166666666667 | Time: 1.0345053672790527 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: 3.2822 | Coherence: 3.2822 | Separation: 49.6832 | Information gain: 7.8333 | Grad Norm: 22.3393 | Time: 0.1s
Step 0001 | Epoch 01 | Objective: 3.5175 | Coherence: 3.5175 | Separation: 49.6946 | Information gain: 7.8333 | Grad Norm: 22.3393 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.582308  0.253710  0.148564  ... -0.455819 -0.505042  0.453644
1  0.423040  0.549401  0.241310  ... -0.570193 -0.415893  0.579775
2  0.436991  0.134275  0.334638  ... -0.354277 -0.533027  0.340275
3  0.538990  0.323265  0.218164  ... -0.504051 -0.506233  0.524895
4  0.460847  0.108103  0.178449  ... -0.308836 -0.482711  0.362039

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7953
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9058
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8833
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.8570, accuracy=0.1104
Testing SVM
  SVM Test Accuracy: 0.8677
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8361

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6740, Accuracy: 9567/12000 (80%)

Epoch 1 | Train Acc: 0.6895416666666667 | Test Acc: 0.79725 | Time: 1.0281720161437988 sec

Test set: Average loss: 0.4764, Accuracy: 10252/12000 (85%)

Epoch 2 | Train Acc: 0.8344583333333333 | Test Acc: 0.8543333333333333 | Time: 1.1549925804138184 sec

Test set: Average loss: 0.4023, Accuracy: 10493/12000 (87%)

Epoch 3 | Train Acc: 0.866 | Test Acc: 0.8744166666666666 | Time: 1.0222256183624268 sec

Test set: Average loss: 0.3695, Accuracy: 10629/12000 (89%)

Epoch 4 | Train Acc: 0.8814583333333333 | Test Acc: 0.88575 | Time: 1.0273773670196533 sec

Test set: Average loss: 0.3513, Accuracy: 10668/12000 (89%)

Epoch 5 | Train Acc: 0.890375 | Test Acc: 0.889 | Time: 1.0190012454986572 sec

Test set: Average loss: 0.3374, Accuracy: 10720/12000 (89%)

Epoch 6 | Train Acc: 0.8960416666666666 | Test Acc: 0.8933333333333333 | Time: 1.021489143371582 sec

Test set: Average loss: 0.3285, Accuracy: 10746/12000 (90%)

Epoch 7 | Train Acc: 0.8991458333333333 | Test Acc: 0.8955 | Time: 1.0248408317565918 sec

Test set: Average loss: 0.3219, Accuracy: 10765/12000 (90%)

Epoch 8 | Train Acc: 0.90125 | Test Acc: 0.8970833333333333 | Time: 1.1735613346099854 sec

Test set: Average loss: 0.3176, Accuracy: 10789/12000 (90%)

Epoch 9 | Train Acc: 0.9036458333333334 | Test Acc: 0.8990833333333333 | Time: 1.1140868663787842 sec

Test set: Average loss: 0.3145, Accuracy: 10800/12000 (90%)

Epoch 10 | Train Acc: 0.9048958333333333 | Test Acc: 0.9 | Time: 1.087721347808838 sec

Test set: Average loss: 0.3122, Accuracy: 10809/12000 (90%)

Epoch 11 | Train Acc: 0.9061666666666667 | Test Acc: 0.90075 | Time: 1.1245214939117432 sec

Test set: Average loss: 0.3107, Accuracy: 10816/12000 (90%)

Epoch 12 | Train Acc: 0.9068958333333333 | Test Acc: 0.9013333333333333 | Time: 1.0215091705322266 sec

Test set: Average loss: 0.3097, Accuracy: 10824/12000 (90%)

Epoch 13 | Train Acc: 0.9075208333333333 | Test Acc: 0.902 | Time: 1.0165627002716064 sec

Test set: Average loss: 0.3089, Accuracy: 10826/12000 (90%)

Epoch 14 | Train Acc: 0.9079166666666667 | Test Acc: 0.9021666666666667 | Time: 1.0189528465270996 sec

Test set: Average loss: 0.3084, Accuracy: 10830/12000 (90%)

Epoch 15 | Train Acc: 0.9080833333333334 | Test Acc: 0.9025 | Time: 1.0253596305847168 sec

Test set: Average loss: 0.3081, Accuracy: 10835/12000 (90%)

Epoch 16 | Train Acc: 0.9083541666666667 | Test Acc: 0.9029166666666667 | Time: 1.023308515548706 sec

Test set: Average loss: 0.3079, Accuracy: 10841/12000 (90%)

Epoch 17 | Train Acc: 0.908375 | Test Acc: 0.9034166666666666 | Time: 1.0230028629302979 sec

Test set: Average loss: 0.3078, Accuracy: 10842/12000 (90%)

Epoch 18 | Train Acc: 0.9084166666666667 | Test Acc: 0.9035 | Time: 1.0210537910461426 sec

Test set: Average loss: 0.3077, Accuracy: 10840/12000 (90%)

Epoch 19 | Train Acc: 0.9085 | Test Acc: 0.9033333333333333 | Time: 1.0260953903198242 sec

Test set: Average loss: 0.3077, Accuracy: 10838/12000 (90%)

Epoch 20 | Train Acc: 0.9085208333333333 | Test Acc: 0.9031666666666667 | Time: 1.1129651069641113 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: 16.7959 | Coherence: 14.3515 | Separation: 51.3029 | Information gain: 7.3333 | Grad Norm: 22.2731 | Time: 0.0s
Step 0001 | Epoch 01 | Objective: 17.0403 | Coherence: 14.5958 | Separation: 51.2996 | Information gain: 7.3333 | Grad Norm: 22.2731 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.548408  0.341419  0.151035  ...  0.328400  0.473533  0.507749
1  0.349947  0.582504  0.279796  ...  0.576469  0.419489  0.322968
2  0.456756  0.411947  0.371151  ...  0.443010  0.537169  0.449955
3  0.403812  0.428552  0.360980  ...  0.470902  0.498043  0.395944
4  0.504584  0.341008  0.201219  ...  0.387483  0.452055  0.541986

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7857
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9009
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8813
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.8631, accuracy=0.1192
Testing SVM
  SVM Test Accuracy: 0.8640
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8255

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6450, Accuracy: 9757/12000 (81%)

Epoch 1 | Train Acc: 0.6695416666666667 | Test Acc: 0.8130833333333334 | Time: 1.446659803390503 sec

Test set: Average loss: 0.4919, Accuracy: 10208/12000 (85%)

Epoch 2 | Train Acc: 0.8309166666666666 | Test Acc: 0.8506666666666667 | Time: 1.5174031257629395 sec

Test set: Average loss: 0.4060, Accuracy: 10511/12000 (88%)

Epoch 3 | Train Acc: 0.8626041666666666 | Test Acc: 0.8759166666666667 | Time: 1.1017873287200928 sec

Test set: Average loss: 0.3675, Accuracy: 10628/12000 (89%)

Epoch 4 | Train Acc: 0.8785833333333334 | Test Acc: 0.8856666666666667 | Time: 1.0191071033477783 sec

Test set: Average loss: 0.3426, Accuracy: 10730/12000 (89%)

Epoch 5 | Train Acc: 0.8888958333333333 | Test Acc: 0.8941666666666667 | Time: 1.0213167667388916 sec

Test set: Average loss: 0.3269, Accuracy: 10769/12000 (90%)

Epoch 6 | Train Acc: 0.895875 | Test Acc: 0.8974166666666666 | Time: 1.0264520645141602 sec

Test set: Average loss: 0.3169, Accuracy: 10809/12000 (90%)

Epoch 7 | Train Acc: 0.8998958333333333 | Test Acc: 0.90075 | Time: 1.2223320007324219 sec

Test set: Average loss: 0.3100, Accuracy: 10842/12000 (90%)

Epoch 8 | Train Acc: 0.9031041666666667 | Test Acc: 0.9035 | Time: 1.3634207248687744 sec

Test set: Average loss: 0.3056, Accuracy: 10858/12000 (90%)

Epoch 9 | Train Acc: 0.90525 | Test Acc: 0.9048333333333334 | Time: 1.1083791255950928 sec

Test set: Average loss: 0.3023, Accuracy: 10870/12000 (91%)

Epoch 10 | Train Acc: 0.9067083333333333 | Test Acc: 0.9058333333333334 | Time: 1.241992473602295 sec

Test set: Average loss: 0.3004, Accuracy: 10882/12000 (91%)

Epoch 11 | Train Acc: 0.9073958333333333 | Test Acc: 0.9068333333333334 | Time: 1.3216078281402588 sec

Test set: Average loss: 0.2990, Accuracy: 10889/12000 (91%)

Epoch 12 | Train Acc: 0.9080416666666666 | Test Acc: 0.9074166666666666 | Time: 1.0223965644836426 sec

Test set: Average loss: 0.2981, Accuracy: 10894/12000 (91%)

Epoch 13 | Train Acc: 0.9083958333333333 | Test Acc: 0.9078333333333334 | Time: 1.0256543159484863 sec

Test set: Average loss: 0.2974, Accuracy: 10893/12000 (91%)

Epoch 14 | Train Acc: 0.9085 | Test Acc: 0.90775 | Time: 1.044771432876587 sec

Test set: Average loss: 0.2969, Accuracy: 10896/12000 (91%)

Epoch 15 | Train Acc: 0.90875 | Test Acc: 0.908 | Time: 1.194960355758667 sec

Test set: Average loss: 0.2966, Accuracy: 10889/12000 (91%)

Epoch 16 | Train Acc: 0.9088125 | Test Acc: 0.9074166666666666 | Time: 1.0916543006896973 sec

Test set: Average loss: 0.2964, Accuracy: 10893/12000 (91%)

Epoch 17 | Train Acc: 0.9086875 | Test Acc: 0.90775 | Time: 1.1628684997558594 sec

Test set: Average loss: 0.2962, Accuracy: 10894/12000 (91%)

Epoch 18 | Train Acc: 0.9088958333333333 | Test Acc: 0.9078333333333334 | Time: 1.3480260372161865 sec

Test set: Average loss: 0.2962, Accuracy: 10896/12000 (91%)

Epoch 19 | Train Acc: 0.9090833333333334 | Test Acc: 0.908 | Time: 1.2332348823547363 sec

Test set: Average loss: 0.2961, Accuracy: 10896/12000 (91%)

Epoch 20 | Train Acc: 0.9090625 | Test Acc: 0.908 | Time: 1.0273244380950928 sec
Early stopping at epoch 20

Testing with M=15
Step 0000 | Epoch 01 | Objective: 18.9846 | Coherence: 14.5402 | Separation: 51.1330 | Information gain: 6.6667 | Grad Norm: 22.0992 | Time: 0.1s
Step 0001 | Epoch 01 | Objective: 19.2118 | Coherence: 14.7673 | Separation: 51.1355 | Information gain: 6.6667 | Grad Norm: 22.0992 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.609371 -0.565551 -0.558439  ... -0.519367  0.517481  0.549200
1  0.503367 -0.567461 -0.464672  ... -0.435253  0.479385  0.441363
2  0.545728 -0.501354 -0.592816  ... -0.491791  0.531103  0.553913
3  0.477785 -0.426141 -0.514638  ... -0.446424  0.434464  0.489962
4  0.486364 -0.449416 -0.508136  ... -0.558375  0.425022  0.554921

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7927
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9038
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8837
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.3695, accuracy=0.0923
Testing SVM
  SVM Test Accuracy: 0.8632
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8323

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7715, Accuracy: 9056/12000 (75%)

Epoch 1 | Train Acc: 0.6444791666666667 | Test Acc: 0.7546666666666667 | Time: 1.030085802078247 sec

Test set: Average loss: 0.4865, Accuracy: 10207/12000 (85%)

Epoch 2 | Train Acc: 0.8299166666666666 | Test Acc: 0.8505833333333334 | Time: 1.0279219150543213 sec

Test set: Average loss: 0.4155, Accuracy: 10451/12000 (87%)

Epoch 3 | Train Acc: 0.861625 | Test Acc: 0.8709166666666667 | Time: 1.2015879154205322 sec

Test set: Average loss: 0.3782, Accuracy: 10579/12000 (88%)

Epoch 4 | Train Acc: 0.8782916666666667 | Test Acc: 0.8815833333333334 | Time: 1.6294488906860352 sec

Test set: Average loss: 0.3524, Accuracy: 10669/12000 (89%)

Epoch 5 | Train Acc: 0.888125 | Test Acc: 0.8890833333333333 | Time: 1.175722599029541 sec

Test set: Average loss: 0.3376, Accuracy: 10709/12000 (89%)

Epoch 6 | Train Acc: 0.8947708333333333 | Test Acc: 0.8924166666666666 | Time: 1.02541184425354 sec

Test set: Average loss: 0.3276, Accuracy: 10750/12000 (90%)

Epoch 7 | Train Acc: 0.8994166666666666 | Test Acc: 0.8958333333333334 | Time: 1.0281360149383545 sec

Test set: Average loss: 0.3218, Accuracy: 10771/12000 (90%)

Epoch 8 | Train Acc: 0.9026875 | Test Acc: 0.8975833333333333 | Time: 1.0836703777313232 sec

Test set: Average loss: 0.3170, Accuracy: 10791/12000 (90%)

Epoch 9 | Train Acc: 0.90475 | Test Acc: 0.89925 | Time: 1.196207046508789 sec

Test set: Average loss: 0.3138, Accuracy: 10790/12000 (90%)

Epoch 10 | Train Acc: 0.9065625 | Test Acc: 0.8991666666666667 | Time: 1.2940680980682373 sec

Test set: Average loss: 0.3117, Accuracy: 10810/12000 (90%)

Epoch 11 | Train Acc: 0.9075 | Test Acc: 0.9008333333333334 | Time: 1.3601131439208984 sec

Test set: Average loss: 0.3100, Accuracy: 10820/12000 (90%)

Epoch 12 | Train Acc: 0.9082916666666667 | Test Acc: 0.9016666666666666 | Time: 1.0493512153625488 sec

Test set: Average loss: 0.3088, Accuracy: 10828/12000 (90%)

Epoch 13 | Train Acc: 0.90875 | Test Acc: 0.9023333333333333 | Time: 1.1242477893829346 sec

Test set: Average loss: 0.3078, Accuracy: 10829/12000 (90%)

Epoch 14 | Train Acc: 0.9090833333333334 | Test Acc: 0.9024166666666666 | Time: 1.0337486267089844 sec

Test set: Average loss: 0.3071, Accuracy: 10838/12000 (90%)

Epoch 15 | Train Acc: 0.90925 | Test Acc: 0.9031666666666667 | Time: 1.0376806259155273 sec

Test set: Average loss: 0.3067, Accuracy: 10842/12000 (90%)

Epoch 16 | Train Acc: 0.9092291666666666 | Test Acc: 0.9035 | Time: 1.0644917488098145 sec

Test set: Average loss: 0.3064, Accuracy: 10844/12000 (90%)

Epoch 17 | Train Acc: 0.9093958333333333 | Test Acc: 0.9036666666666666 | Time: 1.2194366455078125 sec

Test set: Average loss: 0.3063, Accuracy: 10845/12000 (90%)

Epoch 18 | Train Acc: 0.9095 | Test Acc: 0.90375 | Time: 1.2798399925231934 sec

Test set: Average loss: 0.3062, Accuracy: 10843/12000 (90%)

Epoch 19 | Train Acc: 0.9096458333333334 | Test Acc: 0.9035833333333333 | Time: 1.355248212814331 sec

Test set: Average loss: 0.3061, Accuracy: 10845/12000 (90%)

Epoch 20 | Train Acc: 0.9097708333333333 | Test Acc: 0.90375 | Time: 1.04756498336792 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: 18.0410 | Coherence: 9.8744 | Separation: 53.1858 | Information gain: 8.1667 | Grad Norm: 22.2715 | Time: 0.0s
Step 0001 | Epoch 01 | Objective: 18.2751 | Coherence: 10.1084 | Separation: 53.1503 | Information gain: 8.1667 | Grad Norm: 22.2715 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.593368  0.384174  0.456327  ...  0.411459  0.502251  0.437358
1 -0.442379  0.623909  0.474698  ...  0.624395  0.568765  0.442010
2 -0.482759  0.418055  0.603985  ...  0.455533  0.442028  0.584676
3 -0.443280  0.565288  0.435494  ...  0.568075  0.554606  0.428862
4 -0.523145  0.431177  0.582603  ...  0.471664  0.468882  0.541568

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7811
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8880
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8605
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.6562, accuracy=0.1220
Testing SVM
  SVM Test Accuracy: 0.8436
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8106

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7574, Accuracy: 9205/12000 (77%)

Epoch 1 | Train Acc: 0.6360833333333333 | Test Acc: 0.7670833333333333 | Time: 1.2704834938049316 sec

Test set: Average loss: 0.5652, Accuracy: 9798/12000 (82%)

Epoch 2 | Train Acc: 0.8071041666666666 | Test Acc: 0.8165 | Time: 1.0199358463287354 sec

Test set: Average loss: 0.5006, Accuracy: 10046/12000 (84%)

Epoch 3 | Train Acc: 0.8395208333333334 | Test Acc: 0.8371666666666666 | Time: 1.0232031345367432 sec

Test set: Average loss: 0.4519, Accuracy: 10276/12000 (86%)

Epoch 4 | Train Acc: 0.8584791666666667 | Test Acc: 0.8563333333333333 | Time: 1.0295758247375488 sec

Test set: Average loss: 0.4253, Accuracy: 10403/12000 (87%)

Epoch 5 | Train Acc: 0.8697291666666667 | Test Acc: 0.8669166666666667 | Time: 1.0334970951080322 sec

Test set: Average loss: 0.4051, Accuracy: 10470/12000 (87%)

Epoch 6 | Train Acc: 0.8770625 | Test Acc: 0.8725 | Time: 1.0248210430145264 sec

Test set: Average loss: 0.3913, Accuracy: 10514/12000 (88%)

Epoch 7 | Train Acc: 0.882 | Test Acc: 0.8761666666666666 | Time: 1.1312856674194336 sec

Test set: Average loss: 0.3829, Accuracy: 10543/12000 (88%)

Epoch 8 | Train Acc: 0.885 | Test Acc: 0.8785833333333334 | Time: 1.4584870338439941 sec

Test set: Average loss: 0.3773, Accuracy: 10561/12000 (88%)

Epoch 9 | Train Acc: 0.8868541666666667 | Test Acc: 0.8800833333333333 | Time: 1.319737195968628 sec

Test set: Average loss: 0.3735, Accuracy: 10574/12000 (88%)

Epoch 10 | Train Acc: 0.88875 | Test Acc: 0.8811666666666667 | Time: 1.2715318202972412 sec

Test set: Average loss: 0.3710, Accuracy: 10579/12000 (88%)

Epoch 11 | Train Acc: 0.8903541666666667 | Test Acc: 0.8815833333333334 | Time: 1.0213816165924072 sec

Test set: Average loss: 0.3694, Accuracy: 10592/12000 (88%)

Epoch 12 | Train Acc: 0.8904791666666667 | Test Acc: 0.8826666666666667 | Time: 1.022125005722046 sec

Test set: Average loss: 0.3683, Accuracy: 10597/12000 (88%)

Epoch 13 | Train Acc: 0.8912708333333333 | Test Acc: 0.8830833333333333 | Time: 1.0282979011535645 sec

Test set: Average loss: 0.3675, Accuracy: 10594/12000 (88%)

Epoch 14 | Train Acc: 0.8915833333333333 | Test Acc: 0.8828333333333334 | Time: 1.1984097957611084 sec

Test set: Average loss: 0.3668, Accuracy: 10601/12000 (88%)

Epoch 15 | Train Acc: 0.8920416666666666 | Test Acc: 0.8834166666666666 | Time: 1.330157995223999 sec

Test set: Average loss: 0.3663, Accuracy: 10599/12000 (88%)

Epoch 16 | Train Acc: 0.8921875 | Test Acc: 0.88325 | Time: 1.025193452835083 sec

Test set: Average loss: 0.3660, Accuracy: 10597/12000 (88%)

Epoch 17 | Train Acc: 0.8923125 | Test Acc: 0.8830833333333333 | Time: 1.168860912322998 sec

Test set: Average loss: 0.3657, Accuracy: 10599/12000 (88%)

Epoch 18 | Train Acc: 0.8926041666666666 | Test Acc: 0.88325 | Time: 1.139298439025879 sec

Test set: Average loss: 0.3656, Accuracy: 10599/12000 (88%)

Epoch 19 | Train Acc: 0.8925 | Test Acc: 0.88325 | Time: 1.1165680885314941 sec

Test set: Average loss: 0.3655, Accuracy: 10599/12000 (88%)

Epoch 20 | Train Acc: 0.8925 | Test Acc: 0.88325 | Time: 1.1229546070098877 sec
Early stopping at epoch 20

Testing with M=15
Step 0000 | Epoch 01 | Objective: -8.0607 | Coherence: 9.9991 | Separation: 54.1797 | Information gain: 7.6667 | Grad Norm: 25.2838 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: -5.6427 | Coherence: 12.3267 | Separation: 53.9080 | Information gain: 7.6667 | Grad Norm: 25.2378 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -3.2215 | Coherence: 14.6406 | Separation: 53.5864 | Information gain: 7.6667 | Grad Norm: 24.8579 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: -0.8469 | Coherence: 16.9270 | Separation: 53.3216 | Information gain: 7.6667 | Grad Norm: 24.6485 | Time: 0.9s
Step 0038 | Epoch 01 | Objective: 1.0117 | Coherence: 18.7355 | Separation: 53.1713 | Information gain: 7.6667 | Grad Norm: 24.0391 | Time: 1.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.650150  0.518175  0.414527  ...  0.618995  0.420828  0.493872
1 -0.497039  0.577318  0.505552  ...  0.476250  0.408617  0.522087
2 -0.410812  0.505039  0.560376  ...  0.447233  0.385361  0.457501
3 -0.366407  0.495084  0.579491  ...  0.409571  0.380949  0.455808
4 -0.594391  0.516394  0.459894  ...  0.564302  0.422477  0.519615

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7988
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8917
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8722
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.8310, accuracy=0.1150
Testing SVM
  SVM Test Accuracy: 0.8547
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8212

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6978, Accuracy: 9418/12000 (78%)

Epoch 1 | Train Acc: 0.6709583333333333 | Test Acc: 0.7848333333333334 | Time: 1.0227229595184326 sec

Test set: Average loss: 0.5410, Accuracy: 9886/12000 (82%)

Epoch 2 | Train Acc: 0.8141458333333333 | Test Acc: 0.8238333333333333 | Time: 1.0559051036834717 sec

Test set: Average loss: 0.4821, Accuracy: 10062/12000 (84%)

Epoch 3 | Train Acc: 0.8428333333333333 | Test Acc: 0.8385 | Time: 1.2067484855651855 sec

Test set: Average loss: 0.4334, Accuracy: 10298/12000 (86%)

Epoch 4 | Train Acc: 0.86025 | Test Acc: 0.8581666666666666 | Time: 1.0886454582214355 sec

Test set: Average loss: 0.3997, Accuracy: 10406/12000 (87%)

Epoch 5 | Train Acc: 0.8712291666666667 | Test Acc: 0.8671666666666666 | Time: 1.173820972442627 sec

Test set: Average loss: 0.3765, Accuracy: 10537/12000 (88%)

Epoch 6 | Train Acc: 0.8783333333333333 | Test Acc: 0.8780833333333333 | Time: 1.0371873378753662 sec

Test set: Average loss: 0.3618, Accuracy: 10605/12000 (88%)

Epoch 7 | Train Acc: 0.8835208333333333 | Test Acc: 0.88375 | Time: 1.024843454360962 sec

Test set: Average loss: 0.3536, Accuracy: 10639/12000 (89%)

Epoch 8 | Train Acc: 0.8868958333333333 | Test Acc: 0.8865833333333333 | Time: 1.026348352432251 sec

Test set: Average loss: 0.3483, Accuracy: 10674/12000 (89%)

Epoch 9 | Train Acc: 0.8894166666666666 | Test Acc: 0.8895 | Time: 1.029689073562622 sec

Test set: Average loss: 0.3449, Accuracy: 10687/12000 (89%)

Epoch 10 | Train Acc: 0.8910833333333333 | Test Acc: 0.8905833333333333 | Time: 1.0396041870117188 sec

Test set: Average loss: 0.3425, Accuracy: 10695/12000 (89%)

Epoch 11 | Train Acc: 0.8920208333333334 | Test Acc: 0.89125 | Time: 1.0771877765655518 sec

Test set: Average loss: 0.3409, Accuracy: 10698/12000 (89%)

Epoch 12 | Train Acc: 0.8929791666666667 | Test Acc: 0.8915 | Time: 1.0394220352172852 sec

Test set: Average loss: 0.3398, Accuracy: 10703/12000 (89%)

Epoch 13 | Train Acc: 0.8935833333333333 | Test Acc: 0.8919166666666667 | Time: 1.0445914268493652 sec

Test set: Average loss: 0.3392, Accuracy: 10706/12000 (89%)

Epoch 14 | Train Acc: 0.8942291666666666 | Test Acc: 0.8921666666666667 | Time: 1.1410255432128906 sec

Test set: Average loss: 0.3387, Accuracy: 10707/12000 (89%)

Epoch 15 | Train Acc: 0.8945833333333333 | Test Acc: 0.89225 | Time: 1.039989709854126 sec

Test set: Average loss: 0.3383, Accuracy: 10709/12000 (89%)

Epoch 16 | Train Acc: 0.8948541666666666 | Test Acc: 0.8924166666666666 | Time: 1.043022871017456 sec

Test set: Average loss: 0.3380, Accuracy: 10710/12000 (89%)

Epoch 17 | Train Acc: 0.8947916666666667 | Test Acc: 0.8925 | Time: 1.046790599822998 sec

Test set: Average loss: 0.3377, Accuracy: 10710/12000 (89%)

Epoch 18 | Train Acc: 0.8950208333333334 | Test Acc: 0.8925 | Time: 1.0507376194000244 sec

Test set: Average loss: 0.3376, Accuracy: 10711/12000 (89%)

Epoch 19 | Train Acc: 0.8952291666666666 | Test Acc: 0.8925833333333333 | Time: 1.0484097003936768 sec

Test set: Average loss: 0.3374, Accuracy: 10711/12000 (89%)

Epoch 20 | Train Acc: 0.8954166666666666 | Test Acc: 0.8925833333333333 | Time: 1.0627565383911133 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -9.7245 | Coherence: 6.3221 | Separation: 56.6400 | Information gain: 8.5000 | Grad Norm: 26.6185 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -7.2635 | Coherence: 8.5190 | Separation: 55.8476 | Information gain: 8.5000 | Grad Norm: 26.4210 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -4.7800 | Coherence: 10.7342 | Separation: 55.0428 | Information gain: 8.5000 | Grad Norm: 26.1607 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -2.3275 | Coherence: 12.9454 | Separation: 54.3185 | Information gain: 8.5000 | Grad Norm: 25.8038 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: 0.0891 | Coherence: 15.1406 | Separation: 53.6544 | Information gain: 8.5000 | Grad Norm: 25.6159 | Time: 1.0s
Step 0044 | Epoch 01 | Objective: 1.0498 | Coherence: 16.0123 | Separation: 53.3874 | Information gain: 8.5000 | Grad Norm: 25.4959 | Time: 1.0s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.610195  0.596043  0.487570  ...  0.479096 -0.476057  0.451842
1  0.616598  0.626248  0.538081  ...  0.492043 -0.515863  0.428141
2  0.481381  0.517776  0.592232  ...  0.524628 -0.502780  0.370342
3  0.451820  0.427564  0.440930  ...  0.500969 -0.339601  0.474910
4  0.535844  0.509247  0.454089  ...  0.514221 -0.419138  0.431171

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7907
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8928
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8706
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.2397, accuracy=0.0914
Testing SVM
  SVM Test Accuracy: 0.8460
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8128

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7762, Accuracy: 9042/12000 (75%)

Epoch 1 | Train Acc: 0.6263958333333334 | Test Acc: 0.7535 | Time: 1.026806354522705 sec

Test set: Average loss: 0.5783, Accuracy: 9726/12000 (81%)

Epoch 2 | Train Acc: 0.801375 | Test Acc: 0.8105 | Time: 1.0193428993225098 sec

Test set: Average loss: 0.4983, Accuracy: 10064/12000 (84%)

Epoch 3 | Train Acc: 0.8334791666666667 | Test Acc: 0.8386666666666667 | Time: 1.0296244621276855 sec

Test set: Average loss: 0.4490, Accuracy: 10245/12000 (85%)

Epoch 4 | Train Acc: 0.8511041666666667 | Test Acc: 0.85375 | Time: 1.039189338684082 sec

Test set: Average loss: 0.4176, Accuracy: 10373/12000 (86%)

Epoch 5 | Train Acc: 0.8632291666666667 | Test Acc: 0.8644166666666667 | Time: 1.031423807144165 sec

Test set: Average loss: 0.4001, Accuracy: 10454/12000 (87%)

Epoch 6 | Train Acc: 0.8719375 | Test Acc: 0.8711666666666666 | Time: 1.0273489952087402 sec

Test set: Average loss: 0.3872, Accuracy: 10507/12000 (88%)

Epoch 7 | Train Acc: 0.8775625 | Test Acc: 0.8755833333333334 | Time: 1.048159122467041 sec

Test set: Average loss: 0.3783, Accuracy: 10551/12000 (88%)

Epoch 8 | Train Acc: 0.881125 | Test Acc: 0.87925 | Time: 1.0183475017547607 sec

Test set: Average loss: 0.3724, Accuracy: 10568/12000 (88%)

Epoch 9 | Train Acc: 0.8833541666666667 | Test Acc: 0.8806666666666667 | Time: 1.0227022171020508 sec

Test set: Average loss: 0.3682, Accuracy: 10573/12000 (88%)

Epoch 10 | Train Acc: 0.8852916666666667 | Test Acc: 0.8810833333333333 | Time: 1.1371479034423828 sec

Test set: Average loss: 0.3653, Accuracy: 10592/12000 (88%)

Epoch 11 | Train Acc: 0.8863958333333334 | Test Acc: 0.8826666666666667 | Time: 1.0246376991271973 sec

Test set: Average loss: 0.3634, Accuracy: 10602/12000 (88%)

Epoch 12 | Train Acc: 0.887625 | Test Acc: 0.8835 | Time: 1.021718978881836 sec

Test set: Average loss: 0.3621, Accuracy: 10607/12000 (88%)

Epoch 13 | Train Acc: 0.8886041666666666 | Test Acc: 0.8839166666666667 | Time: 1.021327257156372 sec

Test set: Average loss: 0.3612, Accuracy: 10604/12000 (88%)

Epoch 14 | Train Acc: 0.88875 | Test Acc: 0.8836666666666667 | Time: 1.0269649028778076 sec

Test set: Average loss: 0.3606, Accuracy: 10608/12000 (88%)

Epoch 15 | Train Acc: 0.8891666666666667 | Test Acc: 0.884 | Time: 1.0270216464996338 sec

Test set: Average loss: 0.3601, Accuracy: 10604/12000 (88%)

Epoch 16 | Train Acc: 0.8892916666666667 | Test Acc: 0.8836666666666667 | Time: 1.0185799598693848 sec

Test set: Average loss: 0.3598, Accuracy: 10605/12000 (88%)

Epoch 17 | Train Acc: 0.8894791666666667 | Test Acc: 0.88375 | Time: 1.0264639854431152 sec

Test set: Average loss: 0.3597, Accuracy: 10605/12000 (88%)

Epoch 18 | Train Acc: 0.8896041666666666 | Test Acc: 0.88375 | Time: 1.1456031799316406 sec

Test set: Average loss: 0.3595, Accuracy: 10609/12000 (88%)

Epoch 19 | Train Acc: 0.8895416666666667 | Test Acc: 0.8840833333333333 | Time: 1.0545437335968018 sec

Test set: Average loss: 0.3594, Accuracy: 10608/12000 (88%)

Epoch 20 | Train Acc: 0.8896666666666667 | Test Acc: 0.884 | Time: 1.0250093936920166 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: 10.5326 | Coherence: 23.5893 | Separation: 52.5034 | Information gain: 6.6667 | Grad Norm: 22.6235 | Time: 0.0s
Step 0001 | Epoch 01 | Objective: 10.7638 | Coherence: 23.8168 | Separation: 52.4924 | Information gain: 6.6667 | Grad Norm: 22.6165 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.591107  0.507224  0.435857  ...  0.469402  0.486908  0.480753
1  0.494880  0.571167  0.369658  ...  0.433665  0.482016  0.505881
2  0.405542  0.346757  0.545139  ...  0.488424  0.415331  0.428524
3  0.482908  0.446992  0.589444  ...  0.564014  0.512040  0.531285
4  0.543655  0.526063  0.514091  ...  0.588064  0.554632  0.566194

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7926
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9025
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8829
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.3074, accuracy=0.1111
Testing SVM
  SVM Test Accuracy: 0.8634
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8376

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7367, Accuracy: 9122/12000 (76%)

Epoch 1 | Train Acc: 0.661125 | Test Acc: 0.7601666666666667 | Time: 1.036271333694458 sec

Test set: Average loss: 0.5183, Accuracy: 9983/12000 (83%)

Epoch 2 | Train Acc: 0.8281666666666667 | Test Acc: 0.8319166666666666 | Time: 1.0167996883392334 sec

Test set: Average loss: 0.4475, Accuracy: 10283/12000 (86%)

Epoch 3 | Train Acc: 0.8594166666666667 | Test Acc: 0.8569166666666667 | Time: 1.0223388671875 sec

Test set: Average loss: 0.4054, Accuracy: 10462/12000 (87%)

Epoch 4 | Train Acc: 0.874875 | Test Acc: 0.8718333333333333 | Time: 1.0371918678283691 sec

Test set: Average loss: 0.3719, Accuracy: 10598/12000 (88%)

Epoch 5 | Train Acc: 0.8863333333333333 | Test Acc: 0.8831666666666667 | Time: 1.0382626056671143 sec

Test set: Average loss: 0.3514, Accuracy: 10686/12000 (89%)

Epoch 6 | Train Acc: 0.891875 | Test Acc: 0.8905 | Time: 1.1624891757965088 sec

Test set: Average loss: 0.3401, Accuracy: 10721/12000 (89%)

Epoch 7 | Train Acc: 0.8960208333333334 | Test Acc: 0.8934166666666666 | Time: 1.114558458328247 sec

Test set: Average loss: 0.3330, Accuracy: 10745/12000 (90%)

Epoch 8 | Train Acc: 0.8992083333333334 | Test Acc: 0.8954166666666666 | Time: 1.026360034942627 sec

Test set: Average loss: 0.3287, Accuracy: 10758/12000 (90%)

Epoch 9 | Train Acc: 0.9017708333333333 | Test Acc: 0.8965 | Time: 1.0196595191955566 sec

Test set: Average loss: 0.3250, Accuracy: 10769/12000 (90%)

Epoch 10 | Train Acc: 0.9028541666666666 | Test Acc: 0.8974166666666666 | Time: 1.0236494541168213 sec

Test set: Average loss: 0.3219, Accuracy: 10784/12000 (90%)

Epoch 11 | Train Acc: 0.903875 | Test Acc: 0.8986666666666666 | Time: 1.0297563076019287 sec

Test set: Average loss: 0.3196, Accuracy: 10793/12000 (90%)

Epoch 12 | Train Acc: 0.9046041666666667 | Test Acc: 0.8994166666666666 | Time: 1.032392978668213 sec

Test set: Average loss: 0.3180, Accuracy: 10796/12000 (90%)

Epoch 13 | Train Acc: 0.9053333333333333 | Test Acc: 0.8996666666666666 | Time: 1.1259126663208008 sec

Test set: Average loss: 0.3168, Accuracy: 10802/12000 (90%)

Epoch 14 | Train Acc: 0.9057291666666667 | Test Acc: 0.9001666666666667 | Time: 1.3462064266204834 sec

Test set: Average loss: 0.3160, Accuracy: 10803/12000 (90%)

Epoch 15 | Train Acc: 0.9060208333333334 | Test Acc: 0.90025 | Time: 1.2561407089233398 sec

Test set: Average loss: 0.3155, Accuracy: 10805/12000 (90%)

Epoch 16 | Train Acc: 0.9061875 | Test Acc: 0.9004166666666666 | Time: 1.0302369594573975 sec

Test set: Average loss: 0.3152, Accuracy: 10808/12000 (90%)

Epoch 17 | Train Acc: 0.906375 | Test Acc: 0.9006666666666666 | Time: 1.0291354656219482 sec

Test set: Average loss: 0.3150, Accuracy: 10810/12000 (90%)

Epoch 18 | Train Acc: 0.9063541666666667 | Test Acc: 0.9008333333333334 | Time: 1.0301620960235596 sec

Test set: Average loss: 0.3149, Accuracy: 10810/12000 (90%)

Epoch 19 | Train Acc: 0.9065416666666667 | Test Acc: 0.9008333333333334 | Time: 1.026886224746704 sec

Test set: Average loss: 0.3148, Accuracy: 10809/12000 (90%)

Epoch 20 | Train Acc: 0.9065625 | Test Acc: 0.90075 | Time: 1.0430572032928467 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: 2.7983 | Coherence: 13.8066 | Separation: 54.0248 | Information gain: 7.0000 | Grad Norm: 24.2074 | Time: 0.0s
Step 0001 | Epoch 01 | Objective: 3.0196 | Coherence: 14.0130 | Separation: 53.9802 | Information gain: 7.0000 | Grad Norm: 24.2111 | Time: 0.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.561900 -0.465290  0.431297  ...  0.450267  0.366637  0.496133
1  0.477752 -0.600160  0.442580  ...  0.428578  0.397179  0.410693
2  0.452512 -0.441934  0.594999  ...  0.449739  0.544893  0.533600
3  0.564198 -0.479559  0.460756  ...  0.434156  0.378591  0.495505
4  0.537513 -0.430270  0.515505  ...  0.413540  0.433438  0.535512

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7924
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8934
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8754
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.3237, accuracy=0.1135
Testing SVM
  SVM Test Accuracy: 0.8560
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8304

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7791, Accuracy: 9277/12000 (77%)

Epoch 1 | Train Acc: 0.63525 | Test Acc: 0.7730833333333333 | Time: 1.091191291809082 sec

Test set: Average loss: 0.5371, Accuracy: 10020/12000 (84%)

Epoch 2 | Train Acc: 0.8073541666666667 | Test Acc: 0.835 | Time: 1.1660573482513428 sec

Test set: Average loss: 0.4654, Accuracy: 10247/12000 (85%)

Epoch 3 | Train Acc: 0.8413125 | Test Acc: 0.8539166666666667 | Time: 1.0260846614837646 sec

Test set: Average loss: 0.4240, Accuracy: 10373/12000 (86%)

Epoch 4 | Train Acc: 0.8566875 | Test Acc: 0.8644166666666667 | Time: 1.0215528011322021 sec

Test set: Average loss: 0.4018, Accuracy: 10440/12000 (87%)

Epoch 5 | Train Acc: 0.8659583333333334 | Test Acc: 0.87 | Time: 1.028005599975586 sec

Test set: Average loss: 0.3859, Accuracy: 10519/12000 (88%)

Epoch 6 | Train Acc: 0.8724583333333333 | Test Acc: 0.8765833333333334 | Time: 1.0240137577056885 sec

Test set: Average loss: 0.3746, Accuracy: 10559/12000 (88%)

Epoch 7 | Train Acc: 0.8767291666666667 | Test Acc: 0.8799166666666667 | Time: 1.0206010341644287 sec

Test set: Average loss: 0.3674, Accuracy: 10584/12000 (88%)

Epoch 8 | Train Acc: 0.8798333333333334 | Test Acc: 0.882 | Time: 1.029881477355957 sec

Test set: Average loss: 0.3629, Accuracy: 10611/12000 (88%)

Epoch 9 | Train Acc: 0.882125 | Test Acc: 0.88425 | Time: 1.0408902168273926 sec

Test set: Average loss: 0.3595, Accuracy: 10625/12000 (89%)

Epoch 10 | Train Acc: 0.8835416666666667 | Test Acc: 0.8854166666666666 | Time: 1.0213871002197266 sec

Test set: Average loss: 0.3570, Accuracy: 10649/12000 (89%)

Epoch 11 | Train Acc: 0.885125 | Test Acc: 0.8874166666666666 | Time: 1.1219937801361084 sec

Test set: Average loss: 0.3552, Accuracy: 10662/12000 (89%)

Epoch 12 | Train Acc: 0.885875 | Test Acc: 0.8885 | Time: 1.0224339962005615 sec

Test set: Average loss: 0.3540, Accuracy: 10660/12000 (89%)

Epoch 13 | Train Acc: 0.8867916666666666 | Test Acc: 0.8883333333333333 | Time: 1.023341417312622 sec

Test set: Average loss: 0.3531, Accuracy: 10660/12000 (89%)

Epoch 14 | Train Acc: 0.8871041666666667 | Test Acc: 0.8883333333333333 | Time: 1.2266151905059814 sec

Test set: Average loss: 0.3525, Accuracy: 10664/12000 (89%)

Epoch 15 | Train Acc: 0.8872916666666667 | Test Acc: 0.8886666666666667 | Time: 1.2130441665649414 sec

Test set: Average loss: 0.3521, Accuracy: 10663/12000 (89%)

Epoch 16 | Train Acc: 0.8875208333333333 | Test Acc: 0.8885833333333333 | Time: 1.0665841102600098 sec

Test set: Average loss: 0.3518, Accuracy: 10660/12000 (89%)

Epoch 17 | Train Acc: 0.8876666666666667 | Test Acc: 0.8883333333333333 | Time: 1.0278346538543701 sec

Test set: Average loss: 0.3516, Accuracy: 10661/12000 (89%)

Epoch 18 | Train Acc: 0.8877291666666667 | Test Acc: 0.8884166666666666 | Time: 1.0240638256072998 sec

Test set: Average loss: 0.3514, Accuracy: 10664/12000 (89%)

Epoch 19 | Train Acc: 0.887875 | Test Acc: 0.8886666666666667 | Time: 1.0241081714630127 sec

Test set: Average loss: 0.3513, Accuracy: 10664/12000 (89%)

Epoch 20 | Train Acc: 0.887875 | Test Acc: 0.8886666666666667 | Time: 1.1575262546539307 sec
Early stopping at epoch 20

Testing with M=15
Step 0000 | Epoch 01 | Objective: -21.4140 | Coherence: 14.6022 | Separation: 54.0243 | Information gain: 6.8333 | Grad Norm: 32.3651 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -19.0844 | Coherence: 16.0666 | Separation: 52.7264 | Information gain: 7.0000 | Grad Norm: 32.2248 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -16.7261 | Coherence: 17.5539 | Separation: 51.4200 | Information gain: 7.0000 | Grad Norm: 31.5694 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -14.3506 | Coherence: 19.0750 | Separation: 50.1385 | Information gain: 7.1667 | Grad Norm: 31.5324 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -11.8899 | Coherence: 20.6300 | Separation: 48.7799 | Information gain: 7.1667 | Grad Norm: 31.0870 | Time: 0.9s
Step 0050 | Epoch 01 | Objective: -9.4943 | Coherence: 22.1594 | Separation: 47.4806 | Information gain: 7.5000 | Grad Norm: 30.9389 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -7.1158 | Coherence: 23.6458 | Separation: 46.1423 | Information gain: 7.5000 | Grad Norm: 29.6366 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -4.9269 | Coherence: 25.0364 | Separation: 44.9449 | Information gain: 7.5000 | Grad Norm: 27.1806 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -2.9540 | Coherence: 26.3328 | Separation: 43.9303 | Information gain: 7.5000 | Grad Norm: 25.6582 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -1.1797 | Coherence: 27.5969 | Separation: 43.1648 | Information gain: 7.6667 | Grad Norm: 25.5156 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: 0.6108 | Coherence: 28.7709 | Separation: 42.2400 | Information gain: 7.8333 | Grad Norm: 25.6429 | Time: 2.3s
Step 0102 | Epoch 01 | Objective: 0.9685 | Coherence: 28.9992 | Separation: 42.0461 | Information gain: 7.8333 | Grad Norm: 24.8375 | Time: 2.4s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.570494  0.506637  0.535682  ...  0.456090  0.526750  0.458682
1  0.511777  0.642595  0.598303  ...  0.489133  0.552830  0.582681
2  0.536248  0.567783  0.605965  ...  0.404813  0.491658  0.532922
3  0.445433  0.437230  0.443509  ...  0.350023  0.475640  0.500053
4  0.526509  0.484900  0.480700  ...  0.444875  0.551987  0.477241

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8048
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8988
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8817
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0313, accuracy=0.0981
Testing SVM
  SVM Test Accuracy: 0.8655
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8376

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7372, Accuracy: 9135/12000 (76%)

Epoch 1 | Train Acc: 0.6634791666666666 | Test Acc: 0.76125 | Time: 1.0481081008911133 sec

Test set: Average loss: 0.5601, Accuracy: 9630/12000 (80%)

Epoch 2 | Train Acc: 0.8167083333333334 | Test Acc: 0.8025 | Time: 1.239931583404541 sec

Test set: Average loss: 0.4644, Accuracy: 10079/12000 (84%)

Epoch 3 | Train Acc: 0.8547083333333333 | Test Acc: 0.8399166666666666 | Time: 1.0202016830444336 sec

Test set: Average loss: 0.4065, Accuracy: 10391/12000 (87%)

Epoch 4 | Train Acc: 0.8732708333333333 | Test Acc: 0.8659166666666667 | Time: 1.147848129272461 sec

Test set: Average loss: 0.3623, Accuracy: 10630/12000 (89%)

Epoch 5 | Train Acc: 0.8841041666666667 | Test Acc: 0.8858333333333334 | Time: 1.4022932052612305 sec

Test set: Average loss: 0.3405, Accuracy: 10697/12000 (89%)

Epoch 6 | Train Acc: 0.8918958333333333 | Test Acc: 0.8914166666666666 | Time: 1.350888967514038 sec

Test set: Average loss: 0.3308, Accuracy: 10720/12000 (89%)

Epoch 7 | Train Acc: 0.8963125 | Test Acc: 0.8933333333333333 | Time: 1.0465147495269775 sec

Test set: Average loss: 0.3241, Accuracy: 10753/12000 (90%)

Epoch 8 | Train Acc: 0.8998541666666666 | Test Acc: 0.8960833333333333 | Time: 1.1356849670410156 sec

Test set: Average loss: 0.3192, Accuracy: 10773/12000 (90%)

Epoch 9 | Train Acc: 0.9020833333333333 | Test Acc: 0.89775 | Time: 1.0269432067871094 sec

Test set: Average loss: 0.3160, Accuracy: 10784/12000 (90%)

Epoch 10 | Train Acc: 0.9031458333333333 | Test Acc: 0.8986666666666666 | Time: 1.0302495956420898 sec

Test set: Average loss: 0.3139, Accuracy: 10791/12000 (90%)

Epoch 11 | Train Acc: 0.903875 | Test Acc: 0.89925 | Time: 1.3620495796203613 sec

Test set: Average loss: 0.3125, Accuracy: 10799/12000 (90%)

Epoch 12 | Train Acc: 0.9042708333333334 | Test Acc: 0.8999166666666667 | Time: 1.3206706047058105 sec

Test set: Average loss: 0.3116, Accuracy: 10801/12000 (90%)

Epoch 13 | Train Acc: 0.9044583333333334 | Test Acc: 0.9000833333333333 | Time: 1.0316529273986816 sec

Test set: Average loss: 0.3109, Accuracy: 10804/12000 (90%)

Epoch 14 | Train Acc: 0.9046458333333334 | Test Acc: 0.9003333333333333 | Time: 1.31233811378479 sec

Test set: Average loss: 0.3105, Accuracy: 10805/12000 (90%)

Epoch 15 | Train Acc: 0.9045416666666667 | Test Acc: 0.9004166666666666 | Time: 1.03462815284729 sec

Test set: Average loss: 0.3102, Accuracy: 10807/12000 (90%)

Epoch 16 | Train Acc: 0.9043958333333333 | Test Acc: 0.9005833333333333 | Time: 1.2254586219787598 sec

Test set: Average loss: 0.3099, Accuracy: 10804/12000 (90%)

Epoch 17 | Train Acc: 0.9045416666666667 | Test Acc: 0.9003333333333333 | Time: 1.5792596340179443 sec

Test set: Average loss: 0.3098, Accuracy: 10804/12000 (90%)

Epoch 18 | Train Acc: 0.904625 | Test Acc: 0.9003333333333333 | Time: 1.5308659076690674 sec

Test set: Average loss: 0.3096, Accuracy: 10805/12000 (90%)

Epoch 19 | Train Acc: 0.9047083333333333 | Test Acc: 0.9004166666666666 | Time: 1.1003220081329346 sec

Test set: Average loss: 0.3095, Accuracy: 10807/12000 (90%)

Epoch 20 | Train Acc: 0.9048125 | Test Acc: 0.9005833333333333 | Time: 1.024247407913208 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -30.3364 | Coherence: 4.1250 | Separation: 55.0253 | Information gain: 6.6667 | Grad Norm: 34.5606 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -27.7719 | Coherence: 5.6741 | Separation: 53.5856 | Information gain: 6.8333 | Grad Norm: 32.7380 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -25.3365 | Coherence: 7.2193 | Separation: 52.2504 | Information gain: 6.8333 | Grad Norm: 31.9274 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -22.9207 | Coherence: 8.7498 | Separation: 50.9224 | Information gain: 6.8333 | Grad Norm: 31.3118 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -20.5358 | Coherence: 10.2267 | Separation: 49.5604 | Information gain: 6.8333 | Grad Norm: 30.9477 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -18.1776 | Coherence: 11.6937 | Separation: 48.2235 | Information gain: 6.8333 | Grad Norm: 30.7012 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -15.8614 | Coherence: 13.1930 | Separation: 46.9983 | Information gain: 6.8333 | Grad Norm: 29.4970 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -13.5787 | Coherence: 14.6819 | Separation: 45.8076 | Information gain: 6.8333 | Grad Norm: 28.9857 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -11.4475 | Coherence: 16.2049 | Separation: 44.8952 | Information gain: 6.8333 | Grad Norm: 28.2023 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -9.4190 | Coherence: 17.7786 | Separation: 44.1297 | Information gain: 6.6667 | Grad Norm: 27.8242 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -7.3279 | Coherence: 19.3445 | Separation: 43.3419 | Information gain: 6.6667 | Grad Norm: 27.1630 | Time: 2.4s
Step 0110 | Epoch 01 | Objective: -5.3406 | Coherence: 20.8928 | Separation: 42.6834 | Information gain: 6.6667 | Grad Norm: 26.3955 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -3.3588 | Coherence: 22.4607 | Separation: 42.0626 | Information gain: 6.6667 | Grad Norm: 26.1979 | Time: 2.9s
Step 0130 | Epoch 01 | Objective: -1.3401 | Coherence: 24.0365 | Separation: 41.3983 | Information gain: 6.6667 | Grad Norm: 26.4043 | Time: 3.1s
Step 0140 | Epoch 01 | Objective: 0.6031 | Coherence: 25.5779 | Separation: 40.7956 | Information gain: 6.6667 | Grad Norm: 25.1036 | Time: 3.4s
Step 0142 | Epoch 01 | Objective: 0.9724 | Coherence: 25.8829 | Separation: 40.6991 | Information gain: 6.6667 | Grad Norm: 25.3748 | Time: 3.5s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.607676  0.593944 -0.424386  ...  0.492578 -0.029803  0.555135
1  0.613932  0.634523 -0.439192  ...  0.519558  0.041680  0.594548
2  0.368940  0.375647 -0.544168  ...  0.404235  0.146795  0.444061
3  0.563886  0.553332 -0.398056  ...  0.453428 -0.056910  0.529379
4  0.416543  0.438726 -0.539765  ...  0.561189  0.105448  0.455928

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7903
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8925
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8746
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.8969, accuracy=0.1057
Testing SVM
  SVM Test Accuracy: 0.8510
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8278

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6766, Accuracy: 9574/12000 (80%)

Epoch 1 | Train Acc: 0.6637291666666667 | Test Acc: 0.7978333333333333 | Time: 1.36564302444458 sec

Test set: Average loss: 0.4899, Accuracy: 10107/12000 (84%)

Epoch 2 | Train Acc: 0.8266041666666667 | Test Acc: 0.84225 | Time: 1.2514982223510742 sec

Test set: Average loss: 0.4304, Accuracy: 10347/12000 (86%)

Epoch 3 | Train Acc: 0.8568333333333333 | Test Acc: 0.86225 | Time: 1.4998278617858887 sec

Test set: Average loss: 0.3958, Accuracy: 10462/12000 (87%)

Epoch 4 | Train Acc: 0.871 | Test Acc: 0.8718333333333333 | Time: 1.1930944919586182 sec

Test set: Average loss: 0.3696, Accuracy: 10557/12000 (88%)

Epoch 5 | Train Acc: 0.88125 | Test Acc: 0.87975 | Time: 1.0239880084991455 sec

Test set: Average loss: 0.3530, Accuracy: 10640/12000 (89%)

Epoch 6 | Train Acc: 0.8881041666666667 | Test Acc: 0.8866666666666667 | Time: 1.024679183959961 sec

Test set: Average loss: 0.3405, Accuracy: 10693/12000 (89%)

Epoch 7 | Train Acc: 0.8926458333333334 | Test Acc: 0.8910833333333333 | Time: 1.030409336090088 sec

Test set: Average loss: 0.3328, Accuracy: 10734/12000 (89%)

Epoch 8 | Train Acc: 0.8957708333333333 | Test Acc: 0.8945 | Time: 1.150115966796875 sec

Test set: Average loss: 0.3276, Accuracy: 10738/12000 (89%)

Epoch 9 | Train Acc: 0.8975416666666667 | Test Acc: 0.8948333333333334 | Time: 1.1139006614685059 sec

Test set: Average loss: 0.3240, Accuracy: 10753/12000 (90%)

Epoch 10 | Train Acc: 0.8987916666666667 | Test Acc: 0.8960833333333333 | Time: 1.0930848121643066 sec

Test set: Average loss: 0.3217, Accuracy: 10750/12000 (90%)

Epoch 11 | Train Acc: 0.8996875 | Test Acc: 0.8958333333333334 | Time: 1.3133366107940674 sec

Test set: Average loss: 0.3200, Accuracy: 10748/12000 (90%)

Epoch 12 | Train Acc: 0.9003958333333333 | Test Acc: 0.8956666666666667 | Time: 1.4329638481140137 sec

Test set: Average loss: 0.3189, Accuracy: 10750/12000 (90%)

Epoch 13 | Train Acc: 0.9011041666666667 | Test Acc: 0.8958333333333334 | Time: 1.1191816329956055 sec

Test set: Average loss: 0.3182, Accuracy: 10747/12000 (90%)

Epoch 14 | Train Acc: 0.9015625 | Test Acc: 0.8955833333333333 | Time: 1.022834062576294 sec

Test set: Average loss: 0.3178, Accuracy: 10750/12000 (90%)

Epoch 15 | Train Acc: 0.9018333333333334 | Test Acc: 0.8958333333333334 | Time: 1.027984380722046 sec
Early stopping at epoch 15

Testing with M=15
Step 0000 | Epoch 01 | Objective: -19.4978 | Coherence: 8.0144 | Separation: 48.4350 | Information gain: 7.1667 | Grad Norm: 30.3367 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -17.0621 | Coherence: 9.7359 | Separation: 47.3636 | Information gain: 7.1667 | Grad Norm: 30.1664 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -14.6312 | Coherence: 11.4818 | Separation: 46.3361 | Information gain: 7.1667 | Grad Norm: 29.8128 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -12.1994 | Coherence: 13.2386 | Separation: 45.3237 | Information gain: 7.1667 | Grad Norm: 29.7650 | Time: 0.8s
Step 0040 | Epoch 01 | Objective: -9.7823 | Coherence: 14.9692 | Separation: 44.2939 | Information gain: 7.1667 | Grad Norm: 29.5066 | Time: 1.1s
Step 0050 | Epoch 01 | Objective: -7.4701 | Coherence: 16.6341 | Separation: 43.3229 | Information gain: 7.1667 | Grad Norm: 28.2908 | Time: 1.4s
Step 0060 | Epoch 01 | Objective: -5.2101 | Coherence: 18.2641 | Separation: 42.3780 | Information gain: 7.1667 | Grad Norm: 27.7495 | Time: 1.7s
Step 0070 | Epoch 01 | Objective: -3.0298 | Coherence: 19.8342 | Separation: 41.4627 | Information gain: 7.1667 | Grad Norm: 27.9710 | Time: 1.9s
Step 0080 | Epoch 01 | Objective: -0.7160 | Coherence: 21.3987 | Separation: 40.5053 | Information gain: 7.3333 | Grad Norm: 27.1067 | Time: 2.2s
Step 0088 | Epoch 01 | Objective: 0.9117 | Coherence: 22.6308 | Separation: 39.7452 | Information gain: 7.1667 | Grad Norm: 26.7818 | Time: 2.4s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.639268  0.610303  0.529018  ...  0.401655 -0.502740 -0.553904
1  0.519413  0.553672  0.475378  ...  0.323213 -0.448169 -0.499903
2  0.463606  0.483158  0.548638  ...  0.399063 -0.529795 -0.467143
3  0.448358  0.421373  0.466770  ...  0.555057 -0.489899 -0.489668
4  0.646182  0.632825  0.538281  ...  0.378854 -0.507051 -0.570413

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7954
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8880
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8694
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.3028, accuracy=0.1025
Testing SVM
  SVM Test Accuracy: 0.8512
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8269

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6646, Accuracy: 9642/12000 (80%)

Epoch 1 | Train Acc: 0.660125 | Test Acc: 0.8035 | Time: 1.5715031623840332 sec

Test set: Average loss: 0.5121, Accuracy: 10019/12000 (83%)

Epoch 2 | Train Acc: 0.8165 | Test Acc: 0.8349166666666666 | Time: 1.2304377555847168 sec

Test set: Average loss: 0.4527, Accuracy: 10257/12000 (85%)

Epoch 3 | Train Acc: 0.8443125 | Test Acc: 0.85475 | Time: 1.0239267349243164 sec

Test set: Average loss: 0.4182, Accuracy: 10373/12000 (86%)

Epoch 4 | Train Acc: 0.8592291666666667 | Test Acc: 0.8644166666666667 | Time: 1.0187973976135254 sec

Test set: Average loss: 0.3977, Accuracy: 10432/12000 (87%)

Epoch 5 | Train Acc: 0.8682916666666667 | Test Acc: 0.8693333333333333 | Time: 1.1439590454101562 sec

Test set: Average loss: 0.3836, Accuracy: 10495/12000 (87%)

Epoch 6 | Train Acc: 0.8746458333333333 | Test Acc: 0.8745833333333334 | Time: 1.126734733581543 sec

Test set: Average loss: 0.3721, Accuracy: 10548/12000 (88%)

Epoch 7 | Train Acc: 0.8787708333333333 | Test Acc: 0.879 | Time: 1.2980568408966064 sec

Test set: Average loss: 0.3641, Accuracy: 10581/12000 (88%)

Epoch 8 | Train Acc: 0.8818125 | Test Acc: 0.88175 | Time: 1.0869874954223633 sec

Test set: Average loss: 0.3586, Accuracy: 10595/12000 (88%)

Epoch 9 | Train Acc: 0.8838541666666667 | Test Acc: 0.8829166666666667 | Time: 1.1507275104522705 sec

Test set: Average loss: 0.3547, Accuracy: 10605/12000 (88%)

Epoch 10 | Train Acc: 0.885 | Test Acc: 0.88375 | Time: 1.4922358989715576 sec

Test set: Average loss: 0.3522, Accuracy: 10610/12000 (88%)

Epoch 11 | Train Acc: 0.8863125 | Test Acc: 0.8841666666666667 | Time: 1.1005847454071045 sec

Test set: Average loss: 0.3506, Accuracy: 10613/12000 (88%)

Epoch 12 | Train Acc: 0.8871458333333333 | Test Acc: 0.8844166666666666 | Time: 1.064084529876709 sec

Test set: Average loss: 0.3495, Accuracy: 10618/12000 (88%)

Epoch 13 | Train Acc: 0.887625 | Test Acc: 0.8848333333333334 | Time: 1.5137536525726318 sec

Test set: Average loss: 0.3488, Accuracy: 10618/12000 (88%)

Epoch 14 | Train Acc: 0.8881458333333333 | Test Acc: 0.8848333333333334 | Time: 1.6247284412384033 sec

Test set: Average loss: 0.3483, Accuracy: 10618/12000 (88%)

Epoch 15 | Train Acc: 0.8883958333333334 | Test Acc: 0.8848333333333334 | Time: 1.0389368534088135 sec

Test set: Average loss: 0.3480, Accuracy: 10616/12000 (88%)

Epoch 16 | Train Acc: 0.8884791666666667 | Test Acc: 0.8846666666666667 | Time: 1.0327320098876953 sec

Test set: Average loss: 0.3477, Accuracy: 10617/12000 (88%)

Epoch 17 | Train Acc: 0.8888125 | Test Acc: 0.88475 | Time: 1.040433406829834 sec

Test set: Average loss: 0.3475, Accuracy: 10620/12000 (88%)

Epoch 18 | Train Acc: 0.8889166666666667 | Test Acc: 0.885 | Time: 1.0684845447540283 sec

Test set: Average loss: 0.3474, Accuracy: 10623/12000 (89%)

Epoch 19 | Train Acc: 0.8889375 | Test Acc: 0.88525 | Time: 1.1436145305633545 sec

Test set: Average loss: 0.3473, Accuracy: 10624/12000 (89%)

Epoch 20 | Train Acc: 0.8891458333333333 | Test Acc: 0.8853333333333333 | Time: 1.0452792644500732 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -7.0730 | Coherence: 17.4523 | Separation: 49.2879 | Information gain: 8.3333 | Grad Norm: 29.7192 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -4.8354 | Coherence: 19.0890 | Separation: 48.3866 | Information gain: 8.3333 | Grad Norm: 29.0504 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -2.6042 | Coherence: 20.7038 | Separation: 47.4621 | Information gain: 8.3333 | Grad Norm: 28.9871 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: -0.4173 | Coherence: 22.2590 | Separation: 46.5146 | Information gain: 8.3333 | Grad Norm: 27.8728 | Time: 0.9s
Step 0037 | Epoch 01 | Objective: 0.9964 | Coherence: 23.2699 | Separation: 45.9103 | Information gain: 8.3333 | Grad Norm: 26.3294 | Time: 1.1s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.613192 -0.469547  0.495038  ... -0.532582  0.421462 -0.450886
1  0.455936 -0.641883  0.509043  ... -0.488485  0.629566 -0.587587
2  0.497426 -0.515377  0.619365  ... -0.570390  0.493477 -0.519380
3  0.563630 -0.476035  0.529808  ... -0.508896  0.427447 -0.438776
4  0.539174 -0.457769  0.560786  ... -0.594534  0.431616 -0.481195

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7827
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8985
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8804
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0175, accuracy=0.1080
Testing SVM
  SVM Test Accuracy: 0.8568
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8307

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7457, Accuracy: 9306/12000 (78%)

Epoch 1 | Train Acc: 0.6418541666666666 | Test Acc: 0.7755 | Time: 1.3828635215759277 sec

Test set: Average loss: 0.5548, Accuracy: 9913/12000 (83%)

Epoch 2 | Train Acc: 0.813375 | Test Acc: 0.8260833333333333 | Time: 1.0278706550598145 sec

Test set: Average loss: 0.4774, Accuracy: 10173/12000 (85%)

Epoch 3 | Train Acc: 0.8476875 | Test Acc: 0.84775 | Time: 1.0196828842163086 sec

Test set: Average loss: 0.4271, Accuracy: 10351/12000 (86%)

Epoch 4 | Train Acc: 0.8651666666666666 | Test Acc: 0.8625833333333334 | Time: 1.0222997665405273 sec

Test set: Average loss: 0.3972, Accuracy: 10480/12000 (87%)

Epoch 5 | Train Acc: 0.8757916666666666 | Test Acc: 0.8733333333333333 | Time: 1.0846481323242188 sec

Test set: Average loss: 0.3790, Accuracy: 10542/12000 (88%)

Epoch 6 | Train Acc: 0.8830625 | Test Acc: 0.8785 | Time: 1.3060710430145264 sec

Test set: Average loss: 0.3657, Accuracy: 10606/12000 (88%)

Epoch 7 | Train Acc: 0.887625 | Test Acc: 0.8838333333333334 | Time: 1.1088860034942627 sec

Test set: Average loss: 0.3561, Accuracy: 10632/12000 (89%)

Epoch 8 | Train Acc: 0.8913125 | Test Acc: 0.886 | Time: 1.0240442752838135 sec

Test set: Average loss: 0.3487, Accuracy: 10662/12000 (89%)

Epoch 9 | Train Acc: 0.8937291666666667 | Test Acc: 0.8885 | Time: 1.0250017642974854 sec

Test set: Average loss: 0.3437, Accuracy: 10693/12000 (89%)

Epoch 10 | Train Acc: 0.8953958333333333 | Test Acc: 0.8910833333333333 | Time: 1.20729660987854 sec

Test set: Average loss: 0.3402, Accuracy: 10705/12000 (89%)

Epoch 11 | Train Acc: 0.8960416666666666 | Test Acc: 0.8920833333333333 | Time: 1.0251188278198242 sec

Test set: Average loss: 0.3379, Accuracy: 10713/12000 (89%)

Epoch 12 | Train Acc: 0.8968541666666666 | Test Acc: 0.89275 | Time: 1.0277769565582275 sec

Test set: Average loss: 0.3363, Accuracy: 10721/12000 (89%)

Epoch 13 | Train Acc: 0.8974583333333334 | Test Acc: 0.8934166666666666 | Time: 1.0255804061889648 sec

Test set: Average loss: 0.3353, Accuracy: 10720/12000 (89%)

Epoch 14 | Train Acc: 0.8975416666666667 | Test Acc: 0.8933333333333333 | Time: 1.017965316772461 sec

Test set: Average loss: 0.3346, Accuracy: 10729/12000 (89%)

Epoch 15 | Train Acc: 0.8979166666666667 | Test Acc: 0.8940833333333333 | Time: 1.0219569206237793 sec

Test set: Average loss: 0.3343, Accuracy: 10738/12000 (89%)

Epoch 16 | Train Acc: 0.8981458333333333 | Test Acc: 0.8948333333333334 | Time: 1.0531787872314453 sec

Test set: Average loss: 0.3340, Accuracy: 10738/12000 (89%)

Epoch 17 | Train Acc: 0.8983333333333333 | Test Acc: 0.8948333333333334 | Time: 1.3441431522369385 sec

Test set: Average loss: 0.3339, Accuracy: 10737/12000 (89%)

Epoch 18 | Train Acc: 0.8984375 | Test Acc: 0.89475 | Time: 1.1238293647766113 sec

Test set: Average loss: 0.3339, Accuracy: 10738/12000 (89%)

Epoch 19 | Train Acc: 0.8984791666666667 | Test Acc: 0.8948333333333334 | Time: 1.1167032718658447 sec

Test set: Average loss: 0.3338, Accuracy: 10741/12000 (90%)

Epoch 20 | Train Acc: 0.8984791666666667 | Test Acc: 0.8950833333333333 | Time: 1.0238337516784668 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -41.9129 | Coherence: 12.4582 | Separation: 54.3711 | Information gain: 8.5000 | Grad Norm: 42.3775 | Time: 0.5s
Step 0010 | Epoch 01 | Objective: -39.3889 | Coherence: 13.4487 | Separation: 52.8376 | Information gain: 8.5000 | Grad Norm: 41.9601 | Time: 0.7s
Step 0020 | Epoch 01 | Objective: -36.9019 | Coherence: 14.4451 | Separation: 51.3470 | Information gain: 8.3333 | Grad Norm: 41.3200 | Time: 0.9s
Step 0030 | Epoch 01 | Objective: -34.5936 | Coherence: 15.4497 | Separation: 50.0433 | Information gain: 8.3333 | Grad Norm: 39.2386 | Time: 1.2s
Step 0040 | Epoch 01 | Objective: -32.4423 | Coherence: 16.4626 | Separation: 48.9049 | Information gain: 8.3333 | Grad Norm: 38.0918 | Time: 1.4s
Step 0050 | Epoch 01 | Objective: -30.2375 | Coherence: 17.5070 | Separation: 47.7445 | Information gain: 8.3333 | Grad Norm: 38.3287 | Time: 1.6s
Step 0060 | Epoch 01 | Objective: -27.9324 | Coherence: 18.5540 | Separation: 46.4864 | Information gain: 8.3333 | Grad Norm: 37.9586 | Time: 1.8s
Step 0070 | Epoch 01 | Objective: -25.5645 | Coherence: 19.6399 | Separation: 45.2044 | Information gain: 8.3333 | Grad Norm: 37.1852 | Time: 2.1s
Step 0080 | Epoch 01 | Objective: -23.1838 | Coherence: 20.7297 | Separation: 43.9135 | Information gain: 8.3333 | Grad Norm: 36.0684 | Time: 2.3s
Step 0090 | Epoch 01 | Objective: -21.0236 | Coherence: 21.7905 | Separation: 42.8140 | Information gain: 8.1667 | Grad Norm: 35.1316 | Time: 2.5s
Step 0100 | Epoch 01 | Objective: -19.0583 | Coherence: 22.8124 | Separation: 41.8707 | Information gain: 8.1667 | Grad Norm: 33.9123 | Time: 2.7s
Step 0110 | Epoch 01 | Objective: -17.2805 | Coherence: 23.7164 | Separation: 40.9969 | Information gain: 8.1667 | Grad Norm: 33.6069 | Time: 3.0s
Step 0120 | Epoch 01 | Objective: -15.5213 | Coherence: 24.6207 | Separation: 40.1420 | Information gain: 8.3333 | Grad Norm: 31.1018 | Time: 3.2s
Step 0130 | Epoch 01 | Objective: -13.8494 | Coherence: 25.5432 | Separation: 39.3926 | Information gain: 8.0000 | Grad Norm: 33.0563 | Time: 3.4s
Step 0140 | Epoch 01 | Objective: -12.1705 | Coherence: 26.4537 | Separation: 38.6242 | Information gain: 8.0000 | Grad Norm: 33.0082 | Time: 3.6s
Step 0150 | Epoch 01 | Objective: -10.5603 | Coherence: 27.3489 | Separation: 37.9092 | Information gain: 8.0000 | Grad Norm: 31.9895 | Time: 3.9s
Step 0160 | Epoch 01 | Objective: -9.0056 | Coherence: 28.2088 | Separation: 37.2144 | Information gain: 8.3333 | Grad Norm: 30.4058 | Time: 4.1s
Step 0170 | Epoch 01 | Objective: -7.5213 | Coherence: 29.0221 | Separation: 36.5433 | Information gain: 8.1667 | Grad Norm: 31.6949 | Time: 4.3s
Step 0180 | Epoch 01 | Objective: -6.0213 | Coherence: 29.8012 | Separation: 35.8225 | Information gain: 8.3333 | Grad Norm: 31.4089 | Time: 4.6s
Step 0190 | Epoch 01 | Objective: -4.4910 | Coherence: 30.5708 | Separation: 35.0617 | Information gain: 8.6667 | Grad Norm: 30.3110 | Time: 4.8s
Step 0200 | Epoch 01 | Objective: -2.9706 | Coherence: 31.3301 | Separation: 34.3007 | Information gain: 8.6667 | Grad Norm: 30.3537 | Time: 5.0s
Step 0210 | Epoch 01 | Objective: -1.5828 | Coherence: 32.0667 | Separation: 33.6495 | Information gain: 8.5000 | Grad Norm: 29.0438 | Time: 5.2s
Step 0220 | Epoch 01 | Objective: -0.2491 | Coherence: 32.8210 | Separation: 33.0701 | Information gain: 8.5000 | Grad Norm: 30.6679 | Time: 5.5s
Step 0229 | Epoch 01 | Objective: 0.9611 | Coherence: 33.4761 | Separation: 32.5150 | Information gain: 8.6667 | Grad Norm: 26.9789 | Time: 5.7s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.645773  0.590648  0.441523  ...  0.583809  0.459728  0.535092
1  0.585279  0.642658  0.447397  ...  0.564250  0.497357  0.428724
2  0.421407  0.430565  0.589548  ...  0.269826  0.543383  0.436868
3  0.598606  0.528271  0.442603  ...  0.512264  0.443144  0.564830
4  0.484490  0.471056  0.400451  ...  0.465160  0.391978  0.425830

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7931
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8918
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8734
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.0169, accuracy=0.1013
Testing SVM
  SVM Test Accuracy: 0.8549
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8343

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.7093, Accuracy: 9337/12000 (78%)

Epoch 1 | Train Acc: 0.6686875 | Test Acc: 0.7780833333333333 | Time: 1.0198638439178467 sec

Test set: Average loss: 0.5374, Accuracy: 9993/12000 (83%)

Epoch 2 | Train Acc: 0.818375 | Test Acc: 0.83275 | Time: 1.0270614624023438 sec

Test set: Average loss: 0.4588, Accuracy: 10262/12000 (86%)

Epoch 3 | Train Acc: 0.8488333333333333 | Test Acc: 0.8551666666666666 | Time: 1.1617305278778076 sec

Test set: Average loss: 0.4178, Accuracy: 10390/12000 (87%)

Epoch 4 | Train Acc: 0.8626666666666667 | Test Acc: 0.8658333333333333 | Time: 1.1307668685913086 sec

Test set: Average loss: 0.3949, Accuracy: 10458/12000 (87%)

Epoch 5 | Train Acc: 0.8719583333333333 | Test Acc: 0.8715 | Time: 1.0933594703674316 sec

Test set: Average loss: 0.3813, Accuracy: 10519/12000 (88%)

Epoch 6 | Train Acc: 0.8768333333333334 | Test Acc: 0.8765833333333334 | Time: 1.136005163192749 sec

Test set: Average loss: 0.3719, Accuracy: 10550/12000 (88%)

Epoch 7 | Train Acc: 0.881875 | Test Acc: 0.8791666666666667 | Time: 1.025080680847168 sec

Test set: Average loss: 0.3654, Accuracy: 10575/12000 (88%)

Epoch 8 | Train Acc: 0.8843541666666667 | Test Acc: 0.88125 | Time: 1.019096851348877 sec

Test set: Average loss: 0.3610, Accuracy: 10605/12000 (88%)

Epoch 9 | Train Acc: 0.8868958333333333 | Test Acc: 0.88375 | Time: 1.0204617977142334 sec

Test set: Average loss: 0.3578, Accuracy: 10614/12000 (88%)

Epoch 10 | Train Acc: 0.8881041666666667 | Test Acc: 0.8845 | Time: 1.027815818786621 sec

Test set: Average loss: 0.3556, Accuracy: 10618/12000 (88%)

Epoch 11 | Train Acc: 0.8890833333333333 | Test Acc: 0.8848333333333334 | Time: 1.0361261367797852 sec

Test set: Average loss: 0.3539, Accuracy: 10626/12000 (89%)

Epoch 12 | Train Acc: 0.8899375 | Test Acc: 0.8855 | Time: 1.2394497394561768 sec

Test set: Average loss: 0.3527, Accuracy: 10638/12000 (89%)

Epoch 13 | Train Acc: 0.8903541666666667 | Test Acc: 0.8865 | Time: 1.2305033206939697 sec

Test set: Average loss: 0.3520, Accuracy: 10638/12000 (89%)

Epoch 14 | Train Acc: 0.89075 | Test Acc: 0.8865 | Time: 1.0261921882629395 sec

Test set: Average loss: 0.3514, Accuracy: 10642/12000 (89%)

Epoch 15 | Train Acc: 0.8908333333333334 | Test Acc: 0.8868333333333334 | Time: 1.1416053771972656 sec

Test set: Average loss: 0.3510, Accuracy: 10647/12000 (89%)

Epoch 16 | Train Acc: 0.8910833333333333 | Test Acc: 0.88725 | Time: 1.0242340564727783 sec

Test set: Average loss: 0.3508, Accuracy: 10651/12000 (89%)

Epoch 17 | Train Acc: 0.8912916666666667 | Test Acc: 0.8875833333333333 | Time: 1.0247750282287598 sec

Test set: Average loss: 0.3506, Accuracy: 10655/12000 (89%)

Epoch 18 | Train Acc: 0.8913541666666667 | Test Acc: 0.8879166666666667 | Time: 1.0235755443572998 sec

Test set: Average loss: 0.3504, Accuracy: 10656/12000 (89%)

Epoch 19 | Train Acc: 0.8914375 | Test Acc: 0.888 | Time: 1.0217347145080566 sec

Test set: Average loss: 0.3503, Accuracy: 10658/12000 (89%)

Epoch 20 | Train Acc: 0.8914583333333334 | Test Acc: 0.8881666666666667 | Time: 1.019759178161621 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -39.5019 | Coherence: 13.6646 | Separation: 55.4443 | Information gain: 6.8333 | Grad Norm: 42.6802 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -37.0524 | Coherence: 14.5238 | Separation: 53.8540 | Information gain: 6.8333 | Grad Norm: 41.6195 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -34.6052 | Coherence: 15.4863 | Separation: 52.4249 | Information gain: 7.0000 | Grad Norm: 41.7011 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -32.2725 | Coherence: 16.5177 | Separation: 51.1235 | Information gain: 7.0000 | Grad Norm: 40.1606 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -29.8897 | Coherence: 17.5872 | Separation: 49.8103 | Information gain: 7.0000 | Grad Norm: 41.0593 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -27.4276 | Coherence: 18.6632 | Separation: 48.4797 | Information gain: 7.1667 | Grad Norm: 39.7946 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -25.1015 | Coherence: 19.7474 | Separation: 47.2378 | Information gain: 7.1667 | Grad Norm: 38.7851 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -22.9958 | Coherence: 20.8429 | Separation: 46.2276 | Information gain: 7.1667 | Grad Norm: 36.4188 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -21.0673 | Coherence: 21.9397 | Separation: 45.3403 | Information gain: 7.0000 | Grad Norm: 35.5468 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -19.1246 | Coherence: 23.0038 | Separation: 44.5172 | Information gain: 7.1667 | Grad Norm: 33.9893 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -17.3811 | Coherence: 23.9931 | Separation: 43.7631 | Information gain: 7.1667 | Grad Norm: 34.1026 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -15.6685 | Coherence: 24.9672 | Separation: 43.0246 | Information gain: 7.1667 | Grad Norm: 32.2224 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -14.0128 | Coherence: 25.9026 | Separation: 42.3044 | Information gain: 7.1667 | Grad Norm: 33.2159 | Time: 2.9s
Step 0130 | Epoch 01 | Objective: -12.5047 | Coherence: 26.8437 | Separation: 41.7373 | Information gain: 7.1667 | Grad Norm: 30.9720 | Time: 3.1s
Step 0140 | Epoch 01 | Objective: -10.9748 | Coherence: 27.7366 | Separation: 41.1003 | Information gain: 7.1667 | Grad Norm: 31.1956 | Time: 3.4s
Step 0150 | Epoch 01 | Objective: -9.5332 | Coherence: 28.6072 | Separation: 40.5293 | Information gain: 7.1667 | Grad Norm: 29.5674 | Time: 3.6s
Step 0160 | Epoch 01 | Objective: -8.0647 | Coherence: 29.4687 | Separation: 39.9223 | Information gain: 7.1667 | Grad Norm: 30.9770 | Time: 3.9s
Step 0170 | Epoch 01 | Objective: -6.5475 | Coherence: 30.3209 | Separation: 39.2573 | Information gain: 7.1667 | Grad Norm: 29.6744 | Time: 4.2s
Step 0180 | Epoch 01 | Objective: -5.0392 | Coherence: 31.1524 | Separation: 38.5805 | Information gain: 7.1667 | Grad Norm: 29.5204 | Time: 4.4s
Step 0190 | Epoch 01 | Objective: -3.6666 | Coherence: 31.9649 | Separation: 38.0759 | Information gain: 7.3333 | Grad Norm: 28.4593 | Time: 4.7s
Step 0200 | Epoch 01 | Objective: -2.4396 | Coherence: 32.7268 | Separation: 37.6108 | Information gain: 7.3333 | Grad Norm: 29.5750 | Time: 5.0s
Step 0210 | Epoch 01 | Objective: -1.1898 | Coherence: 33.4795 | Separation: 37.1138 | Information gain: 7.3333 | Grad Norm: 28.3915 | Time: 5.2s
Step 0220 | Epoch 01 | Objective: -0.0180 | Coherence: 34.1500 | Separation: 36.6125 | Information gain: 7.3333 | Grad Norm: 27.9812 | Time: 5.5s
Step 0228 | Epoch 01 | Objective: 0.9400 | Coherence: 34.6615 | Separation: 36.1660 | Information gain: 7.3333 | Grad Norm: 27.2957 | Time: 5.7s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.579237  0.444010  0.514787  ...  0.486796  0.477841  0.534989
1  0.445100  0.581120  0.455752  ...  0.503298  0.457057  0.428408
2  0.531673  0.471747  0.607420  ...  0.517631  0.481933  0.471978
3  0.417096  0.436588  0.454974  ...  0.484668  0.530798  0.355692
4  0.496616  0.422406  0.495814  ...  0.424761  0.429453  0.528929

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.7897
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.8933
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8738
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.3920, accuracy=0.0594
Testing SVM
  SVM Test Accuracy: 0.8559
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8335

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6867, Accuracy: 9476/12000 (79%)

Epoch 1 | Train Acc: 0.6528125 | Test Acc: 0.7896666666666666 | Time: 1.2763950824737549 sec

Test set: Average loss: 0.5244, Accuracy: 10025/12000 (84%)

Epoch 2 | Train Acc: 0.8145833333333333 | Test Acc: 0.8354166666666667 | Time: 1.2024126052856445 sec

Test set: Average loss: 0.4634, Accuracy: 10245/12000 (85%)

Epoch 3 | Train Acc: 0.8417708333333334 | Test Acc: 0.85375 | Time: 1.0270719528198242 sec

Test set: Average loss: 0.4283, Accuracy: 10382/12000 (87%)

Epoch 4 | Train Acc: 0.856625 | Test Acc: 0.8651666666666666 | Time: 1.0227291584014893 sec

Test set: Average loss: 0.4024, Accuracy: 10465/12000 (87%)

Epoch 5 | Train Acc: 0.8672083333333334 | Test Acc: 0.8720833333333333 | Time: 1.0214154720306396 sec

Test set: Average loss: 0.3872, Accuracy: 10525/12000 (88%)

Epoch 6 | Train Acc: 0.8745208333333333 | Test Acc: 0.8770833333333333 | Time: 1.024620771408081 sec

Test set: Average loss: 0.3771, Accuracy: 10567/12000 (88%)

Epoch 7 | Train Acc: 0.8795833333333334 | Test Acc: 0.8805833333333334 | Time: 1.0227711200714111 sec

Test set: Average loss: 0.3695, Accuracy: 10602/12000 (88%)

Epoch 8 | Train Acc: 0.8827916666666666 | Test Acc: 0.8835 | Time: 1.0317704677581787 sec

Test set: Average loss: 0.3645, Accuracy: 10623/12000 (89%)

Epoch 9 | Train Acc: 0.8853541666666667 | Test Acc: 0.88525 | Time: 1.1537034511566162 sec

Test set: Average loss: 0.3611, Accuracy: 10630/12000 (89%)

Epoch 10 | Train Acc: 0.887 | Test Acc: 0.8858333333333334 | Time: 1.378218173980713 sec

Test set: Average loss: 0.3591, Accuracy: 10640/12000 (89%)

Epoch 11 | Train Acc: 0.888 | Test Acc: 0.8866666666666667 | Time: 1.0309526920318604 sec

Test set: Average loss: 0.3577, Accuracy: 10640/12000 (89%)

Epoch 12 | Train Acc: 0.8887291666666667 | Test Acc: 0.8866666666666667 | Time: 1.0356662273406982 sec

Test set: Average loss: 0.3568, Accuracy: 10642/12000 (89%)

Epoch 13 | Train Acc: 0.8893958333333334 | Test Acc: 0.8868333333333334 | Time: 1.0444934368133545 sec

Test set: Average loss: 0.3562, Accuracy: 10640/12000 (89%)

Epoch 14 | Train Acc: 0.8898541666666666 | Test Acc: 0.8866666666666667 | Time: 1.0393998622894287 sec

Test set: Average loss: 0.3559, Accuracy: 10639/12000 (89%)

Epoch 15 | Train Acc: 0.8901041666666667 | Test Acc: 0.8865833333333333 | Time: 1.0364313125610352 sec

Test set: Average loss: 0.3556, Accuracy: 10637/12000 (89%)

Epoch 16 | Train Acc: 0.8902708333333333 | Test Acc: 0.8864166666666666 | Time: 1.0414535999298096 sec

Test set: Average loss: 0.3553, Accuracy: 10640/12000 (89%)

Epoch 17 | Train Acc: 0.8904166666666666 | Test Acc: 0.8866666666666667 | Time: 1.055492639541626 sec

Test set: Average loss: 0.3551, Accuracy: 10642/12000 (89%)

Epoch 18 | Train Acc: 0.8904375 | Test Acc: 0.8868333333333334 | Time: 1.03706693649292 sec
Early stopping at epoch 18

Testing with M=15
Step 0000 | Epoch 01 | Objective: -29.9907 | Coherence: 13.3376 | Separation: 47.9949 | Information gain: 7.0000 | Grad Norm: 39.9283 | Time: 0.0s
Step 0010 | Epoch 01 | Objective: -27.3088 | Coherence: 14.6247 | Separation: 46.6001 | Information gain: 7.0000 | Grad Norm: 38.1815 | Time: 0.3s
Step 0020 | Epoch 01 | Objective: -24.8303 | Coherence: 15.9002 | Separation: 45.3972 | Information gain: 7.0000 | Grad Norm: 37.9129 | Time: 0.5s
Step 0030 | Epoch 01 | Objective: -22.3542 | Coherence: 17.1430 | Separation: 44.1639 | Information gain: 7.0000 | Grad Norm: 37.0742 | Time: 0.7s
Step 0040 | Epoch 01 | Objective: -19.9593 | Coherence: 18.3043 | Separation: 42.9303 | Information gain: 7.0000 | Grad Norm: 37.0437 | Time: 1.0s
Step 0050 | Epoch 01 | Objective: -17.6969 | Coherence: 19.3608 | Separation: 41.7244 | Information gain: 7.0000 | Grad Norm: 35.8080 | Time: 1.2s
Step 0060 | Epoch 01 | Objective: -15.5760 | Coherence: 20.4569 | Separation: 40.6996 | Information gain: 7.0000 | Grad Norm: 34.1471 | Time: 1.4s
Step 0070 | Epoch 01 | Objective: -13.5219 | Coherence: 21.5588 | Separation: 39.7473 | Information gain: 7.0000 | Grad Norm: 34.1987 | Time: 1.6s
Step 0080 | Epoch 01 | Objective: -11.5184 | Coherence: 22.6700 | Separation: 38.8551 | Information gain: 7.0000 | Grad Norm: 32.9444 | Time: 1.9s
Step 0090 | Epoch 01 | Objective: -9.4788 | Coherence: 23.8207 | Separation: 37.9662 | Information gain: 7.0000 | Grad Norm: 32.3869 | Time: 2.1s
Step 0100 | Epoch 01 | Objective: -7.4667 | Coherence: 24.9487 | Separation: 37.0821 | Information gain: 7.0000 | Grad Norm: 34.7470 | Time: 2.3s
Step 0110 | Epoch 01 | Objective: -5.3468 | Coherence: 26.1286 | Separation: 36.2532 | Information gain: 7.1667 | Grad Norm: 31.8900 | Time: 2.6s
Step 0120 | Epoch 01 | Objective: -3.3479 | Coherence: 27.2875 | Separation: 35.4132 | Information gain: 7.1667 | Grad Norm: 32.8970 | Time: 2.8s
Step 0130 | Epoch 01 | Objective: -1.3959 | Coherence: 28.4178 | Separation: 34.5915 | Information gain: 7.1667 | Grad Norm: 32.6899 | Time: 3.0s
Step 0140 | Epoch 01 | Objective: 0.2785 | Coherence: 29.4794 | Separation: 33.9787 | Information gain: 7.1667 | Grad Norm: 30.0712 | Time: 3.3s
Step 0145 | Epoch 01 | Objective: 1.0582 | Coherence: 29.9570 | Separation: 33.6766 | Information gain: 7.1667 | Grad Norm: 29.3286 | Time: 3.4s
Similarity matrix:
          0         1         2  ...        12        13        14
0 -0.572451  0.443926 -0.498439  ...  0.498876  0.467161  0.468348
1 -0.487566  0.586581 -0.386316  ...  0.496800  0.412675  0.377800
2 -0.544248  0.424101 -0.629250  ...  0.495785  0.629503  0.555224
3 -0.490073  0.566793 -0.485624  ...  0.514760  0.512994  0.396493
4 -0.530273  0.504565 -0.460725  ...  0.560182  0.458951  0.421030

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8037
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9026
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8836
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 5.1069, accuracy=0.0983
Testing SVM
  SVM Test Accuracy: 0.8676
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8461

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.5999, Accuracy: 9897/12000 (82%)

Epoch 1 | Train Acc: 0.6908333333333333 | Test Acc: 0.82475 | Time: 1.074847936630249 sec

Test set: Average loss: 0.4712, Accuracy: 10204/12000 (85%)

Epoch 2 | Train Acc: 0.8367916666666667 | Test Acc: 0.8503333333333334 | Time: 1.0290617942810059 sec

Test set: Average loss: 0.4081, Accuracy: 10408/12000 (87%)

Epoch 3 | Train Acc: 0.8607916666666666 | Test Acc: 0.8673333333333333 | Time: 1.0235481262207031 sec

Test set: Average loss: 0.3700, Accuracy: 10582/12000 (88%)

Epoch 4 | Train Acc: 0.8758125 | Test Acc: 0.8818333333333334 | Time: 1.022853136062622 sec

Test set: Average loss: 0.3457, Accuracy: 10663/12000 (89%)

Epoch 5 | Train Acc: 0.8859375 | Test Acc: 0.8885833333333333 | Time: 1.0230193138122559 sec

Test set: Average loss: 0.3309, Accuracy: 10713/12000 (89%)

Epoch 6 | Train Acc: 0.8927708333333333 | Test Acc: 0.89275 | Time: 1.0271198749542236 sec

Test set: Average loss: 0.3202, Accuracy: 10742/12000 (90%)

Epoch 7 | Train Acc: 0.897 | Test Acc: 0.8951666666666667 | Time: 1.0396244525909424 sec

Test set: Average loss: 0.3128, Accuracy: 10787/12000 (90%)

Epoch 8 | Train Acc: 0.8997291666666667 | Test Acc: 0.8989166666666667 | Time: 1.2301809787750244 sec

Test set: Average loss: 0.3076, Accuracy: 10798/12000 (90%)

Epoch 9 | Train Acc: 0.90125 | Test Acc: 0.8998333333333334 | Time: 1.1081783771514893 sec

Test set: Average loss: 0.3042, Accuracy: 10805/12000 (90%)

Epoch 10 | Train Acc: 0.9021875 | Test Acc: 0.9004166666666666 | Time: 1.1896476745605469 sec

Test set: Average loss: 0.3020, Accuracy: 10819/12000 (90%)

Epoch 11 | Train Acc: 0.9032708333333334 | Test Acc: 0.9015833333333333 | Time: 1.0247912406921387 sec

Test set: Average loss: 0.3006, Accuracy: 10836/12000 (90%)

Epoch 12 | Train Acc: 0.9041458333333333 | Test Acc: 0.903 | Time: 1.023484706878662 sec

Test set: Average loss: 0.2996, Accuracy: 10843/12000 (90%)

Epoch 13 | Train Acc: 0.9045833333333333 | Test Acc: 0.9035833333333333 | Time: 1.0179157257080078 sec

Test set: Average loss: 0.2990, Accuracy: 10844/12000 (90%)

Epoch 14 | Train Acc: 0.9049375 | Test Acc: 0.9036666666666666 | Time: 1.0218300819396973 sec

Test set: Average loss: 0.2985, Accuracy: 10846/12000 (90%)

Epoch 15 | Train Acc: 0.9052083333333333 | Test Acc: 0.9038333333333334 | Time: 1.023616075515747 sec

Test set: Average loss: 0.2981, Accuracy: 10847/12000 (90%)

Epoch 16 | Train Acc: 0.9056666666666666 | Test Acc: 0.9039166666666667 | Time: 1.0278871059417725 sec

Test set: Average loss: 0.2978, Accuracy: 10849/12000 (90%)

Epoch 17 | Train Acc: 0.9056875 | Test Acc: 0.9040833333333333 | Time: 1.0193510055541992 sec

Test set: Average loss: 0.2977, Accuracy: 10851/12000 (90%)

Epoch 18 | Train Acc: 0.9055833333333333 | Test Acc: 0.90425 | Time: 1.1186931133270264 sec

Test set: Average loss: 0.2976, Accuracy: 10853/12000 (90%)

Epoch 19 | Train Acc: 0.9056458333333334 | Test Acc: 0.9044166666666666 | Time: 1.0266931056976318 sec

Test set: Average loss: 0.2975, Accuracy: 10855/12000 (90%)

Epoch 20 | Train Acc: 0.9056666666666666 | Test Acc: 0.9045833333333333 | Time: 1.0348353385925293 sec

Testing with M=15
Step 0000 | Epoch 01 | Objective: -29.3919 | Coherence: 17.7449 | Separation: 55.8034 | Information gain: 8.6667 | Grad Norm: 43.5214 | Time: 0.1s
Step 0010 | Epoch 01 | Objective: -26.2924 | Coherence: 18.7576 | Separation: 53.8833 | Information gain: 8.8333 | Grad Norm: 42.5331 | Time: 0.4s
Step 0020 | Epoch 01 | Objective: -23.7635 | Coherence: 19.6891 | Separation: 52.1193 | Information gain: 8.6667 | Grad Norm: 40.6845 | Time: 0.6s
Step 0030 | Epoch 01 | Objective: -21.1542 | Coherence: 20.6420 | Separation: 50.4628 | Information gain: 8.6667 | Grad Norm: 39.9334 | Time: 0.9s
Step 0040 | Epoch 01 | Objective: -18.7982 | Coherence: 21.6433 | Separation: 49.1082 | Information gain: 8.6667 | Grad Norm: 36.4262 | Time: 1.2s
Step 0050 | Epoch 01 | Objective: -16.7205 | Coherence: 22.7194 | Separation: 47.9399 | Information gain: 8.5000 | Grad Norm: 36.0314 | Time: 1.4s
Step 0060 | Epoch 01 | Objective: -14.5249 | Coherence: 23.8527 | Separation: 46.8776 | Information gain: 8.5000 | Grad Norm: 36.7719 | Time: 1.7s
Step 0070 | Epoch 01 | Objective: -12.5170 | Coherence: 24.9818 | Separation: 45.9988 | Information gain: 8.5000 | Grad Norm: 33.7944 | Time: 2.0s
Step 0080 | Epoch 01 | Objective: -10.6071 | Coherence: 26.0063 | Separation: 45.1134 | Information gain: 8.5000 | Grad Norm: 33.5141 | Time: 2.2s
Step 0090 | Epoch 01 | Objective: -8.7055 | Coherence: 27.0260 | Separation: 44.2316 | Information gain: 8.5000 | Grad Norm: 32.8153 | Time: 2.5s
Step 0100 | Epoch 01 | Objective: -6.6602 | Coherence: 28.0150 | Separation: 43.3418 | Information gain: 8.6667 | Grad Norm: 32.6246 | Time: 2.8s
Step 0110 | Epoch 01 | Objective: -4.7334 | Coherence: 28.9887 | Separation: 42.3888 | Information gain: 8.6667 | Grad Norm: 33.7690 | Time: 3.0s
Step 0120 | Epoch 01 | Objective: -2.9681 | Coherence: 29.9507 | Separation: 41.5854 | Information gain: 8.6667 | Grad Norm: 31.1992 | Time: 3.2s
Step 0130 | Epoch 01 | Objective: -1.2057 | Coherence: 30.8430 | Separation: 40.8820 | Information gain: 8.8333 | Grad Norm: 28.8425 | Time: 3.5s
Step 0140 | Epoch 01 | Objective: 0.1704 | Coherence: 31.5954 | Separation: 40.2584 | Information gain: 8.8333 | Grad Norm: 28.8071 | Time: 3.7s
Step 0146 | Epoch 01 | Objective: 0.9766 | Coherence: 32.0231 | Separation: 39.8799 | Information gain: 8.8333 | Grad Norm: 28.8505 | Time: 3.9s
Similarity matrix:
          0         1         2  ...        12        13        14
0  0.608233  0.420717  0.477537  ...  0.584022  0.529851  0.496952
1  0.443858  0.644518  0.599988  ...  0.454821  0.415393  0.481218
2  0.504354  0.603172  0.645745  ...  0.528579  0.447854  0.555839
3  0.477578  0.423449  0.445914  ...  0.464100  0.446489  0.511169
4  0.547062  0.496736  0.533920  ...  0.545464  0.460870  0.468965

[5 rows x 15 columns]
  Testing with max_depth=15
  MNIST DecisionTree Test accuracy (M=15, max_depth=15): 0.8050
  Testing XGBoost with max_depth=None
  MNIST XGBoost Test accuracy (M=15, max_depth=None): 0.9041
  Testing Random Forest with max_depth=None
  MNIST RandomForest Test accuracy (M=15, max_depth=None): 0.8857
  Testing ElasticNet with alpha=0.01, l1_ratio=0.5
  ElasticNet Test MSE (M=15, alpha=0.01, l1_ratio=0.5): 4.8896, accuracy=0.1040
Testing SVM
  SVM Test Accuracy: 0.8647
Testing Logistic Regression
  Logistic Regression Test Accuracy: 0.8406

Baseline test with Neural Network trained on concepts
Input shape: torch.Size([60000, 15]), target shapetorch.Size([60000])
Training set size: 48000, test set size: 12000

Test set: Average loss: 0.6495, Accuracy: 9693/12000 (81%)

Epoch 1 | Train Acc: 0.6736875 | Test Acc: 0.80775 | Time: 1.4372189044952393 sec

Test set: Average loss: 0.4836, Accuracy: 10243/12000 (85%)

Epoch 2 | Train Acc: 0.8296458333333333 | Test Acc: 0.8535833333333334 | Time: 1.2008943557739258 sec

Test set: Average loss: 0.4121, Accuracy: 10513/12000 (88%)

Epoch 3 | Train Acc: 0.8608125 | Test Acc: 0.8760833333333333 | Time: 1.023000717163086 sec

Test set: Average loss: 0.3756, Accuracy: 10609/12000 (88%)

Epoch 4 | Train Acc: 0.8768125 | Test Acc: 0.8840833333333333 | Time: 1.022825002670288 sec

Test set: Average loss: 0.3558, Accuracy: 10676/12000 (89%)

Epoch 5 | Train Acc: 0.8865625 | Test Acc: 0.8896666666666667 | Time: 1.0255393981933594 sec

Test set: Average loss: 0.3416, Accuracy: 10729/12000 (89%)

Epoch 6 | Train Acc: 0.8927083333333333 | Test Acc: 0.8940833333333333 | Time: 1.273815631866455 sec

Test set: Average loss: 0.3327, Accuracy: 10757/12000 (90%)

Epoch 7 | Train Acc: 0.8967291666666667 | Test Acc: 0.8964166666666666 | Time: 1.2759199142456055 sec

Test set: Average loss: 0.3263, Accuracy: 10780/12000 (90%)

Epoch 8 | Train Acc: 0.90025 | Test Acc: 0.8983333333333333 | Time: 1.2037062644958496 sec

Test set: Average loss: 0.3217, Accuracy: 10793/12000 (90%)

Epoch 9 | Train Acc: 0.902125 | Test Acc: 0.8994166666666666 | Time: 1.1303415298461914 sec

Test set: Average loss: 0.3184, Accuracy: 10796/12000 (90%)

Epoch 10 | Train Acc: 0.9028333333333334 | Test Acc: 0.8996666666666666 | Time: 1.4477243423461914 sec

Test set: Average loss: 0.3162, Accuracy: 10805/12000 (90%)

Epoch 11 | Train Acc: 0.903875 | Test Acc: 0.9004166666666666 | Time: 1.037975788116455 sec

Test set: Average loss: 0.3149, Accuracy: 10805/12000 (90%)

Epoch 12 | Train Acc: 0.9047291666666667 | Test Acc: 0.9004166666666666 | Time: 1.1490657329559326 sec

Test set: Average loss: 0.3140, Accuracy: 10812/12000 (90%)

Epoch 13 | Train Acc: 0.905 | Test Acc: 0.901 | Time: 1.3003435134887695 sec

Test set: Average loss: 0.3134, Accuracy: 10812/12000 (90%)

Epoch 14 | Train Acc: 0.9052708333333334 | Test Acc: 0.901 | Time: 1.4654591083526611 sec

Test set: Average loss: 0.3130, Accuracy: 10808/12000 (90%)

Epoch 15 | Train Acc: 0.9057291666666667 | Test Acc: 0.9006666666666666 | Time: 1.4191181659698486 sec

Test set: Average loss: 0.3128, Accuracy: 10808/12000 (90%)

Epoch 16 | Train Acc: 0.9057708333333333 | Test Acc: 0.9006666666666666 | Time: 1.0246751308441162 sec

Test set: Average loss: 0.3126, Accuracy: 10810/12000 (90%)

Epoch 17 | Train Acc: 0.9057291666666667 | Test Acc: 0.9008333333333334 | Time: 1.023892879486084 sec

Test set: Average loss: 0.3125, Accuracy: 10810/12000 (90%)

Epoch 18 | Train Acc: 0.9057083333333333 | Test Acc: 0.9008333333333334 | Time: 1.0274622440338135 sec
Early stopping at epoch 18

Baseline test with max_depth=15
Perfect info MNIST DecisionTree Test accuracy (max_depth=15): 0.8818

Results have been saved to json_results/cav_experiment_results.json
Linux idun-03-22 5.14.0-427.13.1.el9_4.x86_64 #1 SMP PREEMPT_DYNAMIC Wed May 1 19:11:28 UTC 2024 x86_64 x86_64 x86_64 GNU/Linux
[1;34mwandb[0m: 
[1;34mwandb[0m: 🚀 View run [33mdenim-universe-10[0m at: [34mhttps://wandb.ai/eirikreiestad-ntnu/multi-gtg-30-static/runs/mvyypaz9[0m
Linux idun-03-01 5.14.0-427.13.1.el9_4.x86_64 #1 SMP PREEMPT_DYNAMIC Wed May 1 19:11:28 UTC 2024 x86_64 x86_64 x86_64 GNU/Linux
