wandb: Currently logged in as: eirikreiestad (eirikreiestad-ntnu) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: eirikreiestad (eirikreiestad-ntnu) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.19.6
wandb: Run data is saved locally in ./wandb/run-20250326_112825-n2r5afy2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eager-serenity-6
wandb: ‚≠êÔ∏è View project at https://wandb.ai/eirikreiestad-ntnu/go-to-goal-ppo-1-7
wandb: üöÄ View run at https://wandb.ai/eirikreiestad-ntnu/go-to-goal-ppo-1-7/runs/n2r5afy2
Traceback (most recent call last):
  File "/cluster/work/eirre/xai-multiworld/examples/go_to_goal_ppo.py", line 42, in <module>
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/algorithm.py", line 36, in learn
    self.collect_rollouts()
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/algorithm.py", line 59, in collect_rollouts
    self.train_step(
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/ppo/ppo.py", line 99, in train_step
    self._optimize_model()
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/ppo/ppo.py", line 195, in _optimize_model
    self._optimize_model_batch()
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/ppo/ppo.py", line 201, in _optimize_model_batch
    self._optimize_model_minibatch(buffer_list)
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/ppo/ppo.py", line 213, in _optimize_model_minibatch
    loss += self._optimize_model_minibatch_episode(buff)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/ppo/ppo.py", line 248, in _optimize_model_minibatch_episode
    _, action_logits, value = self._predict(state, requires_grad=True)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/ppo/ppo.py", line 132, in _predict
    action, log_prob = self._get_action(action_logit)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/ppo/ppo.py", line 154, in _get_action
    return self._get_discrete_action(action_logits=action_logits)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/ppo/ppo.py", line 160, in _get_discrete_action
    action = dist.sample()
             ^^^^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/distributions/categorical.py", line 133, in sample
    probs_2d = self.probs.reshape(-1, self._num_events)
               ^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/distributions/utils.py", line 149, in __get__
    value = self.wrapped(instance)
            ^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/distributions/categorical.py", line 102, in probs
    return logits_to_probs(self.logits)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/distributions/utils.py", line 91, in logits_to_probs
    return F.softmax(logits, dim=-1)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/nn/functional.py", line 2140, in softmax
    ret = input.softmax(dim)
          ^^^^^^^^^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/fx/traceback.py", line 175, in format_stack
    return traceback.format_list(traceback.extract_stack()[:-1])
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/eb/software/Python/3.11.3-GCCcore-12.3.0/lib/python3.11/traceback.py", line 231, in extract_stack
    stack = StackSummary.extract(walk_stack(f), limit=limit)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/eb/software/Python/3.11.3-GCCcore-12.3.0/lib/python3.11/traceback.py", line 393, in extract
    return klass._extract_from_extended_frame_gen(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/eb/software/Python/3.11.3-GCCcore-12.3.0/lib/python3.11/traceback.py", line 432, in _extract_from_extended_frame_gen
    linecache.checkcache(filename)
  File "/cluster/apps/eb/software/Python/3.11.3-GCCcore-12.3.0/lib/python3.11/linecache.py", line 72, in checkcache
    stat = os.stat(fullname)
           ^^^^^^^^^^^^^^^^^
KeyboardInterrupt
Traceback (most recent call last):
  File "/cluster/work/eirre/xai-multiworld/examples/go_to_goal_ppo.py", line 42, in <module>
    ppo.learn()
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/algorithm.py", line 36, in learn
    self.collect_rollouts()
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/algorithm.py", line 59, in collect_rollouts
    self.train_step(
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/ppo/ppo.py", line 99, in train_step
    self._optimize_model()
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/ppo/ppo.py", line 195, in _optimize_model
    self._optimize_model_batch()
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/ppo/ppo.py", line 201, in _optimize_model_batch
    self._optimize_model_minibatch(buffer_list)
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/ppo/ppo.py", line 213, in _optimize_model_minibatch
    loss += self._optimize_model_minibatch_episode(buff)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/ppo/ppo.py", line 248, in _optimize_model_minibatch_episode
    _, action_logits, value = self._predict(state, requires_grad=True)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/ppo/ppo.py", line 125, in _predict
    action_probabilities, policy_values = self._get_policy_values(
                                          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/work/eirre/xai-multiworld/rllib/algorithms/ppo/ppo.py", line 182, in _get_policy_values
    return self._actor_net(*torch_observations), self._critic_net(
                                                 ^^^^^^^^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/work/eirre/xai-multiworld/rllib/core/network/multi_input_network.py", line 54, in forward
    x = self._conv0(x)
        ^^^^^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/work/eirre/xai-multiworld/rllib/core/network/processor.py", line 14, in forward
    return self.conv_layers(x)
           ^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
  File "/cluster/home/eirre/.cache/pypoetry/virtualenvs/xai-multiworld-o99YJ8Jy-py3.11/lib/python3.11/site-packages/torch/fx/traceback.py", line 169, in format_stack
    @compatibility(is_backward_compatible=False)
    
KeyboardInterrupt
